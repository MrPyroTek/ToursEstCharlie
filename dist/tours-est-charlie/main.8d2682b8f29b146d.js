"use strict";(self.webpackChunkToursEstCharlie=self.webpackChunkToursEstCharlie||[]).push([[792],{76:(so,wr,ot)=>{ot.d(wr,{$L:()=>Ke,$g:()=>wu,A4:()=>_e,Am:()=>Cu,As:()=>wt,Bd:()=>fe,Cv:()=>$n,FA:()=>Re,Fy:()=>ni,HN:()=>Ar,Hk:()=>Me,I9:()=>ii,Im:()=>Ca,K3:()=>Ve,KA:()=>Tr,Ku:()=>Ra,Ll:()=>hn,OE:()=>kr,T9:()=>an,Uj:()=>Vt,XA:()=>Mt,ZQ:()=>Ye,bD:()=>oo,cY:()=>xt,dI:()=>Us,eX:()=>se,g:()=>ue,gR:()=>nr,gz:()=>si,hp:()=>Yc,jZ:()=>Mn,kH:()=>Tu,kj:()=>js,lT:()=>zr,lV:()=>ri,nr:()=>K,oD:()=>Au,od:()=>Vs,p7:()=>fn,qc:()=>Tn,sr:()=>jn,tD:()=>ds,u:()=>de,vA:()=>Fe,yw:()=>Ht,zW:()=>Z,zw:()=>Ue});const S={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Fe=function(M,P){if(!M)throw Me(P)},Me=function(M){return new Error("Firebase Database ("+S.SDK_VERSION+") INTERNAL ASSERT FAILED: "+M)},X=function(M){const P=[];let L=0;for(let re=0;re<M.length;re++){let G=M.charCodeAt(re);G<128?P[L++]=G:G<2048?(P[L++]=G>>6|192,P[L++]=63&G|128):55296==(64512&G)&&re+1<M.length&&56320==(64512&M.charCodeAt(re+1))?(G=65536+((1023&G)<<10)+(1023&M.charCodeAt(++re)),P[L++]=G>>18|240,P[L++]=G>>12&63|128,P[L++]=G>>6&63|128,P[L++]=63&G|128):(P[L++]=G>>12|224,P[L++]=G>>6&63|128,P[L++]=63&G|128)}return P},Ve={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(M,P){if(!Array.isArray(M))throw Error("encodeByteArray takes an array as a parameter");this.init_();const L=P?this.byteToCharMapWebSafe_:this.byteToCharMap_,re=[];for(let G=0;G<M.length;G+=3){const De=M[G],Oe=G+1<M.length,Be=Oe?M[G+1]:0,ai=G+2<M.length,Ae=ai?M[G+2]:0;let Lr=(15&Be)<<2|Ae>>6,$s=63&Ae;ai||($s=64,Oe||(Lr=64)),re.push(L[De>>2],L[(3&De)<<4|Be>>4],L[Lr],L[$s])}return re.join("")},encodeString(M,P){return this.HAS_NATIVE_SUPPORT&&!P?btoa(M):this.encodeByteArray(X(M),P)},decodeString(M,P){return this.HAS_NATIVE_SUPPORT&&!P?atob(M):function(M){const P=[];let L=0,re=0;for(;L<M.length;){const G=M[L++];if(G<128)P[re++]=String.fromCharCode(G);else if(G>191&&G<224){const De=M[L++];P[re++]=String.fromCharCode((31&G)<<6|63&De)}else if(G>239&&G<365){const ai=((7&G)<<18|(63&M[L++])<<12|(63&M[L++])<<6|63&M[L++])-65536;P[re++]=String.fromCharCode(55296+(ai>>10)),P[re++]=String.fromCharCode(56320+(1023&ai))}else{const De=M[L++],Oe=M[L++];P[re++]=String.fromCharCode((15&G)<<12|(63&De)<<6|63&Oe)}}return P.join("")}(this.decodeStringToByteArray(M,P))},decodeStringToByteArray(M,P){this.init_();const L=P?this.charToByteMapWebSafe_:this.charToByteMap_,re=[];for(let G=0;G<M.length;){const De=L[M.charAt(G++)],Be=G<M.length?L[M.charAt(G)]:0;++G;const Ae=G<M.length?L[M.charAt(G)]:64;++G;const ut=G<M.length?L[M.charAt(G)]:64;if(++G,null==De||null==Be||null==Ae||null==ut)throw new Pn;re.push(De<<2|Be>>4),64!==Ae&&(re.push(Be<<4&240|Ae>>2),64!==ut&&re.push(Ae<<6&192|ut))}return re},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let M=0;M<this.ENCODED_VALS.length;M++)this.byteToCharMap_[M]=this.ENCODED_VALS.charAt(M),this.charToByteMap_[this.byteToCharMap_[M]]=M,this.byteToCharMapWebSafe_[M]=this.ENCODED_VALS_WEBSAFE.charAt(M),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[M]]=M,M>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(M)]=M,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(M)]=M)}}};class Pn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Tr=function(M){const P=X(M);return Ve.encodeByteArray(P,!0)},Vt=function(M){return Tr(M).replace(/\./g,"")},de=function(M){try{return Ve.decodeString(M,!0)}catch(P){console.error("base64Decode failed: ",P)}return null};function _e(M){return Ue(void 0,M)}function Ue(M,P){if(!(P instanceof Object))return P;switch(P.constructor){case Date:return new Date(P.getTime());case Object:void 0===M&&(M={});break;case Array:M=[];break;default:return P}for(const L in P)!P.hasOwnProperty(L)||!ft(L)||(M[L]=Ue(M[L],P[L]));return M}function ft(M){return"__proto__"!==M}const pt=()=>{try{return function Rt(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const M=process.env.__FIREBASE_DEFAULTS__;return M?JSON.parse(M):void 0})()||(()=>{if(typeof document>"u")return;let M;try{M=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const P=M&&de(M[1]);return P&&JSON.parse(P)})()}catch(M){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${M}`)}},an=()=>{var M;return null===(M=pt())||void 0===M?void 0:M.config},Mt=M=>{var P;return null===(P=pt())||void 0===P?void 0:P[`_${M}`]};class xt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((P,L)=>{this.resolve=P,this.reject=L})}wrapCallback(P){return(L,re)=>{L?this.reject(L):this.resolve(re),"function"==typeof P&&(this.promise.catch(()=>{}),1===P.length?P(L):P(L,re))}}}function ni(M,P){if(M.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const re=P||"demo-project",G=M.iat||0,De=M.sub||M.user_id;if(!De)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Oe=Object.assign({iss:`https://securetoken.google.com/${re}`,aud:re,iat:G,exp:G+3600,auth_time:G,sub:De,user_id:De,firebase:{sign_in_provider:"custom",identities:{}}},M);return[Vt(JSON.stringify({alg:"none",type:"JWT"})),Vt(JSON.stringify(Oe)),""].join(".")}function Ye(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Mn(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ye())}function hn(){var M;const P=null===(M=pt())||void 0===M?void 0:M.forceEnvironment;if("node"===P)return!0;if("browser"===P)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function fe(){return typeof window<"u"||fn()}function fn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function jn(){const M="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof M&&void 0!==M.id}function ri(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function zr(){const M=Ye();return M.indexOf("MSIE ")>=0||M.indexOf("Trident/")>=0}function wu(){return!0===S.NODE_CLIENT||!0===S.NODE_ADMIN}function K(){return!hn()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Z(){try{return"object"==typeof indexedDB}catch{return!1}}function se(){return new Promise((M,P)=>{try{let L=!0;const re="validate-browser-context-for-indexeddb-analytics-module",G=self.indexedDB.open(re);G.onsuccess=()=>{G.result.close(),L||self.indexedDB.deleteDatabase(re),M(!0)},G.onupgradeneeded=()=>{L=!1},G.onerror=()=>{var De;P((null===(De=G.error)||void 0===De?void 0:De.message)||"")}}catch(L){P(L)}})}class ue extends Error{constructor(P,L,re){super(L),this.code=P,this.customData=re,this.name="FirebaseError",Object.setPrototypeOf(this,ue.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Re.prototype.create)}}class Re{constructor(P,L,re){this.service=P,this.serviceName=L,this.errors=re}create(P,...L){const re=L[0]||{},G=`${this.service}/${P}`,De=this.errors[P],Oe=De?function Ct(M,P){return M.replace(xn,(L,re)=>{const G=P[re];return null!=G?String(G):`<${re}?>`})}(De,re):"Error";return new ue(G,`${this.serviceName}: ${Oe} (${G}).`,re)}}const xn=/\{\$([^}]+)}/g;function Ke(M){return JSON.parse(M)}function wt(M){return JSON.stringify(M)}const Yt=function(M){let P={},L={},re={},G="";try{const De=M.split(".");P=Ke(de(De[0])||""),L=Ke(de(De[1])||""),G=De[2],re=L.d||{},delete L.d}catch{}return{header:P,claims:L,data:re,signature:G}},$n=function(M){const L=Yt(M).claims;return!!L&&"object"==typeof L&&L.hasOwnProperty("iat")},Tn=function(M){const P=Yt(M).claims;return"object"==typeof P&&!0===P.admin};function nr(M,P){return Object.prototype.hasOwnProperty.call(M,P)}function Ht(M,P){if(Object.prototype.hasOwnProperty.call(M,P))return M[P]}function Ca(M){for(const P in M)if(Object.prototype.hasOwnProperty.call(M,P))return!1;return!0}function Tu(M,P,L){const re={};for(const G in M)Object.prototype.hasOwnProperty.call(M,G)&&(re[G]=P.call(L,M[G],G,M));return re}function oo(M,P){if(M===P)return!0;const L=Object.keys(M),re=Object.keys(P);for(const G of L){if(!re.includes(G))return!1;const De=M[G],Oe=P[G];if(Ri(De)&&Ri(Oe)){if(!oo(De,Oe))return!1}else if(De!==Oe)return!1}for(const G of re)if(!L.includes(G))return!1;return!0}function Ri(M){return null!==M&&"object"==typeof M}function Cu(M){const P=[];for(const[L,re]of Object.entries(M))Array.isArray(re)?re.forEach(G=>{P.push(encodeURIComponent(L)+"="+encodeURIComponent(G))}):P.push(encodeURIComponent(L)+"="+encodeURIComponent(re));return P.length?"&"+P.join("&"):""}function ii(M){const P={};return M.replace(/^\?/,"").split("&").forEach(re=>{if(re){const[G,De]=re.split("=");P[decodeURIComponent(G)]=decodeURIComponent(De)}}),P}function Yc(M){const P=M.indexOf("?");if(!P)return"";const L=M.indexOf("#",P);return M.substring(P,L>0?L:void 0)}class si{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let P=1;P<this.blockSize;++P)this.pad_[P]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(P,L){L||(L=0);const re=this.W_;if("string"==typeof P)for(let ut=0;ut<16;ut++)re[ut]=P.charCodeAt(L)<<24|P.charCodeAt(L+1)<<16|P.charCodeAt(L+2)<<8|P.charCodeAt(L+3),L+=4;else for(let ut=0;ut<16;ut++)re[ut]=P[L]<<24|P[L+1]<<16|P[L+2]<<8|P[L+3],L+=4;for(let ut=16;ut<80;ut++){const Lr=re[ut-3]^re[ut-8]^re[ut-14]^re[ut-16];re[ut]=4294967295&(Lr<<1|Lr>>>31)}let Ae,rr,G=this.chain_[0],De=this.chain_[1],Oe=this.chain_[2],Be=this.chain_[3],ai=this.chain_[4];for(let ut=0;ut<80;ut++){ut<40?ut<20?(Ae=Be^De&(Oe^Be),rr=1518500249):(Ae=De^Oe^Be,rr=1859775393):ut<60?(Ae=De&Oe|Be&(De|Oe),rr=2400959708):(Ae=De^Oe^Be,rr=3395469782);const Lr=(G<<5|G>>>27)+Ae+ai+rr+re[ut]&4294967295;ai=Be,Be=Oe,Oe=4294967295&(De<<30|De>>>2),De=G,G=Lr}this.chain_[0]=this.chain_[0]+G&4294967295,this.chain_[1]=this.chain_[1]+De&4294967295,this.chain_[2]=this.chain_[2]+Oe&4294967295,this.chain_[3]=this.chain_[3]+Be&4294967295,this.chain_[4]=this.chain_[4]+ai&4294967295}update(P,L){if(null==P)return;void 0===L&&(L=P.length);const re=L-this.blockSize;let G=0;const De=this.buf_;let Oe=this.inbuf_;for(;G<L;){if(0===Oe)for(;G<=re;)this.compress_(P,G),G+=this.blockSize;if("string"==typeof P){for(;G<L;)if(De[Oe]=P.charCodeAt(G),++Oe,++G,Oe===this.blockSize){this.compress_(De),Oe=0;break}}else for(;G<L;)if(De[Oe]=P[G],++Oe,++G,Oe===this.blockSize){this.compress_(De),Oe=0;break}}this.inbuf_=Oe,this.total_+=L}digest(){const P=[];let L=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let G=this.blockSize-1;G>=56;G--)this.buf_[G]=255&L,L/=256;this.compress_(this.buf_);let re=0;for(let G=0;G<5;G++)for(let De=24;De>=0;De-=8)P[re]=this.chain_[G]>>De&255,++re;return P}}function ds(M,P){const L=new oi(M,P);return L.subscribe.bind(L)}class oi{constructor(P,L){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=L,this.task.then(()=>{P(this)}).catch(re=>{this.error(re)})}next(P){this.forEachObserver(L=>{L.next(P)})}error(P){this.forEachObserver(L=>{L.error(P)}),this.close(P)}complete(){this.forEachObserver(P=>{P.complete()}),this.close()}subscribe(P,L,re){let G;if(void 0===P&&void 0===L&&void 0===re)throw new Error("Missing Observer.");G=function Aa(M,P){if("object"!=typeof M||null===M)return!1;for(const L of P)if(L in M&&"function"==typeof M[L])return!0;return!1}(P,["next","error","complete"])?P:{next:P,error:L,complete:re},void 0===G.next&&(G.next=Fs),void 0===G.error&&(G.error=Fs),void 0===G.complete&&(G.complete=Fs);const De=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?G.error(this.finalError):G.complete()}catch{}}),this.observers.push(G),De}unsubscribeOne(P){void 0===this.observers||void 0===this.observers[P]||(delete this.observers[P],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(P){if(!this.finalized)for(let L=0;L<this.observers.length;L++)this.sendOne(L,P)}sendOne(P,L){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[P])try{L(this.observers[P])}catch(re){typeof console<"u"&&console.error&&console.error(re)}})}close(P){this.finalized||(this.finalized=!0,void 0!==P&&(this.finalError=P),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Fs(){}const Vs=function(M,P,L,re){let G;if(re<P?G="at least "+P:re>L&&(G=0===L?"none":"no more than "+L),G)throw new Error(M+" failed: Was called with "+re+(1===re?" argument.":" arguments.")+" Expects "+G+".")};function Us(M,P){return`${M} failed: ${P} argument `}function Au(M,P,L,re){if((!re||L)&&"function"!=typeof L)throw new Error(Us(M,P)+"must be a valid function.")}function Ar(M,P,L,re){if((!re||L)&&("object"!=typeof L||null===L))throw new Error(Us(M,P)+"must be a valid context object.")}const js=function(M){const P=[];let L=0;for(let re=0;re<M.length;re++){let G=M.charCodeAt(re);if(G>=55296&&G<=56319){const De=G-55296;re++,Fe(re<M.length,"Surrogate pair missing trail surrogate."),G=65536+(De<<10)+(M.charCodeAt(re)-56320)}G<128?P[L++]=G:G<2048?(P[L++]=G>>6|192,P[L++]=63&G|128):G<65536?(P[L++]=G>>12|224,P[L++]=G>>6&63|128,P[L++]=63&G|128):(P[L++]=G>>18|240,P[L++]=G>>12&63|128,P[L++]=G>>6&63|128,P[L++]=63&G|128)}return P},kr=function(M){let P=0;for(let L=0;L<M.length;L++){const re=M.charCodeAt(L);re<128?P++:re<2048?P+=2:re>=55296&&re<=56319?(P+=4,L++):P+=3}return P};function Ra(M){return M&&M._delegate?M._delegate:M}},470:(so,wr,ot)=>{function S(t,e){return Object.is(t,e)}let Fe=null,Me=!1,X=1;const Ft=Symbol("SIGNAL");function Ve(t){const e=Fe;return Fe=t,e}const de={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function _e(t){if(Me)throw new Error("");if(null===Fe)return;Fe.consumerOnSignalRead(t);const e=Fe.nextProducerIndex++;ni(Fe),e<Fe.producerNode.length&&Fe.producerNode[e]!==t&&xt(Fe)&&Mt(Fe.producerNode[e],Fe.producerIndexOfThis[e]),Fe.producerNode[e]!==t&&(Fe.producerNode[e]=t,Fe.producerIndexOfThis[e]=xt(Fe)?an(t,Fe,e):0),Fe.producerLastReadVersion[e]=t.version}function ft(t){if((!xt(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==X)){if(!t.producerMustRecompute(t)&&!tr(t))return t.dirty=!1,void(t.lastCleanEpoch=X);t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=X}}function Rt(t){if(void 0===t.liveConsumerNode)return;const e=Me;Me=!0;try{for(const n of t.liveConsumerNode)n.dirty||Ut(n)}finally{Me=e}}function fr(){return!1!==Fe?.consumerAllowSignalWrites}function Ut(t){t.dirty=!0,Rt(t),t.consumerMarkedDirty?.(t)}function at(t){return t&&(t.nextProducerIndex=0),Ve(t)}function pt(t,e){if(Ve(e),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(xt(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Mt(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function tr(t){ni(t);for(let e=0;e<t.producerNode.length;e++){const n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(ft(n),r!==n.version))return!0}return!1}function Cr(t){if(ni(t),xt(t))for(let e=0;e<t.producerNode.length;e++)Mt(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function an(t,e,n){if(Ye(t),0===t.liveConsumerNode.length&&Mn(t))for(let r=0;r<t.producerNode.length;r++)t.producerIndexOfThis[r]=an(t.producerNode[r],t,r);return t.liveConsumerIndexOfThis.push(n),t.liveConsumerNode.push(e)-1}function Mt(t,e){if(Ye(t),1===t.liveConsumerNode.length&&Mn(t))for(let r=0;r<t.producerNode.length;r++)Mt(t.producerNode[r],t.producerIndexOfThis[r]);const n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){const r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];ni(i),i.producerIndexOfThis[r]=e}}function xt(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function ni(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function Ye(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function Mn(t){return void 0!==t.producerNode}const fe=Symbol("UNSET"),fn=Symbol("COMPUTING"),jn=Symbol("ERRORED"),ri={...de,value:fe,dirty:!0,error:null,equal:S,producerMustRecompute:t=>t.value===fe||t.value===fn,producerRecomputeValue(t){if(t.value===fn)throw new Error("Detected cycle in computations.");const e=t.value;t.value=fn;const n=at(t);let r;try{r=t.computation()}catch(i){r=jn,t.error=i}finally{pt(t,n)}e!==fe&&e!==jn&&r!==jn&&t.equal(e,r)?t.value=e:(t.value=r,t.version++)}};let zr=function Os(){throw new Error};function Ta(){zr()}let K=null;function Ee(t,e){fr()||Ta(),t.equal(t.value,e)||(t.value=e,function xn(t){t.version++,function Ue(){X++}(),Rt(t),K?.()}(t))}const Ct={...de,equal:S,value:void 0};function ze(t){return"function"==typeof t}function $n(t){const n=t(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const Tn=$n(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function nr(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class Ht{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(ze(r))try{r()}catch(s){e=s instanceof Tn?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{oo(s)}catch(o){e=e??[],o instanceof Tn?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Tn(e)}}add(e){var n;if(e&&e!==this)if(this.closed)oo(e);else{if(e instanceof Ht){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&nr(n,e)}remove(e){const{_finalizers:n}=this;n&&nr(n,e),e instanceof Ht&&e._removeParent(this)}}Ht.EMPTY=(()=>{const t=new Ht;return t.closed=!0,t})();const Ca=Ht.EMPTY;function Tu(t){return t instanceof Ht||t&&"closed"in t&&ze(t.remove)&&ze(t.add)&&ze(t.unsubscribe)}function oo(t){ze(t)?t():t.unsubscribe()}const Ri={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ao={setTimeout(t,e,...n){const{delegate:r}=ao;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){const{delegate:e}=ao;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Cu(t){ao.setTimeout(()=>{const{onUnhandledError:e}=Ri;if(!e)throw t;e(t)})}function ii(){}const Yc=oi("C",void 0,void 0);function oi(t,e,n){return{kind:t,value:e,error:n}}let xr=null;function Aa(t){if(Ri.useDeprecatedSynchronousErrorHandling){const e=!xr;if(e&&(xr={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:r}=xr;if(xr=null,n)throw r}}else t()}class Vs extends Ht{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Tu(e)&&e.add(this)):this.destination=Da}static create(e,n,r){return new Ar(e,n,r)}next(e){this.isStopped?ba(function ds(t){return oi("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?ba(function si(t){return oi("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ba(Yc,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Us=Function.prototype.bind;function Bs(t,e){return Us.call(t,e)}class Au{constructor(e){this.partialObserver=e}next(e){const{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){js(r)}}error(e){const{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){js(r)}else js(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){js(n)}}}class Ar extends Vs{constructor(e,n,r){let i;if(super(),ze(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Ri.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Bs(e.next,s),error:e.error&&Bs(e.error,s),complete:e.complete&&Bs(e.complete,s)}):i=e}this.destination=new Au(i)}}function js(t){Ri.useDeprecatedSynchronousErrorHandling?function Fs(t){Ri.useDeprecatedSynchronousErrorHandling&&xr&&(xr.errorThrown=!0,xr.error=t)}(t):Cu(t)}function ba(t,e){const{onStoppedNotification:n}=Ri;n&&ao.setTimeout(()=>n(t,e))}const Da={closed:!0,next:ii,error:function kr(t){throw t},complete:ii},hs="function"==typeof Symbol&&Symbol.observable||"@@observable";function Or(t){return t}function Sa(t){return 0===t.length?Or:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}let nn=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const s=function M(t){return t&&t instanceof Vs||function Ra(t){return t&&ze(t.next)&&ze(t.error)&&ze(t.complete)}(t)&&Tu(t)}(n)?n:new Ar(n,r,i);return Aa(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=Fo(r))((i,s)=>{const o=new Ar({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[hs](){return this}pipe(...n){return Sa(n)(this)}toPromise(n){return new(n=Fo(n))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function Fo(t){var e;return null!==(e=t??Ri.Promise)&&void 0!==e?e:Promise}const P=$n(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let L=(()=>{class t extends nn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new re(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new P}next(n){Aa(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){Aa(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Aa(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:i,observers:s}=this;return r||i?Ca:(this.currentObservers=null,s.push(n),new Ht(()=>{this.currentObservers=null,nr(s,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){const n=new nn;return n.source=this,n}}return t.create=(e,n)=>new re(e,n),t})();class re extends L{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,e)}error(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==r?r:Ca}}class G extends L{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}function De(t){return ze(t?.lift)}function Oe(t){return e=>{if(De(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Be(t,e,n,r,i){return new ai(t,e,n,r,i)}class ai extends Vs{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Ae(t,e){return Oe((n,r)=>{let i=0;n.subscribe(Be(r,s=>{r.next(t.call(e,s,i++))}))})}typeof navigator<"u"&&navigator,typeof navigator<"u"&&!/Opera/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||navigator),typeof navigator<"u"&&!/Opera|WebKit/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&navigator;const vg="https://g.co/ng/security#xss";class le extends Error{constructor(e,n){super(function lo(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,n)),this.code=e}}function ho(t){return{toString:t}.toString()}const Nu="__parameters__";function Ho(t,e,n){return ho(()=>{const r=function nl(t){return function(...n){if(t){const r=t(...n);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(u,c,h){const g=u.hasOwnProperty(Nu)?u[Nu]:Object.defineProperty(u,Nu,{value:[]})[Nu];for(;g.length<=h;)g.push(null);return(g[h]=g[h]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}const Zt=globalThis;function Ot(t){for(let e in t)if(t[e]===Ot)return e;throw Error("Could not find renamed property on target object.")}function HA(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Hn(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Hn).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function wg(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const Kv=Ot({__forward_ref__:Ot});function zt(t){return t.__forward_ref__=zt,t.toString=function(){return Hn(this())},t}function Ze(t){return Mu(t)?t():t}function Mu(t){return"function"==typeof t&&t.hasOwnProperty(Kv)&&t.__forward_ref__===zt}function Ne(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function pr(t){return{providers:t.providers||[],imports:t.imports||[]}}function xu(t){return La(t,eh)||La(t,tE)}function La(t,e){return t.hasOwnProperty(e)?t[e]:null}function Xd(t){return t&&(t.hasOwnProperty(Ag)||t.hasOwnProperty(zA))?t[Ag]:null}const eh=Ot({\u0275prov:Ot}),Ag=Ot({\u0275inj:Ot}),tE=Ot({ngInjectableDef:Ot}),zA=Ot({ngInjectorDef:Ot});class ve{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Ne({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function sE(t){return t&&!!t.\u0275providers}const Fa=Ot({\u0275cmp:Ot}),fo=Ot({\u0275dir:Ot}),rl=Ot({\u0275pipe:Ot}),oE=Ot({\u0275mod:Ot}),po=Ot({\u0275fac:Ot}),il=Ot({__NG_ELEMENT_ID__:Ot}),KA=Ot({__NG_ENV_ID__:Ot});function rt(t){return"string"==typeof t?t:null==t?"":String(t)}function Rg(t,e){throw new le(-201,!1)}var yt=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(yt||{});let Ng;function YA(){return Ng}function br(t){const e=Ng;return Ng=t,e}function ZA(t,e,n){const r=xu(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&yt.Optional?null:void 0!==e?e:void Rg()}const sl={},Ua="__NG_DI_FLAG__",nh="ngTempTokenPath",JA=/\n/gm,cE="__source";let Go;function qo(t){const e=Go;return Go=t,e}function lE(t,e=yt.Default){if(void 0===Go)throw new le(-203,!1);return null===Go?ZA(t,void 0,e):Go.get(t,e&yt.Optional?null:void 0,e)}function ce(t,e=yt.Default){return(YA()||lE)(Ze(t),e)}function he(t,e=yt.Default){return ce(t,zo(e))}function zo(t){return typeof t>"u"||"number"==typeof t?t:(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function ku(t){const e=[];for(let n=0;n<t.length;n++){const r=Ze(t[n]);if(Array.isArray(r)){if(0===r.length)throw new le(900,!1);let i,s=yt.Default;for(let o=0;o<r.length;o++){const a=r[o],u=Mg(a);"number"==typeof u?-1===u?i=a.token:s|=u:i=a}e.push(ce(i,s))}else e.push(ce(r))}return e}function al(t,e){return t[Ua]=e,t.prototype[Ua]=e,t}function Mg(t){return t[Ua]}const Ba=al(Ho("Optional"),8),rh=al(Ho("SkipSelf"),4);function Ou(t,e){return t.hasOwnProperty(po)?t[po]:null}function Fu(t,e){t.forEach(n=>Array.isArray(n)?Fu(n,e):e(n))}function fE(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function ih(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Kr(t,e,n){let r=Uu(t,e);return r>=0?t[1|r]=n:(r=~r,function pE(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function kg(t,e){const n=Uu(t,e);if(n>=0)return t[1|n]}function Uu(t,e){return function gE(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){const s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}(t,e,1)}const gs={},Nt=[],ms=new ve(""),mE=new ve("",-1),ul=new ve("");class oh{get(e,n=sl){if(n===sl){const r=new Error(`NullInjectorError: No provider for ${Hn(e)}!`);throw r.name="NullInjectorError",r}return n}}var Bu=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Bu||{}),_s=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(_s||{}),qs=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(qs||{});function nb(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function cl(t,e,n){let r=0;for(;r<n.length;){const i=n[r];if("number"==typeof i){if(0!==i)break;r++;const s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{const s=i,o=n[++r];ah(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function ll(t){return 3===t||4===t||6===t}function ah(t){return 64===t.charCodeAt(0)}function dl(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||uh(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function uh(t,e,n,r,i){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const a=t[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<t.length;){const a=t[s];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==i&&(t[s+1]=i));if(r===t[s+1])return void(t[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==r&&t.splice(s++,0,r),null!==i&&t.splice(s++,0,i)}const ju="ng-template";function ja(t,e,n,r){let i=0;if(r){for(;i<e.length&&"string"==typeof e[i];i+=2)if("class"===e[i]&&-1!==nb(e[i+1].toLowerCase(),n,0))return!0}else if(hl(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&"string"==typeof(s=e[i]);)if(s.toLowerCase()===n)return!0}return!1}function hl(t){return 4===t.type&&t.value!==ju}function rb(t,e,n){return e===(4!==t.type||n?t.value:ju)}function ib(t,e,n){let r=4;const i=t.attrs,s=null!==i?function ob(t){for(let e=0;e<t.length;e++)if(ll(t[e]))return e;return t.length}(i):0;let o=!1;for(let a=0;a<e.length;a++){const u=e[a];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!rb(t,u,n)||""===u&&1===e.length){if(ys(r))return!1;o=!0}}else if(8&r){if(null===i||!ja(t,i,u,n)){if(ys(r))return!1;o=!0}}else{const c=e[++a],h=Og(u,i,hl(t),n);if(-1===h){if(ys(r))return!1;o=!0;continue}if(""!==c){let g;if(g=h>s?"":i[h+1].toLowerCase(),2&r&&c!==g){if(ys(r))return!1;o=!0}}}}else{if(!o&&!ys(r)&&!ys(u))return!1;if(o&&ys(u))continue;o=!1,r=u|1&r}}return ys(r)||o}function ys(t){return!(1&t)}function Og(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){const o=e[i];if(o===t)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function Fg(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function Lg(t,e,n=!1){for(let r=0;r<e.length;r++)if(ib(t,e[r],n))return!0;return!1}function ch(t,e){return t?":not("+e.trim()+")":e}function ub(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&r){const a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!ys(o)&&(e+=ch(s,i),i=""),r=o,s=s||!ys(r);n++}return""!==i&&(e+=ch(s,i)),e}function Wo(t){return ho(()=>{const e=_E(t),n={...e,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Bu.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||_s.Emulated,styles:t.styles||Nt,_:null,schemas:t.schemas||null,tView:null,id:""};dh(n);const r=t.dependencies;return n.directiveDefs=hh(r,!1),n.pipeDefs=hh(r,!0),n.id=function Bg(t){let e=0;const n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const i of n)e=Math.imul(31,e)+i.charCodeAt(0)|0;return e+=2147483648,"c"+e}(n),n})}function fl(t){return gt(t)||Gn(t)}function cb(t){return null!==t}function Fr(t){return ho(()=>({type:t.type,bootstrap:t.bootstrap||Nt,declarations:t.declarations||Nt,imports:t.imports||Nt,exports:t.exports||Nt,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function lh(t,e){if(null==t)return gs;const n={};for(const r in t)if(t.hasOwnProperty(r)){const i=t[r];let s,o,a=qs.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==qs.None?[r,a]:r,e[s]=o):n[s]=r}return n}function Je(t){return ho(()=>{const e=_E(t);return dh(e),e})}function gt(t){return t[Fa]||null}function Gn(t){return t[fo]||null}function gr(t){return t[rl]||null}function Ur(t,e){const n=t[oE]||null;if(!n&&!0===e)throw new Error(`Type ${Hn(t)} does not have '\u0275mod' property.`);return n}function _E(t){const e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||gs,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||Nt,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:lh(t.inputs,e),outputs:lh(t.outputs),debugInfo:null}}function dh(t){t.features?.forEach(e=>e(t))}function hh(t,e){if(!t)return null;const n=e?gr:fl;return()=>("function"==typeof t?t():t).map(r=>n(r)).filter(cb)}function db(...t){return{\u0275providers:pl(0,t),\u0275fromNgModule:!0}}function pl(t,...e){const n=[],r=new Set;let i;const s=o=>{n.push(o)};return Fu(e,o=>{const a=o;$u(a,s,[],r)&&(i||=[],i.push(a))}),void 0!==i&&yE(i,s),n}function yE(t,e){for(let n=0;n<t.length;n++){const{ngModule:r,providers:i}=t[n];gl(i,s=>{e(s,r)})}}function $u(t,e,n,r){if(!(t=Ze(t)))return!1;let i=null,s=Xd(t);const o=!s&&gt(t);if(s||o){if(o&&!o.standalone)return!1;i=t}else{const u=t.ngModule;if(s=Xd(u),!s)return!1;i=u}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of u)$u(c,e,n,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;r.add(i);try{Fu(s.imports,h=>{$u(h,e,n,r)&&(c||=[],c.push(h))})}finally{}void 0!==c&&yE(c,e)}if(!a){const c=Ou(i)||(()=>new i);e({provide:i,useFactory:c,deps:Nt},i),e({provide:ul,useValue:i,multi:!0},i),e({provide:ms,useValue:()=>ce(i),multi:!0},i)}const u=s.providers;if(null!=u&&!a){const c=t;gl(u,h=>{e(h,c)})}}}return i!==t&&void 0!==t.providers}function gl(t,e){for(let n of t)sE(n)&&(n=n.\u0275providers),Array.isArray(n)?gl(n,e):e(n)}const vE=Ot({provide:String,useValue:Ot});function ml(t){return null!==t&&"object"==typeof t&&vE in t}function Ko(t){return"function"==typeof t}const Hg=new ve(""),_l={},Gg={};let qg;function ph(){return void 0===qg&&(qg=new oh),qg}class ci{}class Qo extends ci{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Wg(e,o=>this.processProvider(o)),this.records.set(mE,mo(void 0,this)),i.has("environment")&&this.records.set(ci,mo(void 0,this));const s=this.records.get(Hg);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(ul,Nt,yt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const e=Ve(null);try{for(const r of this._ngOnDestroyHooks)r.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ve(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const n=qo(this),r=br(void 0);try{return e()}finally{qo(n),br(r)}}get(e,n=sl,r=yt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(KA))return e[KA](this);r=zo(r);const s=qo(this),o=br(void 0);try{if(!(r&yt.SkipSelf)){let u=this.records.get(e);if(void 0===u){const c=function gb(t){return"function"==typeof t||"object"==typeof t&&t instanceof ve}(e)&&xu(e);u=c&&this.injectableDefInScope(c)?mo(zg(e),_l):null,this.records.set(e,u)}if(null!=u)return this.hydrate(e,u)}return(r&yt.Self?ph():this.parent).get(e,n=r&yt.Optional&&n===sl?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[nh]=a[nh]||[]).unshift(Hn(e)),s)throw a;return function dE(t,e,n,r){const i=t[nh];throw e[cE]&&i.unshift(e[cE]),t.message=function xg(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let i=Hn(e);if(Array.isArray(e))i=e.map(Hn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Hn(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(JA,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t[nh]=null,t}(a,e,"R3InjectorError",this.source)}throw a}finally{br(o),qo(s)}}resolveInjectorInitializers(){const e=Ve(null),n=qo(this),r=br(void 0);try{const s=this.get(ms,Nt,yt.Self);for(const o of s)o()}finally{qo(n),br(r),Ve(e)}}toString(){const e=[],n=this.records;for(const r of n.keys())e.push(Hn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new le(205,!1)}processProvider(e){let n=Ko(e=Ze(e))?e:Ze(e&&e.provide);const r=function wE(t){return ml(t)?mo(void 0,t.useValue):mo(TE(t),_l)}(e);if(!Ko(e)&&!0===e.multi){let i=this.records.get(n);i||(i=mo(void 0,_l,!0),i.factory=()=>ku(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){const r=Ve(null);try{return n.value===_l&&(n.value=Gg,n.value=n.factory()),"object"==typeof n.value&&n.value&&function pb(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{Ve(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;const n=Ze(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){const n=this._onDestroyHooks.indexOf(e);-1!==n&&this._onDestroyHooks.splice(n,1)}}function zg(t){const e=xu(t),n=null!==e?e.factory:Ou(t);if(null!==n)return n;if(t instanceof ve)throw new le(204,!1);if(t instanceof Function)return function hb(t){if(t.length>0)throw new le(204,!1);const n=function eE(t){return t&&(t[eh]||t[tE])||null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new le(204,!1)}function TE(t,e,n){let r;if(Ko(t)){const i=Ze(t);return Ou(i)||zg(i)}if(ml(t))r=()=>Ze(t.useValue);else if(function $g(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...ku(t.deps||[]));else if(function EE(t){return!(!t||!t.useExisting)}(t))r=()=>ce(Ze(t.useExisting));else{const i=Ze(t&&(t.useClass||t.provide));if(!function fb(t){return!!t.deps}(t))return Ou(i)||zg(i);r=()=>new i(...ku(t.deps))}return r}function mo(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Wg(t,e){for(const n of t)Array.isArray(n)?Wg(n,e):n&&sE(n)?Wg(n.\u0275providers,e):e(n)}function zs(t,e){t instanceof Qo&&t.assertNotDestroyed();const r=qo(t),i=br(void 0);try{return e()}finally{qo(r),br(i)}}function CE(){return void 0!==YA()||null!=function XA(){return Go}()}const gn=0,ye=1,qe=2,qn=3,Wi=4,sr=5,Qr=6,El=7,Wt=8,zn=9,Pi=10,Xe=11,qu=12,DE=13,zu=14,mn=15,$a=16,Wu=17,Ws=18,Ku=19,Tb=20,Yo=21,Ks=22,Ki=23,je=25,Il=1,Qi=7,Qu=9,An=10;var _h=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(_h||{});function mr(t){return Array.isArray(t)&&"object"==typeof t[Il]}function _r(t){return Array.isArray(t)&&!0===t[Il]}function Qg(t){return!!(4&t.flags)}function Ha(t){return t.componentOffset>-1}function yh(t){return!(1&~t.flags)}function vs(t){return!!t.template}function Tl(t){return!!(512&t[qe])}class PE{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function Eh(t,e,n,r){null!==e?e.applyValueToInputSignal(e,r):t[n]=r}function li(){return tm}function tm(t){return t.type.prototype.ngOnChanges&&(t.setInput=nm),Ab}function Ab(){const t=di(this),e=t?.current;if(e){const n=t.previous;if(n===gs)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function nm(t,e,n,r,i){const s=this.declaredInputs[r],o=di(t)||function Al(t,e){return t[ME]=e}(t,{previous:gs,current:null}),a=o.current||(o.current={}),u=o.previous,c=u[s];a[s]=new PE(c&&c.currentValue,n,u===gs),Eh(t,e,i,n)}li.ngInherit=!0;const ME="__ngSimpleChanges__";function di(t){return t[ME]||null}const Yi=function(t,e,n){};function bt(t){for(;Array.isArray(t);)t=t[gn];return t}function Zi(t,e){return bt(e[t])}function Br(t,e){return bt(e[t.index])}function bl(t,e){return t.data[e]}function hi(t,e){const n=e[t];return mr(n)?n:n[gn]}function Dl(t){return!(128&~t[qe])}function Ji(t,e){return null==e?null:t[e]}function Qs(t){t[Wu]=0}function Yu(t){1024&t[qe]||(t[qe]|=1024,Dl(t)&&Ju(t))}function Zu(t){return!!(9216&t[qe]||t[Ki]?.dirty)}function om(t){t[Pi].changeDetectionScheduler?.notify(7),64&t[qe]&&(t[qe]|=1024),Zu(t)&&Ju(t)}function Ju(t){t[Pi].changeDetectionScheduler?.notify(0);let e=_o(t);for(;null!==e&&!(8192&e[qe])&&(e[qe]|=8192,Dl(e));)e=_o(e)}function Th(t,e){if(!(256&~t[qe]))throw new le(911,!1);null===t[Yo]&&(t[Yo]=[]),t[Yo].push(e)}function _o(t){const e=t[qn];return _r(e)?e[qn]:e}const et={lFrame:cO(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let d=!1;function B(){return et.bindingsEnabled}function ee(){return et.lFrame.lView}function lt(){return et.lFrame.tView}function Sl(t){return et.lFrame.contextLView=t,t[Wt]}function Ch(t){return et.lFrame.contextLView=null,t}function Bt(){let t=Ah();for(;null!==t&&64===t.type;)t=t.parent;return t}function Ah(){return et.lFrame.currentTNode}function Xi(t,e){const n=et.lFrame;n.currentTNode=t,n.isParent=e}function Rl(){return et.lFrame.isParent}function rO(){return d}function iO(t){d=t}function yo(){return et.lFrame.bindingIndex++}function za(t){const e=et.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function X9(t,e){const n=et.lFrame;n.bindingIndex=n.bindingRootIndex=t,Sb(e)}function Sb(t){et.lFrame.currentDirectiveIndex=t}function LE(t){et.lFrame.currentQueryIndex=t}function t8(t){const e=t[ye];return 2===e.type?e.declTNode:1===e.type?t[sr]:null}function aO(t,e,n){if(n&yt.SkipSelf){let i=e,s=t;for(;!(i=i.parent,null!==i||n&yt.Host||(i=t8(s),null===i||(s=s[zu],10&i.type))););if(null===i)return!1;e=i,t=s}const r=et.lFrame=uO();return r.currentTNode=e,r.lView=t,!0}function Pb(t){const e=uO(),n=t[ye];et.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function uO(){const t=et.lFrame,e=null===t?null:t.child;return null===e?cO(t):e}function cO(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function lO(){const t=et.lFrame;return et.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const dO=lO;function Mb(){const t=lO();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Yr(){return et.lFrame.selectedIndex}function Nl(t){et.lFrame.selectedIndex=t}function _n(){const t=et.lFrame;return bl(t.tView,t.selectedIndex)}let fO=!0;function um(){return fO}function Zo(t){fO=t}function FE(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:h}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),null!=h&&(t.destroyHooks??=[]).push(n,h)}}function VE(t,e,n){pO(t,e,3,n)}function UE(t,e,n,r){(3&t[qe])===n&&pO(t,e,n,r)}function xb(t,e){let n=t[qe];(3&n)===e&&(n&=16383,n+=1,t[qe]=n)}function pO(t,e,n,r){const s=r??-1,o=e.length-1;let a=0;for(let u=void 0!==r?65535&t[Wu]:0;u<o;u++)if("number"==typeof e[u+1]){if(a=e[u],null!=r&&a>=r)break}else e[u]<0&&(t[Wu]+=65536),(a<s||-1==s)&&(u8(t,n,e,u),t[Wu]=(4294901760&t[Wu])+u+2),u++}function gO(t,e){Yi(4,t,e);const n=Ve(null);try{e.call(t)}finally{Ve(n),Yi(5,t,e)}}function u8(t,e,n,r){const i=n[r]<0,s=n[r+1],a=t[i?-n[r]:n[r]];i?t[qe]>>14<t[Wu]>>16&&(3&t[qe])===e&&(t[qe]+=16384,gO(a,s)):gO(a,s)}const Dh=-1;class cm{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}const Ob={};class Pl{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=zo(r);const i=this.injector.get(e,Ob,r);return i!==Ob||n===Ob?i:this.parentInjector.get(e,n,r)}}function Lb(t){return t!==Dh}function lm(t){return 32767&t}function dm(t,e){let n=function h8(t){return t>>16}(t),r=e;for(;n>0;)r=r[zu],n--;return r}let Fb=!0;function BE(t){const e=Fb;return Fb=t,e}const _O=255,yO=5;let p8=0;const Jo={};function jE(t,e){const n=vO(t,e);if(-1!==n)return n;const r=e[ye];r.firstCreatePass&&(t.injectorIndex=e.length,Vb(r.data,t),Vb(e,null),Vb(r.blueprint,null));const i=$E(t,e),s=t.injectorIndex;if(Lb(i)){const o=lm(i),a=dm(i,e),u=a[ye].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|u[o+c]}return e[s+8]=i,s}function Vb(t,e){t.push(0,0,0,0,0,0,0,0,e)}function vO(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function $E(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){if(r=bO(i),null===r)return Dh;if(n++,i=i[zu],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return Dh}function Ub(t,e,n){!function g8(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(il)&&(r=n[il]),null==r&&(r=n[il]=p8++);const i=r&_O;e.data[t+(i>>yO)]|=1<<i}(t,e,n)}function EO(t,e,n){if(n&yt.Optional||void 0!==t)return t;Rg()}function IO(t,e,n,r){if(n&yt.Optional&&void 0===r&&(r=null),!(n&(yt.Self|yt.Host))){const i=t[zn],s=br(void 0);try{return i?i.get(e,r,n&yt.Optional):ZA(e,r,n&yt.Optional)}finally{br(s)}}return EO(r,0,n)}function wO(t,e,n,r=yt.Default,i){if(null!==t){if(2048&e[qe]&&!(r&yt.Self)){const o=function E8(t,e,n,r,i){let s=t,o=e;for(;null!==s&&null!==o&&2048&o[qe]&&!(512&o[qe]);){const a=TO(s,o,n,r|yt.Self,Jo);if(a!==Jo)return a;let u=s.parent;if(!u){const c=o[Tb];if(c){const h=c.get(n,Jo,r);if(h!==Jo)return h}u=bO(o),o=o[zu]}s=u}return i}(t,e,n,r,Jo);if(o!==Jo)return o}const s=TO(t,e,n,r,Jo);if(s!==Jo)return s}return IO(e,n,r,i)}function TO(t,e,n,r,i){const s=function y8(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(il)?t[il]:void 0;return"number"==typeof e?e>=0?e&_O:v8:e}(n);if("function"==typeof s){if(!aO(e,t,r))return r&yt.Host?EO(i,0,r):IO(e,n,r,i);try{let o;if(o=s(r),null!=o||r&yt.Optional)return o;Rg()}finally{dO()}}else if("number"==typeof s){let o=null,a=vO(t,e),u=Dh,c=r&yt.Host?e[mn][sr]:null;for((-1===a||r&yt.SkipSelf)&&(u=-1===a?$E(t,e):e[a+8],u!==Dh&&AO(r,!1)?(o=e[ye],a=lm(u),e=dm(u,e)):a=-1);-1!==a;){const h=e[ye];if(CO(s,a,h.data)){const g=_8(a,e,n,o,r,c);if(g!==Jo)return g}u=e[a+8],u!==Dh&&AO(r,e[ye].data[a+8]===c)&&CO(s,a,e)?(o=h,a=lm(u),e=dm(u,e)):a=-1}}return i}function _8(t,e,n,r,i,s){const o=e[ye],a=o.data[t+8],h=function HE(t,e,n,r,i){const s=t.providerIndexes,o=e.data,a=1048575&s,u=t.directiveStart,h=s>>20,_=i?a+h:t.directiveEnd;for(let v=r?a:a+h;v<_;v++){const w=o[v];if(v<u&&n===w||v>=u&&w.type===n)return v}if(i){const v=o[u];if(v&&vs(v)&&v.type===n)return u}return null}(a,o,n,null==r?Ha(a)&&Fb:r!=o&&!!(3&a.type),i&yt.Host&&s===a);return null!==h?Ml(e,o,h,a):Jo}function Ml(t,e,n,r){let i=t[n];const s=e.data;if(function c8(t){return t instanceof cm}(i)){const o=i;o.resolving&&function QA(t,e){throw e&&e.join(" > "),new le(-200,t)}(function Lt(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():rt(t)}(s[n]));const a=BE(o.canSeeViewProviders);o.resolving=!0;const c=o.injectImpl?br(o.injectImpl):null;aO(t,r,yt.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&function a8(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=tm(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}(n,s[n],e)}finally{null!==c&&br(c),BE(a),o.resolving=!1,dO()}}return i}function CO(t,e,n){return!!(n[e+(t>>yO)]&1<<t)}function AO(t,e){return!(t&yt.Self||t&yt.Host&&e)}class Dr{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return wO(this._tNode,this._lView,e,zo(r),n)}}function v8(){return new Dr(Bt(),ee())}function jr(t){return ho(()=>{const e=t.prototype.constructor,n=e[po]||Bb(e),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const s=i[po]||Bb(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Bb(t){return Mu(t)?()=>{const e=Bb(Ze(t));return e&&e()}:Ou(t)}function bO(t){const e=t[ye],n=e.type;return 2===n?e.declTNode:1===n?t[sr]:null}function PO(t,e=null,n=null,r){const i=MO(t,e,n,r);return i.resolveInjectorInitializers(),i}function MO(t,e=null,n=null,r,i=new Set){const s=[n||Nt,db(t)];return r=r||("object"==typeof t?void 0:Hn(t)),new Qo(s,e||ph(),r||null,i)}class or{static#e=this.THROW_IF_NOT_FOUND=sl;static#t=this.NULL=new oh;static create(e,n){if(Array.isArray(e))return PO({name:""},n,e,"");{const r=e.name??"";return PO({name:r},e.parent,e.providers,r)}}static#n=this.\u0275prov=Ne({token:or,providedIn:"any",factory:()=>ce(mE)});static#r=this.__NG_ELEMENT_ID__=-1}new ve("").__NG_ELEMENT_ID__=t=>{const e=Bt();if(null===e)throw new le(204,!1);if(2&e.type)return e.value;if(t&yt.Optional)return null;throw new le(204,!1)};function $b(t){return t.ngOriginalError}let fm=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=N8;static#t=this.__NG_ENV_ID__=n=>n}return t})();class R8 extends fm{constructor(e){super(),this._lView=e}onDestroy(e){return Th(this._lView,e),()=>function am(t,e){if(null===t[Yo])return;const n=t[Yo].indexOf(e);-1!==n&&t[Yo].splice(n,1)}(this._lView,e)}}function N8(){return new R8(ee())}let xl=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new G(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275prov=Ne({token:t,providedIn:"root",factory:()=>new t})}return t})();const Yn=class P8 extends L{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,CE()&&(this.destroyRef=he(fm,{optional:!0})??void 0,this.pendingTasks=he(xl,{optional:!0})??void 0)}emit(e){const n=Ve(null);try{super.next(e)}finally{Ve(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&"object"==typeof e){const u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof Ht&&e.add(a),a}wrapInTimeout(e){return n=>{const r=this.pendingTasks?.add();setTimeout(()=>{e(n),void 0!==r&&this.pendingTasks?.remove(r)})}}};function qE(...t){}function kO(t){let e,n;function r(){t=qE;try{void 0!==n&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(n),void 0!==e&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{t(),r()}),"function"==typeof requestAnimationFrame&&(n=requestAnimationFrame(()=>{t(),r()})),()=>r()}function OO(t){return queueMicrotask(()=>t()),()=>{t=qE}}class At{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Yn(!1),this.onMicrotaskEmpty=new Yn(!1),this.onStable=new Yn(!1),this.onError=new Yn(!1),typeof Zone>"u")throw new le(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.callbackScheduled=!1,function k8(t){const e=()=>{!function x8(t){t.isCheckStableRunning||t.callbackScheduled||(t.callbackScheduled=!0,Zone.root.run(()=>{kO(()=>{t.callbackScheduled=!1,Gb(t),t.isCheckStableRunning=!0,Hb(t),t.isCheckStableRunning=!1})}),Gb(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(function O8(t){return VO(t,"__ignore_ng_zone__")}(a))return n.invokeTask(i,s,o,a);try{return LO(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),FO(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return LO(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!function L8(t){return VO(t,"__scheduler_tick__")}(a)&&e(),FO(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,Gb(t),Hb(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!At.isInAngularZone())throw new le(909,!1)}static assertNotInAngularZone(){if(At.isInAngularZone())throw new le(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,M8,qE,qE);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const M8={};function Hb(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Gb(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&!0===t.callbackScheduled)}function LO(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function FO(t){t._nesting--,Hb(t)}class qb{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Yn,this.onMicrotaskEmpty=new Yn,this.onStable=new Yn,this.onError=new Yn}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}}function VO(t,e){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0]?.data?.[e]}class vo{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&$b(e);for(;n&&$b(n);)n=$b(n);return n||null}}const V8=new ve("",{providedIn:"root",factory:()=>{const t=he(At),e=he(vo);return n=>t.runOutsideAngular(()=>e.handleError(n))}});function U8(){return Nh(Bt(),ee())}function Nh(t,e){return new Is(Br(t,e))}let Is=(()=>{class t{constructor(n){this.nativeElement=n}static#e=this.__NG_ELEMENT_ID__=U8}return t})();function zE(t){return!(128&~t.flags)}Symbol;const Wb=new Map;let $8=0;const KE="__ngContext__";function pi(t,e){mr(e)?(t[KE]=e[Ku],function G8(t){Wb.set(t[Ku],t)}(e)):t[KE]=e}function YO(t){return JO(t[qu])}function ZO(t){return JO(t[Wi])}function JO(t){for(;null!==t&&!_r(t);)t=t[Wi];return t}let Qb;const Mh=new ve("",{providedIn:"root",factory:()=>u5}),u5="ng",o1=new ve(""),Ys=new ve("",{providedIn:"platform",factory:()=>"unknown"}),a1=new ve("",{providedIn:"root",factory:()=>function ec(){if(void 0!==Qb)return Qb;if(typeof document<"u")return document;throw new le(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let u1=()=>null;function nD(t,e,n=!1){return u1(t,e,n)}const m1=new ve("",{providedIn:"root",factory:()=>!1});let iI;function I1(t){return function uD(){if(void 0===iI&&(iI=null,Zt.trustedTypes))try{iI=Zt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return iI}()?.createScriptURL(t)||t}class w1{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${vg})`}}function tc(t){return t instanceof w1?t.changingThisBreaksApplicationSecurity:t}function Im(t,e){const n=function D5(t){return t instanceof w1&&t.getTypeName()||null}(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${vg})`)}return n===e}const P5=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var Lh=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Lh||{});function fD(t){const e=Tm();return e?e.sanitize(Lh.URL,t)||"":Im(t,"URL")?tc(t):function cD(t){return(t=String(t)).match(P5)?t:"unsafe:"+t}(rt(t))}function P1(t){const e=Tm();if(e)return I1(e.sanitize(Lh.RESOURCE_URL,t)||"");if(Im(t,"ResourceURL"))return I1(tc(t));throw new le(904,!1)}function Tm(){const t=ee();return t&&t[Pi].sanitizer}function ws(t){return t instanceof Function?t():t}var nc=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(nc||{});let mD;function _D(t,e){return mD(t,e)}function Vh(t,e,n,r,i){if(null!=r){let s,o=!1;_r(r)?s=r:mr(r)&&(o=!0,r=r[gn]);const a=bt(r);0===t&&null!==n?null==i?q1(e,n,a):kl(e,n,a,i||null,!0):1===t&&null!==n?kl(e,n,a,i||null,!0):2===t?function Am(t,e,n){const r=lI(t,e);r&&function fK(t,e,n,r){t.removeChild(e,n,r)}(t,r,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function mK(t,e,n,r,i){const s=n[Qi];s!==bt(n)&&Vh(e,t,r,s,i);for(let a=An;a<n.length;a++){const u=n[a];hI(u[ye],u,t,e,r,s)}}(e,t,s,n,i)}}function uI(t,e,n){return t.createElement(e,n)}function $1(t,e){e[Pi].changeDetectionScheduler?.notify(8),hI(t,e,e[Xe],2,null,null)}function H1(t,e){const n=t[Qu],r=e[qn];(mr(r)||e[mn]!==r[qn][mn])&&(t[qe]|=_h.HasTransplantedViews),null===n?t[Qu]=[e]:n.push(e)}function ED(t,e){const n=t[Qu],r=n.indexOf(e);n.splice(r,1)}function Cm(t,e){if(t.length<=An)return;const n=An+e,r=t[n];if(r){const i=r[$a];null!==i&&i!==t&&ED(i,r),e>0&&(t[n-1][Wi]=r[Wi]);const s=ih(t,An+e);!function aK(t,e){$1(t,e),e[gn]=null,e[sr]=null}(r[ye],r);const o=s[Ws];null!==o&&o.detachView(s[ye]),r[qn]=null,r[Wi]=null,r[qe]&=-129}return r}function cI(t,e){if(!(256&e[qe])){const n=e[Xe];n.destroyNode&&hI(t,e,n,3,null,null),function cK(t){let e=t[qu];if(!e)return ID(t[ye],t);for(;e;){let n=null;if(mr(e))n=e[qu];else{const r=e[An];r&&(n=r)}if(!n){for(;e&&!e[Wi]&&e!==t;)mr(e)&&ID(e[ye],e),e=e[qn];null===e&&(e=t),mr(e)&&ID(e[ye],e),n=e&&e[Wi]}e=n}}(e)}}function ID(t,e){if(256&e[qe])return;const n=Ve(null);try{e[qe]&=-129,e[qe]|=256,e[Ki]&&Cr(e[Ki]),function hK(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof cm)){const s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],u=s[o+1];Yi(4,a,u);try{u.call(a)}finally{Yi(5,a,u)}}else{Yi(4,i,s);try{s.call(i)}finally{Yi(5,i,s)}}}}}(t,e),function dK(t,e){const n=t.cleanup,r=e[El];if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else n[s].call(r[n[s+1]]);null!==r&&(e[El]=null);const i=e[Yo];if(null!==i){e[Yo]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(t,e),1===e[ye].type&&e[Xe].destroy();const r=e[$a];if(null!==r&&_r(e[qn])){r!==e[qn]&&ED(r,e);const i=e[Ws];null!==i&&i.detachView(t)}!function q8(t){Wb.delete(t[Ku])}(e)}finally{Ve(n)}}function wD(t,e,n){return function G1(t,e,n){let r=e;for(;null!==r&&168&r.type;)r=(e=r).parent;if(null===r)return n[gn];{const{componentOffset:i}=r;if(i>-1){const{encapsulation:s}=t.data[r.directiveStart+i];if(s===_s.None||s===_s.Emulated)return null}return Br(r,n)}}(t,e.parent,n)}function kl(t,e,n,r,i){t.insertBefore(e,n,r,i)}function q1(t,e,n){t.appendChild(e,n)}function z1(t,e,n,r,i){null!==r?kl(t,e,n,r,i):q1(t,e,n)}function lI(t,e){return t.parentNode(e)}let TD,Q1=function K1(t,e,n){return 40&t.type?Br(t,n):null};function dI(t,e,n,r){const i=wD(t,r,e),s=e[Xe],a=function W1(t,e,n){return Q1(t,e,n)}(r.parent||e[sr],r,e);if(null!=i)if(Array.isArray(n))for(let u=0;u<n.length;u++)z1(s,i,n[u],a,!1);else z1(s,i,n,a,!1);void 0!==TD&&TD(s,r,e,n,i)}function Ol(t,e){if(null!==e){const n=e.type;if(3&n)return Br(e,t);if(4&n)return CD(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return Ol(t,r);{const i=t[e.index];return _r(i)?CD(-1,i):bt(i)}}if(128&n)return Ol(t,e.next);if(32&n)return _D(e,t)()||bt(t[e.index]);{const r=Z1(t,e);return null!==r?Array.isArray(r)?r[0]:Ol(_o(t[mn]),r):Ol(t,e.next)}}return null}function Z1(t,e){return null!==e?t[mn][sr].projection[e.projection]:null}function CD(t,e){const n=An+t+1;if(n<e.length){const r=e[n],i=r[ye].firstChild;if(null!==i)return Ol(r,i)}return e[Qi]}function AD(t,e,n,r,i,s,o){for(;null!=n;){if(128===n.type){n=n.next;continue}const a=r[n.index],u=n.type;if(o&&0===e&&(a&&pi(bt(a),r),n.flags|=2),32&~n.flags)if(8&u)AD(t,e,n.child,r,i,s,!1),Vh(e,t,i,a,s);else if(32&u){const c=_D(n,r);let h;for(;h=c();)Vh(e,t,i,h,s);Vh(e,t,i,a,s)}else 16&u?X1(t,e,r,n,i,s):Vh(e,t,i,a,s);n=o?n.projectionNext:n.next}}function hI(t,e,n,r,i,s){AD(n,r,t.firstChild,e,i,s,!1)}function X1(t,e,n,r,i,s){const o=n[mn],u=o[sr].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++)Vh(e,t,i,u[c],s);else{let c=u;const h=o[qn];zE(r)&&(c.flags|=128),AD(t,e,c,h,i,s,!0)}}function eL(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function tL(t,e,n){const{mergedAttrs:r,classes:i,styles:s}=n;null!==r&&cl(t,e,r),null!==i&&eL(t,e,i),null!==s&&function yK(t,e,n){t.setAttribute(e,"style",n)}(t,e,s)}const ct={};function gi(t=1){nL(lt(),ee(),Yr()+t,!1)}function nL(t,e,n,r){if(!r)if(3&~e[qe]){const s=t.preOrderHooks;null!==s&&UE(e,s,0,n)}else{const s=t.preOrderCheckHooks;null!==s&&VE(e,s,n)}Nl(n)}function ge(t,e=yt.Default){const n=ee();return null===n?ce(t,e):wO(Bt(),n,Ze(t),e)}function iL(t,e,n,r,i,s){const o=Ve(null);try{let a=null;i&qs.SignalBased&&(a=e[r][Ft]),null!==a&&void 0!==a.transformFn&&(s=a.transformFn(s)),i&qs.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),null!==t.setInput?t.setInput(e,a,s,n,r):Eh(e,a,r,s)}finally{Ve(o)}}function fI(t,e,n,r,i,s,o,a,u,c,h){const g=e.blueprint.slice();return g[gn]=i,g[qe]=204|r,(null!==c||t&&2048&t[qe])&&(g[qe]|=2048),Qs(g),g[qn]=g[zu]=t,g[Wt]=n,g[Pi]=o||t&&t[Pi],g[Xe]=a||t&&t[Xe],g[zn]=u||t&&t[zn]||null,g[sr]=s,g[Ku]=function H8(){return $8++}(),g[Qr]=h,g[Tb]=c,g[mn]=2==e.type?t[mn]:g,g}function Ll(t,e,n,r,i){let s=t.data[e];if(null===s)s=function bD(t,e,n,r,i){const s=Ah(),o=Rl(),u=t.data[e]=function bK(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return function te(){return null!==et.skipHydrationRootTNode}()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=u),null!==s&&(o?null==s.child&&null!==u.parent&&(s.child=u):null===s.next&&(s.next=u,u.prev=s)),u}(t,e,n,r,i),function J9(){return et.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const o=function Xu(){const t=et.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Xi(s,!0),s}function bm(t,e,n,r){if(0===n)return-1;const i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function sL(t,e,n,r,i){const s=Yr(),o=2&r;try{Nl(-1),o&&e.length>je&&nL(t,e,je,!1),Yi(o?2:0,i),n(r,i)}finally{Nl(s),Yi(o?3:1,i)}}function DD(t,e,n){if(Qg(e)){const r=Ve(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{Ve(r)}}}function SD(t,e,n){B()&&(function xK(t,e,n,r){const i=n.directiveStart,s=n.directiveEnd;Ha(n)&&function BK(t,e,n){const r=Br(e,t),i=oL(n);let o=16;n.signals?o=4096:n.onPush&&(o=64);const a=pI(t,fI(t,i,null,o,r,e,null,t[Pi].rendererFactory.createRenderer(r,n),null,null,null));t[e.index]=a}(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||jE(n,e),pi(r,e);const o=n.initialInputs;for(let a=i;a<s;a++){const u=t.data[a],c=Ml(e,t,a,n);pi(c,e),null!==o&&jK(0,a-i,c,u,0,o),vs(u)&&(hi(n.index,e)[Wt]=Ml(e,t,a,n))}}(t,e,n,Br(n,e)),!(64&~n.flags)&&dL(t,e,n))}function RD(t,e,n=Br){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(e,t):t[o];t[i++]=a}}}function oL(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=ND(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function ND(t,e,n,r,i,s,o,a,u,c,h){const g=je+r,_=g+i,v=function EK(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:ct);return n}(g,_),w="function"==typeof c?c():c;return v[ye]={type:t,blueprint:v,template:n,queries:null,viewQuery:a,declTNode:e,data:v.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:_,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:w,incompleteFirstPass:!1,ssrId:h}}let aL=()=>null;function uL(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;const o=e[s];if(void 0===o)continue;r??={};let a,u=qs.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let c=s;if(null!==i){if(!i.hasOwnProperty(s))continue;c=i[s]}0===t?cL(r,n,c,a,u):cL(r,n,c,a)}return r}function cL(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],void 0!==i&&s.push(i)}function ns(t,e,n,r,i,s,o,a){const u=Br(e,n);let h,c=e.inputs;!a&&null!=c&&(h=c[r])?(OD(t,n,h,r,i),Ha(e)&&function RK(t,e){const n=hi(e,t);16&n[qe]||(n[qe]|=64)}(n,e.index)):3&e.type&&(r=function SK(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=o?o(i,e.value||"",r):i,s.setProperty(u,r,i))}function PD(t,e,n,r){if(B()){const i=null===r?null:{"":-1},s=function OK(t,e){const n=t.directiveRegistry;let r=null,i=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];if(Lg(e,o.selectors,!1))if(r||(r=[]),vs(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o),MD(t,e,a.length)}else r.unshift(o),MD(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return null===r?null:[r,i]}(t,n);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&lL(t,e,n,o,i,a),i&&function LK(t,e,n){if(e){const r=t.localNames=[];for(let i=0;i<e.length;i+=2){const s=n[e[i+1]];if(null==s)throw new le(-301,!1);r.push(e[i],s)}}}(n,r,i)}n.mergedAttrs=dl(n.mergedAttrs,n.attrs)}function lL(t,e,n,r,i,s){for(let c=0;c<r.length;c++)Ub(jE(n,e),t,r[c].type);!function VK(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}(n,t.data.length,r.length);for(let c=0;c<r.length;c++){const h=r[c];h.providersResolver&&h.providersResolver(h)}let o=!1,a=!1,u=bm(t,e,r.length,null);for(let c=0;c<r.length;c++){const h=r[c];n.mergedAttrs=dl(n.mergedAttrs,h.hostAttrs),UK(t,n,e,u,h),FK(u,h,i),null!==h.contentQueries&&(n.flags|=4),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(n.flags|=64);const g=h.type.prototype;!o&&(g.ngOnChanges||g.ngOnInit||g.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(g.ngOnChanges||g.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}!function DK(t,e,n){const i=e.directiveEnd,s=t.data,o=e.attrs,a=[];let u=null,c=null;for(let h=e.directiveStart;h<i;h++){const g=s[h],_=n?n.get(g):null,w=_?_.outputs:null;u=uL(0,g.inputs,h,u,_?_.inputs:null),c=uL(1,g.outputs,h,c,w);const b=null===u||null===o||hl(e)?null:$K(u,h,o);a.push(b)}null!==u&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=c}(t,n,s)}function dL(t,e,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=function e8(){return et.lFrame.currentDirectiveIndex}();try{Nl(s);for(let a=r;a<i;a++){const u=t.data[a],c=e[a];Sb(a),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&kK(u,c)}}finally{Nl(-1),Sb(o)}}function kK(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function MD(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function FK(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;vs(e)&&(n[""]=t)}}function UK(t,e,n,r,i){t.data[r]=i;const s=i.factory||(i.factory=Ou(i.type)),o=new cm(s,vs(i),ge);t.blueprint[r]=o,n[r]=o,function PK(t,e,n,r,i){const s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;null===o&&(o=t.hostBindingOpCodes=[]);const a=~e.index;(function MK(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(o)!=a&&o.push(a),o.push(n,r,s)}}(t,e,r,bm(t,n,i.hostVars,ct),i)}function Xo(t,e,n,r,i,s){const o=Br(t,e);!function xD(t,e,n,r,i,s,o){if(null==s)t.removeAttribute(e,i,n);else{const a=null==o?rt(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}(e[Xe],o,s,t.value,n,r,i)}function jK(t,e,n,r,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)iL(r,n,o[a++],o[a++],o[a++],o[a++])}function $K(t,e,n){let r=null,i=0;for(;i<n.length;){const s=n[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(t.hasOwnProperty(s)){null===r&&(r=[]);const o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function hL(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function fL(t,e){const n=t.contentQueries;if(null!==n){const r=Ve(null);try{for(let i=0;i<n.length;i+=2){const o=n[i+1];if(-1!==o){const a=t.data[o];LE(n[i]),a.contentQueries(2,e[o],o)}}}finally{Ve(r)}}}function pI(t,e){return t[qu]?t[DE][Wi]=e:t[qu]=e,t[DE]=e,e}function kD(t,e,n){LE(0);const r=Ve(null);try{e(t,n)}finally{Ve(r)}}function gI(t,e){const n=t[zn],r=n?n.get(vo,null):null;r&&r.handleError(e)}function OD(t,e,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],u=n[s++];iL(t.data[o],e[o],r,a,u,i)}}function Ka(t,e,n){const r=Zi(e,t);!function j1(t,e,n){t.setValue(e,n)}(t[Xe],r,n)}function HK(t,e){const n=hi(e,t),r=n[ye];!function GK(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n);const i=n[gn];null!==i&&null===n[Qr]&&(n[Qr]=nD(i,n[zn])),LD(r,n,n[Wt])}function LD(t,e,n){Pb(e);try{const r=t.viewQuery;null!==r&&kD(1,r,n);const i=t.template;null!==i&&sL(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[Ws]?.finishViewCreation(t),t.staticContentQueries&&fL(t,e),t.staticViewQueries&&kD(2,t.viewQuery,n);const s=t.components;null!==s&&function qK(t,e){for(let n=0;n<e.length;n++)HK(t,e[n])}(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[qe]&=-5,Mb()}}function Fl(t,e){return!e||null===e.firstChild||zE(t)}function Dm(t,e,n,r,i=!1){for(;null!==n;){if(128===n.type){n=i?n.projectionNext:n.next;continue}const s=e[n.index];null!==s&&r.push(bt(s)),_r(s)&&yL(s,r);const o=n.type;if(8&o)Dm(t,e,n.child,r);else if(32&o){const a=_D(n,e);let u;for(;u=a();)r.push(u)}else if(16&o){const a=Z1(e,n);if(Array.isArray(a))r.push(...a);else{const u=_o(e[mn]);Dm(u[ye],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function yL(t,e){for(let n=An;n<t.length;n++){const r=t[n],i=r[ye].firstChild;null!==i&&Dm(r[ye],r,i,e)}t[Qi]!==t[gn]&&e.push(t[Qi])}let vL=[];const QK={...de,consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Ju(t.lView)},consumerOnSignalRead(){this.lView[Ki]=this}},ZK={...de,consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{let e=_o(t.lView);for(;e&&!EL(e[ye]);)e=_o(e);e&&Yu(e)},consumerOnSignalRead(){this.lView[Ki]=this}};function EL(t){return 2!==t.type}const JK=100;function mI(t,e=!0,n=0){const r=t[Pi],i=r.rendererFactory;i.begin?.();try{!function XK(t,e){const n=rO();try{iO(!0),VD(t,e);let r=0;for(;Zu(t);){if(r===JK)throw new le(103,!1);r++,VD(t,1)}}finally{iO(n)}}(t,n)}catch(o){throw e&&gI(t,o),o}finally{i.end?.(),r.inlineEffectRunner?.flush()}}function eQ(t,e,n,r){const i=e[qe];if(!(256&~i))return;e[Pi].inlineEffectRunner?.flush(),Pb(e);let a=!0,u=null,c=null;EL(t)?(c=function zK(t){return t[Ki]??function WK(t){const e=vL.pop()??Object.create(QK);return e.lView=t,e}(t)}(e),u=at(c)):null===function Pn(){return Fe}()?(a=!1,c=function YK(t){const e=t[Ki]??Object.create(ZK);return e.lView=t,e}(e),u=at(c)):e[Ki]&&(Cr(e[Ki]),e[Ki]=null);try{Qs(e),function sO(t){return et.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&sL(t,e,n,2,r);const h=!(3&~i);if(h){const v=t.preOrderCheckHooks;null!==v&&VE(e,v,null)}else{const v=t.preOrderHooks;null!==v&&UE(e,v,0,null),xb(e,0)}if(function tQ(t){for(let e=YO(t);null!==e;e=ZO(e)){if(!(e[qe]&_h.HasTransplantedViews))continue;const n=e[Qu];for(let r=0;r<n.length;r++)Yu(n[r])}}(e),wL(e,0),null!==t.contentQueries&&fL(t,e),h){const v=t.contentCheckHooks;null!==v&&VE(e,v)}else{const v=t.contentHooks;null!==v&&UE(e,v,1),xb(e,1)}!function vK(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const i=n[r];if(i<0)Nl(~i);else{const s=i,o=n[++r],a=n[++r];X9(o,s),a(2,e[s])}}}finally{Nl(-1)}}(t,e);const g=t.components;null!==g&&CL(e,g,0);const _=t.viewQuery;if(null!==_&&kD(2,_,r),h){const v=t.viewCheckHooks;null!==v&&VE(e,v)}else{const v=t.viewHooks;null!==v&&UE(e,v,2),xb(e,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[Ks]){for(const v of e[Ks])v();e[Ks]=null}e[qe]&=-73}catch(h){throw Ju(e),h}finally{null!==c&&(pt(c,u),a&&function KK(t){t.lView[Ki]!==t&&(t.lView=null,vL.push(t))}(c)),Mb()}}function wL(t,e){for(let n=YO(t);null!==n;n=ZO(n))for(let r=An;r<n.length;r++)TL(n[r],e)}function nQ(t,e,n){TL(hi(e,t),n)}function TL(t,e){Dl(t)&&VD(t,e)}function VD(t,e){const r=t[ye],i=t[qe],s=t[Ki];let o=!!(0===e&&16&i);if(o||=!!(64&i&&0===e),o||=!!(1024&i),o||=!(!s?.dirty||!tr(s)),o||=!1,s&&(s.dirty=!1),t[qe]&=-9217,o)eQ(r,t,r.template,t[Wt]);else if(8192&i){wL(t,1);const a=r.components;null!==a&&CL(t,a,1)}}function CL(t,e,n){for(let r=0;r<e.length;r++)nQ(t,e[r],n)}function Sm(t,e){const n=rO()?64:1088;for(t[Pi].changeDetectionScheduler?.notify(e);t;){t[qe]|=n;const r=_o(t);if(Tl(t)&&!r)return t;t=r}return null}class Rm{get rootNodes(){const e=this._lView,n=e[ye];return Dm(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Wt]}set context(e){this._lView[Wt]=e}get destroyed(){return!(256&~this._lView[qe])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[qn];if(_r(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(Cm(e,r),ih(n,r))}this._attachedToViewContainer=!1}cI(this._lView[ye],this._lView)}onDestroy(e){Th(this._lView,e)}markForCheck(){Sm(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[qe]&=-129}reattach(){om(this._lView),this._lView[qe]|=128}detectChanges(){this._lView[qe]|=1024,mI(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new le(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const e=Tl(this._lView),n=this._lView[$a];null!==n&&!e&&ED(n,this._lView),$1(this._lView[ye],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new le(902,!1);this._appRef=e;const n=Tl(this._lView),r=this._lView[$a];null!==r&&!n&&H1(r,this._lView),om(this._lView)}}let Qa=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=sQ}return t})();const rQ=Qa,iQ=class extends rQ{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){const i=function Uh(t,e,n,r){const i=Ve(null);try{const s=e.tView,u=fI(t,s,n,4096&t[qe]?4096:16,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null);u[$a]=t[e.index];const h=t[Ws];return null!==h&&(u[Ws]=h.createEmbeddedView(s)),LD(s,u,n),u}finally{Ve(i)}}(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:r});return new Rm(i)}};function sQ(){return function _I(t,e){return 4&t.type?new iQ(e,t,Nh(t,e)):null}(Bt(),ee())}class $h{}const Fm=new ve("",{providedIn:"root",factory:()=>!1}),zL=new ve("");class ZQ{}class WL{}class XQ{resolveComponentFactory(e){throw function JQ(t){const e=Error(`No component factory found for ${Hn(t)}.`);return e.ngComponent=t,e}(e)}}class TI{static#e=this.NULL=new XQ}class QD{}let Ya=(()=>{class t{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function e7(){const t=ee(),n=hi(Bt().index,t);return(mr(n)?n:t)[Xe]}()}return t})(),t7=(()=>{class t{static#e=this.\u0275prov=Ne({token:t,providedIn:"root",factory:()=>null})}return t})();const QL=new Set;function xi(t){QL.has(t)||(QL.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var ki=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(ki||{});const YL={destroy(){}};function ZL(t,e){!e&&function gh(t){if(!CE())throw new le(-203,!1)}();const n=e?.injector??he(or);return function ts(t){return"browser"===(t??he(or)).get(Ys)}(n)?(xi("NgAfterNextRender"),function JL(t,e,n,r){const i=function r7(t,e){if(t instanceof Function)switch(e){case ki.EarlyRead:return{earlyRead:t};case ki.Write:return{write:t};case ki.MixedReadWrite:return{mixedReadWrite:t};case ki.Read:return{read:t}}return t}(t,r),s=e.get(CI),o=s.handler??=new s7,a=[],u=[],c=()=>{for(const v of u)o.unregister(v);h()},h=e.get(fm).onDestroy(c);let g=0;const _=(v,w)=>{if(!w)return;const b=n?(...F)=>(g--,g<1&&c(),w(...F)):w,D=zs(e,()=>new i7(v,a,b));o.register(D),u.push(D),g++};return _(ki.EarlyRead,i.earlyRead),_(ki.Write,i.write),_(ki.MixedReadWrite,i.mixedReadWrite),_(ki.Read,i.read),{destroy:c}}(t,n,!0,e?.phase??ki.MixedReadWrite)):YL}class i7{constructor(e,n,r){this.phase=e,this.pipelinedArgs=n,this.callbackFn=r,this.zone=he(At),this.errorHandler=he(vo,{optional:!0}),he($h,{optional:!0})?.notify(6)}invoke(){try{const e=this.zone.runOutsideAngular(()=>this.callbackFn.apply(null,this.pipelinedArgs));this.pipelinedArgs.splice(0,this.pipelinedArgs.length,e)}catch(e){this.errorHandler?.handleError(e)}}}class s7{constructor(){this.executingCallbacks=!1,this.buckets={[ki.EarlyRead]:new Set,[ki.Write]:new Set,[ki.MixedReadWrite]:new Set,[ki.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(const e of Object.values(this.buckets))for(const n of e)n.invoke();this.executingCallbacks=!1;for(const e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(const e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}}let CI=(()=>{class t{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const n=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const r of n)r()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=Ne({token:t,providedIn:"root",factory:()=>new t})}return t})();function bI(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=wg(i,a):2==s&&(r=wg(r,a+": "+e[++o]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}class tF extends TI{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=gt(e);return new Bm(n,this.ngModule)}}function nF(t,e){const n=[];for(const r in t){if(!t.hasOwnProperty(r))continue;const i=t[r];if(void 0===i)continue;const s=Array.isArray(i),o=s?i[0]:i;n.push(e?{propName:o,templateName:r,isSignal:!!((s?i[1]:qs.None)&qs.SignalBased)}:{propName:o,templateName:r})}return n}class Bm extends WL{get inputs(){const e=this.componentDef,n=e.inputTransforms,r=nF(e.inputs,!0);if(null!==n)for(const i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return nF(this.componentDef.outputs,!1)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function Vg(t){return t.map(ub).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){const s=Ve(null);try{let o=(i=i||this.ngModule)instanceof ci?i:i?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const a=o?new Pl(e,o):e,u=a.get(QD,null);if(null===u)throw new le(407,!1);const c=a.get(t7,null),_={rendererFactory:u,sanitizer:c,inlineEffectRunner:null,afterRenderEventManager:a.get(CI,null),changeDetectionScheduler:a.get($h,null)},v=u.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",b=r?function IK(t,e,n,r){const s=r.get(m1,!1)||n===_s.ShadowDom,o=t.selectRootElement(e,s);return function wK(t){aL(t)}(o),o}(v,r,this.componentDef.encapsulation,a):uI(v,w,function u7(t){const e=t.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(w));let D=512;this.componentDef.signals?D|=4096:this.componentDef.onPush||(D|=16);let F=null;null!==b&&(F=nD(b,a,!0));const x=ND(0,null,null,1,0,null,null,null,null,null,null),$=fI(null,x,null,D,null,null,_,v,a,null,F);let ie,Ie;Pb($);try{const Pe=this.componentDef;let V,R=null;Pe.findHostDirectiveDefs?(V=[],R=new Map,Pe.findHostDirectiveDefs(Pe,V,R),V.push(Pe)):V=[Pe];const k=function l7(t,e){const n=t[ye],r=je;return t[r]=e,Ll(n,r,2,"#host",null)}($,b),U=function d7(t,e,n,r,i,s,o){const a=i[ye];!function h7(t,e,n,r){for(const i of t)e.mergedAttrs=dl(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(bI(e,e.mergedAttrs,!0),null!==n&&tL(r,n,e))}(r,t,e,o);let u=null;null!==e&&(u=nD(e,i[zn]));const c=s.rendererFactory.createRenderer(e,n);let h=16;n.signals?h=4096:n.onPush&&(h=64);const g=fI(i,oL(n),null,h,i[t.index],t,s,c,null,null,u);return a.firstCreatePass&&MD(a,t,r.length-1),pI(i,g),i[t.index]=g}(k,b,Pe,V,$,_,v);Ie=bl(x,je),b&&function p7(t,e,n,r){if(r)cl(t,n,["ng-version","18.1.3"]);else{const{attrs:i,classes:s}=function Ug(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let s=t[r];if("string"==typeof s)2===i?""!==s&&e.push(s,t[++r]):8===i&&n.push(s);else{if(!ys(i))break;i=s}r++}return{attrs:e,classes:n}}(e.selectors[0]);i&&cl(t,n,i),s&&s.length>0&&eL(t,n,s.join(" "))}}(v,Pe,b,r),void 0!==n&&function g7(t,e,n){const r=t.projection=[];for(let i=0;i<e.length;i++){const s=n[i];r.push(null!=s?Array.from(s):null)}}(Ie,this.ngContentSelectors,n),ie=function f7(t,e,n,r,i,s){const o=Bt(),a=i[ye],u=Br(o,i);lL(a,i,o,n,null,r);for(let h=0;h<n.length;h++)pi(Ml(i,a,o.directiveStart+h,o),i);dL(a,i,o),u&&pi(u,i);const c=Ml(i,a,o.directiveStart+o.componentOffset,o);if(t[Wt]=i[Wt]=c,null!==s)for(const h of s)h(c,e);return DD(a,o,i),c}(U,Pe,V,R,$,[m7]),LD(x,$,null)}finally{Mb()}return new c7(this.componentType,ie,Nh(Ie,$),$,Ie)}finally{Ve(s)}}}class c7 extends ZQ{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Rm(i,void 0,!1),this.componentType=e}setInput(e,n){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;const s=this._rootLView;OD(s[ye],s,i,e,n),this.previousInputValues.set(e,n),Sm(hi(this._tNode.index,s),1)}}get injector(){return new Dr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function m7(){const t=Bt();FE(ee()[ye],t)}let Eo=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=_7}return t})();function _7(){return function sF(t,e){let n;const r=e[t.index];return _r(r)?n=r:(n=hL(r,e,null,t),e[t.index]=n,pI(e,n)),oF(n,e,t,r),new rF(n,t,e)}(Bt(),ee())}const y7=Eo,rF=class extends y7{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Nh(this._hostTNode,this._hostLView)}get injector(){return new Dr(this._hostTNode,this._hostLView)}get parentInjector(){const e=$E(this._hostTNode,this._hostLView);if(Lb(e)){const n=dm(e,this._hostLView),r=lm(e);return new Dr(n[ye].data[r+8],n)}return new Dr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=iF(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-An}createEmbeddedView(e,n,r){let i,s;"number"==typeof r?i=r:null!=r&&(i=r.index,s=r.injector);const a=e.createEmbeddedViewImpl(n||{},s,null);return this.insertImpl(a,i,Fl(this._hostTNode,null)),a}createComponent(e,n,r,i,s){const o=e&&!function yl(t){return"function"==typeof t}(e);let a;if(o)a=n;else{const w=n||{};a=w.index,r=w.injector,i=w.projectableNodes,s=w.environmentInjector||w.ngModuleRef}const u=o?e:new Bm(gt(e)),c=r||this.parentInjector;if(!s&&null==u.ngModule){const b=(o?c:this.parentInjector).get(ci,null);b&&(s=b)}gt(u.componentType??{});const v=u.create(c,i,null,s);return this.insertImpl(v.hostView,a,Fl(this._hostTNode,null)),v}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){const i=e._lView;if(function im(t){return _r(t[qn])}(i)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const u=i[qn],c=new rF(u,u[sr],u[qn]);c.detach(c.indexOf(e))}}const s=this._adjustIndex(n),o=this._lContainer;return function Bh(t,e,n,r=!0){const i=e[ye];if(function lK(t,e,n,r){const i=An+r,s=n.length;r>0&&(n[i-1][Wi]=e),r<s-An?(e[Wi]=n[i],fE(n,An+r,e)):(n.push(e),e[Wi]=null),e[qn]=n;const o=e[$a];null!==o&&n!==o&&H1(o,e);const a=e[Ws];null!==a&&a.insertView(t),om(e),e[qe]|=128}(i,e,t,n),r){const o=CD(n,t),a=e[Xe],u=lI(a,t[Qi]);null!==u&&function uK(t,e,n,r,i,s){r[gn]=i,r[sr]=e,hI(t,r,n,1,i,s)}(i,t[sr],a,e,u,o)}const s=e[Qr];null!==s&&null!==s.firstChild&&(s.firstChild=null)}(o,i,s,r),e.attachToViewContainerRef(),fE(XD(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=iF(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=Cm(this._lContainer,n);r&&(ih(XD(this._lContainer),n),cI(r[ye],r))}detach(e){const n=this._adjustIndex(e,-1),r=Cm(this._lContainer,n);return r&&null!=ih(XD(this._lContainer),n)?new Rm(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function iF(t){return t[8]}function XD(t){return t[8]||(t[8]=[])}let oF=function uF(t,e,n,r){if(t[Qi])return;let i;i=8&n.type?bt(r):function v7(t,e){const n=t[Xe],r=n.createComment(""),i=Br(e,t);return kl(n,lI(n,i),r,function pK(t,e){return t.nextSibling(e)}(n,i),!1),r}(e,n),t[Qi]=i},eS=()=>!1;function Hh(t,e){xi("NgSignals");const n=function Z(t){const e=Object.create(Ct);e.value=t;const n=()=>(_e(e),e.value);return n[Ft]=e,n}(t),r=n[Ft];return e?.equal&&(r.equal=e.equal),n.set=i=>Ee(r,i),n.update=i=>function ue(t,e){fr()||Ta(),Ee(t,e(t.value))}(r,i),n.asReadonly=_F.bind(n),n}function _F(){const t=this[Ft];if(void 0===t.readonlyFn){const e=()=>this();e[Ft]=t,t.readonlyFn=e}return t.readonlyFn}function yF(t){return function mF(t){return"function"==typeof t&&void 0!==t[Ft]}(t)&&"function"==typeof t.set}function Jt(t){let e=function RF(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),n=!0;const r=[t];for(;e;){let i;if(vs(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new le(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);const o=t;o.inputs=SI(t.inputs),o.inputTransforms=SI(t.inputTransforms),o.declaredInputs=SI(t.declaredInputs),o.outputs=SI(t.outputs);const a=i.hostBindings;a&&$7(t,a);const u=i.viewQuery,c=i.contentQueries;if(u&&B7(t,u),c&&j7(t,c),V7(t,i),HA(t.outputs,i.outputs),vs(i)&&i.data.animation){const h=t.data;h.animation=(h.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(t),a===Jt&&(n=!1)}}e=Object.getPrototypeOf(e)}!function U7(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=dl(i.hostAttrs,n=dl(n,i.hostAttrs))}}(r)}function V7(t,e){for(const n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;const r=e.inputs[n];if(void 0!==r&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],null!==e.inputTransforms)){const i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function SI(t){return t===gs?{}:t===Nt?[]:t}function B7(t,e){const n=t.viewQuery;t.viewQuery=n?(r,i)=>{e(r,i),n(r,i)}:e}function j7(t,e){const n=t.contentQueries;t.contentQueries=n?(r,i,s)=>{e(r,i,s),n(r,i,s)}:e}function $7(t,e){const n=t.hostBindings;t.hostBindings=n?(r,i)=>{e(r,i),n(r,i)}:e}function xF(t){const e=t.inputConfig,n={};for(const r in e)if(e.hasOwnProperty(r)){const i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}class Bl{}class kF{}class cS extends Bl{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new tF(this);const i=Ur(e);this._bootstrapComponents=ws(i.bootstrap),this._r3Injector=MO(e,n,[{provide:Bl,useValue:this},{provide:TI,useValue:this.componentFactoryResolver},...r],Hn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class lS extends kF{constructor(e){super(),this.moduleType=e}create(e){return new cS(this.moduleType,e,[])}}class OF extends Bl{constructor(e){super(),this.componentFactoryResolver=new tF(this),this.instance=null;const n=new Qo([...e.providers,{provide:Bl,useValue:this},{provide:TI,useValue:this.componentFactoryResolver}],e.parent||ph(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function RI(t,e,n=null){return new OF({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}function NI(t){return!!function dS(t){return null!==t&&("function"==typeof t||"object"==typeof t)}(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function ar(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Hm(t,e,n,r,i,s,o,a,u,c){const h=n+je,g=e.firstCreatePass?function eY(t,e,n,r,i,s,o,a,u){const c=e.consts,h=Ll(e,t,4,o||null,a||null);PD(e,n,h,Ji(c,u)),FE(e,h);const g=h.tView=ND(2,h,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return null!==e.queries&&(e.queries.template(e,h),g.queries=e.queries.embeddedTView(h)),h}(h,e,t,r,i,s,o,a,u):e.data[h];Xi(g,!1);const _=LF(e,t,g,n);um()&&dI(e,t,_,g),pi(_,t);const v=hL(_,t,_,g);return t[h]=v,pI(t,v),function aF(t,e,n){return eS(t,e,n)}(v,g,t),yh(g)&&SD(e,t,g),null!=u&&RD(t,g,c),g}function zh(t,e,n,r,i,s,o,a){const u=ee(),c=lt();return Hm(u,c,t,e,n,r,i,Ji(c.consts,s),o,a),zh}let LF=function FF(t,e,n,r){return Zo(!0),e[Xe].createComment("")};function ta(t,e,n,r){const i=ee();return ar(i,yo(),e)&&(lt(),Xo(_n(),i,t,e,n,r)),ta}function tf(t,e,n,r,i,s){const a=function jl(t,e,n,r){const i=ar(t,e,n);return ar(t,e+1,r)||i}(t,function qa(){return et.lFrame.bindingIndex}(),n,i);return za(2),a?e+rt(n)+r+rt(i)+s:ct}function FI(t,e){return t<<17|e<<2}function oc(t){return t>>17&32767}function wS(t){return 2|t}function Hl(t){return(131068&t)>>2}function TS(t,e){return-131069&t|e<<2}function CS(t){return 1|t}function pV(t,e,n,r){const i=t[n+1],s=null===e;let o=r?oc(i):Hl(i),a=!1;for(;0!==o&&(!1===a||s);){const c=t[o+1];UY(t[o],e)&&(a=!0,t[o+1]=r?CS(c):wS(c)),o=r?oc(c):Hl(c)}a&&(t[n+1]=r?wS(i):CS(i))}function UY(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&Uu(t,e)>=0}function Js(t,e,n){const r=ee();return ar(r,yo(),e)&&ns(lt(),_n(),r,t,e,r[Xe],n,!1),Js}function AS(t,e,n,r,i){const o=i?"class":"style";OD(t,n,e.inputs[o],o,r)}function VI(t,e){return function Io(t,e,n,r){const i=ee(),s=lt(),o=za(2);s.firstUpdatePass&&function TV(t,e,n,r){const i=t.data;if(null===i[n+1]){const s=i[Yr()],o=function wV(t,e){return e>=t.expandoStartIndex}(t,n);(function DV(t,e){return!!(t.flags&(e?8:16))})(s,r)&&null===e&&!o&&(e=!1),e=function KY(t,e,n,r){const i=function Rb(t){const e=et.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(n=Wm(n=bS(null,t,e,n,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==i)if(n=bS(i,t,e,n,r),null===s){let u=function QY(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==Hl(r))return t[oc(r)]}(t,e,r);void 0!==u&&Array.isArray(u)&&(u=bS(null,t,e,u[1],r),u=Wm(u,e.attrs,r),function YY(t,e,n,r){t[oc(n?e.classBindings:e.styleBindings)]=r}(t,e,r,u))}else s=function ZY(t,e,n){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=Wm(r,t[s].hostAttrs,n);return Wm(r,e.attrs,n)}(t,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),n}(i,s,e,r),function FY(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=oc(o),u=Hl(o);t[r]=n;let h,c=!1;if(Array.isArray(n)?(h=n[1],(null===h||Uu(n,h)>0)&&(c=!0)):h=n,i)if(0!==u){const _=oc(t[a+1]);t[r+1]=FI(_,a),0!==_&&(t[_+1]=TS(t[_+1],r)),t[a+1]=function OY(t,e){return 131071&t|e<<17}(t[a+1],r)}else t[r+1]=FI(a,0),0!==a&&(t[a+1]=TS(t[a+1],r)),a=r;else t[r+1]=FI(u,0),0===a?a=r:t[u+1]=TS(t[u+1],r),u=r;c&&(t[r+1]=wS(t[r+1])),pV(t,h,r,!0),pV(t,h,r,!1),function VY(t,e,n,r,i){const s=i?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&Uu(s,e)>=0&&(n[r+1]=CS(n[r+1]))}(e,h,t,r,s),o=FI(a,u),s?e.classBindings=o:e.styleBindings=o}(i,s,e,n,o,r)}}(s,t,o,r),e!==ct&&ar(i,o,e)&&function AV(t,e,n,r,i,s,o,a){if(!(3&e.type))return;const u=t.data,c=u[a+1],h=function LY(t){return!(1&~t)}(c)?bV(u,e,n,i,Hl(c),o):void 0;UI(h)||(UI(s)||function kY(t){return!(2&~t)}(c)&&(s=bV(u,null,n,i,a,o)),function _K(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=-1===r.indexOf("-")?void 0:nc.DashCase;null==i?t.removeStyle(n,r,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=nc.Important),t.setStyle(n,r,i,s))}}(r,o,Zi(Yr(),n),i,s))}(s,s.data[Yr()],i,i[Xe],t,i[o+1]=function tZ(t,e){return null==t||""===t||("string"==typeof e?t+=e:"object"==typeof t&&(t=Hn(tc(t)))),t}(e,n),r,o)}(t,e,null,!0),VI}function bS(t,e,n,r,i){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=e[a],r=Wm(r,s.hostAttrs,i),s!==t);)a++;return null!==t&&(n.directiveStylingLast=a),r}function Wm(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Kr(t,o,!!n||e[++s]))}return void 0===t?null:t}function bV(t,e,n,r,i,s){const o=null===e;let a;for(;i>0;){const u=t[i],c=Array.isArray(u),h=c?u[1]:u,g=null===h;let _=n[i+1];_===ct&&(_=g?Nt:void 0);let v=g?kg(_,r):h===r?_:void 0;if(c&&!UI(v)&&(v=kg(u,r)),UI(v)&&(a=v,o))return a;const w=t[i+1];i=o?oc(w):Hl(w)}if(null!==e){let u=s?e.residualClasses:e.residualStyles;null!=u&&(a=kg(u,r))}return a}function UI(t){return void 0!==t}function Kt(t,e,n,r){const i=ee(),s=lt(),o=je+t,a=i[Xe],u=s.firstCreatePass?function CZ(t,e,n,r,i,s){const o=e.consts,u=Ll(e,t,2,r,Ji(o,i));return PD(e,n,u,Ji(o,s)),null!==u.attrs&&bI(u,u.attrs,!1),null!==u.mergedAttrs&&bI(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}(o,s,i,e,n,r):s.data[o],c=PV(s,i,u,a,e,t);i[o]=c;const h=yh(u);return Xi(u,!0),tL(a,c,u),!function qh(t){return!(32&~t.flags)}(u)&&um()&&dI(s,i,c,u),0===function E(){return et.lFrame.elementDepthCount}()&&pi(c,i),function T(){et.lFrame.elementDepthCount++}(),h&&(SD(s,i,u),DD(s,u,i)),null!==r&&RD(i,u),Kt}function Xt(){let t=Bt();Rl()?function bh(){et.lFrame.isParent=!1}():(t=t.parent,Xi(t,!1));const e=t;(function we(t){return et.skipHydrationRootTNode===t})(e)&&function Es(){et.skipHydrationRootTNode=null}(),function N(){et.lFrame.elementDepthCount--}();const n=lt();return n.firstCreatePass&&(FE(n,t),Qg(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function l8(t){return!!(8&t.flags)}(e)&&AS(n,e,ee(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function d8(t){return!!(16&t.flags)}(e)&&AS(n,e,ee(),e.stylesWithoutHost,!1),Xt}function Za(t,e,n,r){return Kt(t,e,n,r),Xt(),Za}let PV=(t,e,n,r,i,s)=>(Zo(!0),uI(r,i,function hO(){return et.lFrame.currentNamespace}()));function MS(){return ee()}const hf="en-US";let VV=hf;let rU=(t,e,n)=>{};function yr(t,e,n,r){const i=ee(),s=lt(),o=Bt();return OS(s,i,i[Xe],o,t,e,r),yr}function OS(t,e,n,r,i,s,o){const a=yh(r),c=t.firstCreatePass&&function gL(t){return t.cleanup??=[]}(t),h=e[Wt],g=function pL(t){return t[El]??=[]}(e);let _=!0;if(3&r.type||o){const b=Br(r,e),D=o?o(b):b,F=g.length,x=o?ie=>o(bt(ie[r.index])):r.index;let $=null;if(!o&&a&&($=function vJ(t,e,n,r){const i=t.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===n&&i[s+1]===r){const a=e[El],u=i[s+2];return a.length>u?a[u]:null}"string"==typeof o&&(s+=2)}return null}(t,e,i,r.index)),null!==$)($.__ngLastListenerFn__||$).__ngNextListenerFn__=s,$.__ngLastListenerFn__=s,_=!1;else{s=aU(r,e,h,s),rU(b,i,s);const ie=n.listen(D,i,s);g.push(s,ie),c&&c.push(i,x,F,F+1)}}else s=aU(r,e,h,s);const v=r.outputs;let w;if(_&&null!==v&&(w=v[i])){const b=w.length;if(b)for(let D=0;D<b;D+=2){const Ie=e[w[D]][w[D+1]].subscribe(s),Pe=g.length;g.push(s,Ie),c&&c.push(i,r.index,Pe,-(Pe+1))}}}function oU(t,e,n,r){const i=Ve(null);try{return Yi(6,e,n),!1!==n(r)}catch(s){return gI(t,s),!1}finally{Yi(7,e,n),Ve(i)}}function aU(t,e,n,r){return function i(s){if(s===Function)return r;Sm(t.componentOffset>-1?hi(t.index,e):e,5);let a=oU(e,n,r,s),u=i.__ngNextListenerFn__;for(;u;)a=oU(e,n,u,s)&&a,u=u.__ngNextListenerFn__;return a}}function ff(t=1){return function n8(t){return(et.lFrame.contextLView=function sm(t,e){for(;t>0;)e=e[zu],t--;return e}(t,et.lFrame.contextLView))[Wt]}(t)}function Zn(t,e=""){const n=ee(),r=lt(),i=t+je,s=r.firstCreatePass?Ll(r,i,1,e,null):r.data[i],o=RU(r,n,s,e,t);n[i]=o,um()&&dI(r,n,o,s),Xi(s,!1)}let RU=(t,e,n,r,i)=>(Zo(!0),function yD(t,e){return t.createText(e)}(e[Xe],r));function GI(t){return Xm("",t,""),GI}function Xm(t,e,n){const r=ee(),i=function ef(t,e,n,r){return ar(t,yo(),n)?e+rt(n)+r:ct}(r,t,e,n);return i!==ct&&Ka(r,Yr(),i),Xm}function VS(t,e,n,r,i){const s=ee(),o=tf(s,t,e,n,r,i);return o!==ct&&Ka(s,Yr(),o),VS}function US(t,e,n){yF(e)&&(e=e());const r=ee();return ar(r,yo(),e)&&ns(lt(),_n(),r,t,e,r[Xe],n,!1),US}function BS(t,e){const n=ee(),r=lt(),i=Bt();return OS(r,n,n[Xe],i,t,e),BS}function jS(t,e,n,r,i){if(t=Ze(t),Array.isArray(t))for(let s=0;s<t.length;s++)jS(t[s],e,n,r,i);else{const s=lt(),o=ee(),a=Bt();let u=Ko(t)?t:Ze(t.provide);const c=TE(t),h=1048575&a.providerIndexes,g=a.directiveStart,_=a.providerIndexes>>20;if(Ko(t)||!t.multi){const v=new cm(c,i,ge),w=HS(u,e,i?h:h+_,g);-1===w?(Ub(jE(a,o),s,u),$S(s,t,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(v),o.push(v)):(n[w]=v,o[w]=v)}else{const v=HS(u,e,h+_,g),w=HS(u,e,h,h+_),D=w>=0&&n[w];if(i&&!D||!i&&!(v>=0&&n[v])){Ub(jE(a,o),s,u);const F=function qJ(t,e,n,r,i){const s=new cm(t,n,ge);return s.multi=[],s.index=e,s.componentProviders=0,BU(s,i,r&&!n),s}(i?GJ:HJ,n.length,i,r,c);!i&&D&&(n[w].providerFactory=F),$S(s,t,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(F),o.push(F)}else $S(s,t,v>-1?v:w,BU(n[i?w:v],c,!i&&r));!i&&r&&D&&n[w].componentProviders++}}}function $S(t,e,n,r){const i=Ko(e),s=function IE(t){return!!t.useClass}(e);if(i||s){const u=(s?Ze(e.useClass):e).prototype.ngOnDestroy;if(u){const c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){const h=c.indexOf(n);-1===h?c.push(n,[r,u]):c[h+1].push(r,u)}else c.push(n,u)}}}function BU(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function HS(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function HJ(t,e,n,r){return GS(this.multi,[])}function GJ(t,e,n,r){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Ml(n,n[ye],this.providerFactory.index,r);s=a.slice(0,o),GS(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],GS(i,s);return s}function GS(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function kn(t,e=[]){return n=>{n.providersResolver=(r,i)=>function $J(t,e,n){const r=lt();if(r.firstCreatePass){const i=vs(t);jS(n,r.data,r.blueprint,i,!0),jS(e,r.data,r.blueprint,i,!1)}}(r,i?i(t):t,e)}}let zJ=(()=>{class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const r=pl(0,n.type),i=r.length>0?RI([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,i)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=Ne({token:t,providedIn:"environment",factory:()=>new t(ce(ci))})}return t})();function jU(t){xi("NgStandalone"),t.getStandaloneInjector=e=>e.get(zJ).getOrCreateStandaloneInjector(t)}class mf{constructor(e){this.full=e;const n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}}const OX=new mf("18.1.3");let l2=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();const g2=new ve(""),QI=new ve("");let JS,YS=(()=>{class t{constructor(n,r,i){this._ngZone=n,this.registry=r,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,JS||(function aee(t){JS=t}(i),i.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{At.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb()}});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),n()},r)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:i})}whenStable(n,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,i),this._runCallbacksIfReady()}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,i){return[]}static#e=this.\u0275fac=function(r){return new(r||t)(ce(At),ce(ZS),ce(QI))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})(),ZS=(()=>{class t{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return JS?.findTestabilityInTree(this,n,r)??null}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();function i_(t){return!!t&&"function"==typeof t.then}function m2(t){return!!t&&"function"==typeof t.subscribe}const XS=new ve("");let e0=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=he(XS,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const i of this.appInits){const s=i();if(i_(s))n.push(s);else if(m2(s)){const o=new Promise((a,u)=>{s.subscribe({complete:a,error:u})});n.push(o)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const YI=new ve("");function v2(t,e){return Array.isArray(e)?e.reduce(v2,t):{...t,...e}}let To=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=he(V8),this.afterRenderEffectManager=he(CI),this.zonelessEnabled=he(Fm),this.externalTestViews=new Set,this.beforeRender=new L,this.afterTick=new L,this.componentTypes=[],this.components=[],this.isStable=he(xl).hasPendingTasks.pipe(Ae(n=>!n)),this._injector=he(ci)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){const i=n instanceof WL;if(!this._injector.get(e0).done)throw!i&&function go(t){const e=gt(t)||Gn(t)||gr(t);return null!==e&&e.standalone}(n),new le(405,!1);let o;o=i?n:this._injector.get(TI).resolveComponentFactory(n),this.componentTypes.push(o.componentType);const a=function uee(t){return t.isBoundToModule}(o)?void 0:this._injector.get(Bl),c=o.create(or.NULL,[],r||o.selector,a),h=c.location.nativeElement,g=c.injector.get(g2,null);return g?.registerApplication(h),c.onDestroy(()=>{this.detachView(c.hostView),ZI(this.components,c),g?.unregisterApplication(h)}),this._loadComponent(c),c}tick(){this._tick(!0)}_tick(n){if(this._runningTick)throw new le(101,!1);const r=Ve(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(n)}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,Ve(r),this.afterTick.next()}}detectChangesInAttachedViews(n){let r=null;this._injector.destroyed||(r=this._injector.get(QD,null,{optional:!0}));let i=0;const s=this.afterRenderEffectManager;for(;i<10;){const o=0===i;if(n||!o){this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:u}of this._views)lee(a,u,o,this.zonelessEnabled)}else r?.begin?.(),r?.end?.();if(i++,s.executeInternalCallbacks(),!this.allViews.some(({_lView:a})=>Zu(a))&&(s.execute(),!this.allViews.some(({_lView:a})=>Zu(a))))break}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;ZI(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const r=this._injector.get(YI,[]);[...this._bootstrapListeners,...r].forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>ZI(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new le(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ZI(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function lee(t,e,n,r){(n||Zu(t))&&mI(t,e,n&&!r?0:1)}class dee{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}let I2=(()=>{class t{compileModuleSync(n){return new lS(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),s=ws(Ur(n).declarations).reduce((o,a)=>{const u=gt(a);return u&&o.push(new Bm(u)),o},[]);return new dee(r,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),pee=(()=>{class t{constructor(){this.zone=he(At),this.changeDetectionScheduler=he($h),this.applicationRef=he(To)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function t0({ngZoneFactory:t,ignoreChangesOutsideZone:e}){return t??=()=>new At(n0()),[{provide:At,useFactory:t},{provide:ms,multi:!0,useFactory:()=>{const n=he(pee,{optional:!0});return()=>n.initialize()}},{provide:ms,multi:!0,useFactory:()=>{const n=he(mee);return()=>{n.initialize()}}},!0===e?{provide:zL,useValue:!0}:[]]}function n0(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}let mee=(()=>{class t{constructor(){this.subscription=new Ht,this.initialized=!1,this.zone=he(At),this.pendingTasks=he(xl)}initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{At.assertNotInAngularZone(),queueMicrotask(()=>{null!==n&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{At.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),s_=(()=>{class t{constructor(){this.appRef=he(To),this.taskService=he(xl),this.ngZone=he(At),this.zonelessEnabled=he(Fm),this.disableScheduling=he(zL,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new Ht,this.cancelScheduledCallback=null,this.shouldRefreshViews=!1,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof qb||!this.zoneIsDefined)}notify(n){if(!this.zonelessEnabled&&5===n)return;switch(n){case 3:case 2:case 0:case 4:case 5:case 1:this.shouldRefreshViews=!0}if(!this.shouldScheduleTick())return;const r=this.useMicrotaskScheduler?OO:kO;this.pendingRenderTaskId=this.taskService.add(),this.zoneIsDefined?Zone.root.run(()=>{this.cancelScheduledCallback=r(()=>{this.tick(this.shouldRefreshViews)})}):this.cancelScheduledCallback=r(()=>{this.tick(this.shouldRefreshViews)})}shouldScheduleTick(){return!(this.disableScheduling||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&At.isInAngularZone())}tick(n){if(this.runningTick||this.appRef.destroyed)return;const r=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick(n)},void 0,this.schedulerTickApplyArgs)}catch(i){throw this.taskService.remove(r),i}finally{this.cleanup()}this.useMicrotaskScheduler=!0,OO(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(r)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.shouldRefreshViews=!1,this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Ja=new ve("",{providedIn:"root",factory:()=>he(Ja,yt.Optional|yt.SkipSelf)||function _ee(){return typeof $localize<"u"&&$localize.locale||hf}()}),s0=new ve("");let A2=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const i=function F8(t="zone.js",e){return"noop"===t?new qb:"zone.js"===t?new At(e):t}(r?.ngZone,n0({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return i.run(()=>{const s=r?.ignoreChangesOutsideZone,o=function Q7(t,e,n){return new cS(t,e,n)}(n.moduleType,this.injector,[...t0({ngZoneFactory:()=>i,ignoreChangesOutsideZone:s}),{provide:$h,useExisting:s_}]),a=o.injector.get(vo,null);return i.runOutsideAngular(()=>{const u=i.onError.subscribe({next:c=>{a.handleError(c)}});o.onDestroy(()=>{ZI(this._modules,o),u.unsubscribe()})}),function y2(t,e,n){try{const r=n();return i_(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(a,i,()=>{const u=o.injector.get(e0);return u.runInitializers(),u.donePromise.then(()=>(function UV(t){"string"==typeof t&&(VV=t.toLowerCase().replace(/_/g,"-"))}(o.injector.get(Ja,hf)||hf),this._moduleDoBootstrap(o),o))})})}bootstrapModule(n,r=[]){const i=v2({},r);return function fee(t,e,n){const r=new lS(n);return Promise.resolve(r)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(n){const r=n.injector.get(To);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new le(-403,!1);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new le(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get(s0,null);n&&(n.forEach(r=>r()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(r){return new(r||t)(ce(or))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})(),ac=null;const b2=new ve("");function D2(t,e,n=[]){const r=`Platform: ${e}`,i=new ve(r);return(s=[])=>{let o=o0();if(!o||o.injector.get(b2,!1)){const a=[...n,...s,{provide:i,useValue:!0}];t?t(a):function Eee(t){if(ac&&!ac.get(b2,!1))throw new le(400,!1);(function _2(){!function wu(t){zr=t}(()=>{throw new le(600,!1)})})(),ac=t;const e=t.get(A2);(function R2(t){t.get(o1,null)?.forEach(n=>n())})(t)}(function S2(t=[],e){return or.create({name:e,providers:[{provide:Hg,useValue:"platform"},{provide:s0,useValue:new Set([()=>ac=null])},...t]})}(a,r))}return function Iee(t){const e=o0();if(!e)throw new le(401,!1);return e}()}}function o0(){return ac?.get(A2)??null}let o_=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=Tee}return t})();function Tee(t){return function Cee(t,e,n){if(Ha(t)&&!n){const r=hi(t.index,e);return new Rm(r,r)}return 175&t.type?new Rm(e[mn],e):null}(Bt(),ee(),!(16&~t))}class O2{constructor(){}supports(e){return NI(e)}create(e){return new Ree(e)}}const See=(t,e)=>e;class Ree{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||See}forEachItem(e){let n;for(n=this._itHead;null!==n;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){const o=!r||n&&n.currentIndex<F2(r,i,s)?n:r,a=F2(o,i,s),u=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,null==o.previousIndex)i++;else{s||(s=[]);const c=a-i,h=u-i;if(c!=h){for(let _=0;_<c;_++){const v=_<s.length?s[_]:s[_]=0,w=v+_;h<=w&&w<c&&(s[_]=v+1)}s[o.previousIndex]=h-c}}a!==u&&e(o,a,u)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)e(n)}diff(e){if(null==e&&(e=[]),!NI(e))throw new le(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,s,o,n=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==n&&Object.is(n.trackById,o)?(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)):(n=this._mismatch(n,s,o,a),r=!0),n=n._next}else i=0,function J7(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Symbol.iterator]();let r;for(;!(r=n.next()).done;)e(r.value)}}(e,a=>{o=this._trackByFn(i,a),null!==n&&Object.is(n.trackById,o)?(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,o,i),r=!0),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new Nee(n,r),s,i),e}_verifyReinsertion(e,n,r,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==s?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const n=e._next;this._addToRemovals(this._unlink(e)),e=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,s=e._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){const i=null===n?this._itHead:n._next;return e._next=i,e._prev=n,null===i?this._itTail=e:i._prev=e,null===n?this._itHead=e:n._next=e,null===this._linkedRecords&&(this._linkedRecords=new L2),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const n=e._prev,r=e._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new L2),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Nee{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Pee{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const n=e._prevDup,r=e._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class L2{constructor(){this.map=new Map}put(e){const n=e.trackById;let r=this.map.get(n);r||(r=new Pee,this.map.set(n,r)),r.add(e)}get(e,n){const i=this.map.get(e);return i?i.get(e,n):null}remove(e){const n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function F2(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function U2(){return new d0([new O2])}let d0=(()=>{class t{static#e=this.\u0275prov=Ne({token:t,providedIn:"root",factory:U2});constructor(n){this.factories=n}static create(n,r){if(null!=r){const i=r.factories.slice();n=n.concat(i)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||U2()),deps:[[t,new rh,new Ba]]}}find(n){const r=this.factories.find(i=>i.supports(n));if(null!=r)return r;throw new le(901,!1)}}return t})();const Lee=D2(null,"core",[]);let Fee=(()=>{class t{constructor(n){}static#e=this.\u0275fac=function(r){return new(r||t)(ce(To))};static#t=this.\u0275mod=Fr({type:t});static#n=this.\u0275inj=pr({})}return t})();const rB=new ve("");function _f(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function l_(t,e){xi("NgSignals");const n=function hn(t){const e=Object.create(ri);e.computation=t;const n=()=>{if(ft(e),_e(e),e.value===jn)throw e.error;return e.value};return n[Ft]=e,n}(t);return e?.equal&&(n[Ft].equal=e.equal),n}function ia(t){const e=Ve(null);try{return t()}finally{Ve(e)}}let fB=null;function uc(){return fB}class bte{}const Cs=new ve("");let g0=(()=>{class t{historyGo(n){throw new Error("")}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:()=>he(Ste),providedIn:"platform"})}return t})();const Dte=new ve("");let Ste=(()=>{class t extends g0{constructor(){super(),this._doc=he(Cs),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return uc().getBaseHref(this._doc)}onPopState(n){const r=uc().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=uc().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,i){this._history.pushState(n,r,i)}replaceState(n,r,i){this._history.replaceState(n,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:()=>new t,providedIn:"platform"})}return t})();function m0(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function pB(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function Xa(t){return t&&"?"!==t[0]?"?"+t:t}let zl=(()=>{class t{historyGo(n){throw new Error("")}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:()=>he(mB),providedIn:"root"})}return t})();const gB=new ve("");let mB=(()=>{class t extends zl{constructor(n,r){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??he(Cs).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return m0(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+Xa(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,s){const o=this.prepareExternalUrl(i+Xa(s));this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){const o=this.prepareExternalUrl(i+Xa(s));this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||t)(ce(g0),ce(gB,8))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Rte=(()=>{class t extends zl{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){const r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=m0(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,i,s){let o=this.prepareExternalUrl(i+Xa(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){let o=this.prepareExternalUrl(i+Xa(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||t)(ce(g0),ce(gB,8))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})(),yf=(()=>{class t{constructor(n){this._subject=new Yn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const r=this._locationStrategy.getBaseHref();this._basePath=function Mte(t){if(new RegExp("^(https?:)?//").test(t)){const[,n]=t.split(/\/\/[^\/]+/);return n}return t}(pB(_B(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+Xa(r))}normalize(n){return t.stripTrailingSlash(function Pte(t,e){if(!t||!e.startsWith(t))return e;const n=e.substring(t.length);return""===n||["/",";","?","#"].includes(n[0])?n:e}(this._basePath,_B(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._locationStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Xa(r)),i)}replaceState(n,r="",i=null){this._locationStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Xa(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{const r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r,complete:i})}static#e=this.normalizeQueryParams=Xa;static#t=this.joinWithSlash=m0;static#n=this.stripTrailingSlash=pB;static#r=this.\u0275fac=function(r){return new(r||t)(ce(zl))};static#i=this.\u0275prov=Ne({token:t,factory:()=>function Nte(){return new yf(ce(zl))}(),providedIn:"root"})}return t})();function _B(t){return t.replace(/\/index.html$/,"")}class vne{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let D0=(()=>{class t{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,r,i){this._viewContainer=n,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const r=this._viewContainer;n.forEachOperation((i,s,o)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new vne(i.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===s?void 0:s);else if(null!==s){const a=r.get(s);r.move(a,o),SB(a,i)}});for(let i=0,s=r.length;i<s;i++){const a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}n.forEachIdentityChange(i=>{SB(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(n,r){return!0}static#e=this.\u0275fac=function(r){return new(r||t)(ge(Eo),ge(Qa),ge(d0))};static#t=this.\u0275dir=Je({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return t})();function SB(t,e){t.context.$implicit=e.item}let RB=(()=>{class t{constructor(n,r){this._viewContainer=n,this._context=new Ene,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){NB("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){NB("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}static#e=this.\u0275fac=function(r){return new(r||t)(ge(Eo),ge(Qa))};static#t=this.\u0275dir=Je({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return t})();class Ene{constructor(){this.$implicit=null,this.ngIf=null}}function NB(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Hn(e)}'.`)}let xB=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Fr({type:t});static#n=this.\u0275inj=pr({})}return t})();const kB="browser";function vw(t){return"server"===t}let Wne=(()=>{class t{static#e=this.\u0275prov=Ne({token:t,providedIn:"root",factory:()=>function zne(t){return t===kB}(he(Ys))?new Kne(he(Cs),window):new Yne})}return t})();class Kne{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){const n=function Qne(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&"function"==typeof t.body.attachShadow){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){const n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}}class Yne{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}}class Are extends bte{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class O0 extends Are{static makeCurrent(){!function Ate(t){fB??=t}(new O0)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function bre(){return p_=p_||document.querySelector("base"),p_?p_.getAttribute("href"):null}();return null==n?null:function Dre(t){return new URL(t,document.baseURI).pathname}(n)}resetBaseElement(){p_=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function mne(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,s]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let p_=null,Rre=(()=>{class t{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})();const Tw=new ve("");let GB=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>{i.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(s=>s.supports(n)),!r)throw new le(5101,!1);return this._eventNameToPlugin.set(n,r),r}static#e=this.\u0275fac=function(r){return new(r||t)(ce(Tw),ce(At))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})();class L0{constructor(e){this._doc=e}}const F0="ng-app-id";let qB=(()=>{class t{constructor(n,r,i,s={}){this.doc=n,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=vw(s),this.resetHostNodes()}addStyles(n){for(const r of n)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(n){for(const r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){const r=this.styleRef;r.get(n)?.elements?.forEach(i=>i.remove()),r.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${F0}="${this.appId}"]`);if(n?.length){const r=new Map;return n.forEach(i=>{null!=i.textContent&&r.set(i.textContent,i)}),r}return null}changeUsageCount(n,r){const i=this.styleRef;if(i.has(n)){const s=i.get(n);return s.usage+=r,s.usage}return i.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){const i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===n)return i.delete(r),s.removeAttribute(F0),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(F0,this.appId),n.appendChild(o),o}}addStyleToHost(n,r){const i=this.getStyleElement(n,r),s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}static#e=this.\u0275fac=function(r){return new(r||t)(ce(Cs),ce(Mh),ce(a1,8),ce(Ys))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})();const V0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},U0=/%COMP%/g,xre=new ve("",{providedIn:"root",factory:()=>!0});function WB(t,e){return e.map(n=>n.replace(U0,t))}let KB=(()=>{class t{constructor(n,r,i,s,o,a,u,c=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=u,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=vw(a),this.defaultRenderer=new B0(n,o,u,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===_s.ShadowDom&&(r={...r,encapsulation:_s.Emulated});const i=this.getOrCreateRenderer(n,r);return i instanceof YB?i.applyToHost(n):i instanceof j0&&i.applyStyles(),i}getOrCreateRenderer(n,r){const i=this.rendererByCompId;let s=i.get(r.id);if(!s){const o=this.doc,a=this.ngZone,u=this.eventManager,c=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(r.encapsulation){case _s.Emulated:s=new YB(u,c,r,this.appId,h,o,a,g);break;case _s.ShadowDom:return new Fre(u,c,n,r,o,a,this.nonce,g);default:s=new j0(u,c,r,h,o,a,g)}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(r){return new(r||t)(ce(GB),ce(qB),ce(Mh),ce(xre),ce(Cs),ce(Ys),ce(At),ce(a1))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})();class B0{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(V0[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(QB(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(QB(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new le(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const s=V0[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=V0[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(nc.DashCase|nc.Important)?e.style.setProperty(n,r,i&nc.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&nc.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){null!=e&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if("string"==typeof e&&!(e=uc().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if("__ngUnwrap__"===n)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))&&n.preventDefault()}}}function QB(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class Fre extends B0{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=WB(i.id,i.styles);for(const h of c){const g=document.createElement("style");a&&g.setAttribute("nonce",a),g.textContent=h,this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class j0 extends B0{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?WB(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class YB extends j0{constructor(e,n,r,i,s,o,a,u){const c=i+"-"+r.id;super(e,n,r,s,o,a,u,c),this.contentAttr=function kre(t){return"_ngcontent-%COMP%".replace(U0,t)}(c),this.hostAttr=function Ore(t){return"_nghost-%COMP%".replace(U0,t)}(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}let Vre=(()=>{class t extends L0{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}static#e=this.\u0275fac=function(r){return new(r||t)(ce(Cs))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})(),Ure=(()=>{class t extends L0{constructor(n){super(n),this.delegate=he(rB,{optional:!0})}supports(n){return!!this.delegate&&this.delegate.supports(n)}addEventListener(n,r,i){return this.delegate.addEventListener(n,r,i)}removeEventListener(n,r,i){return this.delegate.removeEventListener(n,r,i)}static#e=this.\u0275fac=function(r){return new(r||t)(ce(Cs))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})();const ZB=["alt","control","meta","shift"],Bre={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},jre={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let $re=(()=>{class t extends L0{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,i){const s=t.parseEventName(r),o=t.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>uc().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=t._normalizeKey(r.pop());let o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),ZB.forEach(c=>{const h=r.indexOf(c);h>-1&&(r.splice(h,1),o+=c+".")}),o+=s,0!=r.length||0===s.length)return null;const u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(n,r){let i=Bre[n.key]||n.key,s="";return r.indexOf("code.")>-1&&(i=n.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),ZB.forEach(o=>{o!==i&&(0,jre[o])(n)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(n,r,i){return s=>{t.matchEventFullKeyCode(s,n)&&i.runGuarded(()=>r(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}static#e=this.\u0275fac=function(r){return new(r||t)(ce(Cs))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})();const zre=D2(Lee,"browser",[{provide:Ys,useValue:kB},{provide:o1,useValue:function Hre(){O0.makeCurrent()},multi:!0},{provide:Cs,useFactory:function qre(){return function a5(t){Qb=t}(document),document},deps:[]}]),Wre=new ve(""),ej=[{provide:QI,useClass:class Sre{addToWindow(e){Zt.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new le(5103,!1);return s},Zt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Zt.getAllAngularRootElements=()=>e.getAllRootElements(),Zt.frameworkStabilizers||(Zt.frameworkStabilizers=[]),Zt.frameworkStabilizers.push(r=>{const i=Zt.getAllAngularTestabilities();let s=i.length;const o=function(){s--,0==s&&r()};i.forEach(a=>{a.whenStable(o)})})}findTestabilityInTree(e,n,r){return null==n?null:e.getTestability(n)??(r?uc().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},deps:[]},{provide:g2,useClass:YS,deps:[At,ZS,QI]},{provide:YS,useClass:YS,deps:[At,ZS,QI]}],tj=[{provide:Hg,useValue:"root"},{provide:vo,useFactory:function Gre(){return new vo},deps:[]},{provide:Tw,useClass:Vre,multi:!0,deps:[Cs,At,Ys]},{provide:Tw,useClass:$re,multi:!0,deps:[Cs]},{provide:Tw,useClass:Ure,multi:!0},KB,qB,GB,{provide:QD,useExisting:KB},{provide:class Zne{},useClass:Rre,deps:[]},[]];let Kre=(()=>{class t{constructor(n){}static withServerTransition(n){return{ngModule:t,providers:[{provide:Mh,useValue:n.appId}]}}static#e=this.\u0275fac=function(r){return new(r||t)(ce(Wre,12))};static#t=this.\u0275mod=Fr({type:t});static#n=this.\u0275inj=pr({providers:[...tj,...ej],imports:[xB,Fee]})}return t})(),Qre=(()=>{class t{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static#e=this.\u0275fac=function(r){return new(r||t)(ce(Cs))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var If=ot(635);const ij=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function sj(t){return ze(t?.then)}function oj(t){return ze(t[hs])}function aj(t){return Symbol.asyncIterator&&ze(t?.[Symbol.asyncIterator])}function uj(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const cj=function Xre(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function lj(t){return ze(t?.[cj])}function dj(t){return(0,If.AQ)(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:r,done:i}=yield(0,If.N3)(n.read());if(i)return yield(0,If.N3)(void 0);yield yield(0,If.N3)(r)}}finally{n.releaseLock()}})}function hj(t){return ze(t?.getReader)}function is(t){if(t instanceof nn)return t;if(null!=t){if(oj(t))return function eie(t){return new nn(e=>{const n=t[hs]();if(ze(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(ij(t))return function tie(t){return new nn(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(sj(t))return function nie(t){return new nn(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Cu)})}(t);if(aj(t))return fj(t);if(lj(t))return function rie(t){return new nn(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(hj(t))return function iie(t){return fj(dj(t))}(t)}throw uj(t)}function fj(t){return new nn(e=>{(function sie(t,e){var n,r,i,s;return(0,If.sH)(this,void 0,void 0,function*(){try{for(n=(0,If.xN)(t);!(r=yield n.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function nu(t,e,n,r=0,i=!1){const s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function cc(t,e=0){return Oe((n,r)=>{n.subscribe(Be(r,i=>nu(r,t,()=>r.next(i),e),()=>nu(r,t,()=>r.complete(),e),i=>nu(r,t,()=>r.error(i),e)))})}function wf(t,e=0){return Oe((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function pj(t,e){if(!t)throw new Error("Iterable cannot be null");return new nn(n=>{nu(n,e,()=>{const r=t[Symbol.asyncIterator]();nu(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function en(t,e){return e?function die(t,e){if(null!=t){if(oj(t))return function oie(t,e){return is(t).pipe(wf(e),cc(e))}(t,e);if(ij(t))return function uie(t,e){return new nn(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}(t,e);if(sj(t))return function aie(t,e){return is(t).pipe(wf(e),cc(e))}(t,e);if(aj(t))return pj(t,e);if(lj(t))return function cie(t,e){return new nn(n=>{let r;return nu(n,e,()=>{r=t[cj](),nu(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void n.error(o)}s?n.complete():n.next(i)},0,!0)}),()=>ze(r?.return)&&r.return()})}(t,e);if(hj(t))return function lie(t,e){return pj(dj(t),e)}(t,e)}throw uj(t)}(t,e):is(t)}const{isArray:hie}=Array,{getPrototypeOf:fie,prototype:pie,keys:gie}=Object;function gj(t){if(1===t.length){const e=t[0];if(hie(e))return{args:e,keys:null};if(function mie(t){return t&&"object"==typeof t&&fie(t)===pie}(e)){const n=gie(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function $0(t){return t[t.length-1]}function H0(t){return ze($0(t))?t.pop():void 0}function g_(t){return function _ie(t){return t&&ze(t.schedule)}($0(t))?t.pop():void 0}const{isArray:vie}=Array;function mj(t){return Ae(e=>function Eie(t,e){return vie(e)?t(...e):t(e)}(t,e))}function _j(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}let yj=(()=>{class t{constructor(n,r){this._renderer=n,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}static#e=this.\u0275fac=function(r){return new(r||t)(ge(Ya),ge(Is))};static#t=this.\u0275dir=Je({type:t})}return t})(),Kl=(()=>{class t extends yj{static#e=this.\u0275fac=(()=>{let n;return function(i){return(n||(n=jr(t)))(i||t)}})();static#t=this.\u0275dir=Je({type:t,features:[Jt]})}return t})();const sa=new ve(""),Tie={provide:sa,useExisting:zt(()=>Tf),multi:!0},Aie=new ve("");let Tf=(()=>{class t extends yj{constructor(n,r,i){super(n,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Cie(){const t=uc()?uc().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}static#e=this.\u0275fac=function(r){return new(r||t)(ge(Ya),ge(Is),ge(Aie,8))};static#t=this.\u0275dir=Je({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){1&r&&yr("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[kn([Tie]),Jt]})}return t})();function lc(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function Ej(t){return null!=t&&"number"==typeof t.length}const mi=new ve(""),dc=new ve(""),bie=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Aw{static min(e){return function Ij(t){return e=>{if(lc(e.value)||lc(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}(e)}static max(e){return function wj(t){return e=>{if(lc(e.value)||lc(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}(e)}static required(e){return Tj(e)}static requiredTrue(e){return function Cj(t){return!0===t.value?null:{required:!0}}(e)}static email(e){return function Aj(t){return lc(t.value)||bie.test(t.value)?null:{email:!0}}(e)}static minLength(e){return function bj(t){return e=>lc(e.value)||!Ej(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function Dj(t){return e=>Ej(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}(e)}static pattern(e){return function Sj(t){if(!t)return bw;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),r=>{if(lc(r.value))return null;const i=r.value;return e.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return kj(e)}static composeAsync(e){return Oj(e)}}function Tj(t){return lc(t.value)?{required:!0}:null}function bw(t){return null}function Rj(t){return null!=t}function Nj(t){return i_(t)?en(t):t}function Pj(t){let e={};return t.forEach(n=>{e=null!=n?{...e,...n}:e}),0===Object.keys(e).length?null:e}function Mj(t,e){return e.map(n=>n(t))}function xj(t){return t.map(e=>function Die(t){return!t.validate}(e)?e:n=>e.validate(n))}function kj(t){if(!t)return null;const e=t.filter(Rj);return 0==e.length?null:function(n){return Pj(Mj(n,e))}}function G0(t){return null!=t?kj(xj(t)):null}function Oj(t){if(!t)return null;const e=t.filter(Rj);return 0==e.length?null:function(n){return function Iie(...t){const e=H0(t),{args:n,keys:r}=gj(t),i=new nn(s=>{const{length:o}=n;if(!o)return void s.complete();const a=new Array(o);let u=o,c=o;for(let h=0;h<o;h++){let g=!1;is(n[h]).subscribe(Be(s,_=>{g||(g=!0,c--),a[h]=_},()=>u--,void 0,()=>{(!u||!g)&&(c||s.next(r?_j(r,a):a),s.complete())}))}});return e?i.pipe(mj(e)):i}(Mj(n,e).map(Nj)).pipe(Ae(Pj))}}function q0(t){return null!=t?Oj(xj(t)):null}function Lj(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function Fj(t){return t._rawValidators}function Vj(t){return t._rawAsyncValidators}function z0(t){return t?Array.isArray(t)?t:[t]:[]}function Dw(t,e){return Array.isArray(t)?t.includes(e):t===e}function Uj(t,e){const n=z0(e);return z0(t).forEach(i=>{Dw(n,i)||n.push(i)}),n}function Bj(t,e){return z0(e).filter(n=>!Dw(t,n))}class jj{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=G0(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=q0(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return!!this.control&&this.control.hasError(e,n)}getError(e,n){return this.control?this.control.getError(e,n):null}}class Vi extends jj{get formDirective(){return null}get path(){return null}}class hc extends jj{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class $j{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}}let Sw=(()=>{class t extends $j{constructor(n){super(n)}static#e=this.\u0275fac=function(r){return new(r||t)(ge(hc,2))};static#t=this.\u0275dir=Je({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){2&r&&VI("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Jt]})}return t})(),W0=(()=>{class t extends $j{constructor(n){super(n)}static#e=this.\u0275fac=function(r){return new(r||t)(ge(Vi,10))};static#t=this.\u0275dir=Je({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){2&r&&VI("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Jt]})}return t})();const m_="VALID",Nw="INVALID",Cf="PENDING",__="DISABLED";class Af{}class Gj extends Af{constructor(e,n){super(),this.value=e,this.source=n}}class Y0 extends Af{constructor(e,n){super(),this.pristine=e,this.source=n}}class Z0 extends Af{constructor(e,n){super(),this.touched=e,this.source=n}}class Pw extends Af{constructor(e,n){super(),this.status=e,this.source=n}}class Mie extends Af{constructor(e){super(),this.source=e}}class xie extends Af{constructor(e){super(),this.source=e}}function J0(t){return(Mw(t)?t.validators:t)||null}function X0(t,e){return(Mw(e)?e.asyncValidators:t)||null}function Mw(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}function qj(t,e,n){const r=t.controls;if(!(e?Object.keys(r):r).length)throw new le(1e3,"");if(!r[n])throw new le(1001,"")}function zj(t,e,n){t._forEachChild((r,i)=>{if(void 0===n[i])throw new le(1002,"")})}class xw{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=l_(()=>this.statusReactive()),this.statusReactive=Hh(void 0),this._pristine=l_(()=>this.pristineReactive()),this.pristineReactive=Hh(!0),this._touched=l_(()=>this.touchedReactive()),this.touchedReactive=Hh(!1),this._events=new L,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return ia(this.statusReactive)}set status(e){ia(()=>this.statusReactive.set(e))}get valid(){return this.status===m_}get invalid(){return this.status===Nw}get pending(){return this.status==Cf}get disabled(){return this.status===__}get enabled(){return this.status!==__}get pristine(){return ia(this.pristineReactive)}set pristine(e){ia(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return ia(this.touchedReactive)}set touched(e){ia(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Uj(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Uj(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Bj(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Bj(e,this._rawAsyncValidators))}hasValidator(e){return Dw(this._rawValidators,e)}hasAsyncValidator(e){return Dw(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){const n=!1===this.touched;this.touched=!0;const r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched({...e,sourceControl:r}),n&&!1!==e.emitEvent&&this._events.next(new Z0(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(n=>n.markAllAsTouched(e))}markAsUntouched(e={}){const n=!0===this.touched;this.touched=!1,this._pendingTouched=!1;const r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),n&&!1!==e.emitEvent&&this._events.next(new Z0(!1,r))}markAsDirty(e={}){const n=!0===this.pristine;this.pristine=!1;const r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty({...e,sourceControl:r}),n&&!1!==e.emitEvent&&this._events.next(new Y0(!1,r))}markAsPristine(e={}){const n=!1===this.pristine;this.pristine=!0,this._pendingDirty=!1;const r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),n&&!1!==e.emitEvent&&this._events.next(new Y0(!0,r))}markAsPending(e={}){this.status=Cf;const n=e.sourceControl??this;!1!==e.emitEvent&&(this._events.next(new Pw(this.status,n)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending({...e,sourceControl:n})}disable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=__,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue();const r=e.sourceControl??this;!1!==e.emitEvent&&(this._events.next(new Gj(this.value,r)),this._events.next(new Pw(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:n},this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=m_,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:n},this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,n){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},n),this._parent._updateTouched({},n))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){const r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===m_||this.status===Cf)&&this._runAsyncValidator(r,e.emitEvent)}const n=e.sourceControl??this;!1!==e.emitEvent&&(this._events.next(new Gj(this.value,n)),this._events.next(new Pw(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity({...e,sourceControl:n})}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?__:m_}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,n){if(this.asyncValidator){this.status=Cf,this._hasOwnPendingAsyncValidator={emitEvent:!1!==n};const r=Nj(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:n,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();const e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(!1!==n.emitEvent,this,n.shouldHaveEmitted)}get(e){let n=e;return null==n||(Array.isArray(n)||(n=n.split(".")),0===n.length)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){const r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,n,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Pw(this.status,n)),this._parent&&this._parent._updateControlsErrors(e,n,r)}_initObservables(){this.valueChanges=new Yn,this.statusChanges=new Yn}_calculateStatus(){return this._allControlsDisabled()?__:this.errors?Nw:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Cf)?Cf:this._anyControlsHaveStatus(Nw)?Nw:m_}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,n){const r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),i&&this._events.next(new Y0(this.pristine,n))}_updateTouched(e={},n){this.touched=this._anyControlsTouched(),this._events.next(new Z0(this.touched,n)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Mw(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function kie(t){return Array.isArray(t)?G0(t):t||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function Oie(t){return Array.isArray(t)?q0(t):t||null}(this._rawAsyncValidators)}}class y_ extends xw{constructor(e,n,r){super(J0(n),X0(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){zj(this,0,e),Object.keys(e).forEach(r=>{qj(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){null!=e&&(Object.keys(e).forEach(r=>{const i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n,this),this._updateTouched(n,this),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>!!r._syncPendingControls()||n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{const r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,s)=>{r=n(r,i,s)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class Wj extends y_{}const Ql=new ve("CallSetDisabledState",{providedIn:"root",factory:()=>v_}),v_="always";function kw(t,e){return[...e.path,t]}function E_(t,e,n=v_){eR(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||"always"===n)&&e.valueAccessor.setDisabledState?.(t.disabled),function Fie(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Kj(t,e)})}(t,e),function Uie(t,e){const n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function Vie(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Kj(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function Lie(t,e){if(e.valueAccessor.setDisabledState){const n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function Ow(t,e,n=!0){const r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Fw(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function Lw(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function eR(t,e){const n=Fj(t);null!==e.validator?t.setValidators(Lj(n,e.validator)):"function"==typeof n&&t.setValidators([n]);const r=Vj(t);null!==e.asyncValidator?t.setAsyncValidators(Lj(r,e.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]);const i=()=>t.updateValueAndValidity();Lw(e._rawValidators,i),Lw(e._rawAsyncValidators,i)}function Fw(t,e){let n=!1;if(null!==t){if(null!==e.validator){const i=Fj(t);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.validator);s.length!==i.length&&(n=!0,t.setValidators(s))}}if(null!==e.asyncValidator){const i=Vj(t);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(n=!0,t.setAsyncValidators(s))}}}const r=()=>{};return Lw(e._rawValidators,r),Lw(e._rawAsyncValidators,r),n}function Kj(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function nR(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}function rR(t,e){if(!e)return null;let n,r,i;return Array.isArray(e),e.forEach(s=>{s.constructor===Tf?n=s:function $ie(t){return Object.getPrototypeOf(t.constructor)===Kl}(s)?r=s:i=s}),i||r||n||null}function Zj(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function Jj(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}Promise.resolve();const w_=class extends xw{constructor(e=null,n,r){super(J0(n),X0(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Mw(n)&&(n.nonNullable||n.initialValueIsDefault)&&(this.defaultValue=Jj(e)?e.value:e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Zj(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Zj(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){Jj(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Wie={provide:hc,useExisting:zt(()=>sR)},t$=Promise.resolve();let sR=(()=>{class t extends hc{constructor(n,r,i,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new w_,this._registered=!1,this.name="",this.update=new Yn,this._parent=n,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=rR(0,s)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const r=n.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),nR(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){E_(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){t$.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const r=n.isDisabled.currentValue,i=0!==r&&_f(r);t$.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?kw(n,this._parent):[n]}static#e=this.\u0275fac=function(r){return new(r||t)(ge(Vi,9),ge(mi,10),ge(dc,10),ge(sa,10),ge(o_,8),ge(Ql,8))};static#t=this.\u0275dir=Je({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[kn([Wie]),Jt,li]})}return t})(),oR=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275dir=Je({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return t})();const aR=new ve(""),Xie={provide:Vi,useExisting:zt(()=>T_)};let T_=(()=>{class t extends Vi{get submitted(){return ia(this._submittedReactive)}set submitted(n){this._submittedReactive.set(n)}constructor(n,r,i){super(),this.callSetDisabledState=i,this._submitted=l_(()=>this._submittedReactive()),this._submittedReactive=Hh(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Yn,this._setValidators(n),this._setAsyncValidators(r)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Fw(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){const r=this.form.get(n.path);return E_(r,n,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),r}getControl(n){return this.form.get(n.path)}removeControl(n){Ow(n.control||null,n,!1),function Hie(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,r){this.form.get(n.path).setValue(r)}onSubmit(n){return this._submittedReactive.set(!0),function Yj(t,e){t._syncPendingControls(),e.forEach(n=>{const r=n.control;"submit"===r.updateOn&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(n),this.form._events.next(new Mie(this.control)),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this._submittedReactive.set(!1),this.form._events.next(new xie(this.form))}_updateDomValue(){this.directives.forEach(n=>{const r=n.control,i=this.form.get(n.path);r!==i&&(Ow(r||null,n),(t=>t instanceof w_)(i)&&(E_(i,n,this.callSetDisabledState),n.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){const r=this.form.get(n.path);(function Qj(t,e){eR(t,e)})(r,n),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){const r=this.form.get(n.path);r&&function Bie(t,e){return Fw(t,e)}(r,n)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){eR(this.form,this),this._oldForm&&Fw(this._oldForm,this)}_checkFormPresent(){}static#e=this.\u0275fac=function(r){return new(r||t)(ge(mi,10),ge(dc,10),ge(Ql,8))};static#t=this.\u0275dir=Je({type:t,selectors:[["","formGroup",""]],hostBindings:function(r,i){1&r&&yr("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[kn([Xie]),Jt,li]})}return t})();const nse={provide:hc,useExisting:zt(()=>Vw)};let Vw=(()=>{class t extends hc{set isDisabled(n){}static#e=this._ngModelWarningSentOnce=!1;constructor(n,r,i,s,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.name=null,this.update=new Yn,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=rR(0,s)}ngOnChanges(n){this._added||this._setUpControl(),nR(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return kw(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static#t=this.\u0275fac=function(r){return new(r||t)(ge(Vi,13),ge(mi,10),ge(dc,10),ge(sa,10),ge(aR,8))};static#n=this.\u0275dir=Je({type:t,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[kn([nse]),Jt,li]})}return t})(),Yl=(()=>{class t{constructor(){this._validator=bw}ngOnChanges(n){if(this.inputName in n){const r=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):bw,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return null!=n}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275dir=Je({type:t,features:[li]})}return t})();const dse={provide:mi,useExisting:zt(()=>Uw),multi:!0};let Uw=(()=>{class t extends Yl{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=_f,this.createValidator=n=>Tj}enabled(n){return n}static#e=this.\u0275fac=(()=>{let n;return function(i){return(n||(n=jr(t)))(i||t)}})();static#t=this.\u0275dir=Je({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){2&r&&ta("required",i._enabled?"":null)},inputs:{required:"required"},features:[kn([dse]),Jt]})}return t})(),y$=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Fr({type:t});static#n=this.\u0275inj=pr({})}return t})();class v$ extends xw{constructor(e,n,r){super(J0(n),X0(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,n={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(e,n,r={}){this.controls.splice(e,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,n={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(e,n,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),n&&(this.controls.splice(i,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,n={}){zj(this,0,e),e.forEach((r,i)=>{qj(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){null!=e&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e=[],n={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n,this),this._updateTouched(n,this),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((n,r)=>!!r._syncPendingControls()||n,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((n,r)=>{e(n,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(n=>n.enabled&&e(n))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function E$(t){return!!t&&(void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn)}let I$=(()=>{class t{constructor(){this.useNonNullable=!1}get nonNullable(){const n=new t;return n.useNonNullable=!0,n}group(n,r=null){const i=this._reduceControls(n);let s={};return E$(r)?s=r:null!==r&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new y_(i,s)}record(n,r=null){const i=this._reduceControls(n);return new Wj(i,r)}control(n,r,i){let s={};return this.useNonNullable?(E$(r)?s=r:(s.validators=r,s.asyncValidators=i),new w_(n,{...s,nonNullable:!0})):new w_(n,r,i)}array(n,r,i){const s=n.map(o=>this._createControl(o));return new v$(s,r,i)}_reduceControls(n){const r={};return Object.keys(n).forEach(i=>{r[i]=this._createControl(n[i])}),r}_createControl(n){return n instanceof w_||n instanceof xw?n:Array.isArray(n)?this.control(n[0],n.length>1?n[1]:null,n.length>2?n[2]:null):this.control(n)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),_se=(()=>{class t{static withConfig(n){return{ngModule:t,providers:[{provide:Ql,useValue:n.callSetDisabledState??v_}]}}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Fr({type:t});static#n=this.\u0275inj=pr({imports:[y$]})}return t})(),yse=(()=>{class t{static withConfig(n){return{ngModule:t,providers:[{provide:aR,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:Ql,useValue:n.callSetDisabledState??v_}]}}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Fr({type:t});static#n=this.\u0275inj=pr({imports:[y$]})}return t})();var ss=ot(852);(0,ss.registerVersion)("firebase","10.12.5","app");class Ise extends Ht{constructor(e,n){super()}schedule(e,n=0){return this}}const Bw={setInterval(t,e,...n){const{delegate:r}=Bw;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){const{delegate:e}=Bw;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};class w$ extends Ise{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return Bw.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return n;null!=n&&Bw.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,n);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let i,r=!1;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,nr(r,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}}const hR={now:()=>(hR.delegate||Date).now(),delegate:void 0};class C_{constructor(e,n=C_.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}}C_.now=hR.now;class T$ extends C_{constructor(e,n=C_.now){super(e,n),this.actions=[],this._active=!1}flush(e){const{actions:n}=this;if(this._active)return void n.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}}const Cse=new class Tse extends T${}(class wse extends w${constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}}),jw=new T$(w$);function Nr(t,e,n){const r=ze(t)||e||n?{next:t,error:e,complete:n}:t;return r?Oe((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let a=!0;i.subscribe(Be(s,u=>{var c;null===(c=r.next)||void 0===c||c.call(r,u),s.next(u)},()=>{var u;a=!1,null===(u=r.complete)||void 0===u||u.call(r),s.complete()},u=>{var c;a=!1,null===(c=r.error)||void 0===c||c.call(r,u),s.error(u)},()=>{var u,c;a&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(c=r.finalize)||void 0===c||c.call(r)}))}):Or}const bf=new mf("ANGULARFIRE2_VERSION");class $w{constructor(){return((t,e)=>{const n=(0,ss.getApps)(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r})(bse)}}const bse="app-check";function Df(){}class C${zone;delegate;constructor(e,n=Cse){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},n,r)}}class Dse{zone;task=null;constructor(e){this.zone=e}call(e,n){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Df,{},Df,Df)),n.pipe(Nr({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Hw=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new C$(Zone.current)),this.insideAngular=n.run(()=>new C$(Zone.current,jw)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(ce(At))};static \u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Sf(){const t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return t}function A$(t){return t.pipe(cc(Sf().outsideAngular))}function lr(t){return function Rse(t){return function(n){return(n=n.lift(new Dse(t.ngZone))).pipe(wf(t.outsideAngular),cc(t.insideAngular))}}(Sf())(t)}var _i=ot(345);_i.A.registerVersion("firebase","10.12.5","app-compat");const xse=["ngOnDestroy"];class b${constructor(e){return e}}const Rf=new ve("angularfire2.app.options"),Nf=new ve("angularfire2.app.name");function A_(t,e,n){const i="object"==typeof n&&n||{};i.name=i.name||"string"==typeof n&&n||"[DEFAULT]";const o=_i.A.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>_i.A.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){const a=!!module.hot;Lse("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new b$(o)}const Lse=(t,...e)=>{},Fse={provide:b$,useFactory:A_,deps:[Rf,At,[new Ba,Nf]]};let Vse=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Rf,useValue:n},{provide:Nf,useValue:r}]}}constructor(n){_i.A.registerVersion("angularfire",bf.full,"core"),_i.A.registerVersion("angularfire",bf.full,"app-compat"),_i.A.registerVersion("angular",OX.full,n.toString())}static \u0275fac=function(r){return new(r||t)(ce(Ys))};static \u0275mod=Fr({type:t});static \u0275inj=pr({providers:[Fse]})}return t})();function Gw(t,e,n,r,i){const[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return function Use(t,e){try{return t.toString()===e.toString()}catch{return t===e}}(i,o)||(D$("error",`${e} was already initialized on the ${n} Firebase App with different settings.${Bse?" You may need to reload as Firebase is not HMR aware.":""}`),D$("warn",{is:i,was:o})),s;{const a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}const Bse=typeof module<"u"&&!!module.hot,D$=(t,...e)=>{};function We(...t){return en(t,g_(t))}function yi(t,e,n=1/0){return ze(e)?yi((r,i)=>Ae((s,o)=>e(r,s,i,o))(is(t(r,i))),n):("number"==typeof e&&(n=e),Oe((r,i)=>function jse(t,e,n,r,i,s,o,a){const u=[];let c=0,h=0,g=!1;const _=()=>{g&&!u.length&&!c&&e.complete()},v=b=>c<r?w(b):u.push(b),w=b=>{s&&e.next(b),c++;let D=!1;is(n(b,h++)).subscribe(Be(e,F=>{i?.(F),s?v(F):e.next(F)},()=>{D=!0},void 0,()=>{if(D)try{for(c--;u.length&&c<r;){const F=u.shift();o?nu(e,o,()=>w(F)):w(F)}_()}catch(F){e.error(F)}}))};return t.subscribe(Be(e,v,()=>{g=!0,_()})),()=>{a?.()}}(r,i,t,n)))}function Pf(t=1/0){return yi(Or,t)}globalThis.\u0275AngularfireInstanceCache||=[],ot(254);const bo=new nn(t=>t.complete());function fR(...t){const e=g_(t),n=function yie(t,e){return"number"==typeof $0(t)?t.pop():e}(t,1/0),r=t;return r.length?1===r.length?is(r[0]):Pf(n)(en(r,e)):bo}function On(t,e){return Oe((n,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();n.subscribe(Be(r,u=>{i?.unsubscribe();let c=0;const h=s++;is(t(u,h)).subscribe(i=Be(r,g=>r.next(e?e(u,g,h,c++):g),()=>{i=null,a()}))},()=>{o=!0,a()}))})}class Hse extends L{constructor(e=1/0,n=1/0,r=hR){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){const{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){const{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){const o=n.now();let a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}}function S$(t={}){const{connector:e=(()=>new L),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,c=0,h=!1,g=!1;const _=()=>{a?.unsubscribe(),a=void 0},v=()=>{_(),o=u=void 0,h=g=!1},w=()=>{const b=o;v(),b?.unsubscribe()};return Oe((b,D)=>{c++,!g&&!h&&_();const F=u=u??e();D.add(()=>{c--,0===c&&!g&&!h&&(a=pR(w,i))}),F.subscribe(D),!o&&c>0&&(o=new Ar({next:x=>F.next(x),error:x=>{g=!0,_(),a=pR(v,n,x),F.error(x)},complete:()=>{h=!0,_(),a=pR(v,r),F.complete()}}),is(b).subscribe(o))})(s)}}function pR(t,e,...n){if(!0===e)return void t();if(!1===e)return;const r=new Ar({next:()=>{r.unsubscribe(),t()}});return is(e(...n)).subscribe(r)}function R$(t,e,n){let r,i=!1;return t&&"object"==typeof t?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t):r=t??1/0,S$({connector:()=>new Hse(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}const qw=$n(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Do(t,e){return Oe((n,r)=>{let i=0;n.subscribe(Be(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Mf(t){return t<=0?()=>bo:Oe((e,n)=>{let r=0;e.subscribe(Be(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function zw(t){return Oe((e,n)=>{let r=!1;e.subscribe(Be(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function N$(t=Gse){return Oe((e,n)=>{let r=!1;e.subscribe(Be(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function Gse(){return new qw}function fc(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Do((i,s)=>t(i,s,r)):Or,Mf(1),n?zw(e):N$(()=>new qw))}function P$(t,e){return ze(e)?On(()=>t,e):On(()=>t)}const gR=new ve("angularfire2.auth.use-emulator"),mR=new ve("angularfire2.auth.settings"),_R=new ve("angularfire2.auth.tenant-id"),yR=new ve("angularfire2.auth.langugage-code"),vR=new ve("angularfire2.auth.use-device-language"),ER=new ve("angularfire.auth.persistence"),IR=(t,e,n,r,i,s,o,a)=>Gw(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{const u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(const[c,h]of Object.entries(o))u.settings[c]=h;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]);let pc=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,c,h,g,_,v){const w=new L,b=We(void 0).pipe(cc(o.outsideAngular),On(()=>s.runOutsideAngular(()=>Promise.resolve().then(ot.bind(ot,254)))),Ae(()=>A_(n,s,r)),Ae(D=>IR(D,s,a,c,h,g,u,_)),R$({bufferSize:1,refCount:!1}));if(vw(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=We(null);else{b.pipe(fc()).subscribe();const D=b.pipe(On($=>$.getRedirectResult().then(ie=>ie,()=>null)),lr,R$({bufferSize:1,refCount:!1})),F=b.pipe(On($=>new nn(ie=>({unsubscribe:s.runOutsideAngular(()=>$.onAuthStateChanged(Ie=>ie.next(Ie),Ie=>ie.error(Ie),()=>ie.complete()))})))),x=b.pipe(On($=>new nn(ie=>({unsubscribe:s.runOutsideAngular(()=>$.onIdTokenChanged(Ie=>ie.next(Ie),Ie=>ie.error(Ie),()=>ie.complete()))}))));this.authState=D.pipe(P$(F),wf(o.outsideAngular),cc(o.insideAngular)),this.user=D.pipe(P$(x),wf(o.outsideAngular),cc(o.insideAngular)),this.idToken=this.user.pipe(On($=>$?en($.getIdToken()):We(null))),this.idTokenResult=this.user.pipe(On($=>$?en($.getIdTokenResult()):We(null))),this.credential=fR(D,w,this.authState.pipe(Do($=>!$))).pipe(Ae($=>$?.user?$:null),wf(o.outsideAngular),cc(o.insideAngular))}return((t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(xse.indexOf(s)>-1)return()=>{};const o=e.toPromise().then(a=>{const u=a?.[s];return"function"==typeof u?u.bind(a):u?.then?u.then(c=>n.run(()=>c)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,c)=>o.then(h=>{const g=h?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,g),g})})})}))(this,b,s,{spy:{apply:(D,F,x)=>{(D.startsWith("signIn")||D.startsWith("createUser"))&&x.then($=>w.next($))}}})}static \u0275fac=function(r){return new(r||t)(ce(Rf),ce(Nf,8),ce(Ys),ce(At),ce(Hw),ce(gR,8),ce(mR,8),ce(_R,8),ce(yR,8),ce(vR,8),ce(ER,8),ce($w,8))};static \u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),zse=(()=>{class t{constructor(){_i.A.registerVersion("angularfire",bf.full,"auth-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Fr({type:t});static \u0275inj=pr({providers:[pc]})}return t})();var ne=ot(467),A=ot(76),So=ot(362);const M$="firebasestorage.googleapis.com",x$="storageBucket";class Wn extends A.g{constructor(e,n,r=0){super(wR(e),`Firebase Storage: ${n} (${wR(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Wn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return wR(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Ln=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Ln||{});function wR(t){return"storage/"+t}function TR(){return new Wn(Ln.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function k$(){return new Wn(Ln.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function O$(){return new Wn(Ln.CANCELED,"User canceled the upload/download.")}function L$(){return new Wn(Ln.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function xf(t){return new Wn(Ln.INVALID_ARGUMENT,t)}function F$(){return new Wn(Ln.APP_DELETED,"The Firebase app was deleted.")}function V$(t){return new Wn(Ln.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function b_(t,e){return new Wn(Ln.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function D_(t){throw new Wn(Ln.INTERNAL_ERROR,"Internal error: "+t)}class vi{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=vi.makeFromUrl(e,n)}catch{return new vi(e,"")}if(""===r.path)return r;throw function roe(t){return new Wn(Ln.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)",a=new RegExp("^gs://"+i+"(/(.*))?$","i");function c(ie){ie.path_=decodeURIComponent(ie.path)}const g=n.replace(/[.]/g,"\\."),$=[{regex:a,indices:{bucket:1,path:3},postModify:function s(ie){"/"===ie.path.charAt(ie.path.length-1)&&(ie.path_=ie.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${g}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:c},{regex:new RegExp(`^https?://${n===M$?"(?:storage.googleapis.com|storage.cloud.google.com)":n}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:c}];for(let ie=0;ie<$.length;ie++){const Ie=$[ie],Pe=Ie.regex.exec(e);if(Pe){let R=Pe[Ie.indices.path];R||(R=""),r=new vi(Pe[Ie.indices.bucket],R),Ie.postModify(r);break}}if(null==r)throw function noe(t){return new Wn(Ln.INVALID_URL,"Invalid URL '"+t+"'.")}(e);return r}}class uoe{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Ww(t){return"string"==typeof t||t instanceof String}function U$(t){return CR()&&t instanceof Blob}function CR(){return typeof Blob<"u"}function AR(t,e,n,r){if(r<e)throw xf(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw xf(`Invalid value for '${t}'. Expected ${n} or less.`)}function ru(t,e,n){let r=e;return null==n&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function B$(t){const e=encodeURIComponent;let n="?";for(const r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n=n.slice(0,-1),n}var kf=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(kf||{});function j$(t,e){const n=t>=500&&t<600,i=-1!==[408,429].indexOf(t),s=-1!==e.indexOf(t);return n||i||s}class poe{constructor(e,n,r,i,s,o,a,u,c,h,g,_=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=g,this.retry=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,w)=>{this.resolve_=v,this.reject_=w,this.start_()})}start_(){const n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());!function doe(t){return void 0!==t}(u)?s():s(u)}catch(u){o(u)}else if(null!==a){const u=TR();u.serverResponse=a.getErrorText(),o(this.errorCallback_?this.errorCallback_(a,u):u)}else o(i.canceled?this.appDelete_?F$():O$():k$())};this.canceled_?n(0,new Kw(!1,null,!0)):this.backoffId_=function coe(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function u(){return 2===a}let c=!1;function h(...D){c||(c=!0,e.apply(null,D))}function g(D){i=setTimeout(()=>{i=null,t(v,u())},D)}function _(){s&&clearTimeout(s)}function v(D,...F){if(c)return void _();if(D)return _(),void h.call(null,D,...F);if(u()||o)return _(),void h.call(null,D,...F);let $;r<64&&(r*=2),1===a?(a=2,$=0):$=1e3*(r+Math.random()),g($)}let w=!1;function b(D){w||(w=!0,_(),!c&&(null!==i?(D||(a=2),clearTimeout(i),g(0)):D||(a=1)))}return g(0),s=setTimeout(()=>{o=!0,b(!0)},n),b}((r,i)=>{if(i)return void r(!1,new Kw(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{null!==this.progressCallback_&&this.progressCallback_(a.loaded,a.lengthComputable?a.total:-1)};null!==this.progressCallback_&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===kf.NO_ERROR,u=s.getStatus();if(!a||j$(u,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===kf.ABORT;return void r(!1,new Kw(!1,null,h))}const c=-1!==this.successCodes_.indexOf(u);r(!0,new Kw(c,s))})},n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function loe(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class Kw{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Ioe(...t){const e=function Eoe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}if(CR())return new Blob(t);throw new Wn(Ln.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const bs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class bR{constructor(e,n){this.data=e,this.contentType=n||null}}function DR(t,e){switch(t){case bs.RAW:return new bR($$(e));case bs.BASE64:case bs.BASE64URL:return new bR(H$(t,e));case bs.DATA_URL:return new bR(function Aoe(t){const e=new G$(t);return e.base64?H$(bs.BASE64,e.rest):function Coe(t){let e;try{e=decodeURIComponent(t)}catch{throw b_(bs.DATA_URL,"Malformed data URL.")}return $$(e)}(e.rest)}(e),function boe(t){return new G$(t).contentType}(e))}throw TR()}function $$(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function H$(t,e){switch(t){case bs.BASE64:{const i=-1!==e.indexOf("-"),s=-1!==e.indexOf("_");if(i||s)throw b_(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case bs.BASE64URL:{const i=-1!==e.indexOf("+"),s=-1!==e.indexOf("/");if(i||s)throw b_(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=function Toe(t){if(typeof atob>"u")throw function aoe(t){return new Wn(Ln.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(t)}(e)}catch(i){throw i.message.includes("polyfill")?i:b_(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class G${constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(null===n)throw b_(bs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;null!=r&&(this.base64=function Doe(t,e){return t.length>=e.length&&t.substring(t.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class oa{constructor(e,n){let r=0,i="";U$(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(U$(this.data_)){const i=function woe(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===i?null:new oa(i)}{const r=new Uint8Array(this.data_.buffer,e,n-e);return new oa(r,!0)}}static getBlob(...e){if(CR()){const n=e.map(r=>r instanceof oa?r.data_:r);return new oa(Ioe.apply(null,n))}{const n=e.map(o=>Ww(o)?DR(bs.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new oa(i,!0)}}uploadData(){return this.data_}}function SR(t){let e;try{e=JSON.parse(t)}catch{return null}return function foe(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}function q$(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Noe(t,e){return e}class Ui{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||Noe}}let Qw=null;function S_(){if(Qw)return Qw;const t=[];t.push(new Ui("bucket")),t.push(new Ui("generation")),t.push(new Ui("metageneration")),t.push(new Ui("name","fullPath",!0));const n=new Ui("name");n.xform=function e(s,o){return function Poe(t){return!Ww(t)||t.length<2?t:q$(t)}(o)},t.push(n);const i=new Ui("size");return i.xform=function r(s,o){return void 0!==o?Number(o):o},t.push(i),t.push(new Ui("timeCreated")),t.push(new Ui("updated")),t.push(new Ui("md5Hash",null,!0)),t.push(new Ui("cacheControl",null,!0)),t.push(new Ui("contentDisposition",null,!0)),t.push(new Ui("contentEncoding",null,!0)),t.push(new Ui("contentLanguage",null,!0)),t.push(new Ui("contentType",null,!0)),t.push(new Ui("metadata","customMetadata",!0)),Qw=t,Qw}function z$(t,e,n){const r=SR(e);return null===r?null:function xoe(t,e,n){const r={type:"file"},i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return function Moe(t,e){Object.defineProperty(t,"ref",{get:function n(){const s=new vi(t.bucket,t.fullPath);return e._makeStorageReference(s)}})}(r,t),r}(t,r,n)}function RR(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}const W$="prefixes",K$="items";class aa{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function ua(t){if(!t)throw TR()}function Yw(t,e){return function n(r,i){const s=z$(t,i,e);return ua(null!==s),s}}function Of(t){return function e(n,r){let i;return i=401===n.getStatus()?n.getErrorText().includes("Firebase App Check token is invalid")?function eoe(){return new Wn(Ln.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function Xse(){return new Wn(Ln.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===n.getStatus()?function Jse(t){return new Wn(Ln.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(t.bucket):403===n.getStatus()?function toe(t){return new Wn(Ln.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}(t.path):r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}}function R_(t){const e=Of(t);return function n(r,i){let s=e(r,i);return 404===r.getStatus()&&(s=function Zse(t){return new Wn(Ln.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}(t.path)),s.serverResponse=i.serverResponse,s}}function Q$(t,e,n){const i=ru(e.fullServerUrl(),t.host,t._protocol),o=t.maxOperationRetryTime,a=new aa(i,"GET",Yw(t,n),o);return a.errorHandler=R_(e),a}function Uoe(t,e,n,r,i){const s={};s.prefix=e.isRoot?"":e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const a=ru(e.bucketOnlyServerUrl(),t.host,t._protocol),c=t.maxOperationRetryTime,h=new aa(a,"GET",function Foe(t,e){return function n(r,i){const s=function Loe(t,e,n){const r=SR(n);return null===r?null:function Ooe(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[W$])for(const i of n[W$]){const s=i.replace(/\/$/,""),o=t._makeStorageReference(new vi(e,s));r.prefixes.push(o)}if(n[K$])for(const i of n[K$]){const s=t._makeStorageReference(new vi(e,i.name));r.items.push(s)}return r}(t,e,r)}(t,e,i);return ua(null!==s),s}}(t,e.bucket),c);return h.urlParams=s,h.errorHandler=Of(e),h}function Z$(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function Hoe(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class Zw{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}}function NR(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{ua(!1)}return ua(!!n&&-1!==(e||["active"]).indexOf(n)),n}const Woe={STATE_CHANGED:"state_changed"},Bi={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function PR(t){switch(t){case"running":case"pausing":case"canceling":return Bi.RUNNING;case"paused":return Bi.PAUSED;case"success":return Bi.SUCCESS;case"canceled":return Bi.CANCELED;default:return Bi.ERROR}}class Koe{constructor(e,n,r){if(function hoe(t){return"function"==typeof t}(e)||null!=n||null!=r)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}}function Lf(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}let eH=null;class Qoe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=kf.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=kf.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=kf.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw D_("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),void 0!==i)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw D_("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw D_("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw D_("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw D_("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Yoe extends Qoe{initXhr(){this.xhr_.responseType="text"}}function Ro(){return eH?eH():new Yoe}class tH{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=S_(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Ln.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const s=this.isExponentialBackoffExpired();if(j$(i.status,[])){if(!s)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=k$()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Ln.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,n)=>{const r=function Goe(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o=Z$(e,r,i),a={name:o.fullPath},u=ru(s,t.host,t._protocol),h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},g=RR(o,n),w=new aa(u,"POST",function v(b){let D;NR(b);try{D=b.getResponseHeader("X-Goog-Upload-URL")}catch{ua(!1)}return ua(Ww(D)),D},t.maxUploadRetryTime);return w.urlParams=a,w.headers=h,w.body=g,w.errorHandler=Of(e),w}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ro,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const i=function qoe(t,e,n,r){const u=new aa(n,"POST",function s(c){const h=NR(c,["active","final"]);let g=null;try{g=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{ua(!1)}g||ua(!1);const _=Number(g);return ua(!isNaN(_)),new Zw(_,r.size(),"final"===h)},t.maxUploadRetryTime);return u.headers={"X-Goog-Upload-Command":"query"},u.errorHandler=Of(e),u}(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Ro,n,r);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,n=new Zw(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=function zoe(t,e,n,r,i,s,o,a){const u=new Zw(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw function soe(){return new Wn(Ln.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const c=u.total-u.current;let h=c;i>0&&(h=Math.min(h,i));const g=u.current;let v="";v=0===h?"finalize":c===h?"upload, finalize":"upload";const w={"X-Goog-Upload-Command":v,"X-Goog-Upload-Offset":`${u.current}`},b=r.slice(g,g+h);if(null===b)throw L$();const $=new aa(n,"POST",function D(ie,Ie){const Pe=NR(ie,["active","final"]),V=u.current+h,R=r.size();let k;return k="final"===Pe?Yw(e,s)(ie,Ie):null,new Zw(V,R,"final"===Pe,k)},e.maxUploadRetryTime);return $.headers=w,$.body=b.uploadData(),$.progressCallback=a||null,$.errorHandler=Of(t),$}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(u){return this._error=u,void this._transition("error")}const a=this._ref.storage._makeRequest(o,Ro,i,s,!1);this._request=a,a.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=Q$(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Ro,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=function J$(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},u=function a(){let $="";for(let ie=0;ie<2;ie++)$+=Math.random().toString().slice(2);return $}();o["Content-Type"]="multipart/related; boundary="+u;const c=Z$(e,r,i),h=RR(c,n),v=oa.getBlob("--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+h+"\r\n--"+u+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",r,"\r\n--"+u+"--");if(null===v)throw L$();const w={name:c.fullPath},b=ru(s,t.host,t._protocol),F=t.maxUploadRetryTime,x=new aa(b,"POST",Yw(t,n),F);return x.urlParams=w,x.headers=o,x.body=v.uploadData(),x.errorHandler=Of(e),x}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ro,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n="paused"===this._state;this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=O$(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=PR(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){const s=new Koe(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);-1!==n&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(PR(this._state)){case Bi.SUCCESS:Lf(this._resolve.bind(null,this.snapshot))();break;case Bi.CANCELED:case Bi.ERROR:Lf(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(PR(this._state)){case Bi.RUNNING:case Bi.PAUSED:e.next&&Lf(e.next.bind(e,this.snapshot))();break;case Bi.SUCCESS:e.complete&&Lf(e.complete.bind(e))();break;default:e.error&&Lf(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class Jl{constructor(e,n){this._service=e,this._location=n instanceof vi?n:vi.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Jl(e,n)}get root(){const e=new vi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return q$(this._location.path)}get storage(){return this._service}get parent(){const e=function Soe(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;const n=new vi(this._location.bucket,e);return new Jl(this._service,n)}_throwIfRoot(e){if(""===this._location.path)throw V$(e)}}function rH(t,e,n){return MR.apply(this,arguments)}function MR(){return(MR=(0,ne.A)(function*(t,e,n){const i=yield iH(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield rH(t,e,i.nextPageToken))})).apply(this,arguments)}function iH(t,e){null!=e&&"number"==typeof e.maxResults&&AR("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=Uoe(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,Ro)}function uae(t){t._throwIfRoot("getDownloadURL");const e=function Boe(t,e,n){const i=ru(e.fullServerUrl(),t.host,t._protocol),o=t.maxOperationRetryTime,a=new aa(i,"GET",function Voe(t,e){return function n(r,i){const s=z$(t,i,e);return ua(null!==s),function koe(t,e,n,r){const i=SR(e);if(null===i||!Ww(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map(c=>{const g=t.fullPath;return ru("/b/"+o(t.bucket)+"/o/"+o(g),n,r)+B$({alt:"media",token:c})})[0]}(s,i,t.host,t._protocol)}}(t,n),o);return a.errorHandler=R_(e),a}(t.storage,t._location,S_());return t.storage.makeRequestWithTokens(e,Ro).then(n=>{if(null===n)throw function ooe(){return new Wn(Ln.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return n})}function sH(t,e){const n=function Roe(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new vi(t._location.bucket,n);return new Jl(t.storage,r)}function oH(t,e){if(t instanceof xR){const n=t;if(null==n._bucket)throw function ioe(){return new Wn(Ln.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+x$+"' property when initializing the app?")}();const r=new Jl(n,n._bucket);return null!=e?oH(r,e):r}return void 0!==e?sH(t,e):t}function hae(t,e){if(e&&function lae(t){return/^[A-Za-z]+:\/\//.test(t)}(e)){if(t instanceof xR)return function dae(t,e){return new Jl(t,e)}(t,e);throw xf("To use ref(service, url), the first argument must be a Storage instance.")}return oH(t,e)}function aH(t,e){const n=e?.[x$];return null==n?null:vi.makeFromBucketSpec(n,t)}class xR{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=M$,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?vi.makeFromBucketSpec(i,this._host):aH(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?vi.makeFromBucketSpec(this._url,e):aH(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){AR("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){AR("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,ne.A)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const n=e._authProvider.getImmediate({optional:!0});if(n){const r=yield n.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,ne.A)(function*(){const n=e._appCheckProvider.getImmediate({optional:!0});return n?(yield n.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Jl(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new uoe(F$());{const o=function voe(t,e,n,r,i,s,o=!0){const a=B$(t.urlParams),u=t.url+a,c=Object.assign({},t.headers);return function _oe(t,e){e&&(t["X-Firebase-GMPID"]=e)}(c,e),function goe(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(c,n),function moe(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(c,s),function yoe(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(c,r),new poe(u,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){var r=this;return(0,ne.A)(function*(){const[i,s]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,n,i,s).getPromise()})()}}const uH="@firebase/storage";function dH(t,e){return hae(t=(0,A.Ku)(t),e)}function wae(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new xR(n,r,i,e,ss.SDK_VERSION)}!function Tae(){(0,ss._registerComponent)(new So.uA("storage",wae,"PUBLIC").setMultipleInstances(!0)),(0,ss.registerVersion)(uH,"0.12.6",""),(0,ss.registerVersion)(uH,"0.12.6","esm2017")}();class Jw{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class fH{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Jw(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new Jw(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(s="function"==typeof n?o=>n(new Jw(o,this,this._ref)):{next:n.next?o=>n.next(new Jw(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}}class pH{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new iu(e,this._service))}get items(){return this._delegate.items.map(e=>new iu(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class iu{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=function Iae(t,e){return sH(t,e)}(this._delegate,e);return new iu(n,this.storage)}get root(){return new iu(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new iu(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new fH(function pae(t,e,n){return function rae(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new tH(t,new oa(e),n)}(t=(0,A.Ku)(t),e,n)}(this._delegate,e,n),this)}putString(e,n=bs.RAW,r){this._throwIfRoot("putString");const i=DR(n,e),s=Object.assign({},r);return null==s.contentType&&null!=i.contentType&&(s.contentType=i.contentType),new fH(new tH(this._delegate,new oa(i.data,!0),s),this)}listAll(){return function yae(t){return function sae(t){const e={prefixes:[],items:[]};return rH(t,e).then(()=>e)}(t=(0,A.Ku)(t))}(this._delegate).then(e=>new pH(e,this.storage))}list(e){return function _ae(t,e){return iH(t=(0,A.Ku)(t),e)}(this._delegate,e||void 0).then(n=>new pH(n,this.storage))}getMetadata(){return function gae(t){return function oae(t){t._throwIfRoot("getMetadata");const e=Q$(t.storage,t._location,S_());return t.storage.makeRequestWithTokens(e,Ro)}(t=(0,A.Ku)(t))}(this._delegate)}updateMetadata(e){return function mae(t,e){return function aae(t,e){t._throwIfRoot("updateMetadata");const n=function joe(t,e,n,r){const s=ru(e.fullServerUrl(),t.host,t._protocol),a=RR(n,r),c=t.maxOperationRetryTime,h=new aa(s,"PATCH",Yw(t,r),c);return h.headers={"Content-Type":"application/json; charset=utf-8"},h.body=a,h.errorHandler=R_(e),h}(t.storage,t._location,e,S_());return t.storage.makeRequestWithTokens(n,Ro)}(t=(0,A.Ku)(t),e)}(this._delegate,e)}getDownloadURL(){return function vae(t){return uae(t=(0,A.Ku)(t))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function Eae(t){return function cae(t){t._throwIfRoot("deleteObject");const e=function $oe(t,e){const r=ru(e.fullServerUrl(),t.host,t._protocol),a=new aa(r,"DELETE",function o(u,c){},t.maxOperationRetryTime);return a.successCodes=[200,204],a.errorHandler=R_(e),a}(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Ro)}(t=(0,A.Ku)(t))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw V$(e)}}class gH{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(mH(e))throw xf("ref() expected a child path but got a URL, use refFromURL instead.");return new iu(dH(this._delegate,e),this)}refFromURL(e){if(!mH(e))throw xf("refFromURL() expected a full URL but got a child path, use ref() instead.");try{vi.makeFromUrl(e,this._delegate.host)}catch{throw xf("refFromUrl() expected a valid full URL but got an invalid one.")}return new iu(dH(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){!function hH(t,e,n,r={}){!function fae(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken="string"==typeof i?i:(0,A.Fy)(i,t.app.options.projectId))}(t,e,n,r)}(this._delegate,e,n,r)}}function mH(t){return/^[A-Za-z]+:\/\//.test(t)}function Dae(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new gH(n,r)}function _H(t){const e=function Rae(t){return new nn(e=>{const n=o=>e.next(o);n(t.snapshot);const s=t.on("state_changed",n);return t.then(o=>{n(o),e.complete()},o=>{n(t.snapshot),(o=>{e.error(o)})(o)}),function(){s()}}).pipe(function Wse(t,e=jw){return Oe((n,r)=>{let i=null,s=null,o=null;const a=()=>{if(i){i.unsubscribe(),i=null;const c=s;s=null,r.next(c)}};function u(){const c=o+t,h=e.now();if(h<c)return i=this.schedule(void 0,c-h),void r.add(i);a()}n.subscribe(Be(r,c=>{s=c,o=e.now(),i||(i=e.schedule(u,t),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}(0))}(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(Ae(n=>n.bytesTransferred/n.totalBytes*100))}}function Xw(t){return{getDownloadURL:()=>We(void 0).pipe(A$,On(()=>t.getDownloadURL()),lr),getMetadata:()=>We(void 0).pipe(A$,On(()=>t.getMetadata()),lr),delete:()=>en(t.delete()),child:e=>Xw(t.child(e)),updateMetadata:e=>en(t.updateMetadata(e)),put:(e,n)=>_H(t.put(e,n)),putString:(e,n,r)=>_H(t.putString(e,n,r)),list:e=>en(t.list(e)),listAll:()=>en(t.listAll())}}!function Sae(t){const e={TaskState:Bi,TaskEvent:Woe,StringFormat:bs,Storage:gH,Reference:iu};t.INTERNAL.registerComponent(new So.uA("storage-compat",Dae,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage-compat","0.3.9")}(_i.A);const Nae=new ve("angularfire2.storageBucket"),Pae=new ve("angularfire2.storage.maxUploadRetryTime"),Mae=new ve("angularfire2.storage.maxOperationRetryTime"),xae=new ve("angularfire2.storage.use-emulator");let kae=(()=>{class t{storage;constructor(n,r,i,s,o,a,u,c,h,g){const _=A_(n,o,r);this.storage=Gw(`${_.name}.storage.${i}`,"AngularFireStorage",_.name,()=>{const v=o.runOutsideAngular(()=>_.storage(i||void 0)),w=h;return w&&v.useEmulator(...w),u&&v.setMaxUploadRetryTime(u),c&&v.setMaxOperationRetryTime(c),v},[u,c])}ref(n){return Xw(this.storage.ref(n))}refFromURL(n){return Xw(this.storage.refFromURL(n))}upload(n,r,i){return Xw(this.storage.ref(n)).put(r,i)}static \u0275fac=function(r){return new(r||t)(ce(Rf),ce(Nf,8),ce(Nae,8),ce(Ys),ce(At),ce(Hw),ce(Pae,8),ce(Mae,8),ce(xae,8),ce($w,8))};static \u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),Oae=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Fr({type:t});static \u0275inj=pr({})}return t})(),Lae=(()=>{class t{constructor(){_i.A.registerVersion("angularfire",bf.full,"gcs-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Fr({type:t});static \u0275inj=pr({providers:[kae],imports:[Oae]})}return t})();function kR(...t){return function Fae(){return Pf(1)}()(en(t,g_(t)))}function eT(...t){const e=g_(t);return Oe((n,r)=>{(e?kR(t,n,e):kR(t,n)).subscribe(r)})}function OR(){return Oe((t,e)=>{let n,r=!1;t.subscribe(Be(e,i=>{const s=n;n=i,r&&e.next([s,i]),r=!0}))})}function Ff(t,e){return Oe(function Vae(t,e,n,r,i){return(s,o)=>{let a=n,u=e,c=0;s.subscribe(Be(o,h=>{const g=c++;u=a?t(u,h,g):(a=!0,h),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}(t,e,arguments.length>=2,!0))}function yH(t,e=Or){return t=t??Uae,Oe((n,r)=>{let i,s=!0;n.subscribe(Be(r,o=>{const a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function Uae(t,e){return t===e}var Xl,IH,Ds=ot(41),vH=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},EH={};(function(){var t;function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function i(V,R,k){k||(k=0);var U=Array(16);if("string"==typeof R)for(var H=0;16>H;++H)U[H]=R.charCodeAt(k++)|R.charCodeAt(k++)<<8|R.charCodeAt(k++)<<16|R.charCodeAt(k++)<<24;else for(H=0;16>H;++H)U[H]=R[k++]|R[k++]<<8|R[k++]<<16|R[k++]<<24;var W=V.g[3],O=(R=V.g[0])+(W^(k=V.g[1])&((H=V.g[2])^W))+U[0]+3614090360&4294967295;O=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=(k=(H=(W=(R=k+(O<<7&4294967295|O>>>25))+((O=W+(H^R&(k^H))+U[1]+3905402710&4294967295)<<12&4294967295|O>>>20))+((O=H+(k^W&(R^k))+U[2]+606105819&4294967295)<<17&4294967295|O>>>15))+((O=k+(R^H&(W^R))+U[3]+3250441966&4294967295)<<22&4294967295|O>>>10))+((O=R+(W^k&(H^W))+U[4]+4118548399&4294967295)<<7&4294967295|O>>>25))+((O=W+(H^R&(k^H))+U[5]+1200080426&4294967295)<<12&4294967295|O>>>20))+((O=H+(k^W&(R^k))+U[6]+2821735955&4294967295)<<17&4294967295|O>>>15))+((O=k+(R^H&(W^R))+U[7]+4249261313&4294967295)<<22&4294967295|O>>>10))+((O=R+(W^k&(H^W))+U[8]+1770035416&4294967295)<<7&4294967295|O>>>25))+((O=W+(H^R&(k^H))+U[9]+2336552879&4294967295)<<12&4294967295|O>>>20))+((O=H+(k^W&(R^k))+U[10]+4294925233&4294967295)<<17&4294967295|O>>>15))+((O=k+(R^H&(W^R))+U[11]+2304563134&4294967295)<<22&4294967295|O>>>10))+((O=R+(W^k&(H^W))+U[12]+1804603682&4294967295)<<7&4294967295|O>>>25))+((O=W+(H^R&(k^H))+U[13]+4254626195&4294967295)<<12&4294967295|O>>>20))+((O=H+(k^W&(R^k))+U[14]+2792965006&4294967295)<<17&4294967295|O>>>15))+((O=k+(R^H&(W^R))+U[15]+1236535329&4294967295)<<22&4294967295|O>>>10))+((O=R+(H^W&(k^H))+U[1]+4129170786&4294967295)<<5&4294967295|O>>>27))+((O=W+(k^H&(R^k))+U[6]+3225465664&4294967295)<<9&4294967295|O>>>23))+((O=H+(R^k&(W^R))+U[11]+643717713&4294967295)<<14&4294967295|O>>>18))+((O=k+(W^R&(H^W))+U[0]+3921069994&4294967295)<<20&4294967295|O>>>12))+((O=R+(H^W&(k^H))+U[5]+3593408605&4294967295)<<5&4294967295|O>>>27))+((O=W+(k^H&(R^k))+U[10]+38016083&4294967295)<<9&4294967295|O>>>23))+((O=H+(R^k&(W^R))+U[15]+3634488961&4294967295)<<14&4294967295|O>>>18))+((O=k+(W^R&(H^W))+U[4]+3889429448&4294967295)<<20&4294967295|O>>>12))+((O=R+(H^W&(k^H))+U[9]+568446438&4294967295)<<5&4294967295|O>>>27))+((O=W+(k^H&(R^k))+U[14]+3275163606&4294967295)<<9&4294967295|O>>>23))+((O=H+(R^k&(W^R))+U[3]+4107603335&4294967295)<<14&4294967295|O>>>18))+((O=k+(W^R&(H^W))+U[8]+1163531501&4294967295)<<20&4294967295|O>>>12))+((O=R+(H^W&(k^H))+U[13]+2850285829&4294967295)<<5&4294967295|O>>>27))+((O=W+(k^H&(R^k))+U[2]+4243563512&4294967295)<<9&4294967295|O>>>23))+((O=H+(R^k&(W^R))+U[7]+1735328473&4294967295)<<14&4294967295|O>>>18))+((O=k+(W^R&(H^W))+U[12]+2368359562&4294967295)<<20&4294967295|O>>>12))+((O=R+(k^H^W)+U[5]+4294588738&4294967295)<<4&4294967295|O>>>28))+((O=W+(R^k^H)+U[8]+2272392833&4294967295)<<11&4294967295|O>>>21))+((O=H+(W^R^k)+U[11]+1839030562&4294967295)<<16&4294967295|O>>>16))+((O=k+(H^W^R)+U[14]+4259657740&4294967295)<<23&4294967295|O>>>9))+((O=R+(k^H^W)+U[1]+2763975236&4294967295)<<4&4294967295|O>>>28))+((O=W+(R^k^H)+U[4]+1272893353&4294967295)<<11&4294967295|O>>>21))+((O=H+(W^R^k)+U[7]+4139469664&4294967295)<<16&4294967295|O>>>16))+((O=k+(H^W^R)+U[10]+3200236656&4294967295)<<23&4294967295|O>>>9))+((O=R+(k^H^W)+U[13]+681279174&4294967295)<<4&4294967295|O>>>28))+((O=W+(R^k^H)+U[0]+3936430074&4294967295)<<11&4294967295|O>>>21))+((O=H+(W^R^k)+U[3]+3572445317&4294967295)<<16&4294967295|O>>>16))+((O=k+(H^W^R)+U[6]+76029189&4294967295)<<23&4294967295|O>>>9))+((O=R+(k^H^W)+U[9]+3654602809&4294967295)<<4&4294967295|O>>>28))+((O=W+(R^k^H)+U[12]+3873151461&4294967295)<<11&4294967295|O>>>21))+((O=H+(W^R^k)+U[15]+530742520&4294967295)<<16&4294967295|O>>>16))+((O=k+(H^W^R)+U[2]+3299628645&4294967295)<<23&4294967295|O>>>9))+((O=R+(H^(k|~W))+U[0]+4096336452&4294967295)<<6&4294967295|O>>>26))+((O=W+(k^(R|~H))+U[7]+1126891415&4294967295)<<10&4294967295|O>>>22))+((O=H+(R^(W|~k))+U[14]+2878612391&4294967295)<<15&4294967295|O>>>17))+((O=k+(W^(H|~R))+U[5]+4237533241&4294967295)<<21&4294967295|O>>>11))+((O=R+(H^(k|~W))+U[12]+1700485571&4294967295)<<6&4294967295|O>>>26))+((O=W+(k^(R|~H))+U[3]+2399980690&4294967295)<<10&4294967295|O>>>22))+((O=H+(R^(W|~k))+U[10]+4293915773&4294967295)<<15&4294967295|O>>>17))+((O=k+(W^(H|~R))+U[1]+2240044497&4294967295)<<21&4294967295|O>>>11))+((O=R+(H^(k|~W))+U[8]+1873313359&4294967295)<<6&4294967295|O>>>26))+((O=W+(k^(R|~H))+U[15]+4264355552&4294967295)<<10&4294967295|O>>>22))+((O=H+(R^(W|~k))+U[6]+2734768916&4294967295)<<15&4294967295|O>>>17))+((O=k+(W^(H|~R))+U[13]+1309151649&4294967295)<<21&4294967295|O>>>11))+((W=(R=k+((O=R+(H^(k|~W))+U[4]+4149444226&4294967295)<<6&4294967295|O>>>26))+((O=W+(k^(R|~H))+U[11]+3174756917&4294967295)<<10&4294967295|O>>>22))^((H=W+((O=H+(R^(W|~k))+U[2]+718787259&4294967295)<<15&4294967295|O>>>17))|~R))+U[9]+3951481745&4294967295,V.g[0]=V.g[0]+R&4294967295,V.g[1]=V.g[1]+(H+(O<<21&4294967295|O>>>11))&4294967295,V.g[2]=V.g[2]+H&4294967295,V.g[3]=V.g[3]+W&4294967295}function o(V,R){this.h=R;for(var k=[],U=!0,H=V.length-1;0<=H;H--){var W=0|V[H];U&&W==R||(k[H]=W,U=!1)}this.g=k}(function e(V,R){function k(){}k.prototype=R.prototype,V.D=R.prototype,V.prototype=new k,V.prototype.constructor=V,V.C=function(U,H,W){for(var O=Array(arguments.length-2),vu=2;vu<arguments.length;vu++)O[vu-2]=arguments[vu];return R.prototype[H].apply(U,O)}})(r,function n(){this.blockSize=-1}),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},r.prototype.u=function(V,R){void 0===R&&(R=V.length);for(var k=R-this.blockSize,U=this.B,H=this.h,W=0;W<R;){if(0==H)for(;W<=k;)i(this,V,W),W+=this.blockSize;if("string"==typeof V){for(;W<R;)if(U[H++]=V.charCodeAt(W++),H==this.blockSize){i(this,U),H=0;break}}else for(;W<R;)if(U[H++]=V[W++],H==this.blockSize){i(this,U),H=0;break}}this.h=H,this.o+=R},r.prototype.v=function(){var V=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);V[0]=128;for(var R=1;R<V.length-8;++R)V[R]=0;var k=8*this.o;for(R=V.length-8;R<V.length;++R)V[R]=255&k,k/=256;for(this.u(V),V=Array(16),R=k=0;4>R;++R)for(var U=0;32>U;U+=8)V[k++]=this.g[R]>>>U&255;return V};var a={};function u(V){return-128<=V&&128>V?function s(V,R){var k=a;return Object.prototype.hasOwnProperty.call(k,V)?k[V]:k[V]=R(V)}(V,function(R){return new o([0|R],0>R?-1:0)}):new o([0|V],0>V?-1:0)}function c(V){if(isNaN(V)||!isFinite(V))return g;if(0>V)return D(c(-V));for(var R=[],k=1,U=0;V>=k;U++)R[U]=V/k|0,k*=4294967296;return new o(R,0)}var g=u(0),_=u(1),v=u(16777216);function w(V){if(0!=V.h)return!1;for(var R=0;R<V.g.length;R++)if(0!=V.g[R])return!1;return!0}function b(V){return-1==V.h}function D(V){for(var R=V.g.length,k=[],U=0;U<R;U++)k[U]=~V.g[U];return new o(k,~V.h).add(_)}function F(V,R){return V.add(D(R))}function x(V,R){for(;(65535&V[R])!=V[R];)V[R+1]+=V[R]>>>16,V[R]&=65535,R++}function $(V,R){this.g=V,this.h=R}function ie(V,R){if(w(R))throw Error("division by zero");if(w(V))return new $(g,g);if(b(V))return R=ie(D(V),R),new $(D(R.g),D(R.h));if(b(R))return R=ie(V,D(R)),new $(D(R.g),R.h);if(30<V.g.length){if(b(V)||b(R))throw Error("slowDivide_ only works with positive integers.");for(var k=_,U=R;0>=U.l(V);)k=Ie(k),U=Ie(U);var H=Pe(k,1),W=Pe(U,1);for(U=Pe(U,2),k=Pe(k,2);!w(U);){var O=W.add(U);0>=O.l(V)&&(H=H.add(k),W=O),U=Pe(U,1),k=Pe(k,1)}return R=F(V,H.j(R)),new $(H,R)}for(H=g;0<=V.l(R);){for(k=Math.max(1,Math.floor(V.m()/R.m())),U=48>=(U=Math.ceil(Math.log(k)/Math.LN2))?1:Math.pow(2,U-48),O=(W=c(k)).j(R);b(O)||0<O.l(V);)O=(W=c(k-=U)).j(R);w(W)&&(W=_),H=H.add(W),V=F(V,O)}return new $(H,V)}function Ie(V){for(var R=V.g.length+1,k=[],U=0;U<R;U++)k[U]=V.i(U)<<1|V.i(U-1)>>>31;return new o(k,V.h)}function Pe(V,R){var k=R>>5;R%=32;for(var U=V.g.length-k,H=[],W=0;W<U;W++)H[W]=0<R?V.i(W+k)>>>R|V.i(W+k+1)<<32-R:V.i(W+k);return new o(H,V.h)}(t=o.prototype).m=function(){if(b(this))return-D(this).m();for(var V=0,R=1,k=0;k<this.g.length;k++){var U=this.i(k);V+=(0<=U?U:4294967296+U)*R,R*=4294967296}return V},t.toString=function(V){if(2>(V=V||10)||36<V)throw Error("radix out of range: "+V);if(w(this))return"0";if(b(this))return"-"+D(this).toString(V);for(var R=c(Math.pow(V,6)),k=this,U="";;){var H=ie(k,R).g,W=((0<(k=F(k,H.j(R))).g.length?k.g[0]:k.h)>>>0).toString(V);if(w(k=H))return W+U;for(;6>W.length;)W="0"+W;U=W+U}},t.i=function(V){return 0>V?0:V<this.g.length?this.g[V]:this.h},t.l=function(V){return b(V=F(this,V))?-1:w(V)?0:1},t.abs=function(){return b(this)?D(this):this},t.add=function(V){for(var R=Math.max(this.g.length,V.g.length),k=[],U=0,H=0;H<=R;H++){var W=U+(65535&this.i(H))+(65535&V.i(H)),O=(W>>>16)+(this.i(H)>>>16)+(V.i(H)>>>16);U=O>>>16,k[H]=(O&=65535)<<16|(W&=65535)}return new o(k,-2147483648&k[k.length-1]?-1:0)},t.j=function(V){if(w(this)||w(V))return g;if(b(this))return b(V)?D(this).j(D(V)):D(D(this).j(V));if(b(V))return D(this.j(D(V)));if(0>this.l(v)&&0>V.l(v))return c(this.m()*V.m());for(var R=this.g.length+V.g.length,k=[],U=0;U<2*R;U++)k[U]=0;for(U=0;U<this.g.length;U++)for(var H=0;H<V.g.length;H++){var W=this.i(U)>>>16,O=65535&this.i(U),vu=V.i(H)>>>16,av=65535&V.i(H);k[2*U+2*H]+=O*av,x(k,2*U+2*H),k[2*U+2*H+1]+=W*av,x(k,2*U+2*H+1),k[2*U+2*H+1]+=O*vu,x(k,2*U+2*H+1),k[2*U+2*H+2]+=W*vu,x(k,2*U+2*H+2)}for(U=0;U<R;U++)k[U]=k[2*U+1]<<16|k[2*U];for(U=R;U<2*R;U++)k[U]=0;return new o(k,0)},t.A=function(V){return ie(this,V).h},t.and=function(V){for(var R=Math.max(this.g.length,V.g.length),k=[],U=0;U<R;U++)k[U]=this.i(U)&V.i(U);return new o(k,this.h&V.h)},t.or=function(V){for(var R=Math.max(this.g.length,V.g.length),k=[],U=0;U<R;U++)k[U]=this.i(U)|V.i(U);return new o(k,this.h|V.h)},t.xor=function(V){for(var R=Math.max(this.g.length,V.g.length),k=[],U=0;U<R;U++)k[U]=this.i(U)^V.i(U);return new o(k,this.h^V.h)},r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,IH=EH.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=function h(V,R){if(0==V.length)throw Error("number format error: empty string");if(2>(R=R||10)||36<R)throw Error("radix out of range: "+R);if("-"==V.charAt(0))return D(h(V.substring(1),R));if(0<=V.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=c(Math.pow(R,8)),U=g,H=0;H<V.length;H+=8){var W=Math.min(8,V.length-H),O=parseInt(V.substring(H,H+W),R);8>W?(W=c(Math.pow(R,W)),U=U.j(W).add(c(O))):U=(U=U.j(k)).add(c(O))}return U},Xl=EH.Integer=o}).apply(typeof vH<"u"?vH:typeof self<"u"?self:typeof window<"u"?window:{});var wH,TH,N_,CH,nT,LR,AH,bH,DH,tT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},su={};(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(f,y,I){return f==Array.prototype||f==Object.prototype||(f[y]=I.value),f},r=function n(f){f=["object"==typeof globalThis&&globalThis,f,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof tT&&tT];for(var y=0;y<f.length;++y){var I=f[y];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}(this);!function i(f,y){if(y)e:{var I=r;f=f.split(".");for(var C=0;C<f.length-1;C++){var q=f[C];if(!(q in I))break e;I=I[q]}(y=y(C=I[f=f[f.length-1]]))!=C&&null!=y&&e(I,f,{configurable:!0,writable:!0,value:y})}}("Array.prototype.values",function(f){return f||function(){return function s(f,y){f instanceof String&&(f+="");var I=0,C=!1,q={next:function(){if(!C&&I<f.length){var J=I++;return{value:y(J,f[J]),done:!1}}return C=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}(this,function(y,I){return I})}});var o=o||{},a=this||self;function u(f){var y=typeof f;return"array"==(y="object"!=y?y:f?Array.isArray(f)?"array":y:"null")||"object"==y&&"number"==typeof f.length}function c(f){var y=typeof f;return"object"==y&&null!=f||"function"==y}function h(f,y,I){return f.call.apply(f.bind,arguments)}function g(f,y,I){if(!f)throw Error();if(2<arguments.length){var C=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,C),f.apply(y,q)}}return function(){return f.apply(y,arguments)}}function _(f,y,I){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?h:g).apply(null,arguments)}function v(f,y){var I=Array.prototype.slice.call(arguments,1);return function(){var C=I.slice();return C.push.apply(C,arguments),f.apply(this,C)}}function w(f,y){function I(){}I.prototype=y.prototype,f.aa=y.prototype,f.prototype=new I,f.prototype.constructor=f,f.Qb=function(C,q,J){for(var Ce=Array(arguments.length-2),dn=2;dn<arguments.length;dn++)Ce[dn-2]=arguments[dn];return y.prototype[q].apply(C,Ce)}}function b(f){const y=f.length;if(0<y){const I=Array(y);for(let C=0;C<y;C++)I[C]=f[C];return I}return[]}function D(f,y){for(let I=1;I<arguments.length;I++){const C=arguments[I];if(u(C)){const q=f.length||0,J=C.length||0;f.length=q+J;for(let Ce=0;Ce<J;Ce++)f[q+Ce]=C[Ce]}else f.push(C)}}function x(f){return/^[\s\xa0]*$/.test(f)}function $(){var f=a.navigator;return f&&(f=f.userAgent)?f:""}function ie(f){return ie[" "](f),f}ie[" "]=function(){};var Ie=!(-1==$().indexOf("Gecko")||-1!=$().toLowerCase().indexOf("webkit")&&-1==$().indexOf("Edge")||-1!=$().indexOf("Trident")||-1!=$().indexOf("MSIE")||-1!=$().indexOf("Edge"));function Pe(f,y,I){for(const C in f)y.call(I,f[C],C,f)}function R(f){const y={};for(const I in f)y[I]=f[I];return y}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(f,y){let I,C;for(let q=1;q<arguments.length;q++){for(I in C=arguments[q],C)f[I]=C[I];for(let J=0;J<k.length;J++)I=k[J],Object.prototype.hasOwnProperty.call(C,I)&&(f[I]=C[I])}}function H(f){var y=1;f=f.split(":");const I=[];for(;0<y&&f.length;)I.push(f.shift()),y--;return f.length&&I.push(f.join(":")),I}function W(f){a.setTimeout(()=>{throw f},0)}function O(){var f=Kx;let y=null;return f.g&&(y=f.g,f.g=f.g.next,f.g||(f.h=null),y.next=null),y}var av=new class F{constructor(y,I){this.i=y,this.j=I,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}(()=>new uve,f=>f.reset());class uve{constructor(){this.next=this.g=this.h=null}set(y,I){this.h=y,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let uv,cv=!1,Kx=new class vu{constructor(){this.h=this.g=null}add(y,I){const C=av.get();C.set(y,I),this.h?this.h.next=C:this.g=C,this.h=C}},W6=()=>{const f=a.Promise.resolve(void 0);uv=()=>{f.then(cve)}};var cve=()=>{for(var f;f=O();){try{f.h.call(f.g)}catch(I){W(I)}var y=av;y.j(f),100>y.h&&(y.h++,f.next=y.g,y.g=f)}cv=!1};function zc(){this.s=this.s,this.C=this.C}function Ai(f,y){this.type=f,this.g=this.target=y,this.defaultPrevented=!1}zc.prototype.s=!1,zc.prototype.ma=function(){this.s||(this.s=!0,this.N())},zc.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},Ai.prototype.h=function(){this.defaultPrevented=!0};var lve=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var f=!1,y=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const I=()=>{};a.addEventListener("test",I,y),a.removeEventListener("test",I,y)}catch{}return f}();function lv(f,y){if(Ai.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var I=this.type=f.type,C=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=y,y=f.relatedTarget){if(Ie){e:{try{ie(y.nodeName);var q=!0;break e}catch{}q=!1}q||(y=null)}}else"mouseover"==I?y=f.fromElement:"mouseout"==I&&(y=f.toElement);this.relatedTarget=y,C?(this.clientX=void 0!==C.clientX?C.clientX:C.pageX,this.clientY=void 0!==C.clientY?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=void 0!==f.clientX?f.clientX:f.pageX,this.clientY=void 0!==f.clientY?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType="string"==typeof f.pointerType?f.pointerType:dve[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&lv.aa.h.call(this)}}w(lv,Ai);var dve={2:"touch",3:"pen",4:"mouse"};lv.prototype.h=function(){lv.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var dv="closure_listenable_"+(1e6*Math.random()|0),hve=0;function fve(f,y,I,C,q){this.listener=f,this.proxy=null,this.src=y,this.type=I,this.capture=!!C,this.ha=q,this.key=++hve,this.da=this.fa=!1}function iA(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function sA(f){this.src=f,this.g={},this.h=0}function Qx(f,y){var I=y.type;if(I in f.g){var J,C=f.g[I],q=Array.prototype.indexOf.call(C,y,void 0);(J=0<=q)&&Array.prototype.splice.call(C,q,1),J&&(iA(y),0==f.g[I].length&&(delete f.g[I],f.h--))}}function Yx(f,y,I,C){for(var q=0;q<f.length;++q){var J=f[q];if(!J.da&&J.listener==y&&J.capture==!!I&&J.ha==C)return q}return-1}sA.prototype.add=function(f,y,I,C,q){var J=f.toString();(f=this.g[J])||(f=this.g[J]=[],this.h++);var Ce=Yx(f,y,C,q);return-1<Ce?(y=f[Ce],I||(y.fa=!1)):((y=new fve(y,this.src,J,!!C,q)).fa=I,f.push(y)),y};var Zx="closure_lm_"+(1e6*Math.random()|0),Jx={};function K6(f,y,I,C,q){if(C&&C.once)return Y6(f,y,I,C,q);if(Array.isArray(y)){for(var J=0;J<y.length;J++)K6(f,y[J],I,C,q);return null}return I=nk(I),f&&f[dv]?f.K(y,I,c(C)?!!C.capture:!!C,q):Q6(f,y,I,!1,C,q)}function Q6(f,y,I,C,q,J){if(!y)throw Error("Invalid event type");var Ce=c(q)?!!q.capture:!!q,dn=ek(f);if(dn||(f[Zx]=dn=new sA(f)),(I=dn.add(y,I,C,Ce,J)).proxy)return I;if(C=function pve(){const y=gve;return function f(I){return y.call(f.src,f.listener,I)}}(),I.proxy=C,C.src=f,C.listener=I,f.addEventListener)lve||(q=Ce),void 0===q&&(q=!1),f.addEventListener(y.toString(),C,q);else if(f.attachEvent)f.attachEvent(J6(y.toString()),C);else{if(!f.addListener||!f.removeListener)throw Error("addEventListener and attachEvent are unavailable.");f.addListener(C)}return I}function Y6(f,y,I,C,q){if(Array.isArray(y)){for(var J=0;J<y.length;J++)Y6(f,y[J],I,C,q);return null}return I=nk(I),f&&f[dv]?f.L(y,I,c(C)?!!C.capture:!!C,q):Q6(f,y,I,!0,C,q)}function Z6(f,y,I,C,q){if(Array.isArray(y))for(var J=0;J<y.length;J++)Z6(f,y[J],I,C,q);else C=c(C)?!!C.capture:!!C,I=nk(I),f&&f[dv]?(f=f.i,(y=String(y).toString())in f.g&&-1<(I=Yx(J=f.g[y],I,C,q))&&(iA(J[I]),Array.prototype.splice.call(J,I,1),0==J.length&&(delete f.g[y],f.h--))):f&&(f=ek(f))&&(y=f.g[y.toString()],f=-1,y&&(f=Yx(y,I,C,q)),(I=-1<f?y[f]:null)&&Xx(I))}function Xx(f){if("number"!=typeof f&&f&&!f.da){var y=f.src;if(y&&y[dv])Qx(y.i,f);else{var I=f.type,C=f.proxy;y.removeEventListener?y.removeEventListener(I,C,f.capture):y.detachEvent?y.detachEvent(J6(I),C):y.addListener&&y.removeListener&&y.removeListener(C),(I=ek(y))?(Qx(I,f),0==I.h&&(I.src=null,y[Zx]=null)):iA(f)}}}function J6(f){return f in Jx?Jx[f]:Jx[f]="on"+f}function gve(f,y){if(f.da)f=!0;else{y=new lv(y,this);var I=f.listener,C=f.ha||f.src;f.fa&&Xx(f),f=I.call(C,y)}return f}function ek(f){return(f=f[Zx])instanceof sA?f:null}var tk="__closure_events_fn_"+(1e9*Math.random()>>>0);function nk(f){return"function"==typeof f?f:(f[tk]||(f[tk]=function(y){return f.handleEvent(y)}),f[tk])}function bi(){zc.call(this),this.i=new sA(this),this.M=this,this.F=null}function Gi(f,y){var I,C=f.F;if(C)for(I=[];C;C=C.F)I.push(C);if(f=f.M,C=y.type||y,"string"==typeof y)y=new Ai(y,f);else if(y instanceof Ai)y.target=y.target||f;else{var q=y;U(y=new Ai(C,f),q)}if(q=!0,I)for(var J=I.length-1;0<=J;J--){var Ce=y.g=I[J];q=oA(Ce,C,!0,y)&&q}if(q=oA(Ce=y.g=f,C,!0,y)&&q,q=oA(Ce,C,!1,y)&&q,I)for(J=0;J<I.length;J++)q=oA(Ce=y.g=I[J],C,!1,y)&&q}function oA(f,y,I,C){if(!(y=f.i.g[String(y)]))return!0;y=y.concat();for(var q=!0,J=0;J<y.length;++J){var Ce=y[J];if(Ce&&!Ce.da&&Ce.capture==I){var dn=Ce.listener,ti=Ce.ha||Ce.src;Ce.fa&&Qx(f.i,Ce),q=!1!==dn.call(ti,C)&&q}}return q&&!C.defaultPrevented}function X6(f,y,I){if("function"==typeof f)I&&(f=_(f,I));else{if(!f||"function"!=typeof f.handleEvent)throw Error("Invalid listener argument");f=_(f.handleEvent,f)}return 2147483647<Number(y)?-1:a.setTimeout(f,y||0)}function e9(f){f.g=X6(()=>{f.g=null,f.i&&(f.i=!1,e9(f))},f.l);const y=f.h;f.h=null,f.m.apply(null,y)}w(bi,zc),bi.prototype[dv]=!0,bi.prototype.removeEventListener=function(f,y,I,C){Z6(this,f,y,I,C)},bi.prototype.N=function(){if(bi.aa.N.call(this),this.i){var y,f=this.i;for(y in f.g){for(var I=f.g[y],C=0;C<I.length;C++)iA(I[C]);delete f.g[y],f.h--}}this.F=null},bi.prototype.K=function(f,y,I,C){return this.i.add(String(f),y,!1,I,C)},bi.prototype.L=function(f,y,I,C){return this.i.add(String(f),y,!0,I,C)};class mve extends zc{constructor(y,I){super(),this.m=y,this.l=I,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:e9(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hv(f){zc.call(this),this.h=f,this.g={}}w(hv,zc);var t9=[];function n9(f){Pe(f.g,function(y,I){this.g.hasOwnProperty(I)&&Xx(y)},f),f.g={}}hv.prototype.N=function(){hv.aa.N.call(this),n9(this)},hv.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rk=a.JSON.stringify,_ve=a.JSON.parse,yve=class{stringify(f){return a.JSON.stringify(f,void 0)}parse(f){return a.JSON.parse(f,void 0)}};function ik(){}function i9(){}ik.prototype.h=null;var fv={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function sk(){Ai.call(this,"d")}function ok(){Ai.call(this,"c")}w(sk,Ai),w(ok,Ai);var Vd={},s9=null;function aA(){return s9=s9||new bi}function o9(f){Ai.call(this,Vd.La,f)}function pv(f){const y=aA();Gi(y,new o9(y))}function a9(f,y){Ai.call(this,Vd.STAT_EVENT,f),this.stat=y}function qi(f){const y=aA();Gi(y,new a9(y,f))}function u9(f,y){Ai.call(this,Vd.Ma,f),this.size=y}function gv(f,y){if("function"!=typeof f)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){f()},y)}function mv(){this.g=!0}function Gp(f,y,I,C){f.info(function(){return"XMLHTTP TEXT ("+y+"): "+function wve(f,y){if(!f.g)return y;if(!y)return null;try{var I=JSON.parse(y);if(I)for(f=0;f<I.length;f++)if(Array.isArray(I[f])){var C=I[f];if(!(2>C.length)){var q=C[1];if(Array.isArray(q)&&!(1>q.length)){var J=q[0];if("noop"!=J&&"stop"!=J&&"close"!=J)for(var Ce=1;Ce<q.length;Ce++)q[Ce]=""}}}return rk(I)}catch{return y}}(f,I)+(C?" "+C:"")})}Vd.La="serverreachability",w(o9,Ai),Vd.STAT_EVENT="statevent",w(a9,Ai),Vd.Ma="timingevent",w(u9,Ai),mv.prototype.xa=function(){this.g=!1},mv.prototype.info=function(){};var ak,uA={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},c9={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function cA(){}function Wc(f,y,I,C){this.j=f,this.i=y,this.l=I,this.R=C||1,this.U=new hv(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new l9}function l9(){this.i=null,this.g="",this.h=!1}w(cA,ik),cA.prototype.g=function(){return new XMLHttpRequest},cA.prototype.i=function(){return{}},ak=new cA;var d9={},uk={};function ck(f,y,I){f.L=1,f.v=fA(Eu(y)),f.m=I,f.P=!0,h9(f,null)}function h9(f,y){f.F=Date.now(),lA(f),f.A=Eu(f.v);var I=f.A,C=f.R;Array.isArray(C)||(C=[String(C)]),b9(I.i,"t",C),f.C=0,I=f.j.J,f.h=new l9,f.g=G9(f.j,I?y:null,!f.m),0<f.O&&(f.M=new mve(_(f.Y,f,f.g),f.O)),y=f.U,I=f.g,C=f.ca;var q="readystatechange";Array.isArray(q)||(q&&(t9[0]=q.toString()),q=t9);for(var J=0;J<q.length;J++){var Ce=K6(I,q[J],C||y.handleEvent,!1,y.h||y);if(!Ce)break;y.g[Ce.key]=Ce}y=f.H?R(f.H):{},f.m?(f.u||(f.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,y)):(f.u="GET",f.g.ea(f.A,f.u,null,y)),pv(),function vve(f,y,I,C,q,J){f.info(function(){if(f.g)if(J)for(var Ce="",dn=J.split("&"),ti=0;ti<dn.length;ti++){var $t=dn[ti].split("=");if(1<$t.length){var Di=$t[0];$t=$t[1];var Si=Di.split("_");Ce=2<=Si.length&&"type"==Si[1]?Ce+(Di+"=")+$t+"&":Ce+(Di+"=redacted&")}}else Ce=null;else Ce=J;return"XMLHTTP REQ ("+C+") [attempt "+q+"]: "+y+"\n"+I+"\n"+Ce})}(f.i,f.u,f.A,f.l,f.R,f.m)}function f9(f){return!!f.g&&"GET"==f.u&&2!=f.L&&f.j.Ca}function Tve(f,y){var I=f.C,C=y.indexOf("\n",I);return-1==C?uk:(I=Number(y.substring(I,C)),isNaN(I)?d9:(C+=1)+I>y.length?uk:(y=y.slice(C,C+I),f.C=C+I,y))}function lA(f){f.S=Date.now()+f.I,p9(f,f.I)}function p9(f,y){if(null!=f.B)throw Error("WatchDog timer not null");f.B=gv(_(f.ba,f),y)}function lk(f){f.B&&(a.clearTimeout(f.B),f.B=null)}function _v(f){0==f.j.G||f.J||B9(f.j,f)}function Ud(f){lk(f);var y=f.M;y&&"function"==typeof y.ma&&y.ma(),f.M=null,n9(f.U),f.g&&(y=f.g,f.g=null,y.abort(),y.ma())}function dk(f,y){try{var I=f.j;if(0!=I.G&&(I.g==f||hk(I.h,f)))if(!f.K&&hk(I.h,f)&&3==I.G){try{var C=I.Da.g.parse(y)}catch{C=null}if(Array.isArray(C)&&3==C.length){var q=C;if(0==q[0]){e:if(!I.u){if(I.g){if(!(I.g.F+3e3<f.F))break e;yA(I),mA(I)}mk(I),qi(18)}}else I.za=q[1],0<I.za-I.T&&37500>q[2]&&I.F&&0==I.v&&!I.C&&(I.C=gv(_(I.Za,I),6e3));if(1>=_9(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else jd(I,11)}else if((f.K||I.g==f)&&yA(I),!x(y))for(q=I.Da.g.parse(y),y=0;y<q.length;y++){let $t=q[y];if(I.T=$t[0],$t=$t[1],2==I.G)if("c"==$t[0]){I.K=$t[1],I.ia=$t[2];const Di=$t[3];null!=Di&&(I.la=Di,I.j.info("VER="+I.la));const Si=$t[4];null!=Si&&(I.Aa=Si,I.j.info("SVER="+I.Aa));const Wp=$t[5];null!=Wp&&"number"==typeof Wp&&0<Wp&&(I.L=C=1.5*Wp,I.j.info("backChannelRequestTimeoutMs_="+C)),C=I;const Lo=f.g;if(Lo){const EA=Lo.g?Lo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(EA){var J=C.h;J.g||-1==EA.indexOf("spdy")&&-1==EA.indexOf("quic")&&-1==EA.indexOf("h2")||(J.j=J.l,J.g=new Set,J.h&&(fk(J,J.h),J.h=null))}if(C.D){const yk=Lo.g?Lo.g.getResponseHeader("X-HTTP-Session-Id"):null;yk&&(C.ya=yk,Nn(C.I,C.D,yk))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-f.F,I.j.info("Handshake RTT: "+I.R+"ms"));var Ce=f;if((C=I).qa=H9(C,C.J?C.ia:null,C.W),Ce.K){y9(C.h,Ce);var dn=Ce,ti=C.L;ti&&(dn.I=ti),dn.B&&(lk(dn),lA(dn)),C.g=Ce}else V9(C);0<I.i.length&&_A(I)}else"stop"!=$t[0]&&"close"!=$t[0]||jd(I,7);else 3==I.G&&("stop"==$t[0]||"close"==$t[0]?"stop"==$t[0]?jd(I,7):gk(I):"noop"!=$t[0]&&I.l&&I.l.ta($t),I.v=0)}pv()}catch{}}Wc.prototype.ca=function(f){f=f.target;const y=this.M;y&&3==Iu(f)?y.j():this.Y(f)},Wc.prototype.Y=function(f){try{if(f==this.g)e:{const Si=Iu(this.g);var y=this.g.Ba();if(this.g.Z(),!(3>Si)&&(3!=Si||this.g&&(this.h.h||this.g.oa()||x9(this.g)))){this.J||4!=Si||7==y||pv(),lk(this);var I=this.g.Z();this.X=I;t:if(f9(this)){var C=x9(this.g);f="";var q=C.length,J=4==Iu(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Ud(this),_v(this);var Ce="";break t}this.h.i=new a.TextDecoder}for(y=0;y<q;y++)this.h.h=!0,f+=this.h.i.decode(C[y],{stream:!(J&&y==q-1)});C.length=0,this.h.g+=f,this.C=0,Ce=this.h.g}else Ce=this.g.oa();if(this.o=200==I,function Eve(f,y,I,C,q,J,Ce){f.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+q+"]: "+y+"\n"+I+"\n"+J+" "+Ce})}(this.i,this.u,this.A,this.l,this.R,Si,I),this.o){if(this.T&&!this.K){t:{if(this.g){var dn,ti=this.g;if((dn=ti.g?ti.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(dn)){var $t=dn;break t}}$t=null}if(!(I=$t)){this.o=!1,this.s=3,qi(12),Ud(this),_v(this);break e}Gp(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,dk(this,I)}if(this.P){let Lo;for(I=!0;!this.J&&this.C<Ce.length;){if(Lo=Tve(this,Ce),Lo==uk){4==Si&&(this.s=4,qi(14),I=!1),Gp(this.i,this.l,null,"[Incomplete Response]");break}if(Lo==d9){this.s=4,qi(15),Gp(this.i,this.l,Ce,"[Invalid Chunk]"),I=!1;break}Gp(this.i,this.l,Lo,null),dk(this,Lo)}if(f9(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=Si||0!=Ce.length||this.h.h||(this.s=1,qi(16),I=!1),this.o=this.o&&I,I){if(0<Ce.length&&!this.W){this.W=!0;var Di=this.j;Di.g==this&&Di.ba&&!Di.M&&(Di.j.info("Great, no buffering proxy detected. Bytes received: "+Ce.length),_k(Di),Di.M=!0,qi(11))}}else Gp(this.i,this.l,Ce,"[Invalid Chunked Response]"),Ud(this),_v(this)}else Gp(this.i,this.l,Ce,null),dk(this,Ce);4==Si&&Ud(this),this.o&&!this.J&&(4==Si?B9(this.j,this):(this.o=!1,lA(this)))}else(function Bve(f){const y={};f=(f.g&&2<=Iu(f)&&f.g.getAllResponseHeaders()||"").split("\r\n");for(let C=0;C<f.length;C++){if(x(f[C]))continue;var I=H(f[C]);const q=I[0];if("string"!=typeof(I=I[1]))continue;I=I.trim();const J=y[q]||[];y[q]=J,J.push(I)}!function V(f,y){for(const I in f)y.call(void 0,f[I],I,f)}(y,function(C){return C.join(", ")})})(this.g),400==I&&0<Ce.indexOf("Unknown SID")?(this.s=3,qi(12)):(this.s=0,qi(13)),Ud(this),_v(this)}}}catch{}},Wc.prototype.cancel=function(){this.J=!0,Ud(this)},Wc.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(function Ive(f,y){f.info(function(){return"TIMEOUT: "+y})}(this.i,this.A),2!=this.L&&(pv(),qi(17)),Ud(this),this.s=2,_v(this)):p9(this,this.S-f)};var Cve=class{constructor(f,y){this.g=f,this.map=y}};function g9(f){this.l=f||10,f=a.PerformanceNavigationTiming?0<(f=a.performance.getEntriesByType("navigation")).length&&("hq"==f[0].nextHopProtocol||"h2"==f[0].nextHopProtocol):!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function m9(f){return!!f.h||!!f.g&&f.g.size>=f.j}function _9(f){return f.h?1:f.g?f.g.size:0}function hk(f,y){return f.h?f.h==y:!!f.g&&f.g.has(y)}function fk(f,y){f.g?f.g.add(y):f.h=y}function y9(f,y){f.h&&f.h==y?f.h=null:f.g&&f.g.has(y)&&f.g.delete(y)}function v9(f){if(null!=f.h)return f.i.concat(f.h.D);if(null!=f.g&&0!==f.g.size){let y=f.i;for(const I of f.g.values())y=y.concat(I.D);return y}return b(f.i)}function E9(f,y){if(f.forEach&&"function"==typeof f.forEach)f.forEach(y,void 0);else if(u(f)||"string"==typeof f)Array.prototype.forEach.call(f,y,void 0);else for(var I=function bve(f){if(f.na&&"function"==typeof f.na)return f.na();if(!f.V||"function"!=typeof f.V){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(u(f)||"string"==typeof f){var y=[];f=f.length;for(var I=0;I<f;I++)y.push(I);return y}y=[],I=0;for(const C in f)y[I++]=C;return y}}}(f),C=function Ave(f){if(f.V&&"function"==typeof f.V)return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if("string"==typeof f)return f.split("");if(u(f)){for(var y=[],I=f.length,C=0;C<I;C++)y.push(f[C]);return y}for(C in y=[],I=0,f)y[I++]=f[C];return y}(f),q=C.length,J=0;J<q;J++)y.call(void 0,C[J],I&&I[J],f)}g9.prototype.cancel=function(){if(this.i=v9(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const f of this.g.values())f.cancel();this.g.clear()}};var I9=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bd(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Bd){this.h=f.h,dA(this,f.j),this.o=f.o,this.g=f.g,hA(this,f.s),this.l=f.l;var y=f.i,I=new Ev;I.i=y.i,y.g&&(I.g=new Map(y.g),I.h=y.h),w9(this,I),this.m=f.m}else f&&(y=String(f).match(I9))?(this.h=!1,dA(this,y[1]||"",!0),this.o=yv(y[2]||""),this.g=yv(y[3]||"",!0),hA(this,y[4]),this.l=yv(y[5]||"",!0),w9(this,y[6]||"",!0),this.m=yv(y[7]||"")):(this.h=!1,this.i=new Ev(null,this.h))}function Eu(f){return new Bd(f)}function dA(f,y,I){f.j=I?yv(y,!0):y,f.j&&(f.j=f.j.replace(/:$/,""))}function hA(f,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);f.s=y}else f.s=null}function w9(f,y,I){y instanceof Ev?(f.i=y,function xve(f,y){y&&!f.j&&(Kc(f),f.i=null,f.g.forEach(function(I,C){var q=C.toLowerCase();C!=q&&(C9(this,C),b9(this,q,I))},f)),f.j=y}(f.i,f.h)):(I||(y=vv(y,Pve)),f.i=new Ev(y,f.h))}function Nn(f,y,I){f.i.set(y,I)}function fA(f){return Nn(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function yv(f,y){return f?y?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function vv(f,y,I){return"string"==typeof f?(f=encodeURI(f).replace(y,Sve),I&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Sve(f){return"%"+((f=f.charCodeAt(0))>>4&15).toString(16)+(15&f).toString(16)}Bd.prototype.toString=function(){var f=[],y=this.j;y&&f.push(vv(y,T9,!0),":");var I=this.g;return(I||"file"==y)&&(f.push("//"),(y=this.o)&&f.push(vv(y,T9,!0),"@"),f.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(I=this.s)&&f.push(":",String(I))),(I=this.l)&&(this.g&&"/"!=I.charAt(0)&&f.push("/"),f.push(vv(I,"/"==I.charAt(0)?Nve:Rve,!0))),(I=this.i.toString())&&f.push("?",I),(I=this.m)&&f.push("#",vv(I,Mve)),f.join("")};var T9=/[#\/\?@]/g,Rve=/[#\?:]/g,Nve=/[#\?]/g,Pve=/[#\?@]/g,Mve=/#/g;function Ev(f,y){this.h=this.g=null,this.i=f||null,this.j=!!y}function Kc(f){f.g||(f.g=new Map,f.h=0,f.i&&function Dve(f,y){if(f){f=f.split("&");for(var I=0;I<f.length;I++){var C=f[I].indexOf("="),q=null;if(0<=C){var J=f[I].substring(0,C);q=f[I].substring(C+1)}else J=f[I];y(J,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}(f.i,function(y,I){f.add(decodeURIComponent(y.replace(/\+/g," ")),I)}))}function C9(f,y){Kc(f),y=qp(f,y),f.g.has(y)&&(f.i=null,f.h-=f.g.get(y).length,f.g.delete(y))}function A9(f,y){return Kc(f),y=qp(f,y),f.g.has(y)}function b9(f,y,I){C9(f,y),0<I.length&&(f.i=null,f.g.set(qp(f,y),b(I)),f.h+=I.length)}function qp(f,y){return y=String(y),f.j&&(y=y.toLowerCase()),y}function Qc(f,y,I,C,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),C(I)}catch{}}function Lve(){this.g=new yve}function Fve(f,y,I){const C=I||"";try{E9(f,function(q,J){let Ce=q;c(q)&&(Ce=rk(q)),y.push(C+J+"="+encodeURIComponent(Ce))})}catch(q){throw y.push(C+"type="+encodeURIComponent("_badmap")),q}}function Iv(f){this.l=f.Ub||null,this.j=f.eb||!1}function pA(f,y){bi.call(this),this.D=f,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function D9(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}function wv(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Tv(f)}function Tv(f){f.onreadystatechange&&f.onreadystatechange.call(f)}function S9(f){let y="";return Pe(f,function(I,C){y+=C,y+=":",y+=I,y+="\r\n"}),y}function pk(f,y,I){e:{for(C in I){var C=!1;break e}C=!0}C||(I=S9(I),"string"==typeof f?null!=I&&encodeURIComponent(String(I)):Nn(f,y,I))}function er(f){bi.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(t=Ev.prototype).add=function(f,y){Kc(this),this.i=null,f=qp(this,f);var I=this.g.get(f);return I||this.g.set(f,I=[]),I.push(y),this.h+=1,this},t.forEach=function(f,y){Kc(this),this.g.forEach(function(I,C){I.forEach(function(q){f.call(y,q,C,this)},this)},this)},t.na=function(){Kc(this);const f=Array.from(this.g.values()),y=Array.from(this.g.keys()),I=[];for(let C=0;C<y.length;C++){const q=f[C];for(let J=0;J<q.length;J++)I.push(y[C])}return I},t.V=function(f){Kc(this);let y=[];if("string"==typeof f)A9(this,f)&&(y=y.concat(this.g.get(qp(this,f))));else{f=Array.from(this.g.values());for(let I=0;I<f.length;I++)y=y.concat(f[I])}return y},t.set=function(f,y){return Kc(this),this.i=null,A9(this,f=qp(this,f))&&(this.h-=this.g.get(f).length),this.g.set(f,[y]),this.h+=1,this},t.get=function(f,y){return f&&0<(f=this.V(f)).length?String(f[0]):y},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],y=Array.from(this.g.keys());for(var I=0;I<y.length;I++){var C=y[I];const J=encodeURIComponent(String(C)),Ce=this.V(C);for(C=0;C<Ce.length;C++){var q=J;""!==Ce[C]&&(q+="="+encodeURIComponent(String(Ce[C]))),f.push(q)}}return this.i=f.join("&")},w(Iv,ik),Iv.prototype.g=function(){return new pA(this.l,this.j)},Iv.prototype.i=function(f){return function(){return f}}({}),w(pA,bi),(t=pA.prototype).open=function(f,y){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=y,this.readyState=1,Tv(this)},t.send=function(f){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(y.body=f),(this.D||a).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,wv(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Tv(this)),this.g&&(this.readyState=3,Tv(this),this.g)))if("arraybuffer"===this.responseType)f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;D9(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))},t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var y=f.value?f.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!f.done}))&&(this.response=this.responseText+=y)}f.done?wv(this):Tv(this),3==this.readyState&&D9(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,wv(this))},t.Qa=function(f){this.g&&(this.response=f,wv(this))},t.ga=function(){this.g&&wv(this)},t.setRequestHeader=function(f,y){this.u.append(f,y)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],y=this.h.entries();for(var I=y.next();!I.done;)f.push((I=I.value)[0]+": "+I[1]),I=y.next();return f.join("\r\n")},Object.defineProperty(pA.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(f){this.m=f?"include":"same-origin"}}),w(er,bi);var Vve=/^https?$/i,Uve=["POST","PUT"];function R9(f,y){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=y,f.m=5,N9(f),gA(f)}function N9(f){f.A||(f.A=!0,Gi(f,"complete"),Gi(f,"error"))}function P9(f){if(f.h&&typeof o<"u"&&(!f.v[1]||4!=Iu(f)||2!=f.Z()))if(f.u&&4==Iu(f))X6(f.Ea,0,f);else if(Gi(f,"readystatechange"),4==Iu(f)){f.h=!1;try{const Ce=f.Z();e:switch(Ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var I;if(!(I=y)){var C;if(C=0===Ce){var q=String(f.D).match(I9)[1]||null;!q&&a.self&&a.self.location&&(q=a.self.location.protocol.slice(0,-1)),C=!Vve.test(q?q.toLowerCase():"")}I=C}if(I)Gi(f,"complete"),Gi(f,"success");else{f.m=6;try{var J=2<Iu(f)?f.g.statusText:""}catch{J=""}f.l=J+" ["+f.Z()+"]",N9(f)}}finally{gA(f)}}}function gA(f,y){if(f.g){M9(f);const I=f.g,C=f.v[0]?()=>{}:null;f.g=null,f.v=null,y||Gi(f,"ready");try{I.onreadystatechange=C}catch{}}}function M9(f){f.I&&(a.clearTimeout(f.I),f.I=null)}function Iu(f){return f.g?f.g.readyState:0}function x9(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function Cv(f,y,I){return I&&I.internalChannelParams&&I.internalChannelParams[f]||y}function k9(f){this.Aa=0,this.i=[],this.j=new mv,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Cv("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Cv("baseRetryDelayMs",5e3,f),this.cb=Cv("retryDelaySeedMs",1e4,f),this.Wa=Cv("forwardChannelMaxRetries",2,f),this.wa=Cv("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new g9(f&&f.concurrentRequestLimit),this.Da=new Lve,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function gk(f){if(O9(f),3==f.G){var y=f.U++,I=Eu(f.I);if(Nn(I,"SID",f.K),Nn(I,"RID",y),Nn(I,"TYPE","terminate"),Av(f,I),(y=new Wc(f,f.j,y)).L=2,y.v=fA(Eu(I)),I=!1,a.navigator&&a.navigator.sendBeacon)try{I=a.navigator.sendBeacon(y.v.toString(),"")}catch{}!I&&a.Image&&((new Image).src=y.v,I=!0),I||(y.g=G9(y.j,null),y.g.ea(y.v)),y.F=Date.now(),lA(y)}$9(f)}function mA(f){f.g&&(_k(f),f.g.cancel(),f.g=null)}function O9(f){mA(f),f.u&&(a.clearTimeout(f.u),f.u=null),yA(f),f.h.cancel(),f.s&&("number"==typeof f.s&&a.clearTimeout(f.s),f.s=null)}function _A(f){if(!m9(f.h)&&!f.s){f.s=!0;var y=f.Ga;uv||W6(),cv||(uv(),cv=!0),Kx.add(y,f),f.B=0}}function L9(f,y){var I;I=y?y.l:f.U++;const C=Eu(f.I);Nn(C,"SID",f.K),Nn(C,"RID",I),Nn(C,"AID",f.T),Av(f,C),f.m&&f.o&&pk(C,f.m,f.o),I=new Wc(f,f.j,I,f.B+1),null===f.m&&(I.H=f.o),y&&(f.i=y.D.concat(f.i)),y=F9(f,I,1e3),I.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),fk(f.h,I),ck(I,C,y)}function Av(f,y){f.H&&Pe(f.H,function(I,C){Nn(y,C,I)}),f.l&&E9({},function(I,C){Nn(y,C,I)})}function F9(f,y,I){I=Math.min(f.i.length,I);var C=f.l?_(f.l.Na,f.l,f):null;e:{var q=f.i;let J=-1;for(;;){const Ce=["count="+I];-1==J?0<I?(J=q[0].g,Ce.push("ofs="+J)):J=0:Ce.push("ofs="+J);let dn=!0;for(let ti=0;ti<I;ti++){let $t=q[ti].g;const Di=q[ti].map;if($t-=J,0>$t)J=Math.max(0,q[ti].g-100),dn=!1;else try{Fve(Di,Ce,"req"+$t+"_")}catch{C&&C(Di)}}if(dn){C=Ce.join("&");break e}}}return f=f.i.splice(0,I),y.D=f,C}function V9(f){if(!f.g&&!f.u){f.Y=1;var y=f.Fa;uv||W6(),cv||(uv(),cv=!0),Kx.add(y,f),f.v=0}}function mk(f){return!(f.g||f.u||3<=f.v||(f.Y++,f.u=gv(_(f.Fa,f),j9(f,f.v)),f.v++,0))}function _k(f){null!=f.A&&(a.clearTimeout(f.A),f.A=null)}function U9(f){f.g=new Wc(f,f.j,"rpc",f.Y),null===f.m&&(f.g.H=f.o),f.g.O=0;var y=Eu(f.qa);Nn(y,"RID","rpc"),Nn(y,"SID",f.K),Nn(y,"AID",f.T),Nn(y,"CI",f.F?"0":"1"),!f.F&&f.ja&&Nn(y,"TO",f.ja),Nn(y,"TYPE","xmlhttp"),Av(f,y),f.m&&f.o&&pk(y,f.m,f.o),f.L&&(f.g.I=f.L);var I=f.g;f=f.ia,I.L=1,I.v=fA(Eu(y)),I.m=null,I.P=!0,h9(I,f)}function yA(f){null!=f.C&&(a.clearTimeout(f.C),f.C=null)}function B9(f,y){var I=null;if(f.g==y){yA(f),_k(f),f.g=null;var C=2}else{if(!hk(f.h,y))return;I=y.D,y9(f.h,y),C=1}if(0!=f.G)if(y.o)if(1==C){I=y.m?y.m.length:0,y=Date.now()-y.F;var q=f.B;Gi(C=aA(),new u9(C,I)),_A(f)}else V9(f);else if(3==(q=y.s)||0==q&&0<y.X||!(1==C&&function jve(f,y){return!(_9(f.h)>=f.h.j-(f.s?1:0)||(f.s?(f.i=y.D.concat(f.i),0):1==f.G||2==f.G||f.B>=(f.Va?0:f.Wa)||(f.s=gv(_(f.Ga,f,y),j9(f,f.B)),f.B++,0)))}(f,y)||2==C&&mk(f)))switch(I&&0<I.length&&(y=f.h,y.i=y.i.concat(I)),q){case 1:jd(f,5);break;case 4:jd(f,10);break;case 3:jd(f,6);break;default:jd(f,2)}}function j9(f,y){let I=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(I*=2),I*y}function jd(f,y){if(f.j.info("Error code "+y),2==y){var I=_(f.fb,f),C=f.Xa;const q=!C;C=new Bd(C||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||dA(C,"https"),fA(C),q?function kve(f,y){const I=new mv;if(a.Image){const C=new Image;C.onload=v(Qc,I,"TestLoadImage: loaded",!0,y,C),C.onerror=v(Qc,I,"TestLoadImage: error",!1,y,C),C.onabort=v(Qc,I,"TestLoadImage: abort",!1,y,C),C.ontimeout=v(Qc,I,"TestLoadImage: timeout",!1,y,C),a.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=f}else y(!1)}(C.toString(),I):function Ove(f,y){new mv;const C=new AbortController,q=setTimeout(()=>{C.abort(),Qc(0,0,!1,y)},1e4);fetch(f,{signal:C.signal}).then(J=>{clearTimeout(q),Qc(0,0,!!J.ok,y)}).catch(()=>{clearTimeout(q),Qc(0,0,!1,y)})}(C.toString(),I)}else qi(2);f.G=0,f.l&&f.l.sa(y),$9(f),O9(f)}function $9(f){if(f.G=0,f.ka=[],f.l){const y=v9(f.h);(0!=y.length||0!=f.i.length)&&(D(f.ka,y),D(f.ka,f.i),f.h.i.length=0,b(f.i),f.i.length=0),f.l.ra()}}function H9(f,y,I){var C=I instanceof Bd?Eu(I):new Bd(I);if(""!=C.g)y&&(C.g=y+"."+C.g),hA(C,C.s);else{var q=a.location;C=q.protocol,y=y?y+"."+q.hostname:q.hostname,q=+q.port;var J=new Bd(null);C&&dA(J,C),y&&(J.g=y),q&&hA(J,q),I&&(J.l=I),C=J}return y=f.ya,(I=f.D)&&y&&Nn(C,I,y),Nn(C,"VER",f.la),Av(f,C),C}function G9(f,y,I){if(y&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return(y=new er(f.Ca&&!f.pa?new Iv({eb:I}):f.pa)).Ha(f.J),y}function q9(){}function vA(){}function ks(f,y){bi.call(this),this.g=new k9(y),this.l=f,this.h=y&&y.messageUrlParams||null,f=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(f?f["X-WebChannel-Content-Type"]=y.messageContentType:f={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(f?f["X-WebChannel-Client-Profile"]=y.va:f={"X-WebChannel-Client-Profile":y.va}),this.g.S=f,(f=y&&y.Sb)&&!x(f)&&(this.g.m=f),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!x(y)&&(this.g.D=y,null!==(f=this.h)&&y in f&&y in(f=this.h)&&delete f[y]),this.j=new zp(this)}function z9(f){sk.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var y=f.__sm__;if(y){e:{for(const I in y){f=I;break e}f=void 0}(this.i=f)&&(f=this.i,y=null!==y&&f in y?y[f]:void 0),this.data=y}else this.data=f}function W9(){ok.call(this),this.status=1}function zp(f){this.g=f}(t=er.prototype).Ha=function(f){this.J=f},t.ea=function(f,y,I,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);y=y?y.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ak.g(),this.v=function r9(f){return f.h||(f.h=f.i())}(this.o?this.o:ak),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(y,String(f),!0),this.B=!1}catch(J){return void R9(this,J)}if(f=I||"",I=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var q in C)I.set(q,C[q]);else{if("function"!=typeof C.keys||"function"!=typeof C.get)throw Error("Unknown input type for opt_headers: "+String(C));for(const J of C.keys())I.set(J,C.get(J))}C=Array.from(I.keys()).find(J=>"content-type"==J.toLowerCase()),q=a.FormData&&f instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Uve,y,void 0))||C||q||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,Ce]of I)this.g.setRequestHeader(J,Ce);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{M9(this),this.u=!0,this.g.send(f),this.u=!1}catch(J){R9(this,J)}},t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Gi(this,"complete"),Gi(this,"abort"),gA(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),gA(this,!0)),er.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?P9(this):this.bb())},t.bb=function(){P9(this)},t.isActive=function(){return!!this.g},t.Z=function(){try{return 2<Iu(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var y=this.g.responseText;return f&&0==y.indexOf(f)&&(y=y.substring(f.length)),_ve(y)}},t.Ba=function(){return this.m},t.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(t=k9.prototype).la=8,t.G=1,t.connect=function(f,y,I,C){qi(0),this.W=f,this.H=y||{},I&&void 0!==C&&(this.H.OSID=I,this.H.OAID=C),this.F=this.X,this.I=H9(this,null,this.W),_A(this)},t.Ga=function(f){if(this.s)if(this.s=null,1==this.G){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const q=new Wc(this,this.j,f);let J=this.o;if(this.S&&(J?(J=R(J),U(J,this.S)):J=this.S),null!==this.m||this.O||(q.H=J,J=null),this.P)e:{for(var y=0,I=0;I<this.i.length;I++){var C=this.i[I];if(void 0===(C="__data__"in C.map&&"string"==typeof(C=C.map.__data__)?C.length:void 0))break;if(4096<(y+=C)){y=I;break e}if(4096===y||I===this.i.length-1){y=I+1;break e}}y=1e3}else y=1e3;y=F9(this,q,y),Nn(I=Eu(this.I),"RID",f),Nn(I,"CVER",22),this.D&&Nn(I,"X-HTTP-Session-Id",this.D),Av(this,I),J&&(this.O?y="headers="+encodeURIComponent(String(S9(J)))+"&"+y:this.m&&pk(I,this.m,J)),fk(this.h,q),this.Ua&&Nn(I,"TYPE","init"),this.P?(Nn(I,"$req",y),Nn(I,"SID","null"),q.T=!0,ck(q,I,null)):ck(q,I,y),this.G=2}}else 3==this.G&&(f?L9(this,f):0==this.i.length||m9(this.h)||L9(this))},t.Fa=function(){if(this.u=null,U9(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=gv(_(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,qi(10),mA(this),U9(this))},t.Za=function(){null!=this.C&&(this.C=null,mA(this),mk(this),qi(19))},t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),qi(2)):(this.j.info("Failed to ping google.com"),qi(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=q9.prototype).ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){},vA.prototype.g=function(f,y){return new ks(f,y)},w(ks,bi),ks.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ks.prototype.close=function(){gk(this.g)},ks.prototype.o=function(f){var y=this.g;if("string"==typeof f){var I={};I.__data__=f,f=I}else this.u&&((I={}).__data__=rk(f),f=I);y.i.push(new Cve(y.Ya++,f)),3==y.G&&_A(y)},ks.prototype.N=function(){this.g.l=null,delete this.j,gk(this.g),delete this.g,ks.aa.N.call(this)},w(z9,sk),w(W9,ok),w(zp,q9),zp.prototype.ua=function(){Gi(this.g,"a")},zp.prototype.ta=function(f){Gi(this.g,new z9(f))},zp.prototype.sa=function(f){Gi(this.g,new W9)},zp.prototype.ra=function(){Gi(this.g,"b")},vA.prototype.createWebChannel=vA.prototype.g,ks.prototype.send=ks.prototype.o,ks.prototype.open=ks.prototype.m,ks.prototype.close=ks.prototype.close,DH=su.createWebChannelTransport=function(){return new vA},bH=su.getStatEventTarget=function(){return aA()},AH=su.Event=Vd,LR=su.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},uA.NO_ERROR=0,uA.TIMEOUT=8,uA.HTTP_ERROR=6,nT=su.ErrorCode=uA,c9.COMPLETE="complete",CH=su.EventType=c9,i9.EventType=fv,fv.OPEN="a",fv.CLOSE="b",fv.ERROR="c",fv.MESSAGE="d",bi.prototype.listen=bi.prototype.K,N_=su.WebChannel=i9,TH=su.FetchXmlHttpFactory=Iv,er.prototype.listenOnce=er.prototype.L,er.prototype.getLastError=er.prototype.Ka,er.prototype.getLastErrorCode=er.prototype.Ba,er.prototype.getStatus=er.prototype.Z,er.prototype.getResponseJson=er.prototype.Oa,er.prototype.getResponseText=er.prototype.oa,er.prototype.send=er.prototype.ea,er.prototype.setWithCredentials=er.prototype.Ha,wH=su.XhrIo=er}).apply(typeof tT<"u"?tT:typeof self<"u"?self:typeof window<"u"?window:{});const SH="@firebase/firestore";class $r{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$r.UNAUTHENTICATED=new $r(null),$r.GOOGLE_CREDENTIALS=new $r("google-credentials-uid"),$r.FIRST_PARTY=new $r("first-party-uid"),$r.MOCK_USER=new $r("mock-user");let Vf="10.12.5";const gc=new Ds.Vy("@firebase/firestore");function Uf(){return gc.logLevel}function me(t,...e){if(gc.logLevel<=Ds.$b.DEBUG){const n=e.map(FR);gc.debug(`Firestore (${Vf}): ${t}`,...n)}}function dr(t,...e){if(gc.logLevel<=Ds.$b.ERROR){const n=e.map(FR);gc.error(`Firestore (${Vf}): ${t}`,...n)}}function os(t,...e){if(gc.logLevel<=Ds.$b.WARN){const n=e.map(FR);gc.warn(`Firestore (${Vf}): ${t}`,...n)}}function FR(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch{return t}}function Le(t="Unexpected state"){const e=`FIRESTORE (${Vf}) INTERNAL ASSERTION FAILED: `+t;throw dr(e),new Error(e)}function $e(t,e){t||Le()}function Te(t,e){return t}const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pe extends A.g{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Pr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}class RH{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $ae{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n($r.UNAUTHENTICATED))}shutdown(){}}class Hae{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Gae{constructor(e){this.t=e,this.currentUser=$r.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){var r=this;let i=this.i;const s=c=>this.i!==i?(i=this.i,n(c)):Promise.resolve();let o=new Pr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Pr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=o;e.enqueueRetryable((0,ne.A)(function*(){yield c.promise,yield s(r.currentUser)}))},u=c=>{me("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(me("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Pr)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(me("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($e("string"==typeof r.accessToken),new RH(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return $e(null===e||"string"==typeof e),new $r(e)}}class qae{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=$r.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class zae{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new qae(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n($r.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class NH{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Wae{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{null!=s.error&&me("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,me("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{me("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):me("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?($e("string"==typeof n.token),this.R=n.token,new NH(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Kae(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class PH{static newId(){const n=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=Kae(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function st(t,e){return t<e?-1:t>e?1:0}function Bf(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function MH(t){return t+"\0"}class Fn{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new pe(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new pe(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new pe(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pe(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Fn.fromMillis(Date.now())}static fromDate(e){return Fn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Fn(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ge{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ge(e)}static min(){return new Ge(new Fn(0,0))}static max(){return new Ge(new Fn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class P_{constructor(e,n,r){void 0===n?n=0:n>e.length&&Le(),void 0===r?r=e.length-n:r>e.length-n&&Le(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return 0===P_.comparator(this,e)}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof P_?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Dt extends P_{construct(e,n,r){return new Dt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new pe(Q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Dt(n)}static emptyPath(){return new Dt([])}}const Qae=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Dn extends P_{construct(e,n,r){return new Dn(e,n,r)}static isValidIdentifier(e){return Qae.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Dn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Dn(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(0===r.length)throw new pe(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new pe(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new pe(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new pe(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Dn(n)}static emptyPath(){return new Dn([])}}class be{constructor(e){this.path=e}static fromPath(e){return new be(Dt.fromString(e))}static fromName(e){return new be(Dt.fromString(e).popFirst(5))}static empty(){return new be(Dt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Dt.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,n){return Dt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new Dt(e.slice()))}}class jf{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function VR(t){return t.fields.find(e=>2===e.kind)}function ed(t){return t.fields.filter(e=>2!==e.kind)}jf.UNKNOWN_ID=-1;class td{constructor(e,n){this.fieldPath=e,this.kind=n}}class $f{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new $f(0,Ss.min())}}function xH(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ge.fromTimestamp(1e9===r?new Fn(n+1,0):new Fn(n,r));return new Ss(i,be.empty(),e)}function kH(t){return new Ss(t.readTime,t.key,-1)}class Ss{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ss(Ge.min(),be.empty(),-1)}static max(){return new Ss(Ge.max(),be.empty(),-1)}}function UR(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=be.comparator(t.documentKey,e.documentKey),0!==n?n:st(t.largestBatchId,e.largestBatchId))}const OH="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class LH{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function mc(t){return BR.apply(this,arguments)}function BR(){return(BR=(0,ne.A)(function*(t){if(t.code!==Q.FAILED_PRECONDITION||t.message!==OH)throw t;me("LocalStore","Unexpectedly lost primary lease")})).apply(this,arguments)}class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new z((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof z?n:z.resolve(n)}catch(n){return z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):z.reject(n)}static resolve(e){return new z((n,r)=>{n(e)})}static reject(e){return new z((n,r)=>{r(e)})}static waitFor(e){return new z((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=z.resolve(!1);for(const r of e)n=n.next(i=>i?z.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new z((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const c=u;n(e[c]).next(h=>{o[c]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new z((r,i)=>{const s=()=>{!0===e()?n().next(()=>{s()},i):r()};s()})}}class rT{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Pr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new M_(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=jR(r.target.error);this.V.reject(new M_(e,i))}}static open(e,n,r,i){try{return new rT(n,e.transaction(i,r))}catch(s){throw new M_(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(me("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const n=this.transaction.objectStore(e);return new Xae(n)}}class ca{constructor(e,n,r){this.name=e,this.version=n,this.p=r,12.2===ca.S((0,A.ZQ)())&&dr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return me("SimpleDb","Removing database:",e),nd(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,A.zW)())return!1;if(ca.C())return!0;const e=(0,A.ZQ)(),n=ca.S(e),r=0<n&&n<10,i=FH(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.v)}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){var n=this;return(0,ne.A)(function*(){return n.db||(me("SimpleDb","Opening database:",n.name),n.db=yield new Promise((r,i)=>{const s=indexedDB.open(n.name,n.version);s.onsuccess=o=>{r(o.target.result)},s.onblocked=()=>{i(new M_(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;i("VersionError"===a.name?new pe(Q.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new pe(Q.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new M_(e,a))},s.onupgradeneeded=o=>{me("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',o.oldVersion),n.p.O(o.target.result,s.transaction,o.oldVersion,n.version).next(()=>{me("SimpleDb","Database upgrade to version "+n.version+" complete")})}})),n.N&&(n.db.onversionchange=r=>n.N(r)),n.db})()}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){var s=this;return(0,ne.A)(function*(){const o="readonly"===n;let a=0;for(;;){++a;try{s.db=yield s.M(e);const u=rT.open(s.db,e,o?"readonly":"readwrite",r),c=i(u).next(h=>(u.g(),h)).catch(h=>(u.abort(h),z.reject(h))).toPromise();return c.catch(()=>{}),yield u.m,c}catch(u){const c=u,h="FirebaseError"!==c.name&&a<3;if(me("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),s.close(),!h)return Promise.reject(c)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}function FH(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Jae{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return nd(this.B.delete())}}class M_ extends pe{constructor(e,n){super(Q.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function _c(t){return"IndexedDbTransactionError"===t.name}class Xae{constructor(e){this.store=e}put(e,n){let r;return void 0!==n?(me("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(me("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),nd(r)}add(e){return me("SimpleDb","ADD",this.store.name,e,e),nd(this.store.add(e))}get(e){return nd(this.store.get(e)).next(n=>(void 0===n&&(n=null),me("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return me("SimpleDb","DELETE",this.store.name,e),nd(this.store.delete(e))}count(){return me("SimpleDb","COUNT",this.store.name),nd(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if("function"==typeof i.getAll){const s=i.getAll(r.range);return new z((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,null===n?void 0:n);return new z((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){me("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new z((r,i)=>{n.onerror=s=>{const o=jR(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new z((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const u=new Jae(a),c=n(a.primaryKey,a.value,u);if(c instanceof z){const h=c.catch(g=>(u.done(),z.reject(g)));r.push(h)}u.isDone?i():null===u.K?a.continue():a.continue(u.K)}}).next(()=>z.waitFor(r))}options(e,n){let r;return void 0!==e&&("string"==typeof e?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function nd(t){return new z((e,n)=>{t.onsuccess=r=>{e(r.target.result)},t.onerror=r=>{const i=jR(r.target.error);n(i)}})}let VH=!1;function jR(t){const e=ca.S((0,A.ZQ)());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new pe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return VH||(VH=!0,setTimeout(()=>{throw r},0)),r}}return t}class eue{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}X(e){var n=this;me("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,ne.A)(function*(){n.task=null;try{me("IndexBackfiller",`Documents written: ${yield n.Z.ee()}`)}catch(r){_c(r)?me("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):yield mc(r)}yield n.X(6e4)}))}}class tue{constructor(e,n){this.localStore=e,this.persistence=n}ee(e=50){var n=this;return(0,ne.A)(function*(){return n.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>n.te(r,e))})()}te(e,n){const r=new Set;let i=n,s=!0;return z.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!r.has(o))return me("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(me("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=kH(s);UR(o,r)>0&&(r=o)}),new Ss(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}let Rs=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){const n=++this.previousValue;return this.se&&this.se(n),n}}return t.oe=-1,t})();function x_(t){return null==t}function k_(t){return 0===t&&1/t==-1/0}function UH(t){return"number"==typeof t&&Number.isInteger(t)&&!k_(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Ei(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=BH(e)),e=nue(t.get(n),e);return BH(e)}function nue(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=s}}return n}function BH(t){return t+"\x01\x01"}function la(t){const e=t.length;if($e(e>=2),2===e)return $e("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Dt.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("\x01",s);switch((o<0||o>n)&&Le(),t.charAt(o+1)){case"\x01":const a=t.substring(s,o);let u;0===i.length?u=a:(i+=a,u=i,i=""),r.push(u);break;case"\x10":i+=t.substring(s,o),i+="\0";break;case"\x11":i+=t.substring(s,o+1);break;default:Le()}s=o+2}return new Dt(r)}const jH=["userId","batchId"];function iT(t,e){return[t,Ei(e)]}function $H(t,e,n){return[t,Ei(e),n]}const rue={},iue=["prefixPath","collectionGroup","readTime","documentId"],sue=["prefixPath","collectionGroup","documentId"],oue=["collectionGroup","readTime","prefixPath","documentId"],aue=["canonicalId","targetId"],uue=["targetId","path"],cue=["path","targetId"],lue=["collectionId","parent"],due=["indexId","uid"],hue=["uid","sequenceNumber"],fue=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],pue=["indexId","uid","orderedDocumentKey"],gue=["userId","collectionPath","documentId"],mue=["userId","collectionPath","largestBatchId"],_ue=["userId","collectionGroup","largestBatchId"],HH=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],yue=[...HH,"documentOverlays"],GH=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],qH=GH,$R=[...qH,"indexConfiguration","indexState","indexEntries"],vue=$R,Eue=[...$R,"globals"];class HR extends LH{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Mr(t,e){const n=Te(t);return ca.F(n._e,e)}function zH(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function yc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function KH(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class En{constructor(e,n){this.comparator=e,this.root=n||Zr.EMPTY}insert(e,n){return new En(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Zr.BLACK,null,null))}remove(e){return new En(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sT(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sT(this.root,e,this.comparator,!1)}getReverseIterator(){return new sT(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sT(this.root,e,this.comparator,!0)}}class sT{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zr{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Zr.RED,this.left=i??Zr.EMPTY,this.right=s??Zr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Zr(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):0===s?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Zr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return Zr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Le();const e=this.left.check();if(e!==this.right.check())throw Le();return e+(this.isRed()?0:1)}}Zr.EMPTY=null,Zr.RED=!0,Zr.BLACK=!1,Zr.EMPTY=new class{constructor(){this.size=0}get key(){throw Le()}get value(){throw Le()}get color(){throw Le()}get left(){throw Le()}get right(){throw Le()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Zr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class rn{constructor(e){this.comparator=e,this.data=new En(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=void 0!==n?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new QH(this.data.getIterator())}getIteratorFrom(e){return new QH(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof rn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new rn(this.comparator);return n.data=e,n}}class QH{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Hf(t){return t.hasNext()?t.getNext():void 0}class as{constructor(e){this.fields=e,e.sort(Dn.comparator)}static empty(){return new as([])}unionWith(e){let n=new rn(Dn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new as(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Bf(this.fields,e.fields,(n,r)=>n.isEqual(r))}}class YH extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Jn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new YH("Invalid base64 string: "+s):s}}(e);return new Jn(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Jn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jn.EMPTY_BYTE_STRING=new Jn("");const wue=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ou(t){if($e(!!t),"string"==typeof t){let e=0;const n=wue.exec(t);if($e(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Xn(t.seconds),nanos:Xn(t.nanos)}}function Xn(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function au(t){return"string"==typeof t?Jn.fromBase64String(t):Jn.fromUint8Array(t)}function oT(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=t?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function aT(t){const e=t.mapValue.fields.__previous_value__;return oT(e)?aT(e):e}function O_(t){const e=ou(t.mapValue.fields.__local_write_time__.timestampValue);return new Fn(e.seconds,e.nanos)}class Tue{constructor(e,n,r,i,s,o,a,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}}class vc{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new vc("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof vc&&e.projectId===this.projectId&&e.database===this.database}}const Ec={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},uT={nullValue:"NULL_VALUE"};function Ic(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?oT(t)?4:eG(t)?9007199254740991:10:Le()}function da(t,e){if(t===e)return!0;const n=Ic(t);if(n!==Ic(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return O_(t).isEqual(O_(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=ou(i.timestampValue),a=ou(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return s=e,au(t.bytesValue).isEqual(au(s.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Xn(i.geoPointValue.latitude)===Xn(s.geoPointValue.latitude)&&Xn(i.geoPointValue.longitude)===Xn(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Xn(i.integerValue)===Xn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Xn(i.doubleValue),a=Xn(s.doubleValue);return o===a?k_(o)===k_(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Bf(t.arrayValue.values||[],e.arrayValue.values||[],da);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(zH(o)!==zH(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(void 0===a[u]||!da(o[u],a[u])))return!1;return!0}(t,e);default:return Le()}var s}function L_(t,e){return void 0!==(t.values||[]).find(n=>da(n,e))}function wc(t,e){if(t===e)return 0;const n=Ic(t),r=Ic(e);if(n!==r)return st(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return st(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Xn(s.integerValue||s.doubleValue),u=Xn(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return ZH(t.timestampValue,e.timestampValue);case 4:return ZH(O_(t),O_(e));case 5:return st(t.stringValue,e.stringValue);case 6:return function(s,o){const a=au(s),u=au(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){const h=st(a[c],u[c]);if(0!==h)return h}return st(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=st(Xn(s.latitude),Xn(o.latitude));return 0!==a?a:st(Xn(s.longitude),Xn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],u=o.values||[];for(let c=0;c<a.length&&c<u.length;++c){const h=wc(a[c],u[c]);if(h)return h}return st(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Ec.mapValue&&o===Ec.mapValue)return 0;if(s===Ec.mapValue)return 1;if(o===Ec.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),c=o.fields||{},h=Object.keys(c);u.sort(),h.sort();for(let g=0;g<u.length&&g<h.length;++g){const _=st(u[g],h[g]);if(0!==_)return _;const v=wc(a[u[g]],c[h[g]]);if(0!==v)return v}return st(u.length,h.length)}(t.mapValue,e.mapValue);default:throw Le()}}function ZH(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return st(t,e);const n=ou(t),r=ou(e),i=st(n.seconds,r.seconds);return 0!==i?i:st(n.nanos,r.nanos)}function Gf(t){return GR(t)}function GR(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ou(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?au(t.bytesValue).toBase64():"referenceValue"in t?be.fromName(t.referenceValue).toString():"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=GR(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${GR(n.fields[o])}`;return i+"}"}(t.mapValue):Le()}function rd(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function qR(t){return!!t&&"integerValue"in t}function F_(t){return!!t&&"arrayValue"in t}function JH(t){return!!t&&"nullValue"in t}function XH(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function lT(t){return!!t&&"mapValue"in t}function V_(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return yc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=V_(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=V_(t.arrayValue.values[n]);return e}return Object.assign({},t)}function eG(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}function Cue(t){return"nullValue"in t?uT:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?rd(vc.empty(),be.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:Le()}function Aue(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?rd(vc.empty(),be.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Ec:Le()}function tG(t,e){const n=wc(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function nG(t,e){const n=wc(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class Jr{constructor(e){this.value=e}static empty(){return new Jr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!lT(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=V_(n)}setAll(e){let n=Dn.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=V_(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());lT(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return da(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];lT(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){yc(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Jr(V_(this.value))}}function rG(t){const e=[];return yc(t.fields,(n,r)=>{const i=new Dn([n]);if(lT(r)){const s=rG(r.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new as(e)}class Sn{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Sn(e,0,Ge.min(),Ge.min(),Ge.min(),Jr.empty(),0)}static newFoundDocument(e,n,r,i){return new Sn(e,1,n,Ge.min(),r,i,0)}static newNoDocument(e,n){return new Sn(e,2,n,Ge.min(),Ge.min(),Jr.empty(),0)}static newUnknownDocument(e,n){return new Sn(e,3,n,Ge.min(),Ge.min(),Jr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ge.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ge.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Sn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Sn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Tc{constructor(e,n){this.position=e,this.inclusive=n}}function iG(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?be.comparator(be.fromName(o.referenceValue),n.key):wc(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function sG(t,e){if(null===t)return null===e;if(null===e||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!da(t.position[n],e.position[n]))return!1;return!0}class U_{constructor(e,n="asc"){this.field=e,this.dir=n}}function bue(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class oG{}class St extends oG{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.createKeyFieldInFilter(e,n,r):new Due(e,n,r):"array-contains"===n?new Nue(e,r):"in"===n?new hG(e,r):"not-in"===n?new Pue(e,r):"array-contains-any"===n?new Mue(e,r):new St(e,n,r)}static createKeyFieldInFilter(e,n,r){return"in"===n?new Sue(e,r):new Rue(e,r)}matches(e){const n=e.data.field(this.field);return"!="===this.op?null!==n&&this.matchesComparison(wc(n,this.value)):null!==n&&Ic(this.value)===Ic(n)&&this.matchesComparison(wc(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class tn extends oG{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new tn(e,n)}matches(e){return qf(this)?void 0===this.filters.find(n=>!n.matches(e)):void 0!==this.filters.find(n=>n.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function qf(t){return"and"===t.op}function zR(t){return"or"===t.op}function WR(t){return aG(t)&&qf(t)}function aG(t){for(const e of t.filters)if(e instanceof tn)return!1;return!0}function KR(t){if(t instanceof St)return t.field.canonicalString()+t.op.toString()+Gf(t.value);if(WR(t))return t.filters.map(e=>KR(e)).join(",");{const e=t.filters.map(n=>KR(n)).join(",");return`${t.op}(${e})`}}function uG(t,e){return t instanceof St?(r=t,(i=e)instanceof St&&r.op===i.op&&r.field.isEqual(i.field)&&da(r.value,i.value)):t instanceof tn?function(r,i){return i instanceof tn&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((s,o,a)=>s&&uG(o,i.filters[a]),!0)}(t,e):void Le();var r,i}function cG(t,e){const n=t.filters.concat(e);return tn.create(n,t.op)}function lG(t){return t instanceof St?`${(n=t).field.canonicalString()} ${n.op} ${Gf(n.value)}`:t instanceof tn?function(n){return n.op.toString()+" {"+n.getFilters().map(lG).join(" ,")+"}"}(t):"Filter";var n}class Due extends St{constructor(e,n,r){super(e,n,r),this.key=be.fromName(r.referenceValue)}matches(e){const n=be.comparator(e.key,this.key);return this.matchesComparison(n)}}class Sue extends St{constructor(e,n){super(e,"in",n),this.keys=dG(0,n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Rue extends St{constructor(e,n){super(e,"not-in",n),this.keys=dG(0,n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function dG(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(r=>be.fromName(r.referenceValue))}class Nue extends St{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return F_(n)&&L_(n.arrayValue,this.value)}}class hG extends St{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return null!==n&&L_(this.value.arrayValue,n)}}class Pue extends St{constructor(e,n){super(e,"not-in",n)}matches(e){if(L_(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return null!==n&&!L_(this.value.arrayValue,n)}}class Mue extends St{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!F_(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>L_(this.value.arrayValue,r))}}class xue{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function QR(t,e=null,n=[],r=[],i=null,s=null,o=null){return new xue(t,e,n,r,i,s,o)}function id(t){const e=Te(t);if(null===e.ue){let n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>KR(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),x_(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Gf(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Gf(r)).join(",")),e.ue=n}return e.ue}function B_(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!bue(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!uG(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sG(t.startAt,e.startAt)&&sG(t.endAt,e.endAt)}function dT(t){return be.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}function hT(t,e){return t.filters.filter(n=>n instanceof St&&n.field.isEqual(e))}function fG(t,e,n){let r=uT,i=!0;for(const s of hT(t,e)){let o=uT,a=!0;switch(s.op){case"<":case"<=":o=Cue(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=uT}tG({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];tG({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}function pG(t,e,n){let r=Ec,i=!0;for(const s of hT(t,e)){let o=Ec,a=!0;switch(s.op){case">=":case">":o=Aue(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ec}nG({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];nG({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}class uu{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null}}function gG(t,e,n,r,i,s,o,a){return new uu(t,e,n,r,i,s,o,a)}function zf(t){return new uu(t)}function mG(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function YR(t){return null!==t.collectionGroup}function Wf(t){const e=Te(t);if(null===e.ce){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new rn(Dn.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new U_(s,r))}),n.has(Dn.keyField().canonicalString())||e.ce.push(new U_(Dn.keyField(),r))}return e.ce}function Ii(t){const e=Te(t);return e.le||(e.le=function yG(t,e){if("F"===t.limitType)return QR(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>new U_(i.field,"desc"===i.dir?"asc":"desc"));const n=t.endAt?new Tc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Tc(t.startAt.position,t.startAt.inclusive):null;return QR(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,Wf(t))),e.le}function ZR(t,e){const n=t.filters.concat([e]);return new uu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function fT(t,e,n){return new uu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function j_(t,e){return B_(Ii(t),Ii(e))&&t.limitType===e.limitType}function vG(t){return`${id(Ii(t))}|lt:${t.limitType}`}function Kf(t){return`Query(target=${function(n){let r=n.path.canonicalString();return null!==n.collectionGroup&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>lG(i)).join(", ")}]`),x_(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>{return`${(o=i).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Gf(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Gf(i)).join(",")),`Target(${r})`}(Ii(t))}; limitType=${t.limitType})`}function $_(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return null!==r.collectionGroup?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):be.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Wf(r))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&(i=e,!((r=t).startAt&&!function(o,a,u){const c=iG(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,Wf(r),i)||r.endAt&&!function(o,a,u){const c=iG(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,Wf(r),i)));var r,i}function EG(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function IG(t){return(e,n)=>{let r=!1;for(const i of Wf(t)){const s=kue(i,e,n);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function kue(t,e,n){const r=t.field.isKeyField()?be.comparator(e.key,n.key):function(s,o,a){const u=o.data.field(s),c=a.data.field(s);return null!==u&&null!==c?wc(u,c):Le()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Le()}}class cu{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){yc(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return KH(this.inner)}size(){return this.innerSize}}const Oue=new En(be.comparator);function us(){return Oue}const wG=new En(be.comparator);function H_(...t){let e=wG;for(const n of t)e=e.insert(n.key,n);return e}function TG(t){let e=wG;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ha(){return G_()}function CG(){return G_()}function G_(){return new cu(t=>t.toString(),(t,e)=>t.isEqual(e))}const Lue=new En(be.comparator),Fue=new rn(be.comparator);function ht(...t){let e=Fue;for(const n of t)e=e.add(n);return e}const Vue=new rn(st);function JR(){return Vue}function AG(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:k_(e)?"-0":e}}function bG(t){return{integerValue:""+t}}function DG(t,e){return UH(e)?bG(e):AG(t,e)}class pT{constructor(){this._=void 0}}function Uue(t,e,n){return t instanceof Qf?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&oT(s)&&(s=aT(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof sd?RG(t,e):t instanceof od?NG(t,e):function(i,s){const o=SG(i,s),a=PG(o)+PG(i.Pe);return qR(o)&&qR(i.Pe)?bG(a):AG(i.serializer,a)}(t,e)}function Bue(t,e,n){return t instanceof sd?RG(t,e):t instanceof od?NG(t,e):n}function SG(t,e){return t instanceof Yf?qR(r=e)||(s=r)&&"doubleValue"in s?e:{integerValue:0}:null;var r,s}class Qf extends pT{}class sd extends pT{constructor(e){super(),this.elements=e}}function RG(t,e){const n=MG(e);for(const r of t.elements)n.some(i=>da(i,r))||n.push(r);return{arrayValue:{values:n}}}class od extends pT{constructor(e){super(),this.elements=e}}function NG(t,e){let n=MG(e);for(const r of t.elements)n=n.filter(i=>!da(i,r));return{arrayValue:{values:n}}}class Yf extends pT{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function PG(t){return Xn(t.integerValue||t.doubleValue)}function MG(t){return F_(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class q_{constructor(e,n){this.field=e,this.transform=n}}class $ue{constructor(e,n){this.version=e,this.transformResults=n}}class Vn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Vn}static exists(e){return new Vn(void 0,e)}static updateTime(e){return new Vn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function gT(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class mT{}function xG(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Jf(t.key,Vn.none()):new Zf(t.key,t.data,Vn.none());{const n=t.data,r=Jr.empty();let i=new rn(Dn.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);null===o&&s.length>1&&(s=s.popLast(),o=n.field(s)),null===o?r.delete(s):r.set(s,o),i=i.add(s)}return new lu(t.key,r,new as(i.toArray()),Vn.none())}}function Hue(t,e,n){t instanceof Zf?function(i,s,o){const a=i.value.clone(),u=LG(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof lu?function(i,s,o){if(!gT(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=LG(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(OG(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):e.convertToNoDocument(n.version).setHasCommittedMutations()}function z_(t,e,n,r){return t instanceof Zf?function(s,o,a,u){if(!gT(s.precondition,o))return a;const c=s.value.clone(),h=FG(s.fieldTransforms,u,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof lu?function(s,o,a,u){if(!gT(s.precondition,o))return a;const c=FG(s.fieldTransforms,u,o),h=o.data;return h.setAll(OG(s)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null===a?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(t,e,n,r):(a=n,gT(t.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a);var o,a}function Gue(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=SG(r.transform,i||null);null!=s&&(null===n&&(n=Jr.empty()),n.set(r.field,s))}return n||null}function kG(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(r=t.fieldTransforms)&&void 0===i||r&&i&&Bf(r,i,(s,o)=>function jue(t,e){return t.field.isEqual(e.field)&&(i=e.transform,(r=t.transform)instanceof sd&&i instanceof sd||r instanceof od&&i instanceof od?Bf(r.elements,i.elements,da):r instanceof Yf&&i instanceof Yf?da(r.Pe,i.Pe):r instanceof Qf&&i instanceof Qf);var r,i}(s,o))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var r,i}class Zf extends mT{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class lu extends mT{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function OG(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function LG(t,e,n){const r=new Map;$e(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Bue(o,a,n[i]))}return r}function FG(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,Uue(s,o,e))}return r}class Jf extends mT{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class XR extends mT{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class eN{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Hue(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=z_(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=z_(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=CG();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const u=xG(o,a);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Ge.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ht())}isEqual(e){return this.batchId===e.batchId&&Bf(this.mutations,e.mutations,(n,r)=>kG(n,r))&&Bf(this.baseMutations,e.baseMutations,(n,r)=>kG(n,r))}}class tN{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){$e(e.mutations.length===r.length);let i=function(){return Lue}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new tN(e,n,r,i)}}class nN{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class que{constructor(e,n){this.count=e,this.unchangedNames=n}}var Ir,kt;function UG(t){switch(t){default:return Le();case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0}}function BG(t){if(void 0===t)return dr("GRPC error has no .code"),Q.UNKNOWN;switch(t){case Ir.OK:return Q.OK;case Ir.CANCELLED:return Q.CANCELLED;case Ir.UNKNOWN:return Q.UNKNOWN;case Ir.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case Ir.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case Ir.INTERNAL:return Q.INTERNAL;case Ir.UNAVAILABLE:return Q.UNAVAILABLE;case Ir.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case Ir.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case Ir.NOT_FOUND:return Q.NOT_FOUND;case Ir.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case Ir.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case Ir.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case Ir.ABORTED:return Q.ABORTED;case Ir.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case Ir.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case Ir.DATA_LOSS:return Q.DATA_LOSS;default:return Le()}}(kt=Ir||(Ir={}))[kt.OK=0]="OK",kt[kt.CANCELLED=1]="CANCELLED",kt[kt.UNKNOWN=2]="UNKNOWN",kt[kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",kt[kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",kt[kt.NOT_FOUND=5]="NOT_FOUND",kt[kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",kt[kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",kt[kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",kt[kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",kt[kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",kt[kt.ABORTED=10]="ABORTED",kt[kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",kt[kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",kt[kt.INTERNAL=13]="INTERNAL",kt[kt.UNAVAILABLE=14]="UNAVAILABLE",kt[kt.DATA_LOSS=15]="DATA_LOSS";function jG(){return new TextEncoder}const zue=new Xl([4294967295,4294967295],0);function $G(t){const e=jG().encode(t),n=new IH;return n.update(e),new Uint8Array(n.digest())}function HG(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Xl([n,r],0),new Xl([i,s],0)]}class rN{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new W_(`Invalid padding: ${n}`);if(r<0)throw new W_(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new W_(`Invalid hash count: ${r}`);if(0===e.length&&0!==n)throw new W_(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Xl.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Xl.fromNumber(r)));return 1===i.compare(zue)&&(i=new Xl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const n=$G(e),[r,i]=HG(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new rN(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(0===this.Ie)return;const n=$G(e),[r,i]=HG(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8);this.bitmap[n]|=1<<e%8}}class W_ extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class K_{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Q_.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new K_(Ge.min(),i,new En(st),us(),ht())}}class Q_{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Q_(r,n,ht(),ht(),ht())}}class yT{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class GG{constructor(e,n){this.targetId=e,this.me=n}}class qG{constructor(e,n,r=Jn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class zG{constructor(){this.fe=0,this.ge=KG(),this.pe=Jn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=ht(),n=ht(),r=ht();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Le()}}),new Q_(this.pe,this.ye,e,n,r)}ve(){this.we=!1,this.ge=KG()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,$e(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Wue{constructor(e){this.Le=e,this.Be=new Map,this.ke=us(),this.qe=WG(),this.Qe=new En(st)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Le()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(dT(s))if(0===r){const o=new be(s.path);this.Ue(n,o,Sn.newNoDocument(o,Ge.min()))}else $e(1===r);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),u=a?this.Xe(a,e,o):1;0!==u&&(this.je(n),this.Qe=this.Qe.insert(n,2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=au(r).toUint8Array()}catch(u){if(u instanceof YH)return os("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new rN(o,i,s)}catch(u){return os(u instanceof W_?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return 0===a.Ie?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&dT(a.target)){const u=new be(a.target.path);null!==this.ke.get(u)||this.it(o,u)||this.Ue(o,u,Sn.newNoDocument(u,e))}s.be&&(n.set(o,s.Ce()),s.ve())}});let r=ht();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.Je(u);return!c||"TargetPurposeLimboResolution"===c.purpose||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new K_(e,n,this.Qe,this.ke,r);return this.ke=us(),this.qe=WG(),this.Qe=new En(st),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new zG,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new rn(st),this.qe=this.qe.insert(e,n)),n}ze(e){const n=null!==this.Je(e);return n||me("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new zG),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function WG(){return new En(be.comparator)}function KG(){return new En(be.comparator)}const Kue={asc:"ASCENDING",desc:"DESCENDING"},Que={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Yue={and:"AND",or:"OR"};class Zue{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function iN(t,e){return t.useProto3Json||x_(e)?e:{value:e}}function Xf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function QG(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Jue(t,e){return Xf(t,e.toTimestamp())}function hr(t){return $e(!!t),Ge.fromTimestamp(function(n){const r=ou(n);return new Fn(r.seconds,r.nanos)}(t))}function sN(t,e){return oN(t,e).canonicalString()}function oN(t,e){const n=(i=t,new Dt(["projects",i.projectId,"databases",i.database])).child("documents");var i;return void 0===e?n:n.child(e)}function YG(t){const e=Dt.fromString(t);return $e(aq(e)),e}function Y_(t,e){return sN(t.databaseId,e.path)}function fa(t,e){const n=YG(e);if(n.get(1)!==t.databaseId.projectId)throw new pe(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new pe(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new be(XG(n))}function ZG(t,e){return sN(t.databaseId,e)}function JG(t){const e=YG(t);return 4===e.length?Dt.emptyPath():XG(e)}function aN(t){return new Dt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function XG(t){return $e(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function eq(t,e,n){return{name:Y_(t,e),fields:n.value.mapValue.fields}}function tq(t,e,n){const r=fa(t,e.name),i=hr(e.updateTime),s=e.createTime?hr(e.createTime):Ge.min(),o=new Jr({mapValue:{fields:e.fields}}),a=Sn.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Z_(t,e){let n;if(e instanceof Zf)n={update:eq(t,e.key,e.value)};else if(e instanceof Jf)n={delete:Y_(t,e.key)};else if(e instanceof lu)n={update:eq(t,e.key,e.data),updateMask:oce(e.fieldMask)};else{if(!(e instanceof XR))return Le();n={verify:Y_(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Qf)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof sd)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof od)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Yf)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Le()}(0,r))),e.precondition.isNone||(n.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:Jue(t,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Le()),n;var s}function uN(t,e){const n=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?Vn.updateTime(hr(s.updateTime)):void 0!==s.exists?Vn.exists(s.exists):Vn.none():Vn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;"setToServerValue"in a?($e("REQUEST_TIME"===a.setToServerValue),u=new Qf):"appendMissingElements"in a?u=new sd(a.appendMissingElements.values||[]):"removeAllFromArray"in a?u=new od(a.removeAllFromArray.values||[]):"increment"in a?u=new Yf(o,a.increment):Le();const c=Dn.fromServerFormat(a.fieldPath);return new q_(c,u)}(t,i)):[];var s;if(e.update){const i=fa(t,e.update.name),s=new Jr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new as((e.updateMask.fieldPaths||[]).map(h=>Dn.fromServerFormat(h)));return new lu(i,s,o,n,r)}return new Zf(i,s,n,r)}if(e.delete){const i=fa(t,e.delete);return new Jf(i,n)}if(e.verify){const i=fa(t,e.verify);return new XR(i,n)}return Le()}function nq(t,e){return{documents:[ZG(t,e.path)]}}function vT(t,e){const n={structuredQuery:{}},r=e.path;let i;null!==e.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ZG(t,i);const s=function(c){if(0!==c.length)return oq(tn.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(0!==c.length)return c.map(h=>{return{field:Cc((_=h).field),direction:rce(_.dir)};var _})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=iN(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt={before:(c=e.startAt).inclusive,values:c.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i};var c}function iq(t){let e=JG(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){$e(1===r);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(g){const _=sq(g);return _ instanceof tn&&WR(_)?_.getFilters():[_]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(_=>{return new U_(ep((w=_).field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction));var w}));let a=null;n.limit&&(a=function(g){let _;return _="object"==typeof g?g.value:g,x_(_)?null:_}(n.limit));let u=null;var g;n.startAt&&(u=new Tc((g=n.startAt).values||[],!!g.before));let c=null;return n.endAt&&(c=function(g){return new Tc(g.values||[],!g.before)}(n.endAt)),gG(e,i,o,s,a,"F",u,c)}function sq(t){return void 0!==t.unaryFilter?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ep(n.unaryFilter.field);return St.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ep(n.unaryFilter.field);return St.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ep(n.unaryFilter.field);return St.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ep(n.unaryFilter.field);return St.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Le()}}(t):void 0!==t.fieldFilter?St.create(ep((n=t).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Le()}}(n.fieldFilter.op),n.fieldFilter.value):void 0!==t.compositeFilter?function(n){return tn.create(n.compositeFilter.filters.map(r=>sq(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Le()}}(n.compositeFilter.op))}(t):Le();var n}function rce(t){return Kue[t]}function ice(t){return Que[t]}function sce(t){return Yue[t]}function Cc(t){return{fieldPath:t.canonicalString()}}function ep(t){return Dn.fromServerFormat(t.fieldPath)}function oq(t){return t instanceof St?function(n){if("=="===n.op){if(XH(n.value))return{unaryFilter:{field:Cc(n.field),op:"IS_NAN"}};if(JH(n.value))return{unaryFilter:{field:Cc(n.field),op:"IS_NULL"}}}else if("!="===n.op){if(XH(n.value))return{unaryFilter:{field:Cc(n.field),op:"IS_NOT_NAN"}};if(JH(n.value))return{unaryFilter:{field:Cc(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Cc(n.field),op:ice(n.op),value:n.value}}}(t):t instanceof tn?function(n){const r=n.getFilters().map(i=>oq(i));return 1===r.length?r[0]:{compositeFilter:{op:sce(n.op),filters:r}}}(t):Le()}function oce(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function aq(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class du{constructor(e,n,r,i,s=Ge.min(),o=Ge.min(),a=Jn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new du(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new du(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new du(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new du(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class uq{constructor(e){this.ct=e}}function cq(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ET(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:Y_(s=t.ct,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:Xf(s,o.version.toTimestamp()),createTime:Xf(s,o.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ad(e.version)};else{if(!e.isUnknownDocument())return Le();r.unknownDocument={path:n.path.toArray(),version:ad(e.version)}}var s,o;return r}function ET(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ad(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ud(t){const e=new Fn(t.seconds,t.nanoseconds);return Ge.fromTimestamp(e)}function cd(t,e){const n=(e.baseMutations||[]).map(s=>uN(t.ct,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>uN(t.ct,s)),i=Fn.fromMillis(e.localWriteTimeMs);return new eN(e.batchId,i,n,r)}function J_(t){const e=ud(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?ud(t.lastLimboFreeSnapshotVersion):Ge.min();let r;return r=void 0!==t.query.documents?($e(1===(s=t.query).documents.length),Ii(zf(JG(s.documents[0])))):function(s){return Ii(iq(s))}(t.query),new du(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Jn.fromBase64String(t.resumeToken));var s}function lq(t,e){const n=ad(e.snapshotVersion),r=ad(e.lastLimboFreeSnapshotVersion);let i;i=dT(e.target)?nq(t.ct,e.target):vT(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:id(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function cN(t){const e=iq({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?fT(e,e.limit,"L"):e}function lN(t,e){return new nN(e.largestBatchId,uN(t.ct,e.overlayMutation))}function dq(t,e){const n=e.path.lastSegment();return[t,Ei(e.path.popLast()),n]}function hq(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ad(r.readTime),documentKey:Ei(r.documentKey.path),largestBatchId:r.largestBatchId}}class uce{getBundleMetadata(e,n){return fq(e).get(n).next(r=>{if(r)return{id:(s=r).bundleId,createTime:ud(s.createTime),version:s.version};var s})}saveBundleMetadata(e,n){return fq(e).put({bundleId:(i=n).id,createTime:ad(hr(i.createTime)),version:i.version});var i}getNamedQuery(e,n){return pq(e).get(n).next(r=>{if(r)return{name:(s=r).name,query:cN(s.bundledQuery),readTime:ud(s.readTime)};var s})}saveNamedQuery(e,n){return pq(e).put({name:(i=n).name,readTime:ad(hr(i.readTime)),bundledQuery:i.bundledQuery});var i}}function fq(t){return Mr(t,"bundles")}function pq(t){return Mr(t,"namedQueries")}class IT{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){return new IT(e,n.uid||"")}getOverlay(e,n){return X_(e).get(dq(this.userId,n)).next(r=>r?lN(this.serializer,r):null)}getOverlays(e,n){const r=ha();return z.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new nN(n,o);i.push(this.ht(e,a))}),z.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(Ei(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(X_(e).j("collectionPathOverlayIndex",a))}),z.waitFor(s)}getOverlaysForCollection(e,n,r){const i=ha(),s=Ei(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return X_(e).U("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const c=lN(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=ha();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return X_(e).J({index:"collectionGroupOverlayIndex",range:a},(u,c,h)=>{const g=lN(this.serializer,c);s.size()<i||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):h.done()}).next(()=>s)}ht(e,n){return X_(e).put(function(i,s,o){const[a,u,c]=dq(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Z_(i.ct,o.mutation)}}(this.serializer,this.userId,n))}}function X_(t){return Mr(t,"documentOverlays")}class cce{Pt(e){return Mr(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n?.value;return r?Jn.fromUint8Array(r):Jn.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}class ld{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(Xn(e.integerValue));else if("doubleValue"in e){const r=Xn(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),k_(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),"string"==typeof r&&(r=ou(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(au(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?eG(e)?this.dt(n,Number.MAX_SAFE_INTEGER):(this.wt(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.St(e.arrayValue,n),this.ft(n)):Le()}Vt(e,n){this.dt(n,25),this.bt(e,n)}bt(e,n){n.Rt(e)}wt(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}St(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),be.fromName(e).path.forEach(r=>{this.dt(n,60),this.bt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}function lce(t){if(0===t)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function gq(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=lce(255&r[s]);if(i+=o,8!==o)break}return i}(t);return Math.ceil(e/8)}ld.Dt=new ld;class dce{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.vt(r.value),r=n.next();this.Ft()}Mt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.xt(r.value),r=n.next();this.Ot()}Nt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.vt(r);else if(r<2048)this.vt(960|r>>>6),this.vt(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.vt(480|r>>>12),this.vt(128|63&r>>>6),this.vt(128|63&r);else{const i=n.codePointAt(0);this.vt(240|i>>>18),this.vt(128|63&i>>>12),this.vt(128|63&i>>>6),this.vt(128|63&i)}}this.Ft()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.xt(r);else if(r<2048)this.xt(960|r>>>6),this.xt(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.xt(480|r>>>12),this.xt(128|63&r>>>6),this.xt(128|63&r);else{const i=n.codePointAt(0);this.xt(240|i>>>18),this.xt(128|63&i>>>12),this.xt(128|63&i>>>6),this.xt(128|63&i)}}this.Ot()}Bt(e){const n=this.kt(e),r=gq(n);this.qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Qt(e){const n=this.kt(e),r=gq(n);this.qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Kt(){this.$t(255),this.$t(255)}Ut(){this.Wt(255),this.Wt(255)}reset(){this.position=0}seed(e){this.qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Gt(){return this.buffer.slice(0,this.position)}kt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}vt(e){const n=255&e;0===n?(this.$t(0),this.$t(255)):255===n?(this.$t(255),this.$t(0)):this.$t(n)}xt(e){const n=255&e;0===n?(this.Wt(0),this.Wt(255)):255===n?(this.Wt(255),this.Wt(0)):this.Wt(e)}Ft(){this.$t(0),this.$t(1)}Ot(){this.Wt(0),this.Wt(1)}$t(e){this.qt(1),this.buffer[this.position++]=e}Wt(e){this.qt(1),this.buffer[this.position++]=~e}qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class hce{constructor(e){this.zt=e}gt(e){this.zt.Ct(e)}Rt(e){this.zt.Nt(e)}At(e){this.zt.Bt(e)}Et(){this.zt.Kt()}}class fce{constructor(e){this.zt=e}gt(e){this.zt.Mt(e)}Rt(e){this.zt.Lt(e)}At(e){this.zt.Qt(e)}Et(){this.zt.Ut()}}class ey{constructor(){this.zt=new dce,this.jt=new hce(this.zt),this.Ht=new fce(this.zt)}seed(e){this.zt.seed(e)}Jt(e){return 0===e?this.jt:this.Ht}Gt(){return this.zt.Gt()}reset(){this.zt.reset()}}class dd{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Yt(){const e=this.directionalValue.length,n=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new dd(this.indexId,this.documentKey,this.arrayValue,r)}}function Ac(t,e){let n=t.indexId-e.indexId;return 0!==n?n:(n=mq(t.arrayValue,e.arrayValue),0!==n?n:(n=mq(t.directionalValue,e.directionalValue),0!==n?n:be.comparator(t.documentKey,e.documentKey)))}function mq(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(0!==r)return r}return t.length-e.length}class _q{constructor(e){this.Zt=new rn((n,r)=>Dn.comparator(n.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Xt=e.orderBy,this.en=[];for(const n of e.filters){const r=n;r.isInequality()?this.Zt=this.Zt.add(r):this.en.push(r)}}get tn(){return this.Zt.size>1}nn(e){if($e(e.collectionGroup===this.collectionId),this.tn)return!1;const n=VR(e);if(void 0!==n&&!this.rn(n))return!1;const r=ed(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.rn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Zt.size>0){const a=this.Zt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const u=r[s];if(!this.sn(a,u)||!this.on(this.Xt[o++],u))return!1}++s}for(;s<r.length;++s)if(o>=this.Xt.length||!this.on(this.Xt[o++],r[s]))return!1;return!0}_n(){if(this.tn)return null;let e=new rn(Dn.comparator);const n=[];for(const r of this.en)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)n.push(new td(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new td(r.field,0))}for(const r of this.Xt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new td(r.field,"asc"===r.dir?0:1)));return new jf(jf.UNKNOWN_ID,this.collectionId,n,$f.empty())}rn(e){for(const n of this.en)if(this.sn(n,e))return!0;return!1}sn(e,n){return!(void 0===e||!e.field.isEqual(n.fieldPath))&&2===n.kind==("array-contains"===e.op||"array-contains-any"===e.op)}on(e,n){return!!e.field.isEqual(n.fieldPath)&&(0===n.kind&&"asc"===e.dir||1===n.kind&&"desc"===e.dir)}}function yq(t){var e,n;if($e(t instanceof St||t instanceof tn),t instanceof St){if(t instanceof hG){const i=(null===(n=null===(e=t.value.arrayValue)||void 0===e?void 0:e.values)||void 0===n?void 0:n.map(s=>St.create(t.field,"==",s)))||[];return tn.create(i,"or")}return t}const r=t.filters.map(i=>yq(i));return tn.create(r,t.op)}function pce(t){if(0===t.getFilters().length)return[];const e=fN(yq(t));return $e(vq(e)),dN(e)||hN(e)?[e]:e.getFilters()}function dN(t){return t instanceof St}function hN(t){return t instanceof tn&&WR(t)}function vq(t){return dN(t)||hN(t)||function(n){if(n instanceof tn&&zR(n)){for(const r of n.getFilters())if(!dN(r)&&!hN(r))return!1;return!0}return!1}(t)}function fN(t){if($e(t instanceof St||t instanceof tn),t instanceof St)return t;if(1===t.filters.length)return fN(t.filters[0]);const e=t.filters.map(r=>fN(r));let n=tn.create(e,t.op);return n=wT(n),vq(n)?n:($e(n instanceof tn),$e(qf(n)),$e(n.filters.length>1),n.filters.reduce((r,i)=>pN(r,i)))}function pN(t,e){let n;return $e(t instanceof St||t instanceof tn),$e(e instanceof St||e instanceof tn),n=t instanceof St?e instanceof St?tn.create([t,e],"and"):Eq(t,e):e instanceof St?Eq(e,t):function(i,s){if($e(i.filters.length>0&&s.filters.length>0),qf(i)&&qf(s))return cG(i,s.getFilters());const o=zR(i)?i:s,a=zR(i)?s:i,u=o.filters.map(c=>pN(c,a));return tn.create(u,"or")}(t,e),wT(n)}function Eq(t,e){if(qf(e))return cG(e,t.getFilters());{const n=e.filters.map(r=>pN(t,r));return tn.create(n,"or")}}function wT(t){if($e(t instanceof St||t instanceof tn),t instanceof St)return t;const e=t.getFilters();if(1===e.length)return wT(e[0]);if(aG(t))return t;const n=e.map(i=>wT(i)),r=[];return n.forEach(i=>{i instanceof St?r.push(i):i instanceof tn&&(i.op===t.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:tn.create(r,t.op)}class gce{constructor(){this.an=new gN}addToCollectionParentIndex(e,n){return this.an.add(n),z.resolve()}getCollectionParents(e,n){return z.resolve(this.an.getEntries(n))}addFieldIndex(e,n){return z.resolve()}deleteFieldIndex(e,n){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,n){return z.resolve()}getDocumentsMatchingTarget(e,n){return z.resolve(null)}getIndexType(e,n){return z.resolve(0)}getFieldIndexes(e,n){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,n){return z.resolve(Ss.min())}getMinOffsetFromCollectionGroup(e,n){return z.resolve(Ss.min())}updateCollectionGroup(e,n,r){return z.resolve()}updateIndexEntries(e,n){return z.resolve()}}class gN{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new rn(Dt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new rn(Dt.comparator)).toArray()}}const TT=new Uint8Array(0);class mce{constructor(e,n){this.databaseId=n,this.un=new gN,this.cn=new cu(r=>id(r),(r,i)=>B_(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.un.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.un.add(n)});const s={collectionId:r,parent:Ei(i)};return Iq(e).put(s)}return z.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[MH(n),""],!1,!0);return Iq(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(la(o.parent))}return r})}addFieldIndex(e,n){const r=ty(e),i={indexId:(a=n).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])};var a;delete i.indexId;const s=r.add(i);if(n.indexState){const o=np(e);return s.next(a=>{o.put(hq(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=ty(e),i=np(e),s=tp(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=ty(e),r=tp(e),i=np(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return z.forEach(this.ln(n),r=>this.getIndexType(e,r).next(i=>{if(0===i||1===i){const s=new _q(r)._n();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=tp(e);let i=!0;const s=new Map;return z.forEach(this.ln(n),o=>this.hn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ht();const a=[];return z.forEach(s,(u,c)=>{var $;me("IndexedDbIndexManager",`Using index ${$=u,`id=${$.indexId}|cg=${$.collectionGroup}|f=${$.fields.map(ie=>`${ie.fieldPath}:${ie.kind}`).join(",")}`} to execute ${id(n)}`);const h=function($,ie){const Ie=VR(ie);if(void 0===Ie)return null;for(const Pe of hT($,Ie.fieldPath))switch(Pe.op){case"array-contains-any":return Pe.value.arrayValue.values||[];case"array-contains":return[Pe.value]}return null}(c,u),g=function($,ie){const Ie=new Map;for(const Pe of ed(ie))for(const V of hT($,Pe.fieldPath))switch(V.op){case"==":case"in":Ie.set(Pe.fieldPath.canonicalString(),V.value);break;case"not-in":case"!=":return Ie.set(Pe.fieldPath.canonicalString(),V.value),Array.from(Ie.values())}return null}(c,u),_=function($,ie){const Ie=[];let Pe=!0;for(const V of ed(ie)){const R=0===V.kind?fG($,V.fieldPath,$.startAt):pG($,V.fieldPath,$.startAt);Ie.push(R.value),Pe&&(Pe=R.inclusive)}return new Tc(Ie,Pe)}(c,u),v=function($,ie){const Ie=[];let Pe=!0;for(const V of ed(ie)){const R=0===V.kind?pG($,V.fieldPath,$.endAt):fG($,V.fieldPath,$.endAt);Ie.push(R.value),Pe&&(Pe=R.inclusive)}return new Tc(Ie,Pe)}(c,u),w=this.Pn(u,c,_),b=this.Pn(u,c,v),D=this.In(u,c,g),F=this.Tn(u.indexId,h,w,_.inclusive,b,v.inclusive,D);return z.forEach(F,x=>r.G(x,n.limit).next($=>{$.forEach(ie=>{const Ie=be.fromSegments(ie.documentKey);o.has(Ie)||(o=o.add(Ie),a.push(Ie))})}))}).next(()=>a)}return z.resolve(null)})}ln(e){let n=this.cn.get(e);return n||(n=0===e.filters.length?[e]:pce(tn.create(e.filters,"and")).map(r=>QR(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.cn.set(e,n),n)}Tn(e,n,r,i,s,o,a){const u=(null!=n?n.length:1)*Math.max(r.length,s.length),c=u/(null!=n?n.length:1),h=[];for(let g=0;g<u;++g){const _=n?this.En(n[g/c]):TT,v=this.dn(e,_,r[g%c],i),w=this.An(e,_,s[g%c],o),b=a.map(D=>this.dn(e,_,D,!0));h.push(...this.createRange(v,w,b))}return h}dn(e,n,r,i){const s=new dd(e,be.empty(),n,r);return i?s:s.Yt()}An(e,n,r,i){const s=new dd(e,be.empty(),n,r);return i?s.Yt():s}hn(e,n){const r=new _q(n),i=null!=n.collectionGroup?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.nn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.ln(n);return z.forEach(i,s=>this.hn(e,s).next(o=>{o?0!==r&&o.fields.length<function(u){let c=new rn(Dn.comparator),h=!1;for(const g of u.filters)for(const _ of g.getFlattenedFilters())_.field.isKeyField()||("array-contains"===_.op||"array-contains-any"===_.op?h=!0:c=c.add(_.field));for(const g of u.orderBy)g.field.isKeyField()||(c=c.add(g.field));return c.size+(h?1:0)}(s)&&(r=1):r=0})).next(()=>null!==n.limit&&i.length>1&&2===r?1:r)}Rn(e,n){const r=new ey;for(const i of ed(e)){const s=n.data.field(i.fieldPath);if(null==s)return null;const o=r.Jt(i.kind);ld.Dt.It(s,o)}return r.Gt()}En(e){const n=new ey;return ld.Dt.It(e,n.Jt(0)),n.Gt()}Vn(e,n){const r=new ey;return ld.Dt.It(rd(this.databaseId,n),r.Jt(function(s){const o=ed(s);return 0===o.length?0:o[o.length-1].kind}(e))),r.Gt()}In(e,n,r){if(null===r)return[];let i=[];i.push(new ey);let s=0;for(const o of ed(e)){const a=r[s++];for(const u of i)if(this.mn(n,o.fieldPath)&&F_(a))i=this.fn(i,o,a);else{const c=u.Jt(o.kind);ld.Dt.It(a,c)}}return this.gn(i)}Pn(e,n,r){return this.In(e,n,r.position)}gn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Gt();return n}fn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const u=new ey;u.seed(a.Gt()),ld.Dt.It(o,u.Jt(n.kind)),s.push(u)}return s}mn(e,n){return!!e.filters.find(r=>r instanceof St&&r.field.isEqual(n)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,n){const r=ty(e),i=np(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const o=[];return z.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(h,g){const _=g?new $f(g.sequenceNumber,new Ss(ud(g.readTime),new be(la(g.documentKey)),g.largestBatchId)):$f.empty(),v=h.fields.map(([w,b])=>new td(Dn.fromServerFormat(w),b));return new jf(h.indexId,h.collectionGroup,v,_)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>0===n.length?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:st(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=ty(e),s=np(e);return this.pn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>z.forEach(a,u=>s.put(hq(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return z.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?z.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),z.forEach(a,u=>this.yn(e,i,u).next(c=>{const h=this.wn(s,u);return c.isEqual(h)?z.resolve():this.Sn(e,s,u,c,h)}))))})}bn(e,n,r,i){return tp(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Vn(r,n.key),documentKey:n.key.path.toArray()})}Dn(e,n,r,i){return tp(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Vn(r,n.key),n.key.path.toArray()])}yn(e,n,r){const i=tp(e);let s=new rn(Ac);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Vn(r,n)])},(o,a)=>{s=s.add(new dd(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}wn(e,n){let r=new rn(Ac);const i=this.Rn(n,e);if(null==i)return r;const s=VR(n);if(null!=s){const o=e.data.field(s.fieldPath);if(F_(o))for(const a of o.arrayValue.values||[])r=r.add(new dd(n.indexId,e.key,this.En(a),i))}else r=r.add(new dd(n.indexId,e.key,TT,i));return r}Sn(e,n,r,i,s){me("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(u,c,h,g,_){const v=u.getIterator(),w=c.getIterator();let b=Hf(v),D=Hf(w);for(;b||D;){let F=!1,x=!1;if(b&&D){const $=h(b,D);$<0?x=!0:$>0&&(F=!0)}else null!=b?x=!0:F=!0;F?(g(D),D=Hf(w)):x?(_(b),b=Hf(v)):(b=Hf(v),D=Hf(w))}}(i,s,Ac,a=>{o.push(this.bn(e,n,r,a))},a=>{o.push(this.Dn(e,n,r,a))}),z.waitFor(o)}pn(e){let n=1;return np(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ac(o,a)).filter((o,a,u)=>!a||0!==Ac(o,u[a-1]));const i=[];i.push(e);for(const o of r){const a=Ac(o,e),u=Ac(o,n);if(0===a)i[0]=e.Yt();else if(a>0&&u<0)i.push(o),i.push(o.Yt());else if(u>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,TT,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,TT,[]]))}return s}Cn(e,n){return Ac(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(wq)}getMinOffset(e,n){return z.mapArray(this.ln(n),r=>this.hn(e,r).next(i=>i||Le())).next(wq)}}function Iq(t){return Mr(t,"collectionParents")}function tp(t){return Mr(t,"indexEntries")}function ty(t){return Mr(t,"indexConfiguration")}function np(t){return Mr(t,"indexState")}function wq(t){$e(0!==t.length);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;UR(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Ss(e.readTime,e.documentKey,n)}const Tq={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class wi{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new wi(e,wi.DEFAULT_COLLECTION_PERCENTILE,wi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Cq(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=r.J({range:o},(h,g,_)=>(a++,_.delete()));s.push(u.next(()=>{$e(1===a)}));const c=[];for(const h of n.mutations){const g=$H(e,h.key.path,n.batchId);s.push(i.delete(g)),c.push(h.key)}return z.waitFor(s).next(()=>c)}function CT(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Le();e=t.noDocument}return JSON.stringify(e).length}wi.DEFAULT_COLLECTION_PERCENTILE=10,wi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wi.DEFAULT=new wi(41943040,wi.DEFAULT_COLLECTION_PERCENTILE,wi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wi.DISABLED=new wi(-1,0,0);class AT{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.vn={}}static lt(e,n,r,i){$e(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new AT(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bc(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=rp(e),o=bc(e);return o.add({}).next(a=>{$e("number"==typeof a);const u=new eN(a,n,r,i),c=function(v,w,b){const D=b.baseMutations.map(x=>Z_(v.ct,x)),F=b.mutations.map(x=>Z_(v.ct,x));return{userId:w,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:D,mutations:F}}(this.serializer,this.userId,u),h=[];let g=new rn((_,v)=>st(_.canonicalString(),v.canonicalString()));for(const _ of i){const v=$H(this.userId,_.key.path,a);g=g.add(_.key.path.popLast()),h.push(o.put(c)),h.push(s.put(v,rue))}return g.forEach(_=>{h.push(this.indexManager.addToCollectionParentIndex(e,_))}),e.addOnCommittedListener(()=>{this.vn[a]=u.keys()}),z.waitFor(h).next(()=>u)})}lookupMutationBatch(e,n){return bc(e).get(n).next(r=>r?($e(r.userId===this.userId),cd(this.serializer,r)):null)}Fn(e,n){return this.vn[n]?z.resolve(this.vn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.vn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return bc(e).J({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&($e(a.batchId>=r),s=cd(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return bc(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return bc(e).U("userMutationsIndex",n).next(r=>r.map(i=>cd(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=iT(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return rp(e).J({range:i},(o,a,u)=>{const[c,h,g]=o,_=la(h);if(c===this.userId&&n.path.isEqual(_))return bc(e).get(g).next(v=>{if(!v)throw Le();$e(v.userId===this.userId),s.push(cd(this.serializer,v))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new rn(st);const i=[];return n.forEach(s=>{const o=iT(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=rp(e).J({range:a},(c,h,g)=>{const[_,v,w]=c,b=la(v);_===this.userId&&s.path.isEqual(b)?r=r.add(w):g.done()});i.push(u)}),z.waitFor(i).next(()=>this.Mn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=iT(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new rn(st);return rp(e).J({range:o},(u,c,h)=>{const[g,_,v]=u,w=la(_);g===this.userId&&r.isPrefixOf(w)?w.length===i&&(a=a.add(v)):h.done()}).next(()=>this.Mn(e,a))}Mn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(bc(e).get(s).next(o=>{if(null===o)throw Le();$e(o.userId===this.userId),r.push(cd(this.serializer,o))}))}),z.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return Cq(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.xn(n.batchId)}),z.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}xn(e){delete this.vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return z.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return rp(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const u=la(s[1]);i.push(u)}else a.done()}).next(()=>{$e(0===i.length)})})}containsKey(e,n){return Aq(e,this.userId,n)}On(e){return bq(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Aq(t,e,n){const r=iT(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return rp(t).J({range:s,H:!0},(a,u,c)=>{const[h,g,_]=a;h===e&&g===i&&(o=!0),c.done()}).next(()=>o)}function bc(t){return Mr(t,"mutations")}function rp(t){return Mr(t,"documentMutations")}function bq(t){return Mr(t,"mutationQueues")}class hd{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static Ln(){return new hd(0)}static Bn(){return new hd(-1)}}class _ce{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.kn(e).next(n=>{const r=new hd(n.highestTargetId);return n.highestTargetId=r.next(),this.qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.kn(e).next(n=>Ge.fromTimestamp(new Fn(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.kn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.kn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.qn(e,i)))}addTargetData(e,n){return this.Qn(e,n).next(()=>this.kn(e).next(r=>(r.targetCount+=1,this.Kn(n,r),this.qn(e,r))))}updateTargetData(e,n){return this.Qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>ip(e).delete(n.targetId)).next(()=>this.kn(e)).next(r=>($e(r.targetCount>0),r.targetCount-=1,this.qn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return ip(e).J((o,a)=>{const u=J_(a);u.sequenceNumber<=n&&null===r.get(u.targetId)&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>z.waitFor(s)).next(()=>i)}forEachTarget(e,n){return ip(e).J((r,i)=>{const s=J_(i);n(s)})}kn(e){return Dq(e).get("targetGlobalKey").next(n=>($e(null!==n),n))}qn(e,n){return Dq(e).put("targetGlobalKey",n)}Qn(e,n){return ip(e).put(lq(this.serializer,n))}Kn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.kn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=id(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return ip(e).J({range:i,index:"queryTargetsIndex"},(o,a,u)=>{const c=J_(a);B_(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Dc(e);return n.forEach(o=>{const a=Ei(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),z.waitFor(i)}removeMatchingKeys(e,n,r){const i=Dc(e);return z.forEach(n,s=>{const o=Ei(s.path);return z.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Dc(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Dc(e);let s=ht();return i.J({range:r,H:!0},(o,a,u)=>{const c=la(o[1]),h=new be(c);s=s.add(h)}).next(()=>s)}containsKey(e,n){const r=Ei(n.path),i=IDBKeyRange.bound([r],[MH(r)],!1,!0);let s=0;return Dc(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],u,c)=>{0!==o&&(s++,c.done())}).next(()=>s>0)}ot(e,n){return ip(e).get(n).next(r=>r?J_(r):null)}}function ip(t){return Mr(t,"targets")}function Dq(t){return Mr(t,"targetGlobal")}function Dc(t){return Mr(t,"targetDocuments")}function Sq([t,e],[n,r]){const i=st(t,n);return 0===i?st(e,r):i}class yce{constructor(e){this.$n=e,this.buffer=new rn(Sq),this.Un=0}Wn(){return++this.Un}Gn(e){const n=[e,this.Wn()];if(this.buffer.size<this.$n)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Sq(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Rq{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.zn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.jn(6e4)}stop(){this.zn&&(this.zn.cancel(),this.zn=null)}get started(){return null!==this.zn}jn(e){var n=this;me("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.zn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,ne.A)(function*(){n.zn=null;try{yield n.localStore.collectGarbage(n.garbageCollector)}catch(r){_c(r)?me("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield mc(r)}yield n.jn(3e5)}))}}class vce{constructor(e,n){this.Hn=e,this.params=n}calculateTargetCount(e,n){return this.Hn.Jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(0===n)return z.resolve(Rs.oe);const r=new yce(n);return this.Hn.forEachTarget(e,i=>r.Gn(i.sequenceNumber)).next(()=>this.Hn.Yn(e,i=>r.Gn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Hn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Hn.removeOrphanedDocuments(e,n)}collect(e,n){return-1===this.params.cacheSizeCollectionThreshold?(me("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(Tq)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(me("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Tq):this.Zn(e,n))}getCacheSize(e){return this.Hn.getCacheSize(e)}Zn(e,n){let r,i,s,o,a,u,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(me("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,o=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(r=g,a=Date.now(),this.removeTargets(e,r,n))).next(g=>(s=g,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(c=Date.now(),Uf()<=Ds.$b.DEBUG&&me("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-h}ms\n\tDetermined least recently used ${i} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(u-a)+`ms\n\tRemoved ${g} documents in `+(c-u)+`ms\nTotal Duration: ${c-h}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g})))}}class Ece{constructor(e,n){this.db=e,this.garbageCollector=function Nq(t,e){return new vce(t,e)}(this,n)}Jn(e){const n=this.Xn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Xn(e){let n=0;return this.Yn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Yn(e,n){return this.er(e,(r,i)=>n(i))}addReference(e,n,r){return bT(e,r)}removeReference(e,n,r){return bT(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return bT(e,n)}tr(e,n){return function(i,s){let o=!1;return bq(i).Y(a=>Aq(i,a,s).next(u=>(u&&(o=!0),z.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.er(e,(o,a)=>{if(a<=n){const u=this.tr(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Ge.min()),Dc(e).delete([0,Ei(o.path)])))});i.push(u)}}).next(()=>z.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return bT(e,n)}er(e,n){const r=Dc(e);let i,s=Rs.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{0===o?(s!==Rs.oe&&n(new be(la(i)),s),s=c,i=u):s=Rs.oe}).next(()=>{s!==Rs.oe&&n(new be(la(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function bT(t,e){return Dc(t).put((i=t.currentSequenceNumber,{targetId:0,path:Ei(e.path),sequenceNumber:i}));var i}class Pq{constructor(){this.changes=new cu(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Sn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return void 0!==r?z.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ice{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return fd(e).put(r)}removeEntry(e,n,r){return fd(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],ET(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.nr(e,r)))}getEntry(e,n){let r=Sn.newInvalidDocument(n);return fd(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ny(n))},(i,s)=>{r=this.rr(n,s)}).next(()=>r)}ir(e,n){let r={size:0,document:Sn.newInvalidDocument(n)};return fd(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ny(n))},(i,s)=>{r={document:this.rr(n,s),size:CT(s)}}).next(()=>r)}getEntries(e,n){let r=us();return this.sr(e,n,(i,s)=>{const o=this.rr(i,s);r=r.insert(i,o)}).next(()=>r)}_r(e,n){let r=us(),i=new En(be.comparator);return this.sr(e,n,(s,o)=>{const a=this.rr(s,o);r=r.insert(s,a),i=i.insert(s,CT(o))}).next(()=>({documents:r,ar:i}))}sr(e,n,r){if(n.isEmpty())return z.resolve();let i=new rn(Oq);n.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(ny(i.first()),ny(i.last())),o=i.getIterator();let a=o.getNext();return fd(e).J({index:"documentKeyIndex",range:s},(u,c,h)=>{const g=be.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&Oq(a,g)<0;)r(a,null),a=o.getNext();a&&a.isEqual(g)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?h.$(ny(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),ET(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return fd(e).U(IDBKeyRange.bound(a,u,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let h=us();for(const g of c){const _=this.rr(be.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);_.isFoundDocument()&&($_(n,_)||i.has(_.key))&&(h=h.insert(_.key,_))}return h})}getAllFromCollectionGroup(e,n,r,i){let s=us();const o=kq(n,r),a=kq(n,Ss.max());return fd(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,h)=>{const g=this.rr(be.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(g.key,g),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new wce(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return xq(e).get("remoteDocumentGlobalKey").next(n=>($e(!!n),n))}nr(e,n){return xq(e).put("remoteDocumentGlobalKey",n)}rr(e,n){if(n){const r=function ace(t,e){let n;if(e.document)n=tq(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=be.fromSegments(e.noDocument.path),i=ud(e.noDocument.readTime);n=Sn.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Le();{const r=be.fromSegments(e.unknownDocument.path),i=ud(e.unknownDocument.version);n=Sn.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Fn(i[0],i[1]);return Ge.fromTimestamp(s)}(e.readTime)),n}(this.serializer,n);if(!r.isNoDocument()||!r.version.isEqual(Ge.min()))return r}return Sn.newInvalidDocument(e)}}function Mq(t){return new Ice(t)}class wce extends Pq{constructor(e,n){super(),this.ur=e,this.trackRemovals=n,this.cr=new cu(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new rn((s,o)=>st(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.cr.get(s);if(n.push(this.ur.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=cq(this.ur.serializer,o);i=i.add(s.path.popLast());const c=CT(u);r+=c-a.size,n.push(this.ur.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){const u=cq(this.ur.serializer,o.convertToNoDocument(Ge.min()));n.push(this.ur.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this.ur.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ur.updateMetadata(e,r)),z.waitFor(n)}getFromCache(e,n){return this.ur.ir(e,n).next(r=>(this.cr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ur._r(e,n).next(({documents:r,ar:i})=>(i.forEach((s,o)=>{this.cr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function xq(t){return Mr(t,"remoteDocumentGlobal")}function fd(t){return Mr(t,"remoteDocumentsV14")}function ny(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function kq(t,e){const n=e.documentKey.path.toArray();return[t,ET(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Oq(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=st(n[s],r[s]),i)return i;return i=st(n.length,r.length),i||(i=st(n[n.length-2],r[r.length-2]),i||st(n[n.length-1],r[r.length-1]))}class Tce{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class Lq{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(null!==r&&z_(r.mutation,i,as.empty(),Fn.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ht()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ht()){const i=ha();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=H_();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ha();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ht()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=us();const o=G_(),a=G_();return n.forEach((u,c)=>{const h=r.get(c.key);i.has(c.key)&&(void 0===h||h.mutation instanceof lu)?s=s.insert(c.key,c):void 0!==h?(o.set(c.key,h.mutation.getFieldMask()),z_(h.mutation,c,h.mutation.getFieldMask(),Fn.now())):o.set(c.key,as.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,h)=>o.set(c,h)),n.forEach((c,h)=>{var g;return a.set(c,new Tce(h,null!==(g=o.get(c))&&void 0!==g?g:null))}),a))}recalculateAndSaveOverlays(e,n){const r=G_();let i=new En((o,a)=>o-a),s=ht();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=n.get(u);if(null===c)return;let h=r.get(u)||as.empty();h=a.applyToLocalView(c,h),r.set(u,h);const g=(i.get(a.batchId)||ht()).add(u);i=i.insert(a.batchId,g)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,h=u.value,g=CG();h.forEach(_=>{if(!s.has(_)){const v=xG(n.get(_),r.get(_));null!==v&&g.set(_,v),s=s.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,g))}return z.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return be.isDocumentKey((o=n).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,n.path):YR(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i);var o}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):z.resolve(ha());let a=-1,u=s;return o.next(c=>z.forEach(c,(h,g)=>(a<g.largestBatchId&&(a=g.largestBatchId),s.get(h)?z.resolve():this.remoteDocumentCache.getEntry(e,h).next(_=>{u=u.insert(h,_)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,ht())).next(h=>({batchId:a,changes:TG(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new be(n)).next(r=>{let i=H_();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=H_();return this.indexManager.getCollectionParents(e,s).next(a=>z.forEach(a,u=>{const c=(g=n,_=u.child(s),new uu(_,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt));var g,_;return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(h=>{h.forEach((g,_)=>{o=o.insert(g,_)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{const h=c.getKey();null===o.get(h)&&(o=o.insert(h,Sn.newInvalidDocument(h)))});let a=H_();return o.forEach((u,c)=>{const h=s.get(u);void 0!==h&&z_(h.mutation,c,as.empty(),Fn.now()),$_(n,c)&&(a=a.insert(u,c))}),a})}}class Cce{constructor(e){this.serializer=e,this.lr=new Map,this.hr=new Map}getBundleMetadata(e,n){return z.resolve(this.lr.get(n))}saveBundleMetadata(e,n){return this.lr.set(n.id,{id:(i=n).id,version:i.version,createTime:hr(i.createTime)}),z.resolve();var i}getNamedQuery(e,n){return z.resolve(this.hr.get(n))}saveNamedQuery(e,n){return this.hr.set(n.name,{name:(i=n).name,query:cN(i.bundledQuery),readTime:hr(i.readTime)}),z.resolve();var i}}class Ace{constructor(){this.overlays=new En(be.comparator),this.Pr=new Map}getOverlay(e,n){return z.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ha();return z.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),z.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Pr.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Pr.delete(r)),z.resolve()}getOverlaysForCollection(e,n,r){const i=ha(),s=n.length+1,o=new be(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return z.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new En((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let h=s.get(c.largestBatchId);null===h&&(h=ha(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=ha(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=i)););return z.resolve(a)}ht(e,n,r){const i=this.overlays.get(r.key);if(null!==i){const o=this.Pr.get(i.largestBatchId).delete(r.key);this.Pr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new nN(n,r));let s=this.Pr.get(n);void 0===s&&(s=ht(),this.Pr.set(n,s)),this.Pr.set(n,s.add(r.key))}}class bce{constructor(){this.sessionToken=Jn.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,z.resolve()}}class mN{constructor(){this.Ir=new rn(Hr.Tr),this.Er=new rn(Hr.dr)}isEmpty(){return this.Ir.isEmpty()}addReference(e,n){const r=new Hr(e,n);this.Ir=this.Ir.add(r),this.Er=this.Er.add(r)}Ar(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Rr(new Hr(e,n))}Vr(e,n){e.forEach(r=>this.removeReference(r,n))}mr(e){const n=new be(new Dt([])),r=new Hr(n,e),i=new Hr(n,e+1),s=[];return this.Er.forEachInRange([r,i],o=>{this.Rr(o),s.push(o.key)}),s}gr(){this.Ir.forEach(e=>this.Rr(e))}Rr(e){this.Ir=this.Ir.delete(e),this.Er=this.Er.delete(e)}pr(e){const n=new be(new Dt([])),r=new Hr(n,e),i=new Hr(n,e+1);let s=ht();return this.Er.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Hr(e,0),r=this.Ir.firstAfterOrEqual(n);return null!==r&&e.isEqual(r.key)}}class Hr{constructor(e,n){this.key=e,this.yr=n}static Tr(e,n){return be.comparator(e.key,n.key)||st(e.yr,n.yr)}static dr(e,n){return st(e.yr,n.yr)||be.comparator(e.key,n.key)}}class Dce{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.wr=1,this.Sr=new rn(Hr.Tr)}checkEmpty(e){return z.resolve(0===this.mutationQueue.length)}addMutationBatch(e,n,r,i){const s=this.wr;this.wr++;const o=new eN(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Sr=this.Sr.add(new Hr(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return z.resolve(o)}lookupMutationBatch(e,n){return z.resolve(this.br(n))}getNextMutationBatchAfterBatchId(e,n){const i=this.Dr(n+1),s=i<0?0:i;return z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(0===this.mutationQueue.length?-1:this.wr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Hr(n,0),i=new Hr(n,Number.POSITIVE_INFINITY),s=[];return this.Sr.forEachInRange([r,i],o=>{const a=this.br(o.yr);s.push(a)}),z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new rn(st);return n.forEach(i=>{const s=new Hr(i,0),o=new Hr(i,Number.POSITIVE_INFINITY);this.Sr.forEachInRange([s,o],a=>{r=r.add(a.yr)})}),z.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;be.isDocumentKey(s)||(s=s.child(""));const o=new Hr(new be(s),0);let a=new rn(st);return this.Sr.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.yr)),!0)},o),z.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const i=this.br(r);null!==i&&n.push(i)}),n}removeMutationBatch(e,n){$e(0===this.vr(n.batchId,"removed")),this.mutationQueue.shift();let r=this.Sr;return z.forEach(n.mutations,i=>{const s=new Hr(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Sr=r})}xn(e){}containsKey(e,n){const r=new Hr(n,0),i=this.Sr.firstAfterOrEqual(r);return z.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return z.resolve()}vr(e,n){return this.Dr(e)}Dr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}br(e){const n=this.Dr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class Sce{constructor(e){this.Fr=e,this.docs=new En(be.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Fr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return z.resolve(r?r.document.mutableCopy():Sn.newInvalidDocument(n))}getEntries(e,n){let r=us();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Sn.newInvalidDocument(i))}),z.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=us();const o=n.path,a=new be(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:h}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||UR(kH(h),r)<=0||(i.has(h.key)||$_(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return z.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Le()}Mr(e,n){return z.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Rce(this)}getSize(e){return z.resolve(this.size)}}class Rce extends Pq{constructor(e){super(),this.ur=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ur.addEntry(e,i)):this.ur.removeEntry(r)}),z.waitFor(n)}getFromCache(e,n){return this.ur.getEntry(e,n)}getAllFromCache(e,n){return this.ur.getEntries(e,n)}}class Nce{constructor(e){this.persistence=e,this.Or=new cu(n=>id(n),B_),this.lastRemoteSnapshotVersion=Ge.min(),this.highestTargetId=0,this.Nr=0,this.Lr=new mN,this.targetCount=0,this.Br=hd.Ln()}forEachTarget(e,n){return this.Or.forEach((r,i)=>n(i)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.Nr)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Nr&&(this.Nr=n),z.resolve()}Qn(e){this.Or.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Br=new hd(n),this.highestTargetId=n),e.sequenceNumber>this.Nr&&(this.Nr=e.sequenceNumber)}addTargetData(e,n){return this.Qn(n),this.targetCount+=1,z.resolve()}updateTargetData(e,n){return this.Qn(n),z.resolve()}removeTargetData(e,n){return this.Or.delete(n.target),this.Lr.mr(n.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Or.forEach((o,a)=>{a.sequenceNumber<=n&&null===r.get(a.targetId)&&(this.Or.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),z.waitFor(s).next(()=>i)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,n){const r=this.Or.get(n)||null;return z.resolve(r)}addMatchingKeys(e,n,r){return this.Lr.Ar(n,r),z.resolve()}removeMatchingKeys(e,n,r){this.Lr.Vr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),z.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Lr.mr(n),z.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Lr.pr(n);return z.resolve(r)}containsKey(e,n){return z.resolve(this.Lr.containsKey(n))}}class _N{constructor(e,n){this.kr={},this.overlays={},this.qr=new Rs(0),this.Qr=!1,this.Qr=!0,this.Kr=new bce,this.referenceDelegate=e(this),this.$r=new Nce(this),this.indexManager=new gce,this.remoteDocumentCache=new Sce(r=>this.referenceDelegate.Ur(r)),this.serializer=new uq(n),this.Wr=new Cce(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Qr=!1,Promise.resolve()}get started(){return this.Qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Ace,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.kr[e.toKey()];return r||(r=new Dce(n,this.referenceDelegate),this.kr[e.toKey()]=r),r}getGlobalsCache(){return this.Kr}getTargetCache(){return this.$r}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Wr}runTransaction(e,n,r){me("MemoryPersistence","Starting transaction:",e);const i=new Pce(this.qr.next());return this.referenceDelegate.Gr(),r(i).next(s=>this.referenceDelegate.zr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}jr(e,n){return z.or(Object.values(this.kr).map(r=>()=>r.containsKey(e,n)))}}class Pce extends LH{constructor(e){super(),this.currentSequenceNumber=e}}class DT{constructor(e){this.persistence=e,this.Hr=new mN,this.Jr=null}static Yr(e){return new DT(e)}get Zr(){if(this.Jr)return this.Jr;throw Le()}addReference(e,n,r){return this.Hr.addReference(r,n),this.Zr.delete(r.toString()),z.resolve()}removeReference(e,n,r){return this.Hr.removeReference(r,n),this.Zr.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,n){return this.Zr.add(n.toString()),z.resolve()}removeTarget(e,n){this.Hr.mr(n.targetId).forEach(i=>this.Zr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Zr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Gr(){this.Jr=new Set}zr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.Zr,r=>{const i=be.fromPath(r);return this.Xr(e,i).next(s=>{s||n.removeEntry(i,Ge.min())})}).next(()=>(this.Jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Xr(e,n).next(r=>{r?this.Zr.delete(n.toString()):this.Zr.add(n.toString())})}Ur(e){return 0}Xr(e,n){return z.or([()=>z.resolve(this.Hr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.jr(e,n)])}}class Mce{constructor(e){this.serializer=e}O(e,n,r,i){const s=new rT("createOrUpgrade",n);var u;r<1&&i>=1&&(e.createObjectStore("owner"),(u=e).createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jH,{unique:!0}),u.createObjectStore("documentMutations"),Fq(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=z.resolve();return r<3&&i>=3&&(0!==r&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),Fq(e)),o=o.next(()=>function(u){const c=u.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ge.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",h)}(s))),r<4&&i>=4&&(0!==r&&(o=o.next(()=>function(u,c){return c.store("mutations").U().next(h=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jH,{unique:!0});const g=c.store("mutations"),_=h.map(v=>g.put(v));return z.waitFor(_)})}(e,s))),o=o.next(()=>{!function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(o=o.next(()=>this.ti(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ni(s)))),r<7&&i>=7&&(o=o.next(()=>this.ri(s))),r<8&&i>=8&&(o=o.next(()=>this.ii(e,s))),r<9&&i>=9&&(o=o.next(()=>{!function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(o=o.next(()=>this.si(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{!function(u){const c=u.createObjectStore("documentOverlays",{keyPath:gue});c.createIndex("collectionPathOverlayIndex",mue,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",_ue,{unique:!1})}(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){const c=u.createObjectStore("remoteDocumentsV14",{keyPath:iue});c.createIndex("documentKeyIndex",sue),c.createIndex("collectionGroupIndex",oue)}(e)).next(()=>this.oi(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this._i(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:due}).createIndex("sequenceNumberIndex",hue,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:fue}).createIndex("documentKeyIndex",pue,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{!function(u){u.createObjectStore("globals",{keyPath:"name"})}(e)})),o}ni(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=CT(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ti(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>z.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>z.forEach(a,u=>{$e(u.userId===s.userId);const c=cd(this.serializer,u);return Cq(e,s.userId,c).next(()=>{})}))}))}ri(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const u=new Dt(o),c=[0,Ei(u)];s.push(n.get(c).next(h=>h?z.resolve():n.put({targetId:0,path:Ei(u),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>z.waitFor(s))})}ii(e,n){e.createObjectStore("collectionParents",{keyPath:lue});const r=n.store("collectionParents"),i=new gN,s=o=>{if(i.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Ei(u)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const u=new Dt(o);return s(u.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,u],c)=>{const h=la(a);return s(h.popLast())}))}si(e){const n=e.store("targets");return n.J((r,i)=>{const s=J_(i),o=lq(this.serializer,s);return n.put(o)})}oi(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=n.store("remoteDocumentsV14"),u=(g=o,g.document?new be(Dt.fromString(g.document.name).popFirst(5)):g.noDocument?be.fromSegments(g.noDocument.path):g.unknownDocument?be.fromSegments(g.unknownDocument.path):Le()).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};var g;i.push(a.put(c))}).next(()=>z.waitFor(i))}_i(e,n){const r=n.store("mutations"),i=Mq(this.serializer),s=new _N(DT.Yr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(u=>{var c;let h=null!==(c=a.get(u.userId))&&void 0!==c?c:ht();cd(this.serializer,u).keys().forEach(g=>h=h.add(g)),a.set(u.userId,h)}),z.forEach(a,(u,c)=>{const h=new $r(c),g=IT.lt(this.serializer,h),_=s.getIndexManager(h),v=AT.lt(h,this.serializer,_,s.referenceDelegate);return new Lq(i,v,g,_).recalculateAndSaveOverlaysForDocumentKeys(new HR(n,Rs.oe),u).next()})})}}function Fq(t){t.createObjectStore("targetDocuments",{keyPath:uue}).createIndex("documentTargetsIndex",cue,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",aue,{unique:!0}),t.createObjectStore("targetGlobal")}const yN="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class vN{constructor(e,n,r,i,s,o,a,u,c,h,g=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ai=s,this.window=o,this.document=a,this.ui=c,this.ci=h,this.li=g,this.qr=null,this.Qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.hi=null,this.inForeground=!1,this.Pi=null,this.Ii=null,this.Ti=Number.NEGATIVE_INFINITY,this.Ei=_=>Promise.resolve(),!vN.D())throw new pe(Q.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ece(this,i),this.di=n+"main",this.serializer=new uq(u),this.Ai=new ca(this.di,this.li,new Mce(this.serializer)),this.Kr=new cce,this.$r=new _ce(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Mq(this.serializer),this.Wr=new uce,this.window&&this.window.localStorage?this.Ri=this.window.localStorage:(this.Ri=null,!1===h&&dr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Vi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new pe(Q.FAILED_PRECONDITION,yN);return this.mi(),this.fi(),this.gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.$r.getHighestSequenceNumber(e))}).then(e=>{this.qr=new Rs(e,this.ui)}).then(()=>{this.Qr=!0}).catch(e=>(this.Ai&&this.Ai.close(),Promise.reject(e)))}pi(e){var n=this;return this.Ei=function(){var r=(0,ne.A)(function*(i){if(n.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ai.L(function(){var n=(0,ne.A)(function*(r){null===r.newVersion&&(yield e())});return function(r){return n.apply(this,arguments)}}())}setNetworkEnabled(e){var n=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ai.enqueueAndForget((0,ne.A)(function*(){n.started&&(yield n.Vi())})))}Vi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>RT(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.yi(e).next(n=>{n||(this.isPrimary=!1,this.ai.enqueueRetryable(()=>this.Ei(!1)))})}).next(()=>this.wi(e)).next(n=>this.isPrimary&&!n?this.Si(e).next(()=>!1):!!n&&this.bi(e).next(()=>!0))).catch(e=>{if(_c(e))return me("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return me("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ai.enqueueRetryable(()=>this.Ei(e)),this.isPrimary=e})}yi(e){return ry(e).get("owner").next(n=>z.resolve(this.Di(n)))}Ci(e){return RT(e).delete(this.clientId)}vi(){var e=this;return(0,ne.A)(function*(){if(e.isPrimary&&!e.Fi(e.Ti,18e5)){e.Ti=Date.now();const n=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Mr(r,"clientMetadata");return i.U().next(s=>{const o=e.Mi(s,18e5),a=s.filter(u=>-1===o.indexOf(u));return z.forEach(a,u=>i.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(e.Ri)for(const r of n)e.Ri.removeItem(e.xi(r.clientId))}})()}gi(){this.Ii=this.ai.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Vi().then(()=>this.vi()).then(()=>this.gi()))}Di(e){return!!e&&e.ownerId===this.clientId}wi(e){return this.ci?z.resolve(!0):ry(e).get("owner").next(n=>{if(null!==n&&this.Fi(n.leaseTimestampMs,5e3)&&!this.Oi(n.ownerId)){if(this.Di(n)&&this.networkEnabled)return!0;if(!this.Di(n)){if(!n.allowTabSynchronization)throw new pe(Q.FAILED_PRECONDITION,yN);return!1}}return!(!this.networkEnabled||!this.inForeground)||RT(e).U().next(r=>void 0===this.Mi(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(n=>(this.isPrimary!==n&&me("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){var e=this;return(0,ne.A)(function*(){e.Qr=!1,e.Ni(),e.Ii&&(e.Ii.cancel(),e.Ii=null),e.Li(),e.Bi(),yield e.Ai.runTransaction("shutdown","readwrite",["owner","clientMetadata"],n=>{const r=new HR(n,Rs.oe);return e.Si(r).next(()=>e.Ci(r))}),e.Ai.close(),e.ki()})()}Mi(e,n){return e.filter(r=>this.Fi(r.updateTimeMs,n)&&!this.Oi(r.clientId))}qi(){return this.runTransaction("getActiveClients","readonly",e=>RT(e).U().next(n=>this.Mi(n,18e5).map(r=>r.clientId)))}get started(){return this.Qr}getGlobalsCache(){return this.Kr}getMutationQueue(e,n){return AT.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.$r}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new mce(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return IT.lt(this.serializer,e)}getBundleCache(){return this.Wr}runTransaction(e,n,r){me("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===n?"readonly":"readwrite",s=17===(u=this.li)?Eue:16===u?vue:15===u?$R:14===u?qH:13===u?GH:12===u?yue:11===u?HH:void Le();var u;let o;return this.Ai.runTransaction(e,i,s,a=>(o=new HR(a,this.qr?this.qr.next():Rs.oe),"readwrite-primary"===n?this.yi(o).next(u=>!!u||this.wi(o)).next(u=>{if(!u)throw dr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ai.enqueueRetryable(()=>this.Ei(!1)),new pe(Q.FAILED_PRECONDITION,OH);return r(o)}).next(u=>this.bi(o).next(()=>u)):this.Qi(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Qi(e){return ry(e).get("owner").next(n=>{if(null!==n&&this.Fi(n.leaseTimestampMs,5e3)&&!this.Oi(n.ownerId)&&!this.Di(n)&&!(this.ci||this.allowTabSynchronization&&n.allowTabSynchronization))throw new pe(Q.FAILED_PRECONDITION,yN)})}bi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ry(e).put("owner",n)}static D(){return ca.D()}Si(e){const n=ry(e);return n.get("owner").next(r=>this.Di(r)?(me("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):z.resolve())}Fi(e,n){const r=Date.now();return!(e<r-n||e>r&&(dr(`Detected an update time that is in the future: ${e} > ${r}`),1))}mi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Pi=()=>{this.ai.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Vi()))},this.document.addEventListener("visibilitychange",this.Pi),this.inForeground="visible"===this.document.visibilityState)}Li(){this.Pi&&(this.document.removeEventListener("visibilitychange",this.Pi),this.Pi=null)}fi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.hi=()=>{this.Ni();const n=/(?:Version|Mobile)\/1[456]/;(0,A.nr)()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ai.enterRestrictedMode(!0),this.ai.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.hi))}Bi(){this.hi&&(this.window.removeEventListener("pagehide",this.hi),this.hi=null)}Oi(e){var n;try{const r=null!==(null===(n=this.Ri)||void 0===n?void 0:n.getItem(this.xi(e)));return me("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return dr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ni(){if(this.Ri)try{this.Ri.setItem(this.xi(this.clientId),String(Date.now()))}catch(e){dr("Failed to set zombie client id.",e)}}ki(){if(this.Ri)try{this.Ri.removeItem(this.xi(this.clientId))}catch{}}xi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ry(t){return Mr(t,"owner")}function RT(t){return Mr(t,"clientMetadata")}function EN(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class IN{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Ki=r,this.$i=i}static Ui(e,n){let r=ht(),i=ht();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new IN(e,n.fromCache,r,i)}}class xce{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Vq{constructor(){this.Wi=!1,this.Gi=!1,this.zi=100,this.ji=(0,A.nr)()?8:FH((0,A.ZQ)())>0?6:4}initialize(e,n){this.Hi=e,this.indexManager=n,this.Wi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Yi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new xce;return this.Zi(e,n,o).next(a=>{if(s.result=a,this.Gi)return this.Xi(e,n,o,a.size)})}).next(()=>s.result)}Xi(e,n,r,i){return r.documentReadCount<this.zi?(Uf()<=Ds.$b.DEBUG&&me("QueryEngine","SDK will not create cache indexes for query:",Kf(n),"since it only creates cache indexes for collection contains","more than or equal to",this.zi,"documents"),z.resolve()):(Uf()<=Ds.$b.DEBUG&&me("QueryEngine","Query:",Kf(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ji*i?(Uf()<=Ds.$b.DEBUG&&me("QueryEngine","The SDK decides to create cache indexes for query:",Kf(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ii(n))):z.resolve())}Ji(e,n){if(mG(n))return z.resolve(null);let r=Ii(n);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==n.limit&&1===i&&(n=fT(n,null,"F"),r=Ii(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ht(...s);return this.Hi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.es(n,a);return this.ts(n,c,o,u.readTime)?this.Ji(e,fT(n,null,"F")):this.ns(e,c,n,u)}))})))}Yi(e,n,r,i){return mG(n)||i.isEqual(Ge.min())?z.resolve(null):this.Hi.getDocuments(e,r).next(s=>{const o=this.es(n,s);return this.ts(n,o,r,i)?z.resolve(null):(Uf()<=Ds.$b.DEBUG&&me("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Kf(n)),this.ns(e,o,n,xH(i,-1)).next(a=>a))})}es(e,n){let r=new rn(IG(e));return n.forEach((i,s)=>{$_(e,s)&&(r=r.add(s))}),r}ts(e,n,r,i){if(null===e.limit)return!1;if(r.size!==n.size)return!0;const s="F"===e.limitType?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Zi(e,n,r){return Uf()<=Ds.$b.DEBUG&&me("QueryEngine","Using full collection scan to execute query:",Kf(n)),this.Hi.getDocumentsMatchingQuery(e,n,Ss.min(),r)}ns(e,n,r,i){return this.Hi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}class kce{constructor(e,n,r,i){this.persistence=e,this.rs=n,this.serializer=i,this.ss=new En(st),this.os=new cu(s=>id(s),B_),this._s=new Map,this.us=e.getRemoteDocumentCache(),this.$r=e.getTargetCache(),this.Wr=e.getBundleCache(),this.cs(r)}cs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Lq(this.us,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.us.setIndexManager(this.indexManager),this.rs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ss))}}function Uq(t,e,n,r){return new kce(t,e,n,r)}function Bq(t,e){return wN.apply(this,arguments)}function wN(){return(wN=(0,ne.A)(function*(t,e){const n=Te(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.cs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let u=ht();for(const c of i){o.push(c.batchId);for(const h of c.mutations)u=u.add(h.key)}for(const c of s){a.push(c.batchId);for(const h of c.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(c=>({ls:c,removedBatchIds:o,addedBatchIds:a}))})})})).apply(this,arguments)}function jq(t){const e=Te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.$r.getLastRemoteSnapshotVersion(n))}function $q(t,e,n){let r=ht(),i=ht();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=us();return n.forEach((a,u)=>{const c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(Ge.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||0===u.version.compareTo(c.version)&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):me("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{hs:o,Ps:i}})}function Fce(t,e){const n=Te(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function sp(t,e){const n=Te(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.$r.getTargetData(r,e).next(s=>s?(i=s,z.resolve(i)):n.$r.allocateTargetId(r).next(o=>(i=new du(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.$r.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.ss.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ss=n.ss.insert(r.targetId,r),n.os.set(e,r.targetId)),r})}function op(t,e,n){return TN.apply(this,arguments)}function TN(){return(TN=(0,ne.A)(function*(t,e,n){const r=Te(t),i=r.ss.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!_c(o))throw o;me("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ss=r.ss.remove(e),r.os.delete(i.target)})).apply(this,arguments)}function NT(t,e,n){const r=Te(t);let i=Ge.min(),s=ht();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,h){const g=Te(u),_=g.os.get(h);return void 0!==_?z.resolve(g.ss.get(_)):g.$r.getTargetData(c,h)}(r,o,Ii(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.$r.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.rs.getDocumentsMatchingQuery(o,e,n?i:Ge.min(),n?s:ht())).next(a=>(qq(r,EG(e),a),{documents:a,Is:s})))}function Hq(t,e){const n=Te(t),r=Te(n.$r),i=n.ss.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function Gq(t,e){const n=Te(t),r=n._s.get(e)||Ge.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.us.getAllFromCollectionGroup(i,e,xH(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(qq(n,e,i),i))}function qq(t,e,n){let r=t._s.get(e)||Ge.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t._s.set(e,r)}function CN(){return(CN=(0,ne.A)(function*(t,e,n,r){const i=Te(t);let s=ht(),o=us();for(const c of n){const h=e.Ts(c.metadata.name);c.document&&(s=s.add(h));const g=e.Es(c);g.setReadTime(e.ds(c.metadata.readTime)),o=o.insert(h,g)}const a=i.us.newChangeBuffer({trackRemovals:!0}),u=yield sp(i,(h=r,Ii(zf(Dt.fromString(`__bundle__/docs/${h}`)))));var h;return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>$q(c,a,o).next(h=>(a.apply(c),h)).next(h=>i.$r.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.$r.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,h.hs,h.Ps)).next(()=>h.hs)))})).apply(this,arguments)}function Uce(t,e){return AN.apply(this,arguments)}function AN(){return(AN=(0,ne.A)(function*(t,e,n=ht()){const r=yield sp(t,Ii(cN(e.bundledQuery))),i=Te(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=hr(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Wr.saveNamedQuery(s,e);const a=r.withResumeToken(Jn.EMPTY_BYTE_STRING,o);return i.ss=i.ss.insert(a.targetId,a),i.$r.updateTargetData(s,a).next(()=>i.$r.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.$r.addMatchingKeys(s,n,r.targetId)).next(()=>i.Wr.saveNamedQuery(s,e))})})).apply(this,arguments)}function zq(t,e){return`firestore_clients_${t}_${e}`}function Wq(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function bN(t,e){return`firestore_targets_${t}_${e}`}class PT{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static As(e,n,r){const i=JSON.parse(r);let s,o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(s=new pe(i.error.code,i.error.message))),o?new PT(e,n,i.state,s):(dr("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Rs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class iy{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static As(e,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new pe(r.error.code,r.error.message))),s?new iy(e,r.state,i):(dr("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Rs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class MT{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static As(e,n){const r=JSON.parse(n);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=JR();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=UH(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new MT(e,s):(dr("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class DN{constructor(e,n){this.clientId=e,this.onlineState=n}static As(e){const n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new DN(n.clientId,n.onlineState):(dr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class SN{constructor(){this.activeTargetIds=JR()}Vs(e){this.activeTargetIds=this.activeTargetIds.add(e)}fs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Rs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class RN{constructor(e,n,r,i,s){this.window=e,this.ai=n,this.persistenceKey=r,this.gs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ps=this.ys.bind(this),this.ws=new En(st),this.started=!1,this.Ss=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.bs=zq(this.persistenceKey,this.gs),this.Ds=`firestore_sequence_number_${this.persistenceKey}`,this.ws=this.ws.insert(this.gs,new SN),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.vs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Fs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Ms=`firestore_online_state_${this.persistenceKey}`,this.xs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ps)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,ne.A)(function*(){const n=yield e.syncEngine.qi();for(const i of n){if(i===e.gs)continue;const s=e.getItem(zq(e.persistenceKey,i));if(s){const o=MT.As(i,s);o&&(e.ws=e.ws.insert(o.clientId,o))}}e.Os();const r=e.storage.getItem(e.Ms);if(r){const i=e.Ns(r);i&&e.Ls(i)}for(const i of e.Ss)e.ys(i);e.Ss=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Ds,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Bs(this.ws)}isActiveQueryTarget(e){let n=!1;return this.ws.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.ks(e,"pending")}updateMutationState(e,n,r){this.ks(e,n,r),this.qs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(bN(this.persistenceKey,e));if(r){const i=iy.As(e,r);i&&(n=i.state)}}return this.Qs.Vs(e),this.Os(),n}removeLocalQueryTarget(e){this.Qs.fs(e),this.Os()}isLocalQueryTarget(e){return this.Qs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(bN(this.persistenceKey,e))}updateQueryState(e,n,r){this.Ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.$s(e)}notifyBundleLoaded(e){this.Us(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ps),this.removeItem(this.bs),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return me("SharedClientState","READ",e,n),n}setItem(e,n){me("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){me("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ys(e){var n=this;const r=e;if(r.storageArea===this.storage){if(me("SharedClientState","EVENT",r.key,r.newValue),r.key===this.bs)return void dr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ai.enqueueRetryable((0,ne.A)(function*(){if(n.started){if(null!==r.key)if(n.Cs.test(r.key)){if(null==r.newValue){const i=n.Ws(r.key);return n.Gs(i,null)}{const i=n.zs(r.key,r.newValue);if(i)return n.Gs(i.clientId,i)}}else if(n.vs.test(r.key)){if(null!==r.newValue){const i=n.js(r.key,r.newValue);if(i)return n.Hs(i)}}else if(n.Fs.test(r.key)){if(null!==r.newValue){const i=n.Js(r.key,r.newValue);if(i)return n.Ys(i)}}else if(r.key===n.Ms){if(null!==r.newValue){const i=n.Ns(r.newValue);if(i)return n.Ls(i)}}else if(r.key===n.Ds){const i=function(o){let a=Rs.oe;if(null!=o)try{const u=JSON.parse(o);$e("number"==typeof u),a=u}catch(u){dr("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(r.newValue);i!==Rs.oe&&n.sequenceNumberHandler(i)}else if(r.key===n.xs){const i=n.Zs(r.newValue);yield Promise.all(i.map(s=>n.syncEngine.Xs(s)))}}else n.Ss.push(r)}))}}get Qs(){return this.ws.get(this.gs)}Os(){this.setItem(this.bs,this.Qs.Rs())}ks(e,n,r){const i=new PT(this.currentUser,e,n,r),s=Wq(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Rs())}qs(e){const n=Wq(this.persistenceKey,this.currentUser,e);this.removeItem(n)}$s(e){this.storage.setItem(this.Ms,JSON.stringify({clientId:this.gs,onlineState:e}))}Ks(e,n,r){const i=bN(this.persistenceKey,e),s=new iy(e,n,r);this.setItem(i,s.Rs())}Us(e){const n=JSON.stringify(Array.from(e));this.setItem(this.xs,n)}Ws(e){const n=this.Cs.exec(e);return n?n[1]:null}zs(e,n){const r=this.Ws(e);return MT.As(r,n)}js(e,n){const r=this.vs.exec(e),i=Number(r[1]);return PT.As(new $r(void 0!==r[2]?r[2]:null),i,n)}Js(e,n){const r=this.Fs.exec(e),i=Number(r[1]);return iy.As(i,n)}Ns(e){return DN.As(e)}Zs(e){return JSON.parse(e)}Hs(e){var n=this;return(0,ne.A)(function*(){if(e.user.uid===n.currentUser.uid)return n.syncEngine.eo(e.batchId,e.state,e.error);me("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Ys(e){return this.syncEngine.no(e.targetId,e.state,e.error)}Gs(e,n){const r=n?this.ws.insert(e,n):this.ws.remove(e),i=this.Bs(this.ws),s=this.Bs(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.ro(o,a).then(()=>{this.ws=r})}Ls(e){this.ws.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Bs(e){let n=JR();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class Kq{constructor(){this.io=new SN,this.so={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.io.Vs(e),this.so[e]||"not-current"}updateQueryState(e,n,r){this.so[e]=n}removeLocalQueryTarget(e){this.io.fs(e)}isLocalQueryTarget(e){return this.io.activeTargetIds.has(e)}clearQueryState(e){delete this.so[e]}getAllActiveQueryTargets(){return this.io.activeTargetIds}isActiveQueryTarget(e){return this.io.activeTargetIds.has(e)}start(){return this.io=new SN,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Bce{oo(e){}shutdown(){}}class Qq{constructor(){this._o=()=>this.ao(),this.uo=()=>this.co(),this.lo=[],this.ho()}oo(e){this.lo.push(e)}shutdown(){window.removeEventListener("online",this._o),window.removeEventListener("offline",this.uo)}ho(){window.addEventListener("online",this._o),window.addEventListener("offline",this.uo)}ao(){me("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.lo)e(0)}co(){me("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.lo)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let xT=null;function NN(){return null===xT?xT=268435456+Math.round(2147483648*Math.random()):xT++,"0x"+xT.toString(16)}const jce={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class $ce{constructor(e){this.Po=e.Po,this.Io=e.Io}To(e){this.Eo=e}Ao(e){this.Ro=e}Vo(e){this.mo=e}onMessage(e){this.fo=e}close(){this.Io()}send(e){this.Po(e)}po(){this.Eo()}yo(){this.Ro()}wo(e){this.mo(e)}So(e){this.fo(e)}}const Ti="WebChannelConnection";class Hce extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.bo=r+"://"+n.host,this.Do=`projects/${i}/databases/${s}`,this.Co="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get vo(){return!1}Fo(n,r,i,s,o){const a=NN(),u=this.Mo(n,r.toUriEncodedString());me("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);const c={"google-cloud-resource-prefix":this.Do,"x-goog-request-params":this.Co};return this.xo(c,s,o),this.Oo(n,u,c,i).then(h=>(me("RestConnection",`Received RPC '${n}' ${a}: `,h),h),h=>{throw os("RestConnection",`RPC '${n}' ${a} failed with error: `,h,"url: ",u,"request:",i),h})}No(n,r,i,s,o,a){return this.Fo(n,r,i,s,o)}xo(n,r,i){n["X-Goog-Api-Client"]="gl-js/ fire/"+Vf,n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}Mo(n,r){return`${this.bo}/v1/${r}:${jce[n]}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Oo(e,n,r,i){const s=NN();return new Promise((o,a)=>{const u=new wH;u.setWithCredentials(!0),u.listenOnce(CH.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case nT.NO_ERROR:const h=u.getResponseJson();me(Ti,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case nT.TIMEOUT:me(Ti,`RPC '${e}' ${s} timed out`),a(new pe(Q.DEADLINE_EXCEEDED,"Request time out"));break;case nT.HTTP_ERROR:const g=u.getStatus();if(me(Ti,`RPC '${e}' ${s} failed with status:`,g,"response text:",u.getResponseText()),g>0){let _=u.getResponseJson();Array.isArray(_)&&(_=_[0]);const v=_?.error;if(v&&v.status&&v.message){const w=function(D){const F=D.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(F)>=0?F:Q.UNKNOWN}(v.status);a(new pe(w,v.message))}else a(new pe(Q.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new pe(Q.UNAVAILABLE,"Connection failed."));break;default:Le()}}finally{me(Ti,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);me(Ti,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}Lo(e,n,r){const i=NN(),s=[this.bo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=DH(),a=bH(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.xmlHttpFactory=new TH({})),this.xo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=s.join("");me(Ti,`Creating RPC '${e}' stream ${i}: ${h}`,u);const g=o.createWebChannel(h,u);let _=!1,v=!1;const w=new $ce({Po:D=>{v?me(Ti,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(_||(me(Ti,`Opening RPC '${e}' stream ${i} transport.`),g.open(),_=!0),me(Ti,`RPC '${e}' stream ${i} sending:`,D),g.send(D))},Io:()=>g.close()}),b=(D,F,x)=>{D.listen(F,$=>{try{x($)}catch(ie){setTimeout(()=>{throw ie},0)}})};return b(g,N_.EventType.OPEN,()=>{v||(me(Ti,`RPC '${e}' stream ${i} transport opened.`),w.po())}),b(g,N_.EventType.CLOSE,()=>{v||(v=!0,me(Ti,`RPC '${e}' stream ${i} transport closed`),w.wo())}),b(g,N_.EventType.ERROR,D=>{v||(v=!0,os(Ti,`RPC '${e}' stream ${i} transport errored:`,D),w.wo(new pe(Q.UNAVAILABLE,"The operation could not be completed")))}),b(g,N_.EventType.MESSAGE,D=>{var F;if(!v){const x=D.data[0];$e(!!x);const ie=x.error||(null===(F=x[0])||void 0===F?void 0:F.error);if(ie){me(Ti,`RPC '${e}' stream ${i} received error:`,ie);const Ie=ie.status;let Pe=function(k){const U=Ir[k];if(void 0!==U)return BG(U)}(Ie),V=ie.message;void 0===Pe&&(Pe=Q.INTERNAL,V="Unknown error status: "+Ie+" with message "+ie.message),v=!0,w.wo(new pe(Pe,V)),g.close()}else me(Ti,`RPC '${e}' stream ${i} received:`,x),w.So(x)}}),b(a,AH.STAT_EVENT,D=>{D.stat===LR.PROXY?me(Ti,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===LR.NOPROXY&&me(Ti,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.yo()},0),w}}function Yq(){return typeof window<"u"?window:null}function kT(){return typeof document<"u"?document:null}function sy(t){return new Zue(t,!0)}class PN{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ai=e,this.timerId=n,this.Bo=r,this.ko=i,this.qo=s,this.Qo=0,this.Ko=null,this.$o=Date.now(),this.reset()}reset(){this.Qo=0}Uo(){this.Qo=this.qo}Wo(e){this.cancel();const n=Math.floor(this.Qo+this.Go()),r=Math.max(0,Date.now()-this.$o),i=Math.max(0,n-r);i>0&&me("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Qo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Ko=this.ai.enqueueAfterDelay(this.timerId,i,()=>(this.$o=Date.now(),e())),this.Qo*=this.ko,this.Qo<this.Bo&&(this.Qo=this.Bo),this.Qo>this.qo&&(this.Qo=this.qo)}zo(){null!==this.Ko&&(this.Ko.skipDelay(),this.Ko=null)}cancel(){null!==this.Ko&&(this.Ko.cancel(),this.Ko=null)}Go(){return(Math.random()-.5)*this.Qo}}class Zq{constructor(e,n,r,i,s,o,a,u){this.ai=e,this.jo=r,this.Ho=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Jo=0,this.Yo=null,this.Zo=null,this.stream=null,this.Xo=0,this.e_=new PN(e,n)}t_(){return 1===this.state||5===this.state||this.n_()}n_(){return 2===this.state||3===this.state}start(){this.Xo=0,4!==this.state?this.auth():this.r_()}stop(){var e=this;return(0,ne.A)(function*(){e.t_()&&(yield e.close(0))})()}i_(){this.state=0,this.e_.reset()}s_(){this.n_()&&null===this.Yo&&(this.Yo=this.ai.enqueueAfterDelay(this.jo,6e4,()=>this.o_()))}__(e){this.a_(),this.stream.send(e)}o_(){var e=this;return(0,ne.A)(function*(){if(e.n_())return e.close(0)})()}a_(){this.Yo&&(this.Yo.cancel(),this.Yo=null)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}close(e,n){var r=this;return(0,ne.A)(function*(){r.a_(),r.u_(),r.e_.cancel(),r.Jo++,4!==e?r.e_.reset():n&&n.code===Q.RESOURCE_EXHAUSTED?(dr(n.toString()),dr("Using maximum backoff delay to prevent overloading the backend."),r.e_.Uo()):n&&n.code===Q.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.c_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Vo(n)})()}c_(){}auth(){this.state=1;const e=this.l_(this.Jo),n=this.Jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Jo===n&&this.h_(r,i)},r=>{e(()=>{const i=new pe(Q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.P_(i)})})}h_(e,n){const r=this.l_(this.Jo);this.stream=this.I_(e,n),this.stream.To(()=>{r(()=>this.listener.To())}),this.stream.Ao(()=>{r(()=>(this.state=2,this.Zo=this.ai.enqueueAfterDelay(this.Ho,1e4,()=>(this.n_()&&(this.state=3),Promise.resolve())),this.listener.Ao()))}),this.stream.Vo(i=>{r(()=>this.P_(i))}),this.stream.onMessage(i=>{r(()=>1==++this.Xo?this.T_(i):this.onNext(i))})}r_(){var e=this;this.state=5,this.e_.Wo((0,ne.A)(function*(){e.state=0,e.start()}))}P_(e){return me("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}l_(e){return n=>{this.ai.enqueueAndForget(()=>this.Jo===e?n():(me("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Gce extends Zq{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}I_(e,n){return this.connection.Lo("Listen",e,n)}T_(e){return this.onNext(e)}onNext(e){this.e_.reset();const n=function ece(t,e){let n;if("targetChange"in e){const r="NO_CHANGE"===(c=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===c?1:"REMOVE"===c?2:"CURRENT"===c?3:"RESET"===c?4:Le(),i=e.targetChange.targetIds||[],s=function(c,h){return c.useProto3Json?($e(void 0===h||"string"==typeof h),Jn.fromBase64String(h||"")):($e(void 0===h||h instanceof Buffer||h instanceof Uint8Array),Jn.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const h=void 0===c.code?Q.UNKNOWN:BG(c.code);return new pe(h,c.message||"")}(o);n=new qG(r,i,s,a||null)}else if("documentChange"in e){const r=e.documentChange,i=fa(t,r.document.name),s=hr(r.document.updateTime),o=r.document.createTime?hr(r.document.createTime):Ge.min(),a=new Jr({mapValue:{fields:r.document.fields}}),u=Sn.newFoundDocument(i,s,o,a);n=new yT(r.targetIds||[],r.removedTargetIds||[],u.key,u)}else if("documentDelete"in e){const r=e.documentDelete,i=fa(t,r.document),s=r.readTime?hr(r.readTime):Ge.min(),o=Sn.newNoDocument(i,s);n=new yT([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,i=fa(t,r.document);n=new yT([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return Le();{const r=e.filter,{count:i=0,unchangedNames:s}=r,o=new que(i,s);n=new GG(r.targetId,o)}}var c;return n}(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ge.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ge.min():o.readTime?hr(o.readTime):Ge.min()}(e);return this.listener.E_(n,r)}d_(e){const n={};n.database=aN(this.serializer),n.addTarget=function(s,o){let a;const u=o.target;if(a=dT(u)?{documents:nq(s,u)}:{query:vT(s,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=QG(s,o.resumeToken);const c=iN(s,o.expectedCount);null!==c&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(Ge.min())>0){a.readTime=Xf(s,o.snapshotVersion.toTimestamp());const c=iN(s,o.expectedCount);null!==c&&(a.expectedCount=c)}return a}(this.serializer,e);const r=function nce(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);r&&(n.labels=r),this.__(n)}A_(e){const n={};n.database=aN(this.serializer),n.removeTarget=e,this.__(n)}}class qce extends Zq{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get R_(){return this.Xo>0}start(){this.lastStreamToken=void 0,super.start()}c_(){this.R_&&this.V_([])}I_(e,n){return this.connection.Lo("Write",e,n)}T_(e){return $e(!!e.streamToken),this.lastStreamToken=e.streamToken,$e(!e.writeResults||0===e.writeResults.length),this.listener.m_()}onNext(e){$e(!!e.streamToken),this.lastStreamToken=e.streamToken,this.e_.reset();const n=function tce(t,e){return t&&t.length>0?($e(void 0!==e),t.map(n=>function(i,s){let o=hr(i.updateTime?i.updateTime:s);return o.isEqual(Ge.min())&&(o=hr(s)),new $ue(o,i.transformResults||[])}(n,e))):[]}(e.writeResults,e.commitTime),r=hr(e.commitTime);return this.listener.f_(r,n)}g_(){const e={};e.database=aN(this.serializer),this.__(e)}V_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Z_(this.serializer,r))};this.__(n)}}class zce extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.p_=!1}y_(){if(this.p_)throw new pe(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Fo(e,n,r,i){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Fo(e,oN(n,r),i,s,o)).catch(s=>{throw"FirebaseError"===s.name?(s.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new pe(Q.UNKNOWN,s.toString())})}No(e,n,r,i,s){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.No(e,oN(n,r),i,o,a,s)).catch(o=>{throw"FirebaseError"===o.name?(o.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new pe(Q.UNKNOWN,o.toString())})}terminate(){this.p_=!0,this.connection.terminate()}}class Wce{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.w_=0,this.S_=null,this.b_=!0}D_(){0===this.w_&&(this.C_("Unknown"),this.S_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.S_=null,this.v_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}F_(e){"Online"===this.state?this.C_("Unknown"):(this.w_++,this.w_>=1&&(this.M_(),this.v_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.M_(),this.w_=0,"Online"===e&&(this.b_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}v_(e){const n=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.b_?(dr(n),this.b_=!1):me("OnlineStateTracker",n)}M_(){null!==this.S_&&(this.S_.cancel(),this.S_=null)}}class Kce{constructor(e,n,r,i,s){var o=this;this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.x_=[],this.O_=new Map,this.N_=new Set,this.L_=[],this.B_=s,this.B_.oo(a=>{r.enqueueAndForget((0,ne.A)(function*(){var u;Sc(o)&&(me("RemoteStore","Restarting streams for network reachability change."),yield(u=(0,ne.A)(function*(h){const g=Te(h);g.N_.add(4),yield ap(g),g.k_.set("Unknown"),g.N_.delete(4),yield oy(g)}),function c(h){return u.apply(this,arguments)})(o))}))}),this.k_=new Wce(r,i)}}function oy(t){return MN.apply(this,arguments)}function MN(){return(MN=(0,ne.A)(function*(t){if(Sc(t))for(const e of t.L_)yield e(!0)})).apply(this,arguments)}function ap(t){return xN.apply(this,arguments)}function xN(){return(xN=(0,ne.A)(function*(t){for(const e of t.L_)yield e(!1)})).apply(this,arguments)}function OT(t,e){const n=Te(t);n.O_.has(e.targetId)||(n.O_.set(e.targetId,e),LN(n)?ON(n):lp(n).n_()&&kN(n,e))}function up(t,e){const n=Te(t),r=lp(n);n.O_.delete(e),r.n_()&&Jq(n,e),0===n.O_.size&&(r.n_()?r.s_():Sc(n)&&n.k_.set("Unknown"))}function kN(t,e){if(t.q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ge.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}lp(t).d_(e)}function Jq(t,e){t.q_.xe(e),lp(t).A_(e)}function ON(t){t.q_=new Wue({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.O_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),lp(t).start(),t.k_.D_()}function LN(t){return Sc(t)&&!lp(t).t_()&&t.O_.size>0}function Sc(t){return 0===Te(t).N_.size}function Xq(t){t.q_=void 0}function Qce(t){return FN.apply(this,arguments)}function FN(){return(FN=(0,ne.A)(function*(t){t.k_.set("Online")})).apply(this,arguments)}function Yce(t){return VN.apply(this,arguments)}function VN(){return(VN=(0,ne.A)(function*(t){t.O_.forEach((e,n)=>{kN(t,e)})})).apply(this,arguments)}function Zce(t,e){return UN.apply(this,arguments)}function UN(){return(UN=(0,ne.A)(function*(t,e){Xq(t),LN(t)?(t.k_.F_(e),ON(t)):t.k_.set("Unknown")})).apply(this,arguments)}function Jce(t,e,n){return BN.apply(this,arguments)}function BN(){return BN=(0,ne.A)(function*(t,e,n){if(t.k_.set("Online"),e instanceof qG&&2===e.state&&e.cause)try{yield(r=(0,ne.A)(function*(s,o){const a=o.cause;for(const u of o.targetIds)s.O_.has(u)&&(yield s.remoteSyncer.rejectListen(u,a),s.O_.delete(u),s.q_.removeTarget(u))}),function i(s,o){return r.apply(this,arguments)})(t,e)}catch(r){me("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield LT(t,r)}else if(e instanceof yT?t.q_.Ke(e):e instanceof GG?t.q_.He(e):t.q_.We(e),!n.isEqual(Ge.min()))try{const r=yield jq(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){const a=s.q_.rt(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const h=s.O_.get(c);h&&s.O_.set(c,h.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{const h=s.O_.get(u);if(!h)return;s.O_.set(u,h.withResumeToken(Jn.EMPTY_BYTE_STRING,h.snapshotVersion)),Jq(s,u);const g=new du(h.target,u,c,h.sequenceNumber);kN(s,g)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){me("RemoteStore","Failed to raise snapshot:",r),yield LT(t,r)}var r}),BN.apply(this,arguments)}function LT(t,e,n){return jN.apply(this,arguments)}function jN(){return(jN=(0,ne.A)(function*(t,e,n){if(!_c(e))throw e;t.N_.add(1),yield ap(t),t.k_.set("Offline"),n||(n=()=>jq(t.localStore)),t.asyncQueue.enqueueRetryable((0,ne.A)(function*(){me("RemoteStore","Retrying IndexedDB access"),yield n(),t.N_.delete(1),yield oy(t)}))})).apply(this,arguments)}function ez(t,e){return e().catch(n=>LT(t,n,e))}function cp(t){return $N.apply(this,arguments)}function $N(){return($N=(0,ne.A)(function*(t){const e=Te(t),n=Rc(e);let r=e.x_.length>0?e.x_[e.x_.length-1].batchId:-1;for(;Xce(e);)try{const i=yield Fce(e.localStore,r);if(null===i){0===e.x_.length&&n.s_();break}r=i.batchId,ele(e,i)}catch(i){yield LT(e,i)}tz(e)&&nz(e)})).apply(this,arguments)}function Xce(t){return Sc(t)&&t.x_.length<10}function ele(t,e){t.x_.push(e);const n=Rc(t);n.n_()&&n.R_&&n.V_(e.mutations)}function tz(t){return Sc(t)&&!Rc(t).t_()&&t.x_.length>0}function nz(t){Rc(t).start()}function tle(t){return HN.apply(this,arguments)}function HN(){return(HN=(0,ne.A)(function*(t){Rc(t).g_()})).apply(this,arguments)}function nle(t){return GN.apply(this,arguments)}function GN(){return(GN=(0,ne.A)(function*(t){const e=Rc(t);for(const n of t.x_)e.V_(n.mutations)})).apply(this,arguments)}function rle(t,e,n){return qN.apply(this,arguments)}function qN(){return(qN=(0,ne.A)(function*(t,e,n){const r=t.x_.shift(),i=tN.from(r,e,n);yield ez(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield cp(t)})).apply(this,arguments)}function ile(t,e){return zN.apply(this,arguments)}function zN(){return zN=(0,ne.A)(function*(t,e){var n;e&&Rc(t).R_&&(yield(n=(0,ne.A)(function*(i,s){if(UG(a=s.code)&&a!==Q.ABORTED){const o=i.x_.shift();Rc(i).i_(),yield ez(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield cp(i)}var a}),function r(i,s){return n.apply(this,arguments)})(t,e)),tz(t)&&nz(t)}),zN.apply(this,arguments)}function rz(t,e){return WN.apply(this,arguments)}function WN(){return(WN=(0,ne.A)(function*(t,e){const n=Te(t);n.asyncQueue.verifyOperationInProgress(),me("RemoteStore","RemoteStore received new credentials");const r=Sc(n);n.N_.add(3),yield ap(n),r&&n.k_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.N_.delete(3),yield oy(n)})).apply(this,arguments)}function KN(t,e){return QN.apply(this,arguments)}function QN(){return(QN=(0,ne.A)(function*(t,e){const n=Te(t);e?(n.N_.delete(2),yield oy(n)):e||(n.N_.add(2),yield ap(n),n.k_.set("Unknown"))})).apply(this,arguments)}function lp(t){return t.Q_||(t.Q_=function(n,r,i){const s=Te(n);return s.y_(),new Gce(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{To:Qce.bind(null,t),Ao:Yce.bind(null,t),Vo:Zce.bind(null,t),E_:Jce.bind(null,t)}),t.L_.push(function(){var e=(0,ne.A)(function*(n){n?(t.Q_.i_(),LN(t)?ON(t):t.k_.set("Unknown")):(yield t.Q_.stop(),Xq(t))});return function(n){return e.apply(this,arguments)}}())),t.Q_}function Rc(t){return t.K_||(t.K_=function(n,r,i){const s=Te(n);return s.y_(),new qce(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{To:()=>Promise.resolve(),Ao:tle.bind(null,t),Vo:ile.bind(null,t),m_:nle.bind(null,t),f_:rle.bind(null,t)}),t.L_.push(function(){var e=(0,ne.A)(function*(n){n?(t.K_.i_(),yield cp(t)):(yield t.K_.stop(),t.x_.length>0&&(me("RemoteStore",`Stopping write stream with ${t.x_.length} pending writes`),t.x_=[]))});return function(n){return e.apply(this,arguments)}}())),t.K_}class YN{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Pr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new YN(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new pe(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dp(t,e){if(dr("AsyncQueue",`${e}: ${t}`),_c(t))return new pe(Q.UNAVAILABLE,`${e}: ${t}`);throw t}class hp{constructor(e){this.comparator=e?(n,r)=>e(n,r)||be.comparator(n.key,r.key):(n,r)=>be.comparator(n.key,r.key),this.keyedMap=H_(),this.sortedSet=new En(this.comparator)}static emptySet(e){return new hp(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof hp)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,n){const r=new hp;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class iz{constructor(){this.U_=new En(be.comparator)}track(e){const n=e.doc.key,r=this.U_.get(n);r?0!==e.type&&3===r.type?this.U_=this.U_.insert(n,e):3===e.type&&1!==r.type?this.U_=this.U_.insert(n,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.U_=this.U_.insert(n,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.U_=this.U_.insert(n,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.U_=this.U_.remove(n):1===e.type&&2===r.type?this.U_=this.U_.insert(n,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.U_=this.U_.insert(n,{type:2,doc:e.doc}):Le():this.U_=this.U_.insert(n,e)}W_(){const e=[];return this.U_.inorderTraversal((n,r)=>{e.push(r)}),e}}class fp{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new fp(e,n,hp.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&j_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class sle{constructor(){this.G_=void 0,this.z_=[]}j_(){return this.z_.some(e=>e.H_())}}class ole{constructor(){this.queries=sz(),this.onlineState="Unknown",this.J_=new Set}terminate(){!function(n,r){const i=Te(n),s=i.queries;i.queries=sz(),s.forEach((o,a)=>{for(const u of a.z_)u.onError(r)})}(this,new pe(Q.ABORTED,"Firestore shutting down"))}}function sz(){return new cu(t=>vG(t),j_)}function ZN(t,e){return JN.apply(this,arguments)}function JN(){return(JN=(0,ne.A)(function*(t,e){const n=Te(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.j_()&&e.H_()&&(r=2):(s=new sle,r=e.H_()?0:1);try{switch(r){case 0:s.G_=yield n.onListen(i,!0);break;case 1:s.G_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){const a=dp(o,`Initialization of query '${Kf(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.z_.push(e),e.Y_(n.onlineState),s.G_&&e.Z_(s.G_)&&tP(n)})).apply(this,arguments)}function XN(t,e){return eP.apply(this,arguments)}function eP(){return(eP=(0,ne.A)(function*(t,e){const n=Te(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.z_.indexOf(e);o>=0&&(s.z_.splice(o,1),0===s.z_.length?i=e.H_()?0:1:!s.j_()&&e.H_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})).apply(this,arguments)}function ale(t,e){const n=Te(t);let r=!1;for(const i of e){const o=n.queries.get(i.query);if(o){for(const a of o.z_)a.Z_(i)&&(r=!0);o.G_=i}}r&&tP(n)}function ule(t,e,n){const r=Te(t),i=r.queries.get(e);if(i)for(const s of i.z_)s.onError(n);r.queries.delete(e)}function tP(t){t.J_.forEach(e=>{e.next()})}var nP,oz;(oz=nP||(nP={})).X_="default",oz.Cache="cache";class rP{constructor(e,n,r){this.query=e,this.ea=n,this.ta=!1,this.na=null,this.onlineState="Unknown",this.options=r||{}}Z_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new fp(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.ta?this.ra(e)&&(this.ea.next(e),n=!0):this.ia(e,this.onlineState)&&(this.sa(e),n=!0),this.na=e,n}onError(e){this.ea.error(e)}Y_(e){this.onlineState=e;let n=!1;return this.na&&!this.ta&&this.ia(this.na,e)&&(this.sa(this.na),n=!0),n}ia(e,n){return!e.fromCache||!this.H_()||(!this.options.oa||!("Offline"!==n))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===n)}ra(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.na&&this.na.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}sa(e){e=fp.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ta=!0,this.ea.next(e)}H_(){return this.options.source!==nP.Cache}}class cle{constructor(e,n){this._a=e,this.byteLength=n}aa(){return"metadata"in this._a}}class az{constructor(e){this.serializer=e}Ts(e){return fa(this.serializer,e)}Es(e){return e.metadata.exists?tq(this.serializer,e.document,!1):Sn.newNoDocument(this.Ts(e.metadata.name),this.ds(e.metadata.readTime))}ds(e){return hr(e)}}class lle{constructor(e,n,r){this.ua=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=uz(e)}ca(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e._a.namedQuery)this.queries.push(e._a.namedQuery);else if(e._a.documentMetadata){this.documents.push({metadata:e._a.documentMetadata}),e._a.documentMetadata.exists||++n;const r=Dt.fromString(e._a.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e._a.document&&(this.documents[this.documents.length-1].document=e._a.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}la(e){const n=new Map,r=new az(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.Ts(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||ht()).add(s);n.set(o,a)}}return n}complete(){var e=this;return(0,ne.A)(function*(){const n=yield function Vce(t,e,n,r){return CN.apply(this,arguments)}(e.localStore,new az(e.serializer),e.documents,e.ua.id),r=e.la(e.documents);for(const i of e.queries)yield Uce(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,ha:e.collectionGroups,Pa:n}})()}}function uz(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}class cz{constructor(e){this.key=e}}class lz{constructor(e){this.key=e}}class dz{constructor(e,n){this.query=e,this.Ia=n,this.Ta=null,this.hasCachedResults=!1,this.current=!1,this.Ea=ht(),this.mutatedKeys=ht(),this.da=IG(e),this.Aa=new hp(this.da)}get Ra(){return this.Ia}Va(e,n){const r=n?n.ma:new iz,i=n?n.Aa:this.Aa;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,g)=>{const _=i.get(h),v=$_(this.query,g)?g:null,w=!!_&&this.mutatedKeys.has(_.key),b=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let D=!1;_&&v?_.data.isEqual(v.data)?w!==b&&(r.track({type:3,doc:v}),D=!0):this.fa(_,v)||(r.track({type:2,doc:v}),D=!0,(u&&this.da(v,u)>0||c&&this.da(v,c)<0)&&(a=!0)):!_&&v?(r.track({type:0,doc:v}),D=!0):_&&!v&&(r.track({type:1,doc:_}),D=!0,(u||c)&&(a=!0)),D&&(v?(o=o.add(v),s=b?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const h="F"===this.query.limitType?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{Aa:o,ma:r,ts:a,mutatedKeys:s}}fa(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Aa;this.Aa=e.Aa,this.mutatedKeys=e.mutatedKeys;const o=e.ma.W_();o.sort((h,g)=>function(v,w){const b=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le()}};return b(v)-b(w)}(h.type,g.type)||this.da(h.doc,g.doc)),this.ga(r),i=null!=i&&i;const a=n&&!i?this.pa():[],u=0===this.Ea.size&&this.current&&!i?1:0,c=u!==this.Ta;return this.Ta=u,0!==o.length||c?{snapshot:new fp(this.query,e.Aa,s,o,e.mutatedKeys,0===u,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),ya:a}:{ya:a}}Y_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Aa:this.Aa,ma:new iz,mutatedKeys:this.mutatedKeys,ts:!1},!1)):{ya:[]}}wa(e){return!this.Ia.has(e)&&!!this.Aa.has(e)&&!this.Aa.get(e).hasLocalMutations}ga(e){e&&(e.addedDocuments.forEach(n=>this.Ia=this.Ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ia=this.Ia.delete(n)),this.current=e.current)}pa(){if(!this.current)return[];const e=this.Ea;this.Ea=ht(),this.Aa.forEach(r=>{this.wa(r.key)&&(this.Ea=this.Ea.add(r.key))});const n=[];return e.forEach(r=>{this.Ea.has(r)||n.push(new lz(r))}),this.Ea.forEach(r=>{e.has(r)||n.push(new cz(r))}),n}Sa(e){this.Ia=e.Is,this.Ea=ht();const n=this.Va(e.documents);return this.applyChanges(n,!0)}ba(){return fp.fromInitialDocuments(this.query,this.Aa,this.mutatedKeys,0===this.Ta,this.hasCachedResults)}}class dle{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class hle{constructor(e){this.key=e,this.Da=!1}}class fle{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.va=new cu(a=>vG(a),j_),this.Fa=new Map,this.Ma=new Set,this.xa=new En(be.comparator),this.Oa=new Map,this.Na=new mN,this.La={},this.Ba=new Map,this.ka=hd.Bn(),this.onlineState="Unknown",this.qa=void 0}get isPrimaryClient(){return!0===this.qa}}function ple(t,e){return iP.apply(this,arguments)}function iP(){return(iP=(0,ne.A)(function*(t,e,n=!0){const r=FT(t);let i;const s=r.va.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ba()):i=yield hz(r,e,n,!0),i})).apply(this,arguments)}function gle(t,e){return sP.apply(this,arguments)}function sP(){return(sP=(0,ne.A)(function*(t,e){const n=FT(t);yield hz(n,e,!0,!1)})).apply(this,arguments)}function hz(t,e,n,r){return oP.apply(this,arguments)}function oP(){return(oP=(0,ne.A)(function*(t,e,n,r){const i=yield sp(t.localStore,Ii(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current";let a;return r&&(a=yield aP(t,e,s,"current"===o,i.resumeToken)),t.isPrimaryClient&&n&&OT(t.remoteStore,i),a})).apply(this,arguments)}function aP(t,e,n,r,i){return uP.apply(this,arguments)}function uP(){return uP=(0,ne.A)(function*(t,e,n,r,i){t.Qa=(g,_,v)=>{return(w=(0,ne.A)(function*(D,F,x,$){let ie=F.view.Va(x);ie.ts&&(ie=yield NT(D.localStore,F.query,!1).then(({documents:R})=>F.view.Va(R,ie)));const Ie=$&&$.targetChanges.get(F.targetId),Pe=$&&null!=$.targetMismatches.get(F.targetId),V=F.view.applyChanges(ie,D.isPrimaryClient,Ie,Pe);return vP(D,F.targetId,V.ya),V.snapshot}),function b(D,F,x,$){return w.apply(this,arguments)})(t,g,_,v);var w};const s=yield NT(t.localStore,e,!0),o=new dz(e,s.Is),a=o.Va(s.documents),u=Q_.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState,i),c=o.applyChanges(a,t.isPrimaryClient,u);vP(t,n,c.ya);const h=new dle(e,n,o);return t.va.set(e,h),t.Fa.has(n)?t.Fa.get(n).push(e):t.Fa.set(n,[e]),c.snapshot}),uP.apply(this,arguments)}function mle(t,e,n){return cP.apply(this,arguments)}function cP(){return(cP=(0,ne.A)(function*(t,e,n){const r=Te(t),i=r.va.get(e),s=r.Fa.get(i.targetId);if(s.length>1)return r.Fa.set(i.targetId,s.filter(o=>!j_(o,e))),void r.va.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield op(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&up(r.remoteStore,i.targetId),pp(r,i.targetId)}).catch(mc))):(pp(r,i.targetId),yield op(r.localStore,i.targetId,!0))})).apply(this,arguments)}function _le(t,e){return lP.apply(this,arguments)}function lP(){return(lP=(0,ne.A)(function*(t,e){const n=Te(t),r=n.va.get(e),i=n.Fa.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),up(n.remoteStore,r.targetId))})).apply(this,arguments)}function dP(){return(dP=(0,ne.A)(function*(t,e,n){const r=NP(t);try{const i=yield function(o,a){const u=Te(o),c=Fn.now(),h=a.reduce((v,w)=>v.add(w.key),ht());let g,_;return u.persistence.runTransaction("Locally write mutations","readwrite",v=>{let w=us(),b=ht();return u.us.getEntries(v,h).next(D=>{w=D,w.forEach((F,x)=>{x.isValidDocument()||(b=b.add(F))})}).next(()=>u.localDocuments.getOverlayedDocuments(v,w)).next(D=>{g=D;const F=[];for(const x of a){const $=Gue(x,g.get(x.key).overlayedDocument);null!=$&&F.push(new lu(x.key,$,rG($.value.mapValue),Vn.exists(!0)))}return u.mutationQueue.addMutationBatch(v,c,F,a)}).next(D=>{_=D;const F=D.applyToLocalDocumentSet(g,b);return u.documentOverlayCache.saveOverlays(v,D.batchId,F)})}).then(()=>({batchId:_.batchId,changes:TG(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.La[o.currentUser.toKey()];c||(c=new En(st)),c=c.insert(a,u),o.La[o.currentUser.toKey()]=c}(r,i.batchId,n),yield hu(r,i.changes),yield cp(r.remoteStore)}catch(i){const s=dp(i,"Failed to persist write");n.reject(s)}})).apply(this,arguments)}function fz(t,e){return hP.apply(this,arguments)}function hP(){return(hP=(0,ne.A)(function*(t,e){const n=Te(t);try{const r=yield function Lce(t,e){const n=Te(t),r=e.snapshotVersion;let i=n.ss;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.us.newChangeBuffer({trackRemovals:!0});i=n.ss;const a=[];e.targetChanges.forEach((h,g)=>{const _=i.get(g);if(!_)return;a.push(n.$r.removeMatchingKeys(s,h.removedDocuments,g).next(()=>n.$r.addMatchingKeys(s,h.addedDocuments,g)));let v=_.withSequenceNumber(s.currentSequenceNumber);var b,D,F;null!==e.targetMismatches.get(g)?v=v.withResumeToken(Jn.EMPTY_BYTE_STRING,Ge.min()).withLastLimboFreeSnapshotVersion(Ge.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),i=i.insert(g,v),D=v,F=h,(0===(b=_).resumeToken.approximateByteSize()||D.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8||F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0)&&a.push(n.$r.updateTargetData(s,v))});let u=us(),c=ht();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push($q(s,o,e.documentUpdates).next(h=>{u=h.hs,c=h.Ps})),!r.isEqual(Ge.min())){const h=n.$r.getLastRemoteSnapshotVersion(s).next(g=>n.$r.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return z.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.ss=i,s))}(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Oa.get(s);o&&($e(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Da=!0:i.modifiedDocuments.size>0?$e(o.Da):i.removedDocuments.size>0&&($e(o.Da),o.Da=!1))}),yield hu(n,r,e)}catch(r){yield mc(r)}})).apply(this,arguments)}function pz(t,e,n){const r=Te(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const i=[];r.va.forEach((s,o)=>{const a=o.view.Y_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const u=Te(o);u.onlineState=a;let c=!1;u.queries.forEach((h,g)=>{for(const _ of g.z_)_.Y_(a)&&(c=!0)}),c&&tP(u)}(r.eventManager,e),i.length&&r.Ca.E_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function vle(t,e,n){return fP.apply(this,arguments)}function fP(){return(fP=(0,ne.A)(function*(t,e,n){const r=Te(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Oa.get(e),s=i&&i.key;if(s){let o=new En(be.comparator);o=o.insert(s,Sn.newNoDocument(s,Ge.min()));const a=ht().add(s),u=new K_(Ge.min(),new Map,new En(st),o,a);yield fz(r,u),r.xa=r.xa.remove(s),r.Oa.delete(e),EP(r)}else yield op(r.localStore,e,!1).then(()=>pp(r,e,n)).catch(mc)})).apply(this,arguments)}function Ele(t,e){return pP.apply(this,arguments)}function pP(){return(pP=(0,ne.A)(function*(t,e){const n=Te(t),r=e.batch.batchId;try{const i=yield function Oce(t,e){const n=Te(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.us.newChangeBuffer({trackRemovals:!0});return function(a,u,c,h){const g=c.batch,_=g.keys();let v=z.resolve();return _.forEach(w=>{v=v.next(()=>h.getEntry(u,w)).next(b=>{const D=c.docVersions.get(w);$e(null!==D),b.version.compareTo(D)<0&&(g.applyToRemoteDocument(b,c),b.isValidDocument()&&(b.setReadTime(c.commitVersion),h.addEntry(b)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(u,g))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=ht();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}(n.localStore,e);yP(n,r,null),_P(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield hu(n,i)}catch(i){yield mc(i)}})).apply(this,arguments)}function Ile(t,e,n){return gP.apply(this,arguments)}function gP(){return(gP=(0,ne.A)(function*(t,e,n){const r=Te(t);try{const i=yield function(o,a){const u=Te(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return u.mutationQueue.lookupMutationBatch(c,a).next(g=>($e(null!==g),h=g.keys(),u.mutationQueue.removeMutationBatch(c,g))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>u.localDocuments.getDocuments(c,h))})}(r.localStore,e);yP(r,e,n),_P(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield hu(r,i)}catch(i){yield mc(i)}})).apply(this,arguments)}function mP(){return(mP=(0,ne.A)(function*(t,e){const n=Te(t);Sc(n.remoteStore)||me("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(o){const a=Te(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(-1===r)return void e.resolve();const i=n.Ba.get(r)||[];i.push(e),n.Ba.set(r,i)}catch(r){const i=dp(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})).apply(this,arguments)}function _P(t,e){(t.Ba.get(e)||[]).forEach(n=>{n.resolve()}),t.Ba.delete(e)}function yP(t,e,n){const r=Te(t);let i=r.La[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.La[r.currentUser.toKey()]=i}}function pp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Fa.get(e))t.va.delete(r),n&&t.Ca.Ka(r,n);t.Fa.delete(e),t.isPrimaryClient&&t.Na.mr(e).forEach(r=>{t.Na.containsKey(r)||gz(t,r)})}function gz(t,e){t.Ma.delete(e.path.canonicalString());const n=t.xa.get(e);null!==n&&(up(t.remoteStore,n),t.xa=t.xa.remove(e),t.Oa.delete(n),EP(t))}function vP(t,e,n){for(const r of n)r instanceof cz?(t.Na.addReference(r.key,e),Tle(t,r)):r instanceof lz?(me("SyncEngine","Document no longer in limbo: "+r.key),t.Na.removeReference(r.key,e),t.Na.containsKey(r.key)||gz(t,r.key)):Le()}function Tle(t,e){const n=e.key,r=n.path.canonicalString();t.xa.get(n)||t.Ma.has(r)||(me("SyncEngine","New document in limbo: "+n),t.Ma.add(r),EP(t))}function EP(t){for(;t.Ma.size>0&&t.xa.size<t.maxConcurrentLimboResolutions;){const e=t.Ma.values().next().value;t.Ma.delete(e);const n=new be(Dt.fromString(e)),r=t.ka.next();t.Oa.set(r,new hle(n)),t.xa=t.xa.insert(n,r),OT(t.remoteStore,new du(Ii(zf(n.path)),r,"TargetPurposeLimboResolution",Rs.oe))}}function hu(t,e,n){return IP.apply(this,arguments)}function IP(){return IP=(0,ne.A)(function*(t,e,n){const r=Te(t),i=[],s=[],o=[];var a;r.va.isEmpty()||(r.va.forEach((a,u)=>{o.push(r.Qa(u,e,n).then(c=>{var h;if((c||n)&&r.isPrimaryClient){const g=c?!c.fromCache:null===(h=n?.targetChanges.get(u.targetId))||void 0===h?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(c){i.push(c);const g=IN.Ui(u.targetId,c);s.push(g)}}))}),yield Promise.all(o),r.Ca.E_(i),yield(a=(0,ne.A)(function*(c,h){const g=Te(c);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>z.forEach(h,v=>z.forEach(v.Ki,w=>g.persistence.referenceDelegate.addReference(_,v.targetId,w)).next(()=>z.forEach(v.$i,w=>g.persistence.referenceDelegate.removeReference(_,v.targetId,w)))))}catch(_){if(!_c(_))throw _;me("LocalStore","Failed to update sequence numbers: "+_)}for(const _ of h){const v=_.targetId;if(!_.fromCache){const w=g.ss.get(v),D=w.withLastLimboFreeSnapshotVersion(w.snapshotVersion);g.ss=g.ss.insert(v,D)}}}),function u(c,h){return a.apply(this,arguments)})(r.localStore,s))}),IP.apply(this,arguments)}function Cle(t,e){return wP.apply(this,arguments)}function wP(){return(wP=(0,ne.A)(function*(t,e){const n=Te(t);if(!n.currentUser.isEqual(e)){me("SyncEngine","User change. New user:",e.toKey());const r=yield Bq(n.localStore,e);n.currentUser=e,(s=n).Ba.forEach(a=>{a.forEach(u=>{u.reject(new pe(Q.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.Ba.clear(),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield hu(n,r.ls)}var s})).apply(this,arguments)}function Ale(t,e){const n=Te(t),r=n.Oa.get(e);if(r&&r.Da)return ht().add(r.key);{let i=ht();const s=n.Fa.get(e);if(!s)return i;for(const o of s){const a=n.va.get(o);i=i.unionWith(a.view.Ra)}return i}}function ble(t,e){return TP.apply(this,arguments)}function TP(){return(TP=(0,ne.A)(function*(t,e){const n=Te(t),r=yield NT(n.localStore,e.query,!0),i=e.view.Sa(r);return n.isPrimaryClient&&vP(n,e.targetId,i.ya),i})).apply(this,arguments)}function Dle(t,e){return CP.apply(this,arguments)}function CP(){return(CP=(0,ne.A)(function*(t,e){const n=Te(t);return Gq(n.localStore,e).then(r=>hu(n,r))})).apply(this,arguments)}function Sle(t,e,n,r){return AP.apply(this,arguments)}function AP(){return(AP=(0,ne.A)(function*(t,e,n,r){const i=Te(t),s=yield function(a,u){const c=Te(a),h=Te(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",g=>h.Fn(g,u).next(_=>_?c.localDocuments.getDocuments(g,_):z.resolve(null)))}(i.localStore,e);var u;null!==s?("pending"===n?yield cp(i.remoteStore):"acknowledged"===n||"rejected"===n?(yP(i,e,r||null),_P(i,e),u=e,Te(Te(i.localStore).mutationQueue).xn(u)):Le(),yield hu(i,s)):me("SyncEngine","Cannot apply mutation batch with id: "+e)})).apply(this,arguments)}function bP(){return(bP=(0,ne.A)(function*(t,e){const n=Te(t);if(FT(n),NP(n),!0===e&&!0!==n.qa){const r=n.sharedClientState.getAllActiveQueryTargets(),i=yield mz(n,r.toArray());n.qa=!0,yield KN(n.remoteStore,!0);for(const s of i)OT(n.remoteStore,s)}else if(!1===e&&!1!==n.qa){const r=[];let i=Promise.resolve();n.Fa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(pp(n,o),op(n.localStore,o,!0))),up(n.remoteStore,o)}),yield i,yield mz(n,r),function(o){const a=Te(o);a.Oa.forEach((u,c)=>{up(a.remoteStore,c)}),a.Na.gr(),a.Oa=new Map,a.xa=new En(be.comparator)}(n),n.qa=!1,yield KN(n.remoteStore,!1)}})).apply(this,arguments)}function mz(t,e,n){return DP.apply(this,arguments)}function DP(){return(DP=(0,ne.A)(function*(t,e,n){const r=Te(t),i=[],s=[];for(const o of e){let a;const u=r.Fa.get(o);if(u&&0!==u.length){a=yield sp(r.localStore,Ii(u[0]));for(const c of u){const h=r.va.get(c),g=yield ble(r,h);g.snapshot&&s.push(g.snapshot)}}else{const c=yield Hq(r.localStore,o);a=yield sp(r.localStore,c),yield aP(r,_z(c),o,!1,a.resumeToken)}i.push(a)}return r.Ca.E_(s),i})).apply(this,arguments)}function _z(t){return gG(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Nle(t){return n=Te(t).localStore,Te(Te(n).persistence).qi();var n}function Ple(t,e,n,r){return SP.apply(this,arguments)}function SP(){return(SP=(0,ne.A)(function*(t,e,n,r){const i=Te(t);if(i.qa)return void me("SyncEngine","Ignoring unexpected query state notification.");const s=i.Fa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=yield Gq(i.localStore,EG(s[0])),a=K_.createSynthesizedRemoteEventForCurrentChange(e,"current"===n,Jn.EMPTY_BYTE_STRING);yield hu(i,o,a);break}case"rejected":yield op(i.localStore,e,!0),pp(i,e,r);break;default:Le()}})).apply(this,arguments)}function Mle(t,e,n){return RP.apply(this,arguments)}function RP(){return(RP=(0,ne.A)(function*(t,e,n){const r=FT(t);if(r.qa){for(const i of e){if(r.Fa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){me("SyncEngine","Adding an already active target "+i);continue}const s=yield Hq(r.localStore,i),o=yield sp(r.localStore,s);yield aP(r,_z(s),o.targetId,!1,o.resumeToken),OT(r.remoteStore,o)}for(const i of n)r.Fa.has(i)&&(yield op(r.localStore,i,!1).then(()=>{up(r.remoteStore,i),pp(r,i)}).catch(mc))}})).apply(this,arguments)}function FT(t){const e=Te(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=fz.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ale.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vle.bind(null,e),e.Ca.E_=ale.bind(null,e.eventManager),e.Ca.Ka=ule.bind(null,e.eventManager),e}function NP(t){const e=Te(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ele.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ile.bind(null,e),e}class gp{constructor(){this.synchronizeTabs=!1}initialize(e){var n=this;return(0,ne.A)(function*(){n.serializer=sy(e.databaseInfo.databaseId),n.sharedClientState=n.createSharedClientState(e),n.persistence=n.createPersistence(e),yield n.persistence.start(),n.localStore=n.createLocalStore(e),n.gcScheduler=n.createGarbageCollectionScheduler(e,n.localStore),n.indexBackfillerScheduler=n.createIndexBackfillerScheduler(e,n.localStore)})()}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Uq(this.persistence,new Vq,e.initialUser,this.serializer)}createPersistence(e){return new _N(DT.Yr,this.serializer)}createSharedClientState(e){return new Kq}terminate(){var e=this;return(0,ne.A)(function*(){var n,r;null===(n=e.gcScheduler)||void 0===n||n.stop(),null===(r=e.indexBackfillerScheduler)||void 0===r||r.stop(),e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class PP extends gp{constructor(e,n,r){super(),this.Ua=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var n=()=>super.initialize,r=this;return(0,ne.A)(function*(){yield n().call(r,e),yield r.Ua.initialize(r,e),yield NP(r.Ua.syncEngine),yield cp(r.Ua.remoteStore),yield r.persistence.pi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return Uq(this.persistence,new Vq,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){return new Rq(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new tue(n,this.persistence);return new eue(e.asyncQueue,r)}createPersistence(e){const n=EN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?wi.withCacheSize(this.cacheSizeBytes):wi.DEFAULT;return new vN(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Yq(),kT(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Kq}}class yz extends PP{constructor(e,n){super(e,n,!1),this.Ua=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){var n=()=>super.initialize,r=this;return(0,ne.A)(function*(){yield n().call(r,e);const i=r.Ua.syncEngine;r.sharedClientState instanceof RN&&(r.sharedClientState.syncEngine={eo:Sle.bind(null,i),no:Ple.bind(null,i),ro:Mle.bind(null,i),qi:Nle.bind(null,i),Xs:Dle.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.pi(function(){var s=(0,ne.A)(function*(o){yield function Rle(t,e){return bP.apply(this,arguments)}(r.Ua.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const n=Yq();if(!RN.D(n))throw new pe(Q.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=EN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new RN(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class mp{initialize(e,n){var r=this;return(0,ne.A)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>pz(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=Cle.bind(null,r.syncEngine),yield KN(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new ole}createDatastore(e){const n=sy(e.databaseInfo.databaseId),r=new Hce(e.databaseInfo);return new zce(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return r=this.localStore,i=this.datastore,s=e.asyncQueue,o=n=>pz(this.syncEngine,n,0),a=Qq.D()?new Qq:new Bce,new Kce(r,i,s,o,a);var r,i,s,o,a}createSyncEngine(e,n){return function(i,s,o,a,u,c,h){const g=new fle(i,s,o,a,u,c);return h&&(g.qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){var e=this;return(0,ne.A)(function*(){var n,r,i;yield(i=(0,ne.A)(function*(o){const a=Te(o);me("RemoteStore","RemoteStore shutting down."),a.N_.add(5),yield ap(a),a.B_.shutdown(),a.k_.set("Unknown")}),function s(o){return i.apply(this,arguments)})(e.remoteStore),null===(n=e.datastore)||void 0===n||n.terminate(),null===(r=e.eventManager)||void 0===r||r.terminate()})()}}function vz(t,e=10240){let n=0;return{read:()=>(0,ne.A)(function*(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}})(),cancel:()=>(0,ne.A)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class VT{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Wa(this.observer.next,e)}error(e){this.observer.error?this.Wa(this.observer.error,e):dr("Uncaught Error in snapshot listener:",e.toString())}Ga(){this.muted=!0}Wa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}class Ole{constructor(e,n){this.za=e,this.serializer=n,this.metadata=new Pr,this.buffer=new Uint8Array,this.ja=new TextDecoder("utf-8"),this.Ha().then(r=>{r&&r.aa()?this.metadata.resolve(r._a.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?._a)}`))},r=>this.metadata.reject(r))}close(){return this.za.cancel()}getMetadata(){var e=this;return(0,ne.A)(function*(){return e.metadata.promise})()}$a(){var e=this;return(0,ne.A)(function*(){return yield e.getMetadata(),e.Ha()})()}Ha(){var e=this;return(0,ne.A)(function*(){const n=yield e.Ja();if(null===n)return null;const r=e.ja.decode(n),i=Number(r);isNaN(i)&&e.Ya(`length string (${r}) is not valid number`);const s=yield e.Za(i);return new cle(JSON.parse(s),n.length+i)})()}Xa(){return this.buffer.findIndex(e=>123===e)}Ja(){var e=this;return(0,ne.A)(function*(){for(;e.Xa()<0&&!(yield e.eu()););if(0===e.buffer.length)return null;const n=e.Xa();n<0&&e.Ya("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,n);return e.buffer=e.buffer.slice(n),r})()}Za(e){var n=this;return(0,ne.A)(function*(){for(;n.buffer.length<e;)(yield n.eu())&&n.Ya("Reached the end of bundle when more is expected.");const r=n.ja.decode(n.buffer.slice(0,e));return n.buffer=n.buffer.slice(e),r})()}Ya(e){throw this.za.cancel(),new Error(`Invalid bundle format: ${e}`)}eu(){var e=this;return(0,ne.A)(function*(){const n=yield e.za.read();if(!n.done){const r=new Uint8Array(e.buffer.length+n.value.length);r.set(e.buffer),r.set(n.value,e.buffer.length),e.buffer=r}return n.done})()}}class Lle{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){var n=this;return(0,ne.A)(function*(){if(n.ensureCommitNotCalled(),n.mutations.length>0)throw n.lastTransactionError=new pe(Q.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),n.lastTransactionError;const r=yield(i=(0,ne.A)(function*(o,a){const u=Te(o),c={documents:a.map(v=>Y_(u.serializer,v))},h=yield u.No("BatchGetDocuments",u.serializer.databaseId,Dt.emptyPath(),c,a.length),g=new Map;h.forEach(v=>{const w=function Xue(t,e){return"found"in e?function(r,i){$e(!!i.found);const s=fa(r,i.found.name),o=hr(i.found.updateTime),a=i.found.createTime?hr(i.found.createTime):Ge.min(),u=new Jr({mapValue:{fields:i.found.fields}});return Sn.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){$e(!!i.missing),$e(!!i.readTime);const s=fa(r,i.missing),o=hr(i.readTime);return Sn.newNoDocument(s,o)}(t,e):Le()}(u.serializer,v);g.set(w.key.toString(),w)});const _=[];return a.forEach(v=>{const w=g.get(v.toString());$e(!!w),_.push(w)}),_}),function s(o,a){return i.apply(this,arguments)})(n.datastore,e);var i;return r.forEach(i=>n.recordVersion(i)),r})()}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Jf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,ne.A)(function*(){if(e.ensureCommitNotCalled(),e.lastTransactionError)throw e.lastTransactionError;const n=e.readVersions;var r;e.mutations.forEach(r=>{n.delete(r.key.toString())}),n.forEach((r,i)=>{const s=be.fromPath(i);e.mutations.push(new XR(s,e.precondition(s)))}),yield(r=(0,ne.A)(function*(s,o){const a=Te(s),u={writes:o.map(c=>Z_(a.serializer,c))};yield a.Fo("Commit",a.serializer.databaseId,Dt.emptyPath(),u)}),function i(s,o){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Le();n=Ge.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new pe(Q.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Ge.min())?Vn.exists(!1):Vn.updateTime(n):Vn.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Ge.min()))throw new pe(Q.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Vn.updateTime(n)}return Vn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Fle{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.tu=r.maxAttempts,this.e_=new PN(this.asyncQueue,"transaction_retry")}nu(){this.tu-=1,this.ru()}ru(){var e=this;this.e_.Wo((0,ne.A)(function*(){const n=new Lle(e.datastore),r=e.iu(n);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>n.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.su(s)}))}).catch(i=>{e.su(i)})}))}iu(e){try{const n=this.updateFunction(e);return!x_(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}su(e){this.tu>0&&this.ou(e)?(this.tu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ru(),Promise.resolve()))):this.deferred.reject(e)}ou(e){if("FirebaseError"===e.name){const n=e.code;return"aborted"===n||"failed-precondition"===n||"already-exists"===n||!UG(n)}return!1}}class Vle{constructor(e,n,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=$r.UNAUTHENTICATED,this.clientId=PH.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=(0,ne.A)(function*(a){me("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(me("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new pe(Q.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const n=new Pr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,ne.A)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),n.resolve()}catch(r){const i=dp(r,"Failed to shutdown persistence");n.reject(i)}})),n.promise}}function UT(t,e){return MP.apply(this,arguments)}function MP(){return MP=(0,ne.A)(function*(t,e){t.asyncQueue.verifyOperationInProgress(),me("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(function(){var i=(0,ne.A)(function*(s){r.isEqual(s)||(yield Bq(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}),MP.apply(this,arguments)}function xP(t,e){return kP.apply(this,arguments)}function kP(){return(kP=(0,ne.A)(function*(t,e){t.asyncQueue.verifyOperationInProgress();const n=yield OP(t);me("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>rz(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>rz(e.remoteStore,i)),t._onlineComponents=e})).apply(this,arguments)}function Ez(t){return"FirebaseError"===t.name?t.code===Q.FAILED_PRECONDITION||t.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}function OP(t){return LP.apply(this,arguments)}function LP(){return(LP=(0,ne.A)(function*(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){me("FirestoreClient","Using user provided OfflineComponentProvider");try{yield UT(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!Ez(n))throw n;os("Error using user provided cache. Falling back to memory cache: "+n),yield UT(t,new gp)}}else me("FirestoreClient","Using default OfflineComponentProvider"),yield UT(t,new gp);return t._offlineComponents})).apply(this,arguments)}function BT(t){return FP.apply(this,arguments)}function FP(){return(FP=(0,ne.A)(function*(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(me("FirestoreClient","Using user provided OnlineComponentProvider"),yield xP(t,t._uninitializedComponentsProvider._online)):(me("FirestoreClient","Using default OnlineComponentProvider"),yield xP(t,new mp))),t._onlineComponents})).apply(this,arguments)}function Iz(t){return OP(t).then(e=>e.persistence)}function _p(t){return OP(t).then(e=>e.localStore)}function wz(t){return BT(t).then(e=>e.remoteStore)}function VP(t){return BT(t).then(e=>e.syncEngine)}function yp(t){return UP.apply(this,arguments)}function UP(){return(UP=(0,ne.A)(function*(t){const e=yield BT(t),n=e.eventManager;return n.onListen=ple.bind(null,e.syncEngine),n.onUnlisten=mle.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=gle.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=_le.bind(null,e.syncEngine),n})).apply(this,arguments)}function Cz(t,e,n={}){const r=new Pr;return t.asyncQueue.enqueueAndForget((0,ne.A)(function*(){return function(s,o,a,u,c){const h=new VT({next:_=>{o.enqueueAndForget(()=>XN(s,g));const v=_.docs.has(a);!v&&_.fromCache?c.reject(new pe(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&_.fromCache&&u&&"server"===u.source?c.reject(new pe(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(_)},error:_=>c.reject(_)}),g=new rP(zf(a.path),h,{includeMetadataChanges:!0,oa:!0});return ZN(s,g)}(yield yp(t),t.asyncQueue,e,n,r)})),r.promise}function Az(t,e,n={}){const r=new Pr;return t.asyncQueue.enqueueAndForget((0,ne.A)(function*(){return function(s,o,a,u,c){const h=new VT({next:_=>{o.enqueueAndForget(()=>XN(s,g)),_.fromCache&&"server"===u.source?c.reject(new pe(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(_)},error:_=>c.reject(_)}),g=new rP(a,h,{includeMetadataChanges:!0,oa:!0});return ZN(s,g)}(yield yp(t),t.asyncQueue,e,n,r)})),r.promise}function bz(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Dz=new Map;function BP(t,e,n){if(!n)throw new pe(Q.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Sz(t,e,n,r){if(!0===e&&!0===r)throw new pe(Q.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Rz(t){if(!be.isDocumentKey(t))throw new pe(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Nz(t){if(be.isDocumentKey(t))throw new pe(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function jT(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=(r=t).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof t?"a function":Le()}function vt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new pe(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=jT(t);throw new pe(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Pz(t,e){if(e<=0)throw new pe(Q.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}class Mz{constructor(e){var n,r;if(void 0===e.host){if(void 0!==e.ssl)throw new pe(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(n=e.ssl)||void 0===n||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new pe(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Sz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=bz(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new pe(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new pe(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new pe(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ay{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Mz({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new pe(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new pe(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Mz(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new $ae;switch(r.type){case"firstParty":return new zae(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new pe(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Dz.get(n);r&&(me("ComponentProvider","Removing Datastore"),Dz.delete(n),r.terminate())}(this),Promise.resolve()}}class Xr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Xr(this.firestore,e,this._query)}}class Rn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Rn(this.firestore,e,this._key)}}class pa extends Xr{constructor(e,n,r){super(e,n,zf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Rn(this.firestore,null,new be(e))}withConverter(e){return new pa(this.firestore,e,this._path)}}function kz(t,e,...n){if(t=(0,A.Ku)(t),BP("collection","path",e),t instanceof ay){const r=Dt.fromString(e,...n);return Nz(r),new pa(t,null,r)}{if(!(t instanceof Rn||t instanceof pa))throw new pe(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Dt.fromString(e,...n));return Nz(r),new pa(t.firestore,null,r)}}function $T(t,e,...n){if(t=(0,A.Ku)(t),1===arguments.length&&(e=PH.newId()),BP("doc","path",e),t instanceof ay){const r=Dt.fromString(e,...n);return Rz(r),new Rn(t,null,new be(r))}{if(!(t instanceof Rn||t instanceof pa))throw new pe(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Dt.fromString(e,...n));return Rz(r),new Rn(t.firestore,t instanceof pa?t.converter:null,new be(r))}}function Oz(t,e){return t=(0,A.Ku)(t),e=(0,A.Ku)(e),(t instanceof Rn||t instanceof pa)&&(e instanceof Rn||e instanceof pa)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function jP(t,e){return t=(0,A.Ku)(t),e=(0,A.Ku)(e),t instanceof Xr&&e instanceof Xr&&t.firestore===e.firestore&&j_(t._query,e._query)&&t.converter===e.converter}class Zle{constructor(){this._u=Promise.resolve(),this.au=[],this.uu=!1,this.cu=[],this.lu=null,this.hu=!1,this.Pu=!1,this.Iu=[],this.e_=new PN(this,"async_queue_retry"),this.Tu=()=>{const n=kT();n&&me("AsyncQueue","Visibility state changed to "+n.visibilityState),this.e_.zo()};const e=kT();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tu)}get isShuttingDown(){return this.uu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Eu(),this.du(e)}enterRestrictedMode(e){if(!this.uu){this.uu=!0,this.Pu=e||!1;const n=kT();n&&"function"==typeof n.removeEventListener&&n.removeEventListener("visibilitychange",this.Tu)}}enqueue(e){if(this.Eu(),this.uu)return new Promise(()=>{});const n=new Pr;return this.du(()=>this.uu&&this.Pu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.au.push(e),this.Au()))}Au(){var e=this;return(0,ne.A)(function*(){if(0!==e.au.length){try{yield e.au[0](),e.au.shift(),e.e_.reset()}catch(n){if(!_c(n))throw n;me("AsyncQueue","Operation failed with retryable error: "+n)}e.au.length>0&&e.e_.Wo(()=>e.Au())}})()}du(e){const n=this._u.then(()=>(this.hu=!0,e().catch(r=>{throw this.lu=r,this.hu=!1,dr("INTERNAL UNHANDLED ERROR: ",function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),a}(r)),r}).then(r=>(this.hu=!1,r))));return this._u=n,n}enqueueAfterDelay(e,n,r){this.Eu(),this.Iu.indexOf(e)>-1&&(n=0);const i=YN.createAndSchedule(this,e,n,r,s=>this.Ru(s));return this.cu.push(i),i}Eu(){this.lu&&Le()}verifyOperationInProgress(){}Vu(){var e=this;return(0,ne.A)(function*(){let n;do{n=e._u,yield n}while(n!==e._u)})()}mu(e){for(const n of this.cu)if(n.timerId===e)return!0;return!1}fu(e){return this.Vu().then(()=>{this.cu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.cu)if(n.skipDelay(),"all"!==e&&n.timerId===e)break;return this.Vu()})}gu(e){this.Iu.push(e)}Ru(e){const n=this.cu.indexOf(e);this.cu.splice(n,1)}}function $P(t){return function(n,r){if("object"!=typeof n||null===n)return!1;const i=n;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(t)}class Jle{constructor(){this._progressObserver={},this._taskCompletionResolver=new Pr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class sn extends ay{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Zle,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Lz(this),this._firestoreClient.terminate()}}function Un(t){return t._firestoreClient||Lz(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Lz(t){var e,n,r;const i=t._freezeSettings(),s=(u=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",new Tue(t._databaseId,u,t._persistenceKey,(h=i).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,bz(h.experimentalLongPollingOptions),h.useFetchStreams));var u,h;t._firestoreClient=new Vle(t._authCredentials,t._appCheckCredentials,t._queue,s),null!==(n=i.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Fz(t,e,n){const r=new Pr;return t.asyncQueue.enqueue((0,ne.A)(function*(){try{yield UT(t,n),yield xP(t,e),r.resolve()}catch(i){const s=i;if(!Ez(s))throw s;os("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function Vz(t){if(t._initialized||t._terminated)throw new pe(Q.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class ga{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ga(Jn.fromBase64String(e))}catch(n){throw new pe(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ga(Jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class fu{constructor(...e){for(let n=0;n<e.length;++n)if(0===e[n].length)throw new pe(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class pd{constructor(e){this._methodName=e}}class HT{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new pe(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new pe(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}}const cde=/^__.*__$/;class lde{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return null!==this.fieldMask?new lu(e,this.data,this.fieldMask,n,this.fieldTransforms):new Zf(e,this.data,n,this.fieldTransforms)}}class Uz{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new lu(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Bz(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le()}}class GT{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get yu(){return this.settings.yu}wu(e){return new GT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Su(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.wu({path:r,bu:!1});return i.Du(e),i}Cu(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.wu({path:r,bu:!1});return i.pu(),i}vu(e){return this.wu({path:void 0,bu:!0})}Fu(e){return WT(e,this.settings.methodName,this.settings.Mu||!1,this.path,this.settings.xu)}contains(e){return void 0!==this.fieldMask.find(n=>e.isPrefixOf(n))||void 0!==this.fieldTransforms.find(n=>e.isPrefixOf(n.field))}pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Du(this.path.get(e))}Du(e){if(0===e.length)throw this.Fu("Document fields must not be empty");if(Bz(this.yu)&&cde.test(e))throw this.Fu('Document fields cannot begin and end with "__"')}}class dde{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||sy(e)}Ou(e,n,r,i=!1){return new GT({yu:e,methodName:n,xu:r,path:Dn.emptyPath(),bu:!1,Mu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gd(t){const e=t._freezeSettings(),n=sy(t._databaseId);return new dde(t._databaseId,!!e.ignoreUndefinedProperties,n)}function qT(t,e,n,r,i,s={}){const o=t.Ou(s.merge||s.mergeFields?2:0,e,n,i);QP("Data must be an object, but it was:",o,r);const a=Hz(r,o);let u,c;if(s.merge)u=new as(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const g of s.mergeFields){const _=ly(e,g,n);if(!o.contains(_))throw new pe(Q.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);qz(h,_)||h.push(_)}u=new as(h),c=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,c=o.fieldTransforms;return new lde(new Jr(a),u,c)}class cy extends pd{_toFieldTransform(e){if(2!==e.yu)throw e.Fu(1===e.yu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof cy}}function jz(t,e,n){return new GT({yu:3,xu:e.settings.xu,methodName:t._methodName,bu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class HP extends pd{_toFieldTransform(e){return new q_(e.path,new Qf)}isEqual(e){return e instanceof HP}}class GP extends pd{constructor(e,n){super(e),this.Nu=n}_toFieldTransform(e){const n=jz(this,e,!0),r=this.Nu.map(s=>md(s,n)),i=new sd(r);return new q_(e.path,i)}isEqual(e){return e instanceof GP&&(0,A.bD)(this.Nu,e.Nu)}}class qP extends pd{constructor(e,n){super(e),this.Nu=n}_toFieldTransform(e){const n=jz(this,e,!0),r=this.Nu.map(s=>md(s,n)),i=new od(r);return new q_(e.path,i)}isEqual(e){return e instanceof qP&&(0,A.bD)(this.Nu,e.Nu)}}class zP extends pd{constructor(e,n){super(e),this.Lu=n}_toFieldTransform(e){const n=new Yf(e.serializer,DG(e.serializer,this.Lu));return new q_(e.path,n)}isEqual(e){return e instanceof zP&&this.Lu===e.Lu}}function WP(t,e,n,r){const i=t.Ou(1,e,n);QP("Data must be an object, but it was:",i,r);const s=[],o=Jr.empty();yc(r,(u,c)=>{const h=zT(e,u,n);c=(0,A.Ku)(c);const g=i.Cu(h);if(c instanceof cy)s.push(h);else{const _=md(c,g);null!=_&&(s.push(h),o.set(h,_))}});const a=new as(s);return new Uz(o,a,i.fieldTransforms)}function KP(t,e,n,r,i,s){const o=t.Ou(1,e,n),a=[ly(e,r,n)],u=[i];if(s.length%2!=0)throw new pe(Q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)a.push(ly(e,s[_])),u.push(s[_+1]);const c=[],h=Jr.empty();for(let _=a.length-1;_>=0;--_)if(!qz(c,a[_])){const v=a[_];let w=u[_];w=(0,A.Ku)(w);const b=o.Cu(v);if(w instanceof cy)c.push(v);else{const D=md(w,b);null!=D&&(c.push(v),h.set(v,D))}}const g=new as(c);return new Uz(h,g,o.fieldTransforms)}function $z(t,e,n,r=!1){return md(n,t.Ou(r?4:3,e))}function md(t,e){if(Gz(t=(0,A.Ku)(t)))return QP("Unsupported field value:",e,t),Hz(t,e);if(t instanceof pd)return function(r,i){if(!Bz(i.yu))throw i.Fu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Fu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.bu&&4!==e.yu)throw e.Fu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let u=md(a,i.vu(o));null==u&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if(null===(r=(0,A.Ku)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return DG(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const s=Fn.fromDate(r);return{timestampValue:Xf(i.serializer,s)}}if(r instanceof Fn){const s=new Fn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Xf(i.serializer,s)}}if(r instanceof HT)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ga)return{bytesValue:QG(i.serializer,r._byteString)};if(r instanceof Rn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Fu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:sN(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Fu(`Unsupported field value: ${jT(r)}`)}(t,e)}function Hz(t,e){const n={};return KH(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yc(t,(r,i)=>{const s=md(i,e.Su(r));null!=s&&(n[r]=s)}),{mapValue:{fields:n}}}function Gz(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Fn||t instanceof HT||t instanceof ga||t instanceof Rn||t instanceof pd)}function QP(t,e,n){if(!Gz(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=jT(n);throw e.Fu("an object"===r?t+" a custom object":t+" "+r)}var i}function ly(t,e,n){if((e=(0,A.Ku)(e))instanceof fu)return e._internalPath;if("string"==typeof e)return zT(t,e);throw WT("Field path arguments must be of type string or ",t,!1,void 0,n)}const hde=new RegExp("[~\\*/\\[\\]]");function zT(t,e,n){if(e.search(hde)>=0)throw WT(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fu(...e.split("."))._internalPath}catch{throw WT(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function WT(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new pe(Q.INVALID_ARGUMENT,a+t+u)}function qz(t,e){return t.some(n=>n.isEqual(e))}class dy{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Rn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new fde(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(KT("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n)}}}class fde extends dy{data(){return super.data()}}function KT(t,e){return"string"==typeof e?zT(t,e):e instanceof fu?e._internalPath:e._delegate._internalPath}function zz(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new pe(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class YP{}class hy extends YP{}function Nc(t,e,...n){let r=[];e instanceof YP&&r.push(e),r=r.concat(n),function(s){const o=s.filter(u=>u instanceof vp).length,a=s.filter(u=>u instanceof fy).length;if(o>1||o>0&&a>0)throw new pe(Q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class fy extends hy{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new fy(e,n,r)}_apply(e){const n=this._parse(e);return Yz(e._query,n),new Xr(e.firestore,e.converter,ZR(e._query,n))}_parse(e){const n=gd(e.firestore);return function(s,o,a,u,c,h,g){let _;if(c.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new pe(Q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){Qz(g,h);const v=[];for(const w of g)v.push(Kz(u,s,w));_={arrayValue:{values:v}}}else _=Kz(u,s,g)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||Qz(g,h),_=$z(a,"where",g,"in"===h||"not-in"===h);return St.create(c,h,_)}(e._query,0,n,e.firestore._databaseId,this._field,this._op,this._value)}}class vp extends YP{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new vp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===n.length?n[0]:tn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return 0===n.getFilters().length?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const u of a)Yz(o,u),o=ZR(o,u)}(e._query,n),new Xr(e.firestore,e.converter,ZR(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class ZP extends hy{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new ZP(e,n)}_apply(e){const n=function(i,s,o){if(null!==i.startAt)throw new pe(Q.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new pe(Q.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new U_(s,o)}(e._query,this._field,this._direction);return new Xr(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new uu(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}class QT extends hy{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new QT(e,n,r)}_apply(e){return new Xr(e.firestore,e.converter,fT(e._query,this._limit,this._limitType))}}class YT extends hy{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new YT(e,n,r)}_apply(e){const n=Wz(e,this.type,this._docOrFields,this._inclusive);return new Xr(e.firestore,e.converter,(s=n,new uu((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class ZT extends hy{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new ZT(e,n,r)}_apply(e){const n=Wz(e,this.type,this._docOrFields,this._inclusive);return new Xr(e.firestore,e.converter,(s=n,new uu((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function Wz(t,e,n,r){if(n[0]=(0,A.Ku)(n[0]),n[0]instanceof dy)return function(s,o,a,u,c){if(!u)throw new pe(Q.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const g of Wf(s))if(g.field.isKeyField())h.push(rd(o,u.key));else{const _=u.data.field(g.field);if(oT(_))throw new pe(Q.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===_){const v=g.field.canonicalString();throw new pe(Q.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}h.push(_)}return new Tc(h,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=gd(t.firestore);return function(o,a,u,c,h,g){const _=o.explicitOrderBy;if(h.length>_.length)throw new pe(Q.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let w=0;w<h.length;w++){const b=h[w];if(_[w].field.isKeyField()){if("string"!=typeof b)throw new pe(Q.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof b}`);if(!YR(o)&&-1!==b.indexOf("/"))throw new pe(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${b}' contains a slash.`);const D=o.path.child(Dt.fromString(b));if(!be.isDocumentKey(D))throw new pe(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${D}' is not because it contains an odd number of segments.`);const F=new be(D);v.push(rd(a,F))}else{const D=$z(u,c,b);v.push(D)}}return new Tc(v,g)}(t._query,t.firestore._databaseId,i,e,n,r)}}function Kz(t,e,n){if("string"==typeof(n=(0,A.Ku)(n))){if(""===n)throw new pe(Q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!YR(e)&&-1!==n.indexOf("/"))throw new pe(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Dt.fromString(n));if(!be.isDocumentKey(r))throw new pe(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return rd(t,new be(r))}if(n instanceof Rn)return rd(t,n._key);throw new pe(Q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jT(n)}.`)}function Qz(t,e){if(!Array.isArray(t)||0===t.length)throw new pe(Q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Yz(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw new pe(Q.INVALID_ARGUMENT,n===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class JP{convertValue(e,n="none"){switch(Ic(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(au(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw Le()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return yc(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new HT(Xn(e.latitude),Xn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=aT(e);return null==r?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(O_(e));default:return null}}convertTimestamp(e){const n=ou(e);return new Fn(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Dt.fromString(e);$e(aq(r));const i=new vc(r.get(1),r.get(3)),s=new be(r.popFirst(5));return i.isEqual(n)||dr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}function JT(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class wde extends JP{constructor(e){super(),this.firestore=e}convertBytes(e){return new ga(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Rn(this.firestore,null,n)}}class _d{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pu extends dy{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new py(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(KT("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class py extends pu{data(e={}){return super.data(e)}}class Pc{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new _d(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new py(this._firestore,this._userDataWriter,r.key,r,new _d(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new pe(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new py(i._firestore,i._userDataWriter,a.doc.key,a.doc,new _d(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:o++}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||3!==a.type).map(a=>{const u=new py(i._firestore,i._userDataWriter,a.doc.key,a.doc,new _d(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return 0!==a.type&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),1!==a.type&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:Cde(a.type),doc:u,oldIndex:c,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function Cde(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le()}}function Jz(t,e){return t instanceof pu&&e instanceof pu?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Pc&&e instanceof Pc&&t._firestore===e._firestore&&jP(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}class Mc extends JP{constructor(e){super(),this.firestore=e}convertBytes(e){return new ga(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Rn(this.firestore,null,n)}}function Xz(t,e,n){t=vt(t,Rn);const r=vt(t.firestore,sn),i=JT(t.converter,e,n);return Ep(r,[qT(gd(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Vn.none())])}function e4(t,e,n,...r){t=vt(t,Rn);const i=vt(t.firestore,sn),s=gd(i);let o;return o="string"==typeof(e=(0,A.Ku)(e))||e instanceof fu?KP(s,"updateDoc",t._key,e,n,r):WP(s,"updateDoc",t._key,e),Ep(i,[o.toMutation(t._key,Vn.exists(!0))])}function t4(t,...e){var n,r,i;t=(0,A.Ku)(t);let s={includeMetadataChanges:!1,source:"default"},o=0;"object"!=typeof e[o]||$P(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if($P(e[o])){const g=e[o];e[o]=null===(n=g.next)||void 0===n?void 0:n.bind(g),e[o+1]=null===(r=g.error)||void 0===r?void 0:r.bind(g),e[o+2]=null===(i=g.complete)||void 0===i?void 0:i.bind(g)}let u,c,h;if(t instanceof Rn)c=vt(t.firestore,sn),h=zf(t._key.path),u={next:g=>{e[o]&&e[o](XP(c,t,g))},error:e[o+1],complete:e[o+2]};else{const g=vt(t,Xr);c=vt(g.firestore,sn),h=g._query;const _=new Mc(c);u={next:v=>{e[o]&&e[o](new Pc(c,_,g,v))},error:e[o+1],complete:e[o+2]},zz(t._query)}return function(_,v,w,b){const D=new VT(b),F=new rP(v,D,w);return _.asyncQueue.enqueueAndForget((0,ne.A)(function*(){return ZN(yield yp(_),F)})),()=>{D.Ga(),_.asyncQueue.enqueueAndForget((0,ne.A)(function*(){return XN(yield yp(_),F)}))}}(Un(c),h,a,u)}function Ep(t,e){return function(r,i){const s=new Pr;return r.asyncQueue.enqueueAndForget((0,ne.A)(function*(){return function yle(t,e,n){return dP.apply(this,arguments)}(yield VP(r),i,s)})),s.promise}(Un(t),e)}function XP(t,e,n){const r=n.docs.get(e._key),i=new Mc(t);return new pu(t,i,e._key,r,new _d(n.hasPendingWrites,n.fromCache),e.converter)}const $de={maxAttempts:5};class n4{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=gd(e)}set(e,n,r){this._verifyNotCommitted();const i=xc(e,this._firestore),s=JT(i.converter,n,r),o=qT(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(o.toMutation(i._key,Vn.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=xc(e,this._firestore);let o;return o="string"==typeof(n=(0,A.Ku)(n))||n instanceof fu?KP(this._dataReader,"WriteBatch.update",s._key,n,r,i):WP(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Vn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=xc(e,this._firestore);return this._mutations=this._mutations.concat(new Jf(n._key,Vn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new pe(Q.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function xc(t,e){if((t=(0,A.Ku)(t)).firestore!==e)throw new pe(Q.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}class Hde extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=gd(n)}get(n){const r=xc(n,this._firestore),i=new wde(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||1!==s.length)return Le();const o=s[0];if(o.isFoundDocument())return new dy(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new dy(this._firestore,i,r._key,null,r.converter);throw Le()})}set(n,r,i){const s=xc(n,this._firestore),o=JT(s.converter,r,i),a=qT(this._dataReader,"Transaction.set",s._key,o,null!==s.converter,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){const o=xc(n,this._firestore);let a;return a="string"==typeof(r=(0,A.Ku)(r))||r instanceof fu?KP(this._dataReader,"Transaction.update",o._key,r,i,s):WP(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=xc(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=xc(e,this._firestore),r=new Mc(this._firestore);return super.get(e).then(i=>new pu(this._firestore,r,n._key,i._document,new _d(!1,!1),n.converter))}}function tM(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new pe("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function o4(){if(typeof Uint8Array>"u")throw new pe("unimplemented","Uint8Arrays are not available in this environment.")}function a4(){if(!function Iue(){return typeof atob<"u"}())throw new pe("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,n=!0){Vf=ss.SDK_VERSION,(0,ss._registerComponent)(new So.uA("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new sn(new Gae(r.getProvider("auth-internal")),new Wae(r.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new pe(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vc(c.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),(0,ss.registerVersion)(SH,"4.6.5",e),(0,ss.registerVersion)(SH,"4.6.5","esm2017")}();class gy{constructor(e){this._delegate=e}static fromBase64String(e){return a4(),new gy(ga.fromBase64String(e))}static fromUint8Array(e){return o4(),new gy(ga.fromUint8Array(e))}toBase64(){return a4(),this._delegate.toBase64()}toUint8Array(){return o4(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function nM(t){return function Xde(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const r of e)if(r in n&&"function"==typeof n[r])return!0;return!1}(t,["next","error","complete"])}class ehe{enableIndexedDbPersistence(e,n){return function ede(t,e){Vz(t=vt(t,sn));const n=Un(t);if(n._uninitializedComponentsProvider)throw new pe(Q.FAILED_PRECONDITION,"SDK cache is already specified.");os("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new mp;return Fz(n,i,new PP(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return function tde(t){Vz(t=vt(t,sn));const e=Un(t);if(e._uninitializedComponentsProvider)throw new pe(Q.FAILED_PRECONDITION,"SDK cache is already specified.");os("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new mp;return Fz(e,r,new yz(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function nde(t){if(t._initialized&&!t._terminated)throw new pe(Q.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Pr;return t._queue.enqueueAndForgetEvenWhileRestricted((0,ne.A)(function*(){try{yield(n=(0,ne.A)(function*(i){if(!ca.D())return Promise.resolve();const s=i+"main";yield ca.delete(s)}),function r(i){return n.apply(this,arguments)})(EN(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}var n})),e.promise}(e._delegate)}}class u4{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof vc||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&os("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},n),e)).merge,this._delegate._setSettings(e)}useEmulator(e,n,r={}){!function xz(t,e,n,r={}){var i;const s=(t=vt(t,ay))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&os("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if("string"==typeof r.mockUserToken)a=r.mockUserToken,u=$r.MOCK_USER;else{a=(0,A.Fy)(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new pe(Q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new $r(c)}t._authCredentials=new Hae(new RH(a,u))}}(this._delegate,e,n,r)}enableNetwork(){return function ide(t){return function Ule(t){return t.asyncQueue.enqueue((0,ne.A)(function*(){const e=yield Iz(t),n=yield wz(t);return e.setNetworkEnabled(!0),function(i){const s=Te(i);return s.N_.delete(0),oy(s)}(n)}))}(Un(t=vt(t,sn)))}(this._delegate)}disableNetwork(){return function sde(t){return function Ble(t){return t.asyncQueue.enqueue((0,ne.A)(function*(){const e=yield Iz(t),n=yield wz(t);return e.setNetworkEnabled(!1),(r=(0,ne.A)(function*(s){const o=Te(s);o.N_.add(0),yield ap(o),o.k_.set("Offline")}),function i(s){return r.apply(this,arguments)})(n);var r}))}(Un(t=vt(t,sn)))}(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Sz("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function rde(t){return function(n){const r=new Pr;return n.asyncQueue.enqueueAndForget((0,ne.A)(function*(){return function wle(t,e){return mP.apply(this,arguments)}(yield VP(n),r)})),r.promise}(Un(t=vt(t,sn)))}(this._delegate)}onSnapshotsInSync(e){return function xde(t,e){return function Gle(t,e){const n=new VT(e);return t.asyncQueue.enqueueAndForget((0,ne.A)(function*(){return i=yield yp(t),s=n,Te(i).J_.add(s),void s.next();var i,s})),()=>{n.Ga(),t.asyncQueue.enqueueAndForget((0,ne.A)(function*(){return i=yield yp(t),s=n,void Te(i).J_.delete(s);var i,s}))}}(Un(t=vt(t,sn)),$P(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new pe("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ip(this,kz(this._delegate,e))}catch(n){throw ji(n,"collection()","Firestore.collection()")}}doc(e){try{return new to(this,$T(this._delegate,e))}catch(n){throw ji(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new $i(this,function Yle(t,e){if(t=vt(t,ay),BP("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new pe(Q.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Xr(t,null,(r=e,new uu(Dt.emptyPath(),r)));var r}(this._delegate,e))}catch(n){throw ji(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function Gde(t,e,n){t=vt(t,sn);const r=Object.assign(Object.assign({},$de),n);return function(s){if(s.maxAttempts<1)throw new pe(Q.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const u=new Pr;return s.asyncQueue.enqueueAndForget((0,ne.A)(function*(){const c=yield function Tz(t){return BT(t).then(e=>e.datastore)}(s);new Fle(s.asyncQueue,c,a,o,u).nu()})),u.promise}(Un(t),i=>e(new Hde(t,i)),r)}(this._delegate,n=>e(new c4(this,n)))}batch(){return Un(this._delegate),new l4(new n4(this._delegate,e=>Ep(this._delegate,e)))}loadBundle(e){return function ode(t,e){const n=Un(t=vt(t,sn)),r=new Jle;return function qle(t,e,n,r){const i=function(o,a){let u;return u="string"==typeof o?jG().encode(o):o,h=function(h,g){if(h instanceof Uint8Array)return vz(h,g);if(h instanceof ArrayBuffer)return vz(new Uint8Array(h),g);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),new Ole(h,a);var h}(n,sy(e));t.asyncQueue.enqueueAndForget((0,ne.A)(function*(){!function xle(t,e,n){const r=Te(t);var i;(i=(0,ne.A)(function*(o,a,u){try{const c=yield a.getMetadata();if(yield function(w,b){const D=Te(w),F=hr(b.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",x=>D.Wr.getBundleMetadata(x,b.id)).then(x=>!!x&&x.createTime.compareTo(F)>=0)}(o.localStore,c))return yield a.close(),u._completeWith({taskState:"Success",documentsLoaded:(w=c).totalDocuments,bytesLoaded:w.totalBytes,totalDocuments:w.totalDocuments,totalBytes:w.totalBytes}),Promise.resolve(new Set);u._updateProgress(uz(c));const h=new lle(c,o.localStore,a.serializer);let g=yield a.$a();for(;g;){const v=yield h.ca(g);v&&u._updateProgress(v),g=yield a.$a()}const _=yield h.complete();return yield hu(o,_.Pa,void 0),yield function(w,b){const D=Te(w);return D.persistence.runTransaction("Save bundle","readwrite",F=>D.Wr.saveBundleMetadata(F,b))}(o.localStore,c),u._completeWith(_.progress),Promise.resolve(_.ha)}catch(c){return os("SyncEngine",`Loading bundle failed with ${c}`),u._failWith(c),Promise.resolve(new Set)}var w}),function s(o,a,u){return i.apply(this,arguments)})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield VP(t),i,r)}))}(n,t._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function ade(t,e){return function zle(t,e){return t.asyncQueue.enqueue((0,ne.A)(function*(){return function(r,i){const s=Te(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Wr.getNamedQuery(o,i))}(yield _p(t),e)}))}(Un(t=vt(t,sn)),e).then(n=>n?new Xr(t,null,n.query):null)}(this._delegate,e).then(n=>n?new $i(this,n):null)}}class eC extends JP{constructor(e){super(),this.firestore=e}convertBytes(e){return new gy(new ga(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return to.forKey(n,this.firestore,null)}}class c4{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new eC(e)}get(e){const n=vd(e);return this._delegate.get(n).then(r=>new my(this._firestore,new pu(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=vd(e);return r?(tM("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=vd(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=vd(e);return this._delegate.delete(n),this}}class l4{constructor(e){this._delegate=e}set(e,n,r){const i=vd(e);return r?(tM("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=vd(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=vd(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class yd{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new py(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new _y(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=yd.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new yd(e,new eC(e),n),i.set(n,s)),s}}yd.INSTANCES=new WeakMap;class to{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new eC(e)}static forPath(e,n,r){if(e.length%2!=0)throw new pe("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new to(n,new Rn(n._delegate,r,new be(e)))}static forKey(e,n,r){return new to(n,new Rn(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ip(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ip(this.firestore,kz(this._delegate,e))}catch(n){throw ji(n,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,A.Ku)(e))instanceof Rn&&Oz(this._delegate,e)}set(e,n){n=tM("DocumentReference.set",n);try{return n?Xz(this._delegate,e,n):Xz(this._delegate,e)}catch(r){throw ji(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return 1===arguments.length?e4(this._delegate,e):e4(this._delegate,e,n,...r)}catch(i){throw ji(i,"updateDoc()","DocumentReference.update()")}}delete(){return function Pde(t){return Ep(vt(t.firestore,sn),[new Jf(t._key,Vn.none())])}(this._delegate)}onSnapshot(...e){const n=d4(e),r=h4(e,i=>new my(this.firestore,new pu(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return t4(this._delegate,n,r)}get(e){let n;return n="cache"===e?.source?function bde(t){t=vt(t,Rn);const e=vt(t.firestore,sn),n=Un(e),r=new Mc(e);return function jle(t,e){const n=new Pr;return t.asyncQueue.enqueueAndForget((0,ne.A)(function*(){return(r=(0,ne.A)(function*(s,o,a){try{const u=yield function(h,g){const _=Te(h);return _.persistence.runTransaction("read document","readonly",v=>_.localDocuments.getDocument(v,g))}(s,o);u.isFoundDocument()?a.resolve(u):u.isNoDocument()?a.resolve(null):a.reject(new pe(Q.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const c=dp(u,`Failed to get document '${o} from cache`);a.reject(c)}}),function i(s,o,a){return r.apply(this,arguments)})(yield _p(t),e,n);var r})),n.promise}(n,t._key).then(i=>new pu(e,r,t._key,i,new _d(null!==i&&i.hasLocalMutations,!0),t.converter))}(this._delegate):"server"===e?.source?function Dde(t){t=vt(t,Rn);const e=vt(t.firestore,sn);return Cz(Un(e),t._key,{source:"server"}).then(n=>XP(e,t,n))}(this._delegate):function Ade(t){t=vt(t,Rn);const e=vt(t.firestore,sn);return Cz(Un(e),t._key).then(n=>XP(e,t,n))}(this._delegate),n.then(r=>new my(this.firestore,new pu(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new to(this.firestore,this._delegate.withConverter(e?yd.getInstance(this.firestore,e):null))}}function ji(t,e,n){return t.message=t.message.replace(e,n),t}function d4(t){for(const e of t)if("object"==typeof e&&!nM(e))return e;return{}}function h4(t,e){var n,r;let i;return i=nM(t[0])?t[0]:nM(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class my{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new to(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Jz(this._delegate,e._delegate)}}class _y extends my{data(e){const n=this._delegate.data(e);return this._delegate._converter||function jae(t,e){t||Le()}(void 0!==n),n}}class $i{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new eC(e)}where(e,n,r){try{return new $i(this.firestore,Nc(this._delegate,function pde(t,e,n){const r=e,i=KT("where",t);return fy._create(i,r,n)}(e,n,r)))}catch(i){throw ji(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new $i(this.firestore,Nc(this._delegate,function gde(t,e="asc"){const n=e,r=KT("orderBy",t);return ZP._create(r,n)}(e,n)))}catch(r){throw ji(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new $i(this.firestore,Nc(this._delegate,function mde(t){return Pz("limit",t),QT._create("limit",t,"F")}(e)))}catch(n){throw ji(n,"limit()","Query.limit()")}}limitToLast(e){try{return new $i(this.firestore,Nc(this._delegate,function _de(t){return Pz("limitToLast",t),QT._create("limitToLast",t,"L")}(e)))}catch(n){throw ji(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new $i(this.firestore,Nc(this._delegate,function yde(...t){return YT._create("startAt",t,!0)}(...e)))}catch(n){throw ji(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new $i(this.firestore,Nc(this._delegate,function vde(...t){return YT._create("startAfter",t,!1)}(...e)))}catch(n){throw ji(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new $i(this.firestore,Nc(this._delegate,function Ede(...t){return ZT._create("endBefore",t,!1)}(...e)))}catch(n){throw ji(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new $i(this.firestore,Nc(this._delegate,function Ide(...t){return ZT._create("endAt",t,!0)}(...e)))}catch(n){throw ji(n,"endAt()","Query.endAt()")}}isEqual(e){return jP(this._delegate,e._delegate)}get(e){let n;return n="cache"===e?.source?function Rde(t){t=vt(t,Xr);const e=vt(t.firestore,sn),n=Un(e),r=new Mc(e);return function $le(t,e){const n=new Pr;return t.asyncQueue.enqueueAndForget((0,ne.A)(function*(){return(r=(0,ne.A)(function*(s,o,a){try{const u=yield NT(s,o,!0),c=new dz(o,u.Is),h=c.Va(u.documents),g=c.applyChanges(h,!1);a.resolve(g.snapshot)}catch(u){const c=dp(u,`Failed to execute query '${o} against cache`);a.reject(c)}}),function i(s,o,a){return r.apply(this,arguments)})(yield _p(t),e,n);var r})),n.promise}(n,t._query).then(i=>new Pc(e,r,t,i))}(this._delegate):"server"===e?.source?function Nde(t){t=vt(t,Xr);const e=vt(t.firestore,sn),n=Un(e),r=new Mc(e);return Az(n,t._query,{source:"server"}).then(i=>new Pc(e,r,t,i))}(this._delegate):function Sde(t){t=vt(t,Xr);const e=vt(t.firestore,sn),n=Un(e),r=new Mc(e);return zz(t._query),Az(n,t._query).then(i=>new Pc(e,r,t,i))}(this._delegate),n.then(r=>new rM(this.firestore,new Pc(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=d4(e),r=h4(e,i=>new rM(this.firestore,new Pc(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return t4(this._delegate,n,r)}withConverter(e){return new $i(this.firestore,this._delegate.withConverter(e?yd.getInstance(this.firestore,e):null))}}class nhe{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new _y(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class rM{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new $i(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new _y(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new nhe(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new _y(this._firestore,r))})}isEqual(e){return Jz(this._delegate,e._delegate)}}class Ip extends $i{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new to(this.firestore,e):null}doc(e){try{return new to(this.firestore,void 0===e?$T(this._delegate):$T(this._delegate,e))}catch(n){throw ji(n,"doc()","CollectionReference.doc()")}}add(e){return function Mde(t,e){const n=vt(t.firestore,sn),r=$T(t),i=JT(t.converter,e);return Ep(n,[qT(gd(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Vn.exists(!1))]).then(()=>r)}(this._delegate,e).then(n=>new to(this.firestore,n))}isEqual(e){return Oz(this._delegate,e._delegate)}withConverter(e){return new Ip(this.firestore,this._delegate.withConverter(e?yd.getInstance(this.firestore,e):null))}}function vd(t){return vt(t,Rn)}class iM{constructor(...e){this._delegate=new fu(...e)}static documentId(){return new iM(Dn.keyField().canonicalString())}isEqual(e){return(e=(0,A.Ku)(e))instanceof fu&&this._delegate._internalPath.isEqual(e._internalPath)}}class Ed{constructor(e){this._delegate=e}static serverTimestamp(){const e=function zde(){return new HP("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Ed(e)}static delete(){const e=function qde(){return new cy("deleteField")}();return e._methodName="FieldValue.delete",new Ed(e)}static arrayUnion(...e){const n=function Wde(...t){return new GP("arrayUnion",t)}(...e);return n._methodName="FieldValue.arrayUnion",new Ed(n)}static arrayRemove(...e){const n=function Kde(...t){return new qP("arrayRemove",t)}(...e);return n._methodName="FieldValue.arrayRemove",new Ed(n)}static increment(e){const n=function Qde(t){return new zP("increment",t)}(e);return n._methodName="FieldValue.increment",new Ed(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const rhe={Firestore:u4,GeoPoint:HT,Timestamp:Fn,Blob:gy,Transaction:c4,WriteBatch:l4,DocumentReference:to,DocumentSnapshot:my,Query:$i,QueryDocumentSnapshot:_y,QuerySnapshot:rM,CollectionReference:Ip,FieldPath:iM,FieldValue:Ed,setLogLevel:function the(t){!function Bae(t){gc.setLogLevel(t)}(t)},CACHE_SIZE_UNLIMITED:-1};function f4(t,e){return function ohe(t,e=jw){return new nn(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}(t,e)}function sM(t,e){return f4(t,e).pipe(Ae(n=>({payload:n,type:"query"})))}!function she(t){(function ihe(t,e){t.INTERNAL.registerComponent(new So.uA("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},rhe)))})(t,(e,n)=>new u4(e,n,new ehe)),t.registerVersion("@firebase/firestore-compat","0.3.34")}(_i.A);class p4{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){const r=this.ref.collection(e),{ref:i,query:s}=E4(r,n);return new _4(i,s,this.afs)}snapshotChanges(){return function ahe(t,e){return f4(t,e).pipe(eT(void 0),OR(),Ae(n=>{const[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(lr)}valueChanges(e={}){return this.snapshotChanges().pipe(Ae(({payload:n})=>e.idField?{...n.data(),[e.idField]:n.id}:n.data()))}get(e){return en(this.ref.get(e)).pipe(lr)}}function tC(t,e){return sM(t,e).pipe(eT(void 0),OR(),Ae(n=>{const[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{const c=s.find(g=>g.doc.ref.isEqual(a.ref)),h=r?.payload.docs.find(g=>g.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&h&&JSON.stringify(h.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function g4(t,e,n){return tC(t,n).pipe(Ff((r,i)=>function uhe(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=function che(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return oM(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return oM(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return oM(t,e.oldIndex,1)}return t}(t,r))}),t}(r,i.map(s=>s.payload),e),[]),yH(),Ae(r=>r.map(i=>({type:i.type,payload:i}))))}function oM(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function m4(t){return(!t||0===t.length)&&(t=["added","removed","modified"]),t}class _4{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=tC(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(Ae(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(eT(void 0),OR(),Do(([r,i])=>i.length>0||!r),Ae(([,r])=>r),lr)}auditTrail(e){return this.stateChanges(e).pipe(Ff((n,r)=>[...n,...r],[]))}snapshotChanges(e){const n=m4(e);return g4(this.query,n,this.afs.schedulers.outsideAngular).pipe(lr)}valueChanges(e={}){return sM(this.query,this.afs.schedulers.outsideAngular).pipe(Ae(n=>n.payload.docs.map(r=>e.idField?{...r.data(),[e.idField]:r.id}:r.data())),lr)}get(e){return en(this.query.get(e)).pipe(lr)}add(e){return this.ref.add(e)}doc(e){return new p4(this.ref.doc(e),this.afs)}}class lhe{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return e&&0!==e.length?tC(this.query,this.afs.schedulers.outsideAngular).pipe(Ae(n=>n.filter(r=>e.indexOf(r.type)>-1)),Do(n=>n.length>0),lr):tC(this.query,this.afs.schedulers.outsideAngular).pipe(lr)}auditTrail(e){return this.stateChanges(e).pipe(Ff((n,r)=>[...n,...r],[]))}snapshotChanges(e){const n=m4(e);return g4(this.query,n,this.afs.schedulers.outsideAngular).pipe(lr)}valueChanges(e={}){return sM(this.query,this.afs.schedulers.outsideAngular).pipe(Ae(r=>r.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),lr)}get(e){return en(this.query.get(e)).pipe(lr)}}const y4=new ve("angularfire2.enableFirestorePersistence"),v4=new ve("angularfire2.firestore.persistenceSettings"),dhe=new ve("angularfire2.firestore.settings"),hhe=new ve("angularfire2.firestore.use-emulator");function E4(t,e=(n=>n)){return{query:e(t),ref:t}}let I4=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,c,h,g,_,v,w,b,D,F,x){this.schedulers=u;const $=A_(n,a,r),ie=h;g&&IR($,a,_,w,b,D,v,F),[this.firestore,this.persistenceEnabled$]=Gw(`${$.name}.firestore`,"AngularFirestore",$.name,()=>{const Ie=a.runOutsideAngular(()=>$.firestore());if(s&&Ie.settings(s),ie&&Ie.useEmulator(...ie),i&&!vw(o)){const Pe=()=>{try{return en(Ie.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(V){return typeof console<"u"&&console.warn(V),We(!1)}};return[Ie,a.runOutsideAngular(Pe)]}return[Ie,We(!1)]},[s,ie,i])}collection(n,r){let i;i="string"==typeof n?this.firestore.collection(n):n;const{ref:s,query:o}=E4(i,r),a=this.schedulers.ngZone.run(()=>s);return new _4(a,o,this)}collectionGroup(n,r){const i=r||(o=>o),s=this.firestore.collectionGroup(n);return new lhe(i(s),this)}doc(n){let r;r="string"==typeof n?this.firestore.doc(n):n;const i=this.schedulers.ngZone.run(()=>r);return new p4(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(ce(Rf),ce(Nf,8),ce(y4,8),ce(dhe,8),ce(Ys),ce(At),ce(Hw),ce(v4,8),ce(hhe,8),ce(pc,8),ce(gR,8),ce(mR,8),ce(_R,8),ce(yR,8),ce(vR,8),ce(ER,8),ce($w,8))};static \u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),fhe=(()=>{class t{constructor(){_i.A.registerVersion("angularfire",bf.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:y4,useValue:!0},{provide:v4,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Fr({type:t});static \u0275inj=pr({providers:[I4]})}return t})();const w4="@firebase/database";let aM="";function uM(t){aM=t}class mhe{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){null==n?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,A.As)(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return null==n?null:(0,A.$L)(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class _he{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){null==n?delete this.cache_[e]:this.cache_[e]=n}get(e){return(0,A.gR)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const C4=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new mhe(e)}}catch{}return new _he},Id=C4("localStorage"),cM=C4("sessionStorage"),wp=new Ds.Vy("@firebase/database"),A4=function(){let t=1;return function(){return t++}}(),b4=function(t){const e=(0,A.kj)(t),n=new A.gz;n.update(e);const r=n.digest();return A.K3.encodeByteArray(r)},yy=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=yy.apply(null,r):e+="object"==typeof r?(0,A.As)(r):r,e+=" "}return e};let wd=null,D4=!0;const S4=function(t,e){(0,A.vA)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(wp.logLevel=Ds.$b.VERBOSE,wd=wp.log.bind(wp),e&&cM.set("logging_enabled",!0)):"function"==typeof t?wd=t:(wd=null,cM.remove("logging_enabled"))},Gr=function(...t){if(!0===D4&&(D4=!1,null===wd&&!0===cM.get("logging_enabled")&&S4(!0)),wd){const e=yy.apply(null,t);wd(e)}},vy=function(t){return function(...e){Gr(t,...e)}},lM=function(...t){const e="FIREBASE INTERNAL ERROR: "+yy(...t);wp.error(e)},ma=function(...t){const e=`FIREBASE FATAL ERROR: ${yy(...t)}`;throw wp.error(e),new Error(e)},Ci=function(...t){const e="FIREBASE WARNING: "+yy(...t);wp.warn(e)},nC=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},kc="[MIN_NAME]",gu="[MAX_NAME]",Td=function(t,e){if(t===e)return 0;if(t===kc||e===gu)return-1;if(e===kc||t===gu)return 1;{const n=P4(t),r=P4(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1}},Ehe=function(t,e){return t===e?0:t<e?-1:1},Ey=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,A.As)(e))},dM=function(t){if("object"!=typeof t||null===t)return(0,A.As)(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)0!==r&&(n+=","),n+=(0,A.As)(e[r]),n+=":",n+=dM(t[e[r]]);return n+="}",n},R4=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)r.push(t.substring(i,i+e>n?n:i+e));return r};function qr(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const N4=function(t){(0,A.vA)(!nC(t),"Invalid JSON number");const r=1023;let i,s,o,a,u;0===t?(s=0,o=0,i=1/t==-1/0?1:0):(i=t<0,(t=Math.abs(t))>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,52-a)-Math.pow(2,52))):(s=0,o=Math.round(t/Math.pow(2,-1074))));const c=[];for(u=52;u;u-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(u=11;u;u-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();const h=c.join("");let g="";for(u=0;u<64;u+=8){let _=parseInt(h.substr(u,8),2).toString(16);1===_.length&&(_="0"+_),g+=_}return g.toLowerCase()},Che=new RegExp("^-?(0*)\\d{1,10}$"),P4=function(t){if(Che.test(t)){const e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},Tp=function(t){try{t()}catch(e){setTimeout(()=>{throw Ci("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},Iy=function(t,e){const n=setTimeout(t,e);return"number"==typeof n&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class She{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;null===(n=this.appCheckProvider)||void 0===n||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Ci(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Rhe{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&"auth/token-not-initialized"===n.code?(Gr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ci(e)}}let wy=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}return t.OWNER="owner",t})();const L4=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,U4="websocket",B4="long_polling";class fM{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Id.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Id.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function j4(t,e,n){let r;if((0,A.vA)("string"==typeof e,"typeof type must == string"),(0,A.vA)("object"==typeof n,"typeof params must == object"),e===U4)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==B4)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function Nhe(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);const i=[];return qr(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}class Phe{constructor(){this.counters_={}}incrementCounter(e,n=1){(0,A.gR)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return(0,A.A4)(this.counters_)}}const pM={},gM={};function mM(t){const e=t.toString();return pM[e]||(pM[e]=new Phe),pM[e]}class xhe{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Tp(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Oc{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=vy(e),this.stats_=mM(n),this.urlFn=u=>(this.appCheckToken&&(u.ac=this.appCheckToken),j4(n,B4,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new xhe(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if((0,A.$g)()||"complete"===document.readyState)t();else{let e=!1;const n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new _M((...s)=>{const[o,a,u,c,h]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=a,this.password=u;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&L4.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Oc.forceAllow_=!0}static forceDisallow(){Oc.forceDisallow_=!0}static isAvailable(){return!((0,A.$g)()||!Oc.forceAllow_&&(Oc.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=(0,A.As)(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=(0,A.KA)(n),i=R4(r,1840);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if((0,A.$g)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=(0,A.As)(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class _M{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,A.$g)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=A4(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=_M.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Gr("frame writing exception"),a.stack&&Gr(a.stack),Gr(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Gr("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const o=this.pendingSegs.shift();r=r+"&seg"+i+"="+o.seg+"&ts"+i+"="+o.ts+"&d"+i+"="+o.d,i++}return n+=r,this.addLongPollTag_(n,this.currentSerial),!0}return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,n){(0,A.$g)()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Gr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let iC=null;typeof MozWebSocket<"u"?iC=MozWebSocket:typeof WebSocket<"u"&&(iC=WebSocket);let Cp=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=vy(this.connId),this.stats_=mM(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){const a={v:"5"};return!(0,A.$g)()&&typeof location<"u"&&location.hostname&&L4.test(location.hostname)&&(a.r="f"),r&&(a.s=r),i&&(a.ls=i),s&&(a.ac=s),o&&(a.p=o),j4(n,U4,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Id.set("previous_websocket_failure",!0);try{let i;if((0,A.$g)()){i={headers:{"User-Agent":`Firebase/5/${aM}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new iC(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&null!==iC&&!t.forceDisallow_}static previouslyFailed(){return Id.isInMemoryStorage||!0===Id.get("previous_websocket_failure")}markConnectionHealthy(){Id.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,A.$L)(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if((0,A.vA)(null===this.frames,"We already have a frame buffer"),n.length<=6){const r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(null===this.mySock)return;const r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();const r=(0,A.As)(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=R4(r,16384);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t})(),K4=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Oc,Cp]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){const r=Cp&&Cp.isAvailable();let i=r&&!Cp.previouslyFailed();if(n.webSocketOnly&&(r||Ci("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Cp];else{const s=this.transports_=[];for(const o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return t.globalTransportInitialized_=!1,t})();class tW{constructor(e,n,r,i,s,o,a,u,c,h){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=vy("c:"+this.id+":"),this.transportManager_=new K4(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Iy(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const n=e.t;"a"===n?this.upgradeIfSecondaryHealthy_():"r"===n?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===n&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Ey("t",e),r=Ey("d",e);if("c"===n)this.onSecondaryControl_(r);else{if("d"!==n)throw new Error("Unknown protocol layer: "+n);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Ey("t",e),r=Ey("d",e);"c"===n?this.onControl_(r):"d"===n&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Ey("t",e);if("d"in e){const r=e.d;if("h"===n){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===n){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===n?this.onConnectionShutdown_(r):"r"===n?this.onReset_(r):"e"===n?lM("Server Error: "+r):"o"===n?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):lM("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),"5"!==r&&Ci("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Iy(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Iy(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Id.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class nW{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}class rW{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,A.vA)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context))return void i.splice(s,1)}validateEventType_(e){(0,A.vA)(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}class sC extends rW{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,A.jZ)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new sC}getInitialEvent(e){return(0,A.vA)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Qt{constructor(e,n){if(void 0===n){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)""!==this.pieces_[n]&&(e+="/"+this.pieces_[n]);return e||"/"}}function jt(){return new Qt("")}function Et(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Lc(t){return t.pieces_.length-t.pieceNum_}function ln(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Qt(t.pieces_,e)}function vM(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Ty(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function oW(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Qt(e,0)}function Bn(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Qt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Qt(n,0)}function It(t){return t.pieceNum_>=t.pieces_.length}function Hi(t,e){const n=Et(t),r=Et(e);if(null===n)return e;if(n===r)return Hi(ln(t),ln(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function tfe(t,e){const n=Ty(t,0),r=Ty(e,0);for(let i=0;i<n.length&&i<r.length;i++){const s=Td(n[i],r[i]);if(0!==s)return s}return n.length===r.length?0:n.length<r.length?-1:1}function EM(t,e){if(Lc(t)!==Lc(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function no(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Lc(t)>Lc(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class nfe{constructor(e,n){this.errorPrefix_=n,this.parts_=Ty(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,A.OE)(this.parts_[r]);aW(this)}}function aW(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Cd(t))}function Cd(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class IM extends rW{constructor(){let e,n;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new IM}getInitialEvent(e){return(0,A.vA)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Cy=1e3;let aC,Ad=(()=>{class t extends nW{constructor(n,r,i,s,o,a,u,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=vy("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Cy,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!(0,A.$g)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");IM.getInstance().on("visible",this.onVisible_,this),-1===n.host.indexOf("fblocal")&&sC.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){const s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_((0,A.As)(o)),(0,A.vA)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();const r=new A.cY,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{const u=a.d;"ok"===a.s?r.resolve(u):r.reject(u)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(n,r,i,s){this.initConnection_();const o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),(0,A.vA)(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,A.vA)(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){const r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){const r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i};n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest("q",o,u=>{const c=u.d,h=u.s;t.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),"ok"!==h&&this.removeListen_(i,s),n.onComplete&&n.onComplete(h,c))})}static warnOnListenWarnings_(n,r){if(n&&"object"==typeof n&&(0,A.gR)(n,"w")){const i=(0,A.yw)(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Ci(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&40===n.length||(0,A.qc)(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const n=this.authToken_,r=(0,A.Cv)(n)?"auth":"gauth",i={cred:n};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{const o=s.s,a=s.d||"error";this.authToken_===n&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{const r=n.s,i=n.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){const i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),(0,A.vA)(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);const o={p:n};s&&(o.q=i,o.t=s),this.sendRequest("n",o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){const o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();const a={p:r,d:i};void 0!==o&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(n){const r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){const r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+(0,A.As)(n));const r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),"d"===n?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===n?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===n?this.onListenRevoked_(r.p,r.q):"ac"===n?this.onAuthRevoked_(r.s,r.d):"apc"===n?this.onAppCheckRevoked_(r.s,r.d):"sd"===n?this.onSecurityDebugPacket_(r):lM("Unrecognized action received from server: "+(0,A.As)(n)+"\nAre you using the latest client?")}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){(0,A.vA)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Cy,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Cy,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Cy),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const n=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var n=this;return(0,ne.A)(function*(){if(n.shouldReconnect_()){n.log_("Making a connection attempt"),n.lastConnectionAttemptTime_=(new Date).getTime(),n.lastConnectionEstablishedTime_=null;const r=n.onDataMessage_.bind(n),i=n.onReady_.bind(n),s=n.onRealtimeDisconnect_.bind(n),o=n.id+":"+t.nextConnectionId_++,a=n.lastSessionId;let u=!1,c=null;const h=function(){c?c.close():(u=!0,s())};n.realtime_={close:h,sendRequest:function(v){(0,A.vA)(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(v)}};const _=n.forceTokenRefresh_;n.forceTokenRefresh_=!1;try{const[v,w]=yield Promise.all([n.authTokenProvider_.getToken(_),n.appCheckTokenProvider_.getToken(_)]);u?Gr("getToken() completed but was canceled"):(Gr("getToken() completed. Creating connection."),n.authToken_=v&&v.accessToken,n.appCheckToken_=w&&w.token,c=new tW(o,n.repoInfo_,n.applicationId_,n.appCheckToken_,n.authToken_,r,i,s,b=>{Ci(b+" ("+n.repoInfo_.toString()+")"),n.interrupt("server_kill")},a))}catch(v){n.log_("Failed to get token: "+v),u||(n.repoInfo_.nodeAdmin&&Ci(v),h())}}})()}interrupt(n){Gr("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Gr("Resuming connection for reason: "+n),delete this.interruptReasons_[n],(0,A.Im)(this.interruptReasons_)&&(this.reconnectDelay_=Cy,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){const r=n-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){const r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;i=r?r.map(o=>dM(o)).join("$"):"default";const s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){const i=new Qt(n).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(r),o.delete(r),0===o.size&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Gr("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===n||"permission_denied"===n)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Gr("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===n||"permission_denied"===n)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const n of this.listens.values())for(const r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){const n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){const n={};let r="js";(0,A.$g)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),n["sdk."+r+"."+aM.replace(/\./g,"-")]=1,(0,A.jZ)()?n["framework.cordova"]=1:(0,A.lV)()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){const n=sC.getInstance().currentlyOnline();return(0,A.Im)(this.interruptReasons_)&&n}}return t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t})();class Tt{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new Tt(e,n)}}class oC{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new Tt(kc,e),i=new Tt(kc,n);return 0!==this.compare(r,i)}minPost(){return Tt.MIN}}class lW extends oC{static get __EMPTY_NODE(){return aC}static set __EMPTY_NODE(e){aC=e}compare(e,n){return Td(e.name,n.name)}isDefinedOn(e){throw(0,A.Hk)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Tt.MIN}maxPost(){return new Tt(gu,aC)}makePost(e,n){return(0,A.vA)("string"==typeof e,"KeyIndex indexValue must always be a string."),new Tt(e,aC)}toString(){return".key"}}const _a=new lW;class uC{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,i&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let n,e=this.nodeStack_.pop();if(n=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let TM,No=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??cs.EMPTY_NODE,this.right=o??cs.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this;const o=i(n,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(n,r,i),null):0===o?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return cs.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(n,i.key)){if(i.right.isEmpty())return cs.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){const n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){const n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){const n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){const n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})();class cs{constructor(e,n=cs.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new cs(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,No.BLACK,null,null))}remove(e){return new cs(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,No.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),0===n)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),0===n){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}n<0?r=r.left:n>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new uC(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new uC(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new uC(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new uC(this.root_,null,this.comparator_,!0,e)}}function lfe(t,e){return Td(t.name,e.name)}function wM(t,e){return Td(t,e)}cs.EMPTY_NODE=new class cfe{copy(e,n,r,i,s){return this}insert(e,n,r){return new No(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const dW=function(t){return"number"==typeof t?"number:"+N4(t):"string:"+t},hW=function(t){if(t.isLeafNode()){const e=t.val();(0,A.vA)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,A.gR)(e,".sv"),"Priority must be a string or number.")}else(0,A.vA)(t===TM||t.isEmpty(),"priority of unexpected type.");(0,A.vA)(t===TM||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let fW,pW,gW,Ap=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,(0,A.vA)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),hW(this.priorityNode_)}static set __childrenNodeConstructor(n){fW=n}static get __childrenNodeConstructor(){return fW}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return".priority"===n?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return It(n)?this:".priority"===Et(n)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return".priority"===n?this.updatePriority(r):r.isEmpty()&&".priority"!==n?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){const i=Et(n);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,A.vA)(".priority"!==i||1===Lc(n),".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(ln(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+dW(this.priorityNode_.val())+":");const r=typeof this.value_;n+=r+":",n+="number"===r?N4(this.value_):this.value_,this.lazyHash_=b4(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:((0,A.vA)(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){const r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return(0,A.vA)(s>=0,"Unknown leaf type: "+r),(0,A.vA)(o>=0,"Unknown leaf type: "+i),s===o?"object"===i?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){return n===this||!!n.isLeafNode()&&(this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_))}}return t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t})();const In=new class pfe extends oC{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return 0===s?Td(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Tt.MIN}maxPost(){return new Tt(gu,new Ap("[PRIORITY-POST]",gW))}makePost(e,n){const r=pW(e);return new Tt(n,new Ap("[PRIORITY-POST]",r))}toString(){return".priority"}},gfe=Math.log(2);class mfe{constructor(e){this.count=parseInt(Math.log(e+1)/gfe,10),this.current_=this.count-1;const i=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const cC=function(t,e,n,r){t.sort(e);const i=function(u,c){const h=c-u;let g,_;if(0===h)return null;if(1===h)return g=t[u],_=n?n(g):g,new No(_,g.node,No.BLACK,null,null);{const v=parseInt(h/2,10)+u,w=i(u,v),b=i(v+1,c);return g=t[v],_=n?n(g):g,new No(_,g.node,No.BLACK,w,b)}},a=function(u){let c=null,h=null,g=t.length;const _=function(w,b){const D=g-w,F=g;g-=w;const x=i(D+1,F),$=t[D],ie=n?n($):$;v(new No(ie,$.node,b,null,x))},v=function(w){c?(c.left=w,c=w):(h=w,c=w)};for(let w=0;w<u.count;++w){const b=u.nextBitIsOne(),D=Math.pow(2,u.count-(w+1));b?_(D,No.BLACK):(_(D,No.BLACK),_(D,No.RED))}return h}(new mfe(t.length));return new cs(r||e,a)};let CM;const bp={};class mu{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return(0,A.vA)(bp&&In,"ChildrenNode.ts has not been loaded"),CM=CM||new mu({".priority":bp},{".priority":In}),CM}get(e){const n=(0,A.yw)(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof cs?n:null}hasIndex(e){return(0,A.gR)(this.indexSet_,e.toString())}addIndex(e,n){(0,A.vA)(e!==_a,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(Tt.Wrap);let a,o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();a=i?cC(r,e.getCompare()):bp;const u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;const h=Object.assign({},this.indexes_);return h[u]=a,new mu(h,c)}addToIndexes(e,n){const r=(0,A.kH)(this.indexes_,(i,s)=>{const o=(0,A.yw)(this.indexSet_,s);if((0,A.vA)(o,"Missing index implementation for "+s),i===bp){if(o.isDefinedOn(e.node)){const a=[],u=n.getIterator(Tt.Wrap);let c=u.getNext();for(;c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),cC(a,o.getCompare())}return bp}{const a=n.get(e.name);let u=i;return a&&(u=u.remove(new Tt(e.name,a))),u.insert(e,e.node)}});return new mu(r,this.indexSet_)}removeFromIndexes(e,n){const r=(0,A.kH)(this.indexes_,i=>{if(i===bp)return i;{const s=n.get(e.name);return s?i.remove(new Tt(e.name,s)):i}});return new mu(r,this.indexSet_)}}let Ay,dt=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&hW(this.priorityNode_),this.children_.isEmpty()&&(0,A.vA)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ay||(Ay=new t(new cs(wM),null,mu.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ay}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(".priority"===n)return this.getPriority();{const r=this.children_.get(n);return null===r?Ay:r}}getChild(n){const r=Et(n);return null===r?this:this.getImmediateChild(r).getChild(ln(n))}hasChild(n){return null!==this.children_.get(n)}updateImmediateChild(n,r){if((0,A.vA)(r,"We should always be passing snapshot nodes"),".priority"===n)return this.updatePriority(r);{const i=new Tt(n,r);let s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));const a=s.isEmpty()?Ay:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){const i=Et(n);if(null===i)return r;{(0,A.vA)(".priority"!==Et(n)||1===Lc(n),".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(ln(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;const r={};let i=0,s=0,o=!0;if(this.forEachChild(In,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){const a=[];for(const u in r)a[u]=r[u];return a}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let n="";this.getPriority().isEmpty()||(n+="priority:"+dW(this.getPriority().val())+":"),this.forEachChild(In,(r,i)=>{const s=i.hash();""!==s&&(n+=":"+r+":"+s)}),this.lazyHash_=""===n?"":b4(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new Tt(n,r));return o?o.name:null}return this.children_.getPredecessorKey(n)}getFirstChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(n){const r=this.getFirstChildName(n);return r?new Tt(r,this.children_.get(r)):null}getLastChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(n){const r=this.getLastChildName(n);return r?new Tt(r,this.children_.get(r)):null}forEachChild(n,r){const i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{const s=this.children_.getIteratorFrom(n.name,Tt.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{const s=this.children_.getReverseIteratorFrom(n.name,Tt.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===by?-1:0}withIndex(n){if(n===_a||this.indexMap_.hasIndex(n))return this;{const r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===_a||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{const r=n;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(In),s=r.getIterator(In);let o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return null===o&&null===a}return!1}return!1}}resolveIndex_(n){return n===_a?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})();const by=new class _fe extends dt{constructor(){super(new cs(wM),dt.EMPTY_NODE,mu.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return dt.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Tt,{MIN:{value:new Tt(kc,dt.EMPTY_NODE)},MAX:{value:new Tt(gu,by)}}),lW.__EMPTY_NODE=dt.EMPTY_NODE,Ap.__childrenNodeConstructor=dt,function dfe(t){TM=t}(by),function ffe(t){gW=t}(by);const yfe=!0;function Kn(t,e=null){if(null===t)return dt.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,A.vA)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Ap(t,Kn(e));if(t instanceof Array||!yfe){let n=dt.EMPTY_NODE;return qr(t,(r,i)=>{if((0,A.gR)(t,r)&&"."!==r.substring(0,1)){const s=Kn(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Kn(e))}{const n=[];let r=!1;if(qr(t,(o,a)=>{if("."!==o.substring(0,1)){const u=Kn(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new Tt(o,u)))}}),0===n.length)return dt.EMPTY_NODE;const s=cC(n,lfe,o=>o.name,wM);if(r){const o=cC(n,In.getCompare());return new dt(s,Kn(e),new mu({".priority":o},{".priority":In}))}return new dt(s,Kn(e),mu.Default)}}!function hfe(t){pW=t}(Kn);class AM extends oC{constructor(e){super(),this.indexPath_=e,(0,A.vA)(!It(e)&&".priority"!==Et(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return 0===s?Td(e.name,n.name):s}makePost(e,n){const r=Kn(e),i=dt.EMPTY_NODE.updateChild(this.indexPath_,r);return new Tt(n,i)}maxPost(){const e=dt.EMPTY_NODE.updateChild(this.indexPath_,by);return new Tt(gu,e)}toString(){return Ty(this.indexPath_,0).join("/")}}const bM=new class vfe extends oC{compare(e,n){const r=e.node.compareTo(n.node);return 0===r?Td(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Tt.MIN}maxPost(){return Tt.MAX}makePost(e,n){const r=Kn(e);return new Tt(n,r)}toString(){return".value"}};function mW(t){return{type:"value",snapshotNode:t}}function Dp(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Dy(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Sy(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}class DM{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){(0,A.vA)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(null!=o&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Dy(n,a)):(0,A.vA)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Dp(n,r)):o.trackChildChange(Sy(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return null!=r&&(e.isLeafNode()||e.forEachChild(In,(i,s)=>{n.hasChild(i)||r.trackChildChange(Dy(i,s))}),n.isLeafNode()||n.forEachChild(In,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Sy(i,s,o))}else r.trackChildChange(Dp(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?dt.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Ry{constructor(e){this.indexedFilter_=new DM(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Ry.getStartPost_(e),this.endPost_=Ry.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new Tt(n,r))||(r=dt.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=dt.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(dt.EMPTY_NODE);const s=this;return n.forEachChild(In,(o,a)=>{s.matches(new Tt(o,a))||(i=i.updateImmediateChild(o,dt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}return e.getIndex().maxPost()}}class Ife{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Ry(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new Tt(n,r))||(r=dt.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=dt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<n.numChildren()&&n.isIndexed(this.index_)){let s;i=dt.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a)){if(!this.withinDirectionalEnd(a))break;i=i.updateImmediateChild(a.name,a.node),o++}}}else{let s;i=n.withIndex(this.index_),i=i.updatePriority(dt.EMPTY_NODE),s=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,dt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){const g=this.index_.getCompare();o=(_,v)=>g(v,_)}else o=this.index_.getCompare();const a=e;(0,A.vA)(a.numChildren()===this.limit_,"");const u=new Tt(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(u);if(a.hasChild(n)){const g=a.getImmediateChild(n);let _=i.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=_&&(_.name===n||a.hasChild(_.name));)_=i.getChildAfterChild(this.index_,_,this.reverse_);const v=null==_?1:o(_,u);if(h&&!r.isEmpty()&&v>=0)return s?.trackChildChange(Sy(n,r,g)),a.updateImmediateChild(n,r);{s?.trackChildChange(Dy(n,g));const b=a.updateImmediateChild(n,dt.EMPTY_NODE);return null!=_&&this.rangedFilter_.matches(_)?(s?.trackChildChange(Dp(_.name,_.node)),b.updateImmediateChild(_.name,_.node)):b}}return r.isEmpty()?e:h&&o(c,u)>=0?(null!=s&&(s.trackChildChange(Dy(c.name,c.node)),s.trackChildChange(Dp(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,dt.EMPTY_NODE)):e}}class lC{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=In}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,A.vA)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,A.vA)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:kc}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,A.vA)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,A.vA)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:gu}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,A.vA)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===In}copy(){const e=new lC;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function SM(t,e,n){const r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function RM(t,e,n){const r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function dC(t,e){const n=t.copy();return n.index_=e,n}function _W(t){const e={};if(t.isDefault())return e;let n;if(t.index_===In?n="$priority":t.index_===bM?n="$value":t.index_===_a?n="$key":((0,A.vA)(t.index_ instanceof AM,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=(0,A.As)(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=(0,A.As)(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+(0,A.As)(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=(0,A.As)(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+(0,A.As)(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function yW(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==In&&(e.i=t.index_.toString()),e}class hC extends nW{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=vy("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return void 0!==n?"tag$"+n:((0,A.vA)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=hC.getListenId_(e,r),a={};this.listens_[o]=a;const u=_W(e._queryParams);this.restRequest_(s+".json",u,(c,h)=>{let g=h;if(404===c&&(g=null,c=null),null===c&&this.onDataUpdate_(s,g,!1,r),(0,A.yw)(this.listens_,o)===a){let _;_=c?401===c?"permission_denied":"rest_error:"+c:"ok",i(_,null)}})}unlisten(e,n){const r=hC.getListenId_(e,n);delete this.listens_[r]}get(e){const n=_W(e._queryParams),r=e._path.toString(),i=new A.cY;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;404===s&&(a=null,s=null),null===s?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,A.Am)(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=(0,A.$L)(a.responseText)}catch{Ci("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else 401!==a.status&&404!==a.status&&Ci("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}class Dfe{constructor(){this.rootNode_=dt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}function fC(){return{value:null,children:new Map}}function Sp(t,e,n){if(It(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{const r=Et(e);t.children.has(r)||t.children.set(r,fC()),Sp(t.children.get(r),e=ln(e),n)}}function NM(t,e){if(It(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(In,(r,i)=>{Sp(t,new Qt(r),i)}),NM(t,e)}}if(t.children.size>0){const n=Et(e);return e=ln(e),t.children.has(n)&&NM(t.children.get(n),e)&&t.children.delete(n),0===t.children.size}return!0}function PM(t,e,n){null!==t.value?n(e,t.value):function Sfe(t,e){t.children.forEach((n,r)=>{e(r,n)})}(t,(r,i)=>{PM(i,new Qt(e.toString()+"/"+r),n)})}class Rfe{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&qr(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}class Mfe{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Rfe(e);const r=1e4+2e4*Math.random();Iy(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;qr(e,(i,s)=>{s>0&&(0,A.gR)(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Iy(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var ya=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(ya||{});function kM(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}class pC{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=ya.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(It(this.path)){if(null!=this.affectedTree.value)return(0,A.vA)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Qt(e));return new pC(jt(),n,this.revert)}}return(0,A.vA)(Et(this.path)===e,"operationForChild called for unrelated child."),new pC(ln(this.path),this.affectedTree,this.revert)}}class Ny{constructor(e,n){this.source=e,this.path=n,this.type=ya.LISTEN_COMPLETE}operationForChild(e){return It(this.path)?new Ny(this.source,jt()):new Ny(this.source,ln(this.path))}}class bd{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=ya.OVERWRITE}operationForChild(e){return It(this.path)?new bd(this.source,jt(),this.snap.getImmediateChild(e)):new bd(this.source,ln(this.path),this.snap)}}class Rp{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=ya.MERGE}operationForChild(e){if(It(this.path)){const n=this.children.subtree(new Qt(e));return n.isEmpty()?null:n.value?new bd(this.source,jt(),n.value):new Rp(this.source,jt(),n)}return(0,A.vA)(Et(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Rp(this.source,ln(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Fc{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(It(e))return this.isFullyInitialized()&&!this.filtered_;const n=Et(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class xfe{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Py(t,e,n,r,i,s){const o=r.filter(a=>a.type===n);o.sort((a,u)=>function Lfe(t,e,n){if(null==e.childName||null==n.childName)throw(0,A.Hk)("Should only compare child_ events.");const r=new Tt(e.childName,e.snapshotNode),i=new Tt(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,a,u)),o.forEach(a=>{const u=function Ofe(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(u,t.query_))})})}function gC(t,e){return{eventCache:t,serverCache:e}}function My(t,e,n,r){return gC(new Fc(e,n,r),t.serverCache)}function EW(t,e,n,r){return gC(t.eventCache,new Fc(e,n,r))}function mC(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Dd(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let OM;class wn{constructor(e,n=(()=>(OM||(OM=new cs(Ehe)),OM))()){this.value=e,this.children=n}static fromObject(e){let n=new wn(null);return qr(e,(r,i)=>{n=n.set(new Qt(r),i)}),n}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(null!=this.value&&n(this.value))return{path:jt(),value:this.value};if(It(e))return null;{const r=Et(e),i=this.children.get(r);if(null!==i){const s=i.findRootMostMatchingPathAndValue(ln(e),n);return null!=s?{path:Bn(new Qt(r),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(It(e))return this;{const n=Et(e),r=this.children.get(n);return null!==r?r.subtree(ln(e)):new wn(null)}}set(e,n){if(It(e))return new wn(n,this.children);{const r=Et(e),s=(this.children.get(r)||new wn(null)).set(ln(e),n),o=this.children.insert(r,s);return new wn(this.value,o)}}remove(e){if(It(e))return this.children.isEmpty()?new wn(null):new wn(null,this.children);{const n=Et(e),r=this.children.get(n);if(r){const i=r.remove(ln(e));let s;return s=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&s.isEmpty()?new wn(null):new wn(this.value,s)}return this}}get(e){if(It(e))return this.value;{const n=Et(e),r=this.children.get(n);return r?r.get(ln(e)):null}}setTree(e,n){if(It(e))return n;{const r=Et(e),s=(this.children.get(r)||new wn(null)).setTree(ln(e),n);let o;return o=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new wn(this.value,o)}}fold(e){return this.fold_(jt(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Bn(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,jt(),n)}findOnPath_(e,n,r){const i=!!this.value&&r(n,this.value);if(i)return i;if(It(e))return null;{const s=Et(e),o=this.children.get(s);return o?o.findOnPath_(ln(e),Bn(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,jt(),n)}foreachOnPath_(e,n,r){if(It(e))return this;{this.value&&r(n,this.value);const i=Et(e),s=this.children.get(i);return s?s.foreachOnPath_(ln(e),Bn(n,i),r):new wn(null)}}foreach(e){this.foreach_(jt(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Bn(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}class Po{constructor(e){this.writeTree_=e}static empty(){return new Po(new wn(null))}}function xy(t,e,n){if(It(e))return new Po(new wn(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let s=r.value;const o=Hi(i,e);return s=s.updateChild(o,n),new Po(t.writeTree_.set(i,s))}{const i=new wn(n),s=t.writeTree_.setTree(e,i);return new Po(s)}}}function LM(t,e,n){let r=t;return qr(n,(i,s)=>{r=xy(r,Bn(e,i),s)}),r}function IW(t,e){if(It(e))return Po.empty();{const n=t.writeTree_.setTree(e,new wn(null));return new Po(n)}}function FM(t,e){return null!=Sd(t,e)}function Sd(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(Hi(n.path,e)):null}function wW(t){const e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(In,(r,i)=>{e.push(new Tt(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new Tt(r,i.value))}),e}function Vc(t,e){if(It(e))return t;{const n=Sd(t,e);return new Po(null!=n?new wn(n):t.writeTree_.subtree(e))}}function VM(t){return t.writeTree_.isEmpty()}function Np(t,e){return TW(jt(),t.writeTree_,e)}function TW(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{".priority"===i?((0,A.vA)(null!==s.value,"Priority writes must always be leaf nodes"),r=s.value):n=TW(Bn(t,i),s,n)}),!n.getChild(t).isEmpty()&&null!==r&&(n=n.updateChild(Bn(t,".priority"),r)),n}}function _C(t,e){return SW(e,t)}function $fe(t,e){if(t.snap)return no(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&no(Bn(t.path,n),e))return!0;return!1}function Gfe(t){return t.visible}function CW(t,e,n){let r=Po.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let a;if(s.snap)no(n,o)?(a=Hi(n,o),r=xy(r,a,s.snap)):no(o,n)&&(a=Hi(o,n),r=xy(r,jt(),s.snap.getChild(a)));else{if(!s.children)throw(0,A.Hk)("WriteRecord should have .snap or .children");if(no(n,o))a=Hi(n,o),r=LM(r,a,s.children);else if(no(o,n))if(a=Hi(o,n),It(a))r=LM(r,jt(),s.children);else{const u=(0,A.yw)(s.children,Et(a));if(u){const c=u.getChild(ln(a));r=xy(r,jt(),c)}}}}}return r}function AW(t,e,n,r,i){if(r||i){const s=Vc(t.visibleWrites,e);return!i&&VM(s)?n:i||null!=n||FM(s,jt())?Np(CW(t.allWrites,function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(no(c.path,e)||no(e,c.path))},e),n||dt.EMPTY_NODE):null}{const s=Sd(t.visibleWrites,e);if(null!=s)return s;{const o=Vc(t.visibleWrites,e);return VM(o)?n:null!=n||FM(o,jt())?Np(o,n||dt.EMPTY_NODE):null}}}function yC(t,e,n,r){return AW(t.writeTree,t.treePath,e,n,r)}function UM(t,e){return function qfe(t,e,n){let r=dt.EMPTY_NODE;const i=Sd(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(In,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=Vc(t.visibleWrites,e);return n.forEachChild(In,(o,a)=>{const u=Np(Vc(s,new Qt(o)),a);r=r.updateImmediateChild(o,u)}),wW(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}return wW(Vc(t.visibleWrites,e)).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}(t.writeTree,t.treePath,e)}function bW(t,e,n,r){return function zfe(t,e,n,r,i){(0,A.vA)(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Bn(e,n);if(FM(t.visibleWrites,s))return null;{const o=Vc(t.visibleWrites,s);return VM(o)?i.getChild(n):Np(o,i.getChild(n))}}(t.writeTree,t.treePath,e,n,r)}function vC(t,e){return function Kfe(t,e){return Sd(t.visibleWrites,e)}(t.writeTree,Bn(t.treePath,e))}function BM(t,e,n){return function Wfe(t,e,n,r){const i=Bn(e,n),s=Sd(t.visibleWrites,i);return null!=s?s:r.isCompleteForChild(n)?Np(Vc(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function DW(t,e){return SW(Bn(t.treePath,e),t.writeTree)}function SW(t,e){return{treePath:t,writeTree:e}}class Jfe{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;(0,A.vA)("child_added"===n||"child_changed"===n||"child_removed"===n,"Only child changes supported for tracking"),(0,A.vA)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if("child_added"===n&&"child_removed"===s)this.changeMap.set(r,Sy(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===n&&"child_added"===s)this.changeMap.delete(r);else if("child_removed"===n&&"child_changed"===s)this.changeMap.set(r,Dy(r,i.oldSnap));else if("child_changed"===n&&"child_added"===s)this.changeMap.set(r,Dp(r,e.snapshotNode));else{if("child_changed"!==n||"child_changed"!==s)throw(0,A.Hk)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,Sy(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const RW=new class Xfe{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}};class jM{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Fc(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return BM(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Dd(this.viewCache_),s=function Zfe(t,e,n,r,i,s){return function Qfe(t,e,n,r,i,s,o){let a;const u=Vc(t.visibleWrites,e),c=Sd(u,jt());if(null!=c)a=c;else{if(null==n)return[];a=Np(u,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const h=[],g=o.getCompare(),_=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let v=_.getNext();for(;v&&h.length<i;)0!==g(v,r)&&h.push(v),v=_.getNext();return h}}(t.writeTree,t.treePath,e,n,r,i,s)}(this.writes_,i,n,1,r,e);return 0===s.length?null:s[0]}}function NW(t,e,n,r,i,s){const o=e.eventCache;if(null!=vC(r,n))return e;{let a,u;if(It(n))if((0,A.vA)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Dd(e),g=UM(r,c instanceof dt?c:dt.EMPTY_NODE);a=t.filter.updateFullNode(e.eventCache.getNode(),g,s)}else{const c=yC(r,Dd(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{const c=Et(n);if(".priority"===c){(0,A.vA)(1===Lc(n),"Can't have a priority with additional path components");const h=o.getNode();u=e.serverCache.getNode();const g=bW(r,n,h,u);a=null!=g?t.filter.updatePriority(h,g):o.getNode()}else{const h=ln(n);let g;if(o.isCompleteForChild(c)){u=e.serverCache.getNode();const _=bW(r,n,o.getNode(),u);g=null!=_?o.getNode().getImmediateChild(c).updateChild(h,_):o.getNode().getImmediateChild(c)}else g=BM(r,c,e.serverCache);a=null!=g?t.filter.updateChild(o.getNode(),c,g,h,i,s):o.getNode()}}return My(e,a,o.isFullyInitialized()||It(n),t.filter.filtersNodes())}}function EC(t,e,n,r,i,s,o,a){const u=e.serverCache;let c;const h=o?t.filter:t.filter.getIndexedFilter();if(It(n))c=h.updateFullNode(u.getNode(),r,null);else if(h.filtersNodes()&&!u.isFiltered()){const v=u.getNode().updateChild(n,r);c=h.updateFullNode(u.getNode(),v,null)}else{const v=Et(n);if(!u.isCompleteForPath(n)&&Lc(n)>1)return e;const w=ln(n),D=u.getNode().getImmediateChild(v).updateChild(w,r);c=".priority"===v?h.updatePriority(u.getNode(),D):h.updateChild(u.getNode(),v,D,w,RW,null)}const g=EW(e,c,u.isFullyInitialized()||It(n),h.filtersNodes());return NW(t,g,n,i,new jM(i,g,s),a)}function $M(t,e,n,r,i,s,o){const a=e.eventCache;let u,c;const h=new jM(i,e,s);if(It(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=My(e,c,!0,t.filter.filtersNodes());else{const g=Et(n);if(".priority"===g)c=t.filter.updatePriority(e.eventCache.getNode(),r),u=My(e,c,a.isFullyInitialized(),a.isFiltered());else{const _=ln(n),v=a.getNode().getImmediateChild(g);let w;if(It(_))w=r;else{const b=h.getCompleteChild(g);w=null!=b?".priority"===vM(_)&&b.getChild(oW(_)).isEmpty()?b:b.updateChild(_,r):dt.EMPTY_NODE}u=v.equals(w)?e:My(e,t.filter.updateChild(a.getNode(),g,w,_,h,o),a.isFullyInitialized(),t.filter.filtersNodes())}}return u}function PW(t,e){return t.eventCache.isCompleteForChild(e)}function MW(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function HM(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c,u=e;c=It(n)?r:new wn(null).setTree(n,r);const h=e.serverCache.getNode();return c.children.inorderTraversal((g,_)=>{if(h.hasChild(g)){const w=MW(0,e.serverCache.getNode().getImmediateChild(g),_);u=EC(t,u,new Qt(g),w,i,s,o,a)}}),c.children.inorderTraversal((g,_)=>{const v=!e.serverCache.isCompleteForChild(g)&&null===_.value;if(!h.hasChild(g)&&!v){const b=MW(0,e.serverCache.getNode().getImmediateChild(g),_);u=EC(t,u,new Qt(g),b,i,s,o,a)}}),u}class upe{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new DM(r.getIndex()),s=function wfe(t){return t.loadsAllData()?new DM(t.getIndex()):t.hasLimit()?new Ife(t):new Ry(t)}(r);this.processor_=function epe(t){return{filter:t}}(s);const o=n.serverCache,a=n.eventCache,u=i.updateFullNode(dt.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(dt.EMPTY_NODE,a.getNode(),null),h=new Fc(u,o.isFullyInitialized(),i.filtersNodes()),g=new Fc(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=gC(g,h),this.eventGenerator_=new xfe(this.query_)}get query(){return this.query_}}function dpe(t,e){const n=Dd(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!It(e)&&!n.getImmediateChild(Et(e)).isEmpty())?n.getChild(e):null}function xW(t){return 0===t.eventRegistrations_.length}function kW(t,e,n){const r=[];if(n){(0,A.vA)(null==e,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const o=t.eventRegistrations_[s];if(o.matches(e)){if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}else i.push(o)}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function OW(t,e,n,r){e.type===ya.MERGE&&null!==e.source.queryId&&((0,A.vA)(Dd(t.viewCache_),"We should always have a full cache before handling merges"),(0,A.vA)(mC(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=function npe(t,e,n,r,i){const s=new Jfe;let o,a;if(n.type===ya.OVERWRITE){const c=n;c.source.fromUser?o=$M(t,e,c.path,c.snap,r,i,s):((0,A.vA)(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!It(c.path),o=EC(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===ya.MERGE){const c=n;c.source.fromUser?o=function ipe(t,e,n,r,i,s,o){let a=e;return r.foreach((u,c)=>{const h=Bn(n,u);PW(e,Et(h))&&(a=$M(t,a,h,c,i,s,o))}),r.foreach((u,c)=>{const h=Bn(n,u);PW(e,Et(h))||(a=$M(t,a,h,c,i,s,o))}),a}(t,e,c.path,c.children,r,i,s):((0,A.vA)(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=HM(t,e,c.path,c.children,r,i,a,s))}else if(n.type===ya.ACK_USER_WRITE){const c=n;o=c.revert?function ape(t,e,n,r,i,s){let o;if(null!=vC(r,n))return e;{const a=new jM(r,e,i),u=e.eventCache.getNode();let c;if(It(n)||".priority"===Et(n)){let h;if(e.serverCache.isFullyInitialized())h=yC(r,Dd(e));else{const g=e.serverCache.getNode();(0,A.vA)(g instanceof dt,"serverChildren would be complete if leaf node"),h=UM(r,g)}c=t.filter.updateFullNode(u,h,s)}else{const h=Et(n);let g=BM(r,h,e.serverCache);null==g&&e.serverCache.isCompleteForChild(h)&&(g=u.getImmediateChild(h)),c=null!=g?t.filter.updateChild(u,h,g,ln(n),a,s):e.eventCache.getNode().hasChild(h)?t.filter.updateChild(u,h,dt.EMPTY_NODE,ln(n),a,s):u,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=yC(r,Dd(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||null!=vC(r,jt()),My(e,c,o,t.filter.filtersNodes())}}(t,e,c.path,r,i,s):function spe(t,e,n,r,i,s,o){if(null!=vC(i,n))return e;const a=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(It(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return EC(t,e,n,u.getNode().getChild(n),i,s,a,o);if(It(n)){let c=new wn(null);return u.getNode().forEachChild(_a,(h,g)=>{c=c.set(new Qt(h),g)}),HM(t,e,n,c,i,s,a,o)}return e}{let c=new wn(null);return r.foreach((h,g)=>{const _=Bn(n,h);u.isCompleteForPath(_)&&(c=c.set(h,u.getNode().getChild(_)))}),HM(t,e,n,c,i,s,a,o)}}(t,e,c.path,c.affectedTree,r,i,s)}else{if(n.type!==ya.LISTEN_COMPLETE)throw(0,A.Hk)("Unknown operation type: "+n.type);o=function ope(t,e,n,r,i){const s=e.serverCache;return NW(t,EW(e,s.getNode(),s.isFullyInitialized()||It(n),s.isFiltered()),n,r,RW,i)}(t,e,n.path,r,s)}const u=s.getChanges();return function rpe(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=mC(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(mW(mC(e)))}}(e,o,u),{viewCache:o,changes:u}}(t.processor_,i,e,n,r);return function tpe(t,e){(0,A.vA)(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),(0,A.vA)(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}(t.processor_,s.viewCache),(0,A.vA)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,LW(t,s.changes,s.viewCache.eventCache.getNode(),null)}function LW(t,e,n,r){return function kfe(t,e,n,r){const i=[],s=[];return e.forEach(o=>{"child_changed"===o.type&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(function Efe(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}(o.childName,o.snapshotNode))}),Py(t,i,"child_removed",e,r,n),Py(t,i,"child_added",e,r,n),Py(t,i,"child_moved",s,r,n),Py(t,i,"child_changed",e,r,n),Py(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,r?[r]:t.eventRegistrations_)}let IC,TC;class FW{constructor(){this.views=new Map}}function GM(t,e,n,r){const i=e.source.queryId;if(null!==i){const s=t.views.get(i);return(0,A.vA)(null!=s,"SyncTree gave us an op for an invalid query."),OW(s,e,n,r)}{let s=[];for(const o of t.views.values())s=s.concat(OW(o,e,n,r));return s}}function VW(t,e,n,r,i){const o=t.views.get(e._queryIdentifier);if(!o){let a=yC(n,i?r:null),u=!1;a?u=!0:r instanceof dt?(a=UM(n,r),u=!1):(a=dt.EMPTY_NODE,u=!1);const c=gC(new Fc(a,u,!1),new Fc(r,i,!1));return new upe(e,c)}return o}function UW(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Uc(t,e){let n=null;for(const r of t.views.values())n=n||dpe(r,e);return n}function BW(t,e){return e._queryParams.loadsAllData()?wC(t):t.views.get(e._queryIdentifier)}function jW(t,e){return null!=BW(t,e)}function Bc(t){return null!=wC(t)}function wC(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let Ipe=1;class $W{constructor(e){this.listenProvider_=e,this.syncPointTree_=new wn(null),this.pendingWriteTree_=function Yfe(){return{visibleWrites:Po.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function qM(t,e,n,r,i){return function Vfe(t,e,n,r,i){(0,A.vA)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=xy(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?Pp(t,new bd({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function jc(t,e,n=!1){const r=function Bfe(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(function jfe(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);(0,A.vA)(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&$fe(a,r.path)?i=!1:no(r.path,a.path)&&(s=!0)),o--}return!!i&&(s?(function Hfe(t){t.visibleWrites=CW(t.allWrites,Gfe,jt()),t.lastWriteId=t.allWrites.length>0?t.allWrites[t.allWrites.length-1].writeId:-1}(t),!0):(r.snap?t.visibleWrites=IW(t.visibleWrites,r.path):qr(r.children,u=>{t.visibleWrites=IW(t.visibleWrites,Bn(r.path,u))}),!0))}(t.pendingWriteTree_,e)){let s=new wn(null);return null!=r.snap?s=s.set(jt(),!0):qr(r.children,o=>{s=s.set(new Qt(o),!0)}),Pp(t,new pC(r.path,s,n))}return[]}function ky(t,e,n){return Pp(t,new bd({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function CC(t,e,n,r,i=!1){const s=e._path,o=t.syncPointTree_.get(s);let a=[];if(o&&("default"===e._queryIdentifier||jW(o,e))){const u=function ype(t,e,n,r){const i=e._queryIdentifier,s=[];let o=[];const a=Bc(t);if("default"===i)for(const[u,c]of t.views.entries())o=o.concat(kW(c,n,r)),xW(c)&&(t.views.delete(u),c.query._queryParams.loadsAllData()||s.push(c.query));else{const u=t.views.get(i);u&&(o=o.concat(kW(u,n,r)),xW(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!Bc(t)&&s.push(new(function gpe(){return(0,A.vA)(IC,"Reference.ts has not been loaded"),IC}())(e._repo,e._path)),{removed:s,events:o}}(o,e,n,r);(function mpe(t){return 0===t.views.size})(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const c=u.removed;if(a=u.events,!i){const h=-1!==c.findIndex(_=>_._queryParams.loadsAllData()),g=t.syncPointTree_.findOnPath(s,(_,v)=>Bc(v));if(h&&!g){const _=t.syncPointTree_.subtree(s);if(!_.isEmpty()){const v=function Spe(t){return t.fold((e,n,r)=>{if(n&&Bc(n))return[wC(n)];{let i=[];return n&&(i=UW(n)),qr(r,(s,o)=>{i=i.concat(o)}),i}})}(_);for(let w=0;w<v.length;++w){const b=v[w],D=b.query,F=zW(t,b);t.listenProvider_.startListening(Ly(D),Oy(t,D),F.hashFn,F.onComplete)}}}!g&&c.length>0&&!r&&(h?t.listenProvider_.stopListening(Ly(e),null):c.forEach(_=>{const v=t.queryToTagMap.get(bC(_));t.listenProvider_.stopListening(Ly(_),v)}))}!function Rpe(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=bC(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}(t,c)}return a}function HW(t,e,n,r){const i=WM(t,r);if(null!=i){const s=KM(i),o=s.path,a=s.queryId,u=Hi(o,e);return QM(t,o,new bd(kM(a),u,n))}return[]}function zM(t,e,n,r=!1){const i=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(_,v)=>{const w=Hi(_,i);s=s||Uc(v,w),o=o||Bc(v)});let u,a=t.syncPointTree_.get(i);a?(o=o||Bc(a),s=s||Uc(a,jt())):(a=new FW,t.syncPointTree_=t.syncPointTree_.set(i,a)),null!=s?u=!0:(u=!1,s=dt.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((v,w)=>{const b=Uc(w,jt());b&&(s=s.updateImmediateChild(v,b))}));const c=jW(a,e);if(!c&&!e._queryParams.loadsAllData()){const _=bC(e);(0,A.vA)(!t.queryToTagMap.has(_),"View does not exist, but we have a tag");const v=function Npe(){return Ipe++}();t.queryToTagMap.set(_,v),t.tagToQueryMap.set(v,_)}let g=function _pe(t,e,n,r,i,s){const o=VW(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),function hpe(t,e){t.eventRegistrations_.push(e)}(o,n),function fpe(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(In,(s,o)=>{r.push(Dp(s,o))}),n.isFullyInitialized()&&r.push(mW(n.getNode())),LW(t,r,n.getNode(),e)}(o,n)}(a,e,n,_C(t.pendingWriteTree_,i),s,u);if(!c&&!o&&!r){const _=BW(a,e);g=g.concat(function Ppe(t,e,n){const r=e._path,i=Oy(t,e),s=zW(t,n),o=t.listenProvider_.startListening(Ly(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)(0,A.vA)(!Bc(a.value),"If we're adding a query, it shouldn't be shadowed");else{const u=a.fold((c,h,g)=>{if(!It(c)&&h&&Bc(h))return[wC(h).query];{let _=[];return h&&(_=_.concat(UW(h).map(v=>v.query))),qr(g,(v,w)=>{_=_.concat(w)}),_}});for(let c=0;c<u.length;++c){const h=u[c];t.listenProvider_.stopListening(Ly(h),Oy(t,h))}}return o}(t,e,_))}return g}function AC(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{const c=Uc(a,Hi(o,e));if(c)return c});return AW(i,e,s,n,!0)}function Pp(t,e){return GW(e,t.syncPointTree_,null,_C(t.pendingWriteTree_,jt()))}function GW(t,e,n,r){if(It(t.path))return qW(t,e,n,r);{const i=e.get(jt());null==n&&null!=i&&(n=Uc(i,jt()));let s=[];const o=Et(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){const c=n?n.getImmediateChild(o):null,h=DW(r,o);s=s.concat(GW(a,u,c,h))}return i&&(s=s.concat(GM(i,t,r,n))),s}}function qW(t,e,n,r){const i=e.get(jt());null==n&&null!=i&&(n=Uc(i,jt()));let s=[];return e.children.inorderTraversal((o,a)=>{const u=n?n.getImmediateChild(o):null,c=DW(r,o),h=t.operationForChild(o);h&&(s=s.concat(qW(h,a,u,c)))}),i&&(s=s.concat(GM(i,t,r,n))),s}function zW(t,e){const n=e.query,r=Oy(t,n);return{hashFn:()=>(function cpe(t){return t.viewCache_.serverCache.getNode()}(e)||dt.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function Ape(t,e,n){const r=WM(t,n);if(r){const i=KM(r),s=i.path,o=i.queryId,a=Hi(s,e);return QM(t,s,new Ny(kM(o),a))}return[]}(t,n._path,r):function Cpe(t,e){return Pp(t,new Ny({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);{const s=function The(t,e){let n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(i,n);return CC(t,n,null,s)}}}}function Oy(t,e){const n=bC(e);return t.queryToTagMap.get(n)}function bC(t){return t._path.toString()+"$"+t._queryIdentifier}function WM(t,e){return t.tagToQueryMap.get(e)}function KM(t){const e=t.indexOf("$");return(0,A.vA)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Qt(t.substr(0,e))}}function QM(t,e,n){const r=t.syncPointTree_.get(e);return(0,A.vA)(r,"Missing sync point for query tag that we're tracking"),GM(r,n,_C(t.pendingWriteTree_,e),null)}function Ly(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(function Epe(){return(0,A.vA)(TC,"Reference.ts has not been loaded"),TC}())(t._repo,t._path):t}class YM{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new YM(n)}node(){return this.node_}}class ZM{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Bn(this.path_,e);return new ZM(this.syncTree_,n)}node(){return AC(this.syncTree_,this.path_)}}const Mpe=function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t},WW=function(t,e,n){return t&&"object"==typeof t?((0,A.vA)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?xpe(t[".sv"],e,n):"object"==typeof t[".sv"]?kpe(t[".sv"],e):void(0,A.vA)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},xpe=function(t,e,n){if("timestamp"===t)return n.timestamp;(0,A.vA)(!1,"Unexpected server value: "+t)},kpe=function(t,e,n){t.hasOwnProperty("increment")||(0,A.vA)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;"number"!=typeof r&&(0,A.vA)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,A.vA)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},KW=function(t,e,n,r){return XM(e,new ZM(n,t),r)},JM=function(t,e,n){return XM(t,new YM(e),n)};function XM(t,e,n){const r=t.getPriority().val(),i=WW(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,a=WW(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Ap(a,Kn(i)):t}{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Ap(i))),o.forEachChild(In,(a,u)=>{const c=XM(u,e.getImmediateChild(a),n);c!==u&&(s=s.updateImmediateChild(a,c))}),s}}class ex{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function DC(t,e){let n=e instanceof Qt?e:new Qt(e),r=t,i=Et(n);for(;null!==i;){const s=(0,A.yw)(r.node.children,i)||{children:{},childCount:0};r=new ex(i,r,s),n=ln(n),i=Et(n)}return r}function Rd(t){return t.node.value}function tx(t,e){t.node.value=e,nx(t)}function QW(t){return t.node.childCount>0}function SC(t,e){qr(t.node.children,(n,r)=>{e(new ex(n,t,r))})}function YW(t,e,n,r){n&&!r&&e(t),SC(t,i=>{YW(i,e,!0,r)}),n&&r&&e(t)}function Fy(t){return new Qt(null===t.parent?t.name:Fy(t.parent)+"/"+t.name)}function nx(t){null!==t.parent&&function Fpe(t,e,n){const r=function Ope(t){return void 0===Rd(t)&&!QW(t)}(n),i=(0,A.gR)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,nx(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,nx(t))}(t.parent,t.name,t)}const Vpe=/[\[\].#$\/\u0000-\u001F\u007F]/,Upe=/[\[\].#$\u0000-\u001F\u007F]/,rx=10485760,RC=function(t){return"string"==typeof t&&0!==t.length&&!Vpe.test(t)},ZW=function(t){return"string"==typeof t&&0!==t.length&&!Upe.test(t)},Vy=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!nC(t)||t&&"object"==typeof t&&(0,A.gR)(t,".sv")},va=function(t,e,n,r){r&&void 0===e||Uy((0,A.dI)(t,"value"),e,n)},Uy=function(t,e,n){const r=n instanceof Qt?new nfe(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+Cd(r));if("function"==typeof e)throw new Error(t+"contains a function "+Cd(r)+" with contents = "+e.toString());if(nC(e))throw new Error(t+"contains "+e.toString()+" "+Cd(r));if("string"==typeof e&&e.length>rx/3&&(0,A.OE)(e)>rx)throw new Error(t+"contains a string greater than "+rx+" utf8 bytes "+Cd(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,s=!1;if(qr(e,(o,a)=>{if(".value"===o)i=!0;else if(".priority"!==o&&".sv"!==o&&(s=!0,!RC(o)))throw new Error(t+" contains an invalid key ("+o+") "+Cd(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function rfe(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,A.OE)(e),aW(t)})(r,o),Uy(t,a,r),function ife(t){const e=t.parts_.pop();t.byteLength_-=(0,A.OE)(e),t.parts_.length>0&&(t.byteLength_-=1)}(r)}),i&&s)throw new Error(t+' contains ".value" child '+Cd(r)+" in addition to actual children.")}},JW=function(t,e,n,r){if(r&&void 0===e)return;const i=(0,A.dI)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];qr(e,(o,a)=>{const u=new Qt(o);if(Uy(i,a,Bn(n,u)),".priority"===vM(u)&&!Vy(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const s=Ty(r);for(let o=0;o<s.length;o++)if((".priority"!==s[o]||o!==s.length-1)&&!RC(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(tfe);let i=null;for(n=0;n<e.length;n++){if(r=e[n],null!==i&&no(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},ix=function(t,e,n){if(!n||void 0!==e){if(nC(e))throw new Error((0,A.dI)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Vy(e))throw new Error((0,A.dI)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},By=function(t,e,n,r){if(!(r&&void 0===n||RC(n)))throw new Error((0,A.dI)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},jy=function(t,e,n,r){if(!(r&&void 0===n||ZW(n)))throw new Error((0,A.dI)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},$pe=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),jy(t,e,n,r)},ro=function(t,e){if(".info"===Et(e))throw new Error(t+" failed = Can't modify data under /.info/")},XW=function(t,e){const n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!RC(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),ZW(t)}(n))throw new Error((0,A.dI)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Hpe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function NC(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();null!==n&&!EM(s,n.path)&&(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function e3(t,e,n){NC(t,n),t3(t,r=>EM(r,e))}function Ns(t,e,n){NC(t,n),t3(t,r=>no(r,e)||no(e,r))}function t3(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];i&&(e(i.path)?(Gpe(t.eventLists_[r]),t.eventLists_[r]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function Gpe(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(null!==n){t.events[e]=null;const r=n.getEventRunner();wd&&Gr("event: "+n.toString()),Tp(r)}}}const n3="repo_interrupt",qpe=25;class zpe{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Hpe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=fC(),this.transactionQueueTree_=new ex,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function r3(t){const n=t.infoData_.getNode(new Qt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+n}function $y(t){return Mpe({timestamp:r3(t)})}function i3(t,e,n,r,i){t.dataUpdateCount++;const s=new Qt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const u=(0,A.kH)(n,c=>Kn(c));o=function bpe(t,e,n,r){const i=WM(t,r);if(i){const s=KM(i),o=s.path,a=s.queryId,u=Hi(o,e),c=wn.fromObject(n);return QM(t,o,new Rp(kM(a),u,c))}return[]}(t.serverSyncTree_,s,u,i)}else{const u=Kn(n);o=HW(t.serverSyncTree_,s,u,i)}else if(r){const u=(0,A.kH)(n,c=>Kn(c));o=function Tpe(t,e,n){const r=wn.fromObject(n);return Pp(t,new Rp({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,s,u)}else{const u=Kn(n);o=ky(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=xp(t,s)),Ns(t.eventQueue_,a,o)}function s3(t,e){sx(t,"connected",e),!1===e&&function Zpe(t){Mp(t,"onDisconnectEvents");const e=$y(t),n=fC();PM(t.onDisconnect_,jt(),(i,s)=>{const o=KW(i,s,t.serverSyncTree_,e);Sp(n,i,o)});let r=[];PM(n,jt(),(i,s)=>{r=r.concat(ky(t.serverSyncTree_,i,s));const o=cx(t,i);xp(t,o)}),t.onDisconnect_=fC(),Ns(t.eventQueue_,jt(),r)}(t)}function sx(t,e,n){const r=new Qt("/.info/"+e),i=Kn(n);t.infoData_.updateSnapshot(r,i);const s=ky(t.infoSyncTree_,r,i);Ns(t.eventQueue_,r,s)}function PC(t){return t.nextWriteId_++}function ox(t,e,n,r,i){Mp(t,"set",{path:e.toString(),value:n,priority:r});const s=$y(t),o=Kn(n,r),a=AC(t.serverSyncTree_,e),u=JM(o,a,s),c=PC(t),h=qM(t.serverSyncTree_,e,u,c,!0);NC(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(_,v)=>{const w="ok"===_;w||Ci("set at "+e+" failed: "+_);const b=jc(t.serverSyncTree_,c,!w);Ns(t.eventQueue_,e,b),$c(0,i,_,v)});const g=cx(t,e);xp(t,g),Ns(t.eventQueue_,g,[])}function Jpe(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&NM(t.onDisconnect_,e),$c(0,n,r,i)})}function o3(t,e,n,r){const i=Kn(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{"ok"===s&&Sp(t.onDisconnect_,e,i),$c(0,r,s,o)})}function ax(t,e,n){let r;r=".info"===Et(e._path)?CC(t.infoSyncTree_,e,n):CC(t.serverSyncTree_,e,n),e3(t.eventQueue_,e._path,r)}function a3(t){t.persistentConnection_&&t.persistentConnection_.interrupt(n3)}function Mp(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Gr(n,...e)}function $c(t,e,n,r){e&&Tp(()=>{if("ok"===n)e(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function ux(t,e,n){return AC(t.serverSyncTree_,e,n)||dt.EMPTY_NODE}function MC(t,e=t.transactionQueueTree_){if(e||xC(t,e),Rd(e)){const n=c3(t,e);(0,A.vA)(n.length>0,"Sending zero length transaction queue"),n.every(i=>0===i.status)&&function ige(t,e,n){const r=n.map(c=>c.currentWriteId),i=ux(t,e,r);let s=i;const o=i.hash();for(let c=0;c<n.length;c++){const h=n[c];(0,A.vA)(0===h.status,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const g=Hi(e,h.path);s=s.updateChild(g,h.currentOutputSnapshotRaw)}const a=s.val(!0),u=e;t.server_.put(u.toString(),a,c=>{Mp(t,"transaction put response",{path:u.toString(),status:c});let h=[];if("ok"===c){const g=[];for(let _=0;_<n.length;_++)n[_].status=2,h=h.concat(jc(t.serverSyncTree_,n[_].currentWriteId)),n[_].onComplete&&g.push(()=>n[_].onComplete(null,!0,n[_].currentOutputSnapshotResolved)),n[_].unwatcher();xC(t,DC(t.transactionQueueTree_,e)),MC(t,t.transactionQueueTree_),Ns(t.eventQueue_,e,h);for(let _=0;_<g.length;_++)Tp(g[_])}else{if("datastale"===c)for(let g=0;g<n.length;g++)n[g].status=3===n[g].status?4:0;else{Ci("transaction at "+u.toString()+" failed: "+c);for(let g=0;g<n.length;g++)n[g].status=4,n[g].abortReason=c}xp(t,e)}},o)}(t,Fy(e),n)}else QW(e)&&SC(e,n=>{MC(t,n)})}function xp(t,e){const n=u3(t,e),r=Fy(n);return function sge(t,e,n){if(0===e.length)return;const r=[];let i=[];const o=e.filter(a=>0===a.status).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const u=e[a],c=Hi(n,u.path);let g,h=!1;if((0,A.vA)(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)h=!0,g=u.abortReason,i=i.concat(jc(t.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=qpe)h=!0,g="maxretry",i=i.concat(jc(t.serverSyncTree_,u.currentWriteId,!0));else{const _=ux(t,u.path,o);u.currentInputSnapshot=_;const v=e[a].update(_.val());if(void 0!==v){Uy("transaction failed: Data returned ",v,u.path);let w=Kn(v);"object"==typeof v&&null!=v&&(0,A.gR)(v,".priority")||(w=w.updatePriority(_.getPriority()));const D=u.currentWriteId,F=$y(t),x=JM(w,_,F);u.currentOutputSnapshotRaw=w,u.currentOutputSnapshotResolved=x,u.currentWriteId=PC(t),o.splice(o.indexOf(D),1),i=i.concat(qM(t.serverSyncTree_,u.path,x,u.currentWriteId,u.applyLocally)),i=i.concat(jc(t.serverSyncTree_,D,!0))}else h=!0,g="nodata",i=i.concat(jc(t.serverSyncTree_,u.currentWriteId,!0))}Ns(t.eventQueue_,n,i),i=[],h&&(e[a].status=2,setTimeout(e[a].unwatcher,Math.floor(0)),e[a].onComplete&&r.push("nodata"===g?()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot):()=>e[a].onComplete(new Error(g),!1,null)))}xC(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Tp(r[a]);MC(t,t.transactionQueueTree_)}(t,c3(t,n),r),r}function u3(t,e){let n,r=t.transactionQueueTree_;for(n=Et(e);null!==n&&void 0===Rd(r);)r=DC(r,n),n=Et(e=ln(e));return r}function c3(t,e){const n=[];return l3(t,e,n),n.sort((r,i)=>r.order-i.order),n}function l3(t,e,n){const r=Rd(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);SC(e,i=>{l3(t,i,n)})}function xC(t,e){const n=Rd(e);if(n){let r=0;for(let i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,tx(e,n.length>0?n:void 0)}SC(e,r=>{xC(t,r)})}function cx(t,e){const n=Fy(u3(t,e)),r=DC(t.transactionQueueTree_,e);return function Lpe(t,e,n){let r=n?t:t.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{lx(t,i)}),lx(t,r),YW(r,i=>{lx(t,i)}),n}function lx(t,e){const n=Rd(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?((0,A.vA)(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):((0,A.vA)(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(jc(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===s?tx(e,void 0):n.length=s+1,Ns(t.eventQueue_,Fy(e),i);for(let o=0;o<r.length;o++)Tp(r[o])}}const dx=function(t,e){const n=uge(t),r=n.namespace;return"firebase.com"===n.domain&&ma(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==n.domain&&ma("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Ci("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new fM(n.host,n.secure,r,"ws"===n.scheme||"wss"===n.scheme,e,"",r!==n.subdomain),path:new Qt(n.pathString)}},uge=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if("string"==typeof t){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let h=t.indexOf("/");-1===h&&(h=t.length);let g=t.indexOf("?");-1===g&&(g=t.length),e=t.substring(0,Math.min(h,g)),h<g&&(i=function oge(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(t.substring(h,g)));const _=function age(t){const e={};"?"===t.charAt(0)&&(t=t.substring(1));for(const n of t.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Ci(`Invalid query segment '${n}' in query '${t}'`)}return e}(t.substring(Math.min(t.length,g)));c=e.indexOf(":"),c>=0?(o="https"===a||"wss"===a,u=parseInt(e.substring(c+1),10)):c=e.length;const v=e.slice(0,c);if("localhost"===v.toLowerCase())n="localhost";else if(v.split(".").length<=2)n=v;else{const w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),n=e.substring(w+1),s=r}"ns"in _&&(s=_.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},d3="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",cge=function(){let t=0;const e=[];return function(n){const r=n===t;let i;t=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=d3.charAt(n%64),n=Math.floor(n/64);(0,A.vA)(0===n,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=d3.charAt(e[i]);return(0,A.vA)(20===o.length,"nextPushId: Length should be 20."),o}}();class h3{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,A.As)(this.snapshot.exportVal())}}class f3{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class hx{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return(0,A.vA)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class p3{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new A.cY;return Jpe(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){ro("OnDisconnect.remove",this._path);const e=new A.cY;return o3(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){ro("OnDisconnect.set",this._path),va("OnDisconnect.set",e,this._path,!1);const n=new A.cY;return o3(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){ro("OnDisconnect.setWithPriority",this._path),va("OnDisconnect.setWithPriority",e,this._path,!1),ix("OnDisconnect.setWithPriority",n,!1);const r=new A.cY;return function Xpe(t,e,n,r,i){const s=Kn(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{"ok"===o&&Sp(t.onDisconnect_,e,s),$c(0,i,o,a)})}(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){ro("OnDisconnect.update",this._path),JW("OnDisconnect.update",e,this._path,!1);const n=new A.cY;return function ege(t,e,n,r){if((0,A.Im)(n))return Gr("onDisconnect().update() called with empty data.  Don't do anything."),void $c(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{"ok"===i&&qr(n,(o,a)=>{const u=Kn(a);Sp(t.onDisconnect_,Bn(e,o),u)}),$c(0,r,i,s)})}(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}class ls{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return It(this._path)?null:vM(this._path)}get ref(){return new io(this._repo,this._path)}get _queryIdentifier(){const e=yW(this._queryParams),n=dM(e);return"{}"===n?"default":n}get _queryObject(){return yW(this._queryParams)}isEqual(e){if(!((e=(0,A.Ku)(e))instanceof ls))return!1;const n=this._repo===e._repo,r=EM(this._path,e._path);return n&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function efe(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)}}function kC(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Hc(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===_a){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==kc)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==gu)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===In){if(null!=e&&!Vy(e)||null!=n&&!Vy(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,A.vA)(t.getIndex()instanceof AM||t.getIndex()===bM,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function OC(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class io extends ls{constructor(e,n){super(e,n,new lC,!1)}get parent(){const e=oW(this._path);return null===e?null:new io(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Nd{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Qt(e),r=Pd(this.ref,e);return new Nd(this._node.getChild(n),r,In)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new Nd(i,Pd(this.ref,r),In)))}hasChild(e){const n=new Qt(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function g3(t,e){return(t=(0,A.Ku)(t))._checkNotDeleted("ref"),void 0!==e?Pd(t._root,e):t._root}function m3(t,e){(t=(0,A.Ku)(t))._checkNotDeleted("refFromURL");const n=dx(e,t._repo.repoInfo_.nodeAdmin);XW("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&ma("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),g3(t,n.path.toString())}function Pd(t,e){return null===Et((t=(0,A.Ku)(t))._path)?$pe("child","path",e,!1):jy("child","path",e,!1),new io(t._repo,Bn(t._path,e))}function fx(t,e){t=(0,A.Ku)(t),ro("set",t._path),va("set",e,t._path,!1);const n=new A.cY;return ox(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function pge(t,e){JW("update",e,t._path,!1);const n=new A.cY;return function Ype(t,e,n,r){Mp(t,"update",{path:e.toString(),value:n});let i=!0;const s=$y(t),o={};if(qr(n,(a,u)=>{i=!1,o[a]=KW(Bn(e,a),Kn(u),t.serverSyncTree_,s)}),i)Gr("update() called with empty data.  Don't do anything."),$c(0,r,"ok",void 0);else{const a=PC(t),u=function wpe(t,e,n,r){!function Ufe(t,e,n,r){(0,A.vA)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=LM(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);const i=wn.fromObject(n);return Pp(t,new Rp({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,e,o,a);NC(t.eventQueue_,u),t.server_.merge(e.toString(),n,(c,h)=>{const g="ok"===c;g||Ci("update at "+e+" failed: "+c);const _=jc(t.serverSyncTree_,a,!g),v=_.length>0?xp(t,e):e;Ns(t.eventQueue_,v,_),$c(0,r,c,h)}),qr(n,c=>{const h=cx(t,Bn(e,c));xp(t,h)}),Ns(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function gge(t){t=(0,A.Ku)(t);const e=new hx(()=>{}),n=new Hy(e);return function Qpe(t,e,n){const r=function Dpe(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(c,h)=>{const g=Hi(c,n);r=r||Uc(h,g)});let i=t.syncPointTree_.get(n);i?r=r||Uc(i,jt()):(i=new FW,t.syncPointTree_=t.syncPointTree_.set(n,i));const s=null!=r,o=s?new Fc(r,!0,!1):null;return function lpe(t){return mC(t.viewCache_)}(VW(i,e,_C(t.pendingWriteTree_,e._path),s?o.getNode():dt.EMPTY_NODE,s))}(t.serverSyncTree_,e);return null!=r?Promise.resolve(r):t.server_.get(e).then(i=>{const s=Kn(i).withIndex(e._queryParams.getIndex());let o;if(zM(t.serverSyncTree_,e,n,!0),e._queryParams.loadsAllData())o=ky(t.serverSyncTree_,e._path,s);else{const a=Oy(t.serverSyncTree_,e);o=HW(t.serverSyncTree_,e._path,s,a)}return Ns(t.eventQueue_,e._path,o),CC(t.serverSyncTree_,e,n,null,!0),s},i=>(Mp(t,"get for query "+(0,A.As)(e)+" failed: "+i),Promise.reject(new Error(i))))}(t._repo,t,n).then(r=>new Nd(r,new io(t._repo,t._path),t._queryParams.getIndex()))}class Hy{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,n){const r=n._queryParams.getIndex();return new h3("value",this,new Nd(e.snapshotNode,new io(n._repo,n._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new f3(this,e,n):null}matches(e){return e instanceof Hy&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class LC{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n="children_added"===e?"child_added":e;return n="children_removed"===n?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new f3(this,e,n):null}createEvent(e,n){(0,A.vA)(null!=e.childName,"Child events should have a childName.");const r=Pd(new io(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new h3(e.type,this,new Nd(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof LC&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Gy(t,e,n,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const u=n,c=(h,g)=>{ax(t._repo,t,a),u(h,g)};c.userCallback=n.userCallback,c.context=n.context,n=c}const o=new hx(n,s||void 0),a="value"===e?new Hy(o):new LC(e,o);return function tge(t,e,n){let r;r=".info"===Et(e._path)?zM(t.infoSyncTree_,e,n):zM(t.serverSyncTree_,e,n),e3(t.eventQueue_,e._path,r)}(t._repo,t,a),()=>ax(t._repo,t,a)}function px(t,e,n,r){return Gy(t,"value",e,n,r)}function _3(t,e,n,r){return Gy(t,"child_added",e,n,r)}function y3(t,e,n,r){return Gy(t,"child_changed",e,n,r)}function v3(t,e,n,r){return Gy(t,"child_moved",e,n,r)}function E3(t,e,n,r){return Gy(t,"child_removed",e,n,r)}function I3(t,e,n){let r=null;const i=n?new hx(n):null;"value"===e?r=new Hy(i):e&&(r=new LC(e,i)),ax(t._repo,t,r)}class Mo{}class w3 extends Mo{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){va("endAt",this._value,e._path,!0);const n=RM(e._queryParams,this._value,this._key);if(OC(n),Hc(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ls(e._repo,e._path,n,e._orderByCalled)}}class _ge extends Mo{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){va("endBefore",this._value,e._path,!1);const n=function bfe(t,e,n){let r;return r=RM(t,e,t.index_===_a||n?n:kc),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(OC(n),Hc(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ls(e._repo,e._path,n,e._orderByCalled)}}class T3 extends Mo{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){va("startAt",this._value,e._path,!0);const n=SM(e._queryParams,this._value,this._key);if(OC(n),Hc(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new ls(e._repo,e._path,n,e._orderByCalled)}}class Ege extends Mo{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){va("startAfter",this._value,e._path,!1);const n=function Afe(t,e,n){let r;return r=SM(t,e,t.index_===_a||n?n:gu),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(OC(n),Hc(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new ls(e._repo,e._path,n,e._orderByCalled)}}class wge extends Mo{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new ls(e._repo,e._path,function Tfe(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class Cge extends Mo{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new ls(e._repo,e._path,function Cfe(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class bge extends Mo{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){kC(e,"orderByChild");const n=new Qt(this._path);if(It(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new AM(n),i=dC(e._queryParams,r);return Hc(i),new ls(e._repo,e._path,i,!0)}}class Sge extends Mo{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){kC(e,"orderByKey");const n=dC(e._queryParams,_a);return Hc(n),new ls(e._repo,e._path,n,!0)}}class Nge extends Mo{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){kC(e,"orderByPriority");const n=dC(e._queryParams,In);return Hc(n),new ls(e._repo,e._path,n,!0)}}class Mge extends Mo{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){kC(e,"orderByValue");const n=dC(e._queryParams,bM);return Hc(n),new ls(e._repo,e._path,n,!0)}}class kge extends Mo{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(va("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new w3(this._value,this._key)._apply(new T3(this._value,this._key)._apply(e))}}function xo(t,...e){let n=(0,A.Ku)(t);for(const r of e)n=r._apply(n);return n}(function ppe(t){(0,A.vA)(!IC,"__referenceConstructor has already been defined"),IC=t})(io),function vpe(t){(0,A.vA)(!TC,"__referenceConstructor has already been defined"),TC=t}(io);const gx={};function mx(t,e,n,r,i){let s=r||t.options.databaseURL;void 0===s&&(t.options.projectId||ma("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Gr("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let u,c,o=dx(s,i),a=o.repoInfo;typeof process<"u"&&process.env&&(c=process.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(u=!0,s=`http://${c}?ns=${a.namespace}`,o=dx(s,i),a=o.repoInfo):u=!o.repoInfo.secure;const h=i&&u?new wy(wy.OWNER):new Rhe(t.name,t.options,e);XW("Invalid Firebase Database URL",o),It(o.path)||ma("Database URL must point to the root of a Firebase Database (not including a child path).");const g=function Uge(t,e,n,r){let i=gx[e.name];i||(i={},gx[e.name]=i);let s=i[t.toURLString()];return s&&ma("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new zpe(t,false,n,r),i[t.toURLString()]=s,s}(a,t,h,new She(t.name,n));return new jge(g,t)}class jge{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Wpe(t,e,n){if(t.stats_=mM(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new hC(t.repoInfo_,(r,i,s,o)=>{i3(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>s3(t,!0),0);else{if(typeof n<"u"&&null!==n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,A.As)(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Ad(t.repoInfo_,e,(r,i,s,o)=>{i3(t,r,i,s,o)},r=>{s3(t,r)},r=>{!function Kpe(t,e){qr(e,(n,r)=>{sx(t,n,r)})}(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=function Mhe(t,e){const n=t.toString();return gM[n]||(gM[n]=e()),gM[n]}(t.repoInfo_,()=>new Mfe(t.stats_,t.server_)),t.infoData_=new Dfe,t.infoSyncTree_=new $W({startListening:(r,i,s,o)=>{let a=[];const u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=ky(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),sx(t,"connected",!1),t.serverSyncTree_=new $W({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{const c=o(a,u);Ns(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new io(this._repo,jt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function Vge(t,e){const n=gx[e];(!n||n[t.key]!==t)&&ma(`Database ${e}(${t.repoInfo_}) has already been deleted.`),a3(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&ma("Cannot call "+e+" on a deleted database.")}}function A3(){K4.IS_TRANSPORT_INITIALIZED&&Ci("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function $ge(){A3(),Oc.forceDisallow()}function Hge(){A3(),Cp.forceDisallow(),Oc.forceAllow()}function zge(t,e){S4(t,e)}const Kge={".sv":"timestamp"};class Zge{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}Ad.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Ad.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)},function Wge(t){uM(ss.SDK_VERSION),(0,ss._registerComponent)(new So.uA("database",(e,{instanceIdentifier:n})=>mx(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n),"PUBLIC").setMultipleInstances(!0)),(0,ss.registerVersion)(w4,"1.0.7",t),(0,ss.registerVersion)(w4,"1.0.7","esm2017")}();const tme=new Ds.Vy("@firebase/database-compat"),D3=function(t){tme.warn("FIREBASE WARNING: "+t)};class ime{constructor(e){this._delegate=e}cancel(e){(0,A.od)("OnDisconnect.cancel",0,1,arguments.length),(0,A.oD)("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){(0,A.od)("OnDisconnect.remove",0,1,arguments.length),(0,A.oD)("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){(0,A.od)("OnDisconnect.set",1,2,arguments.length),(0,A.oD)("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){(0,A.od)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,A.oD)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if((0,A.od)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,D3("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,A.oD)("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}}class sme{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return(0,A.od)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Gc{constructor(e,n){this._database=e,this._delegate=n}val(){return(0,A.od)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,A.od)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,A.od)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,A.od)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,A.od)("DataSnapshot.child",0,1,arguments.length),e=String(e),jy("DataSnapshot.child","path",e,!1),new Gc(this._database,this._delegate.child(e))}hasChild(e){return(0,A.od)("DataSnapshot.hasChild",1,1,arguments.length),jy("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,A.od)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,A.od)("DataSnapshot.forEach",1,1,arguments.length),(0,A.oD)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new Gc(this._database,n)))}hasChildren(){return(0,A.od)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,A.od)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,A.od)("DataSnapshot.ref",0,0,arguments.length),new Ps(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class ei{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;(0,A.od)("Query.on",2,4,arguments.length),(0,A.oD)("Query.on","callback",n,!1);const o=ei.getCancelAndContextArgs_("Query.on",r,i),a=(c,h)=>{n.call(o.context,new Gc(this.database,c),h)};a.userCallback=n,a.context=o.context;const u=null===(s=o.cancel)||void 0===s?void 0:s.bind(o.context);switch(e){case"value":return px(this._delegate,a,u),n;case"child_added":return _3(this._delegate,a,u),n;case"child_removed":return E3(this._delegate,a,u),n;case"child_changed":return y3(this._delegate,a,u),n;case"child_moved":return v3(this._delegate,a,u),n;default:throw new Error((0,A.dI)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if((0,A.od)("Query.off",0,3,arguments.length),function(t,e,n){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,A.dI)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,A.oD)("Query.off","callback",n,!0),(0,A.HN)("Query.off","context",r,!0),n){const i=()=>{};i.userCallback=n,i.context=r,I3(this._delegate,e,i)}else I3(this._delegate,e)}get(){return gge(this._delegate).then(e=>new Gc(this.database,e))}once(e,n,r,i){(0,A.od)("Query.once",1,4,arguments.length),(0,A.oD)("Query.once","callback",n,!0);const s=ei.getCancelAndContextArgs_("Query.once",r,i),o=new A.cY,a=(c,h)=>{const g=new Gc(this.database,c);n&&n.call(s.context,g,h),o.resolve(g)};a.userCallback=n,a.context=s.context;const u=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":px(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":_3(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":E3(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":y3(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":v3(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error((0,A.dI)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return(0,A.od)("Query.limitToFirst",1,1,arguments.length),new ei(this.database,xo(this._delegate,function Tge(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new wge(t)}(e)))}limitToLast(e){return(0,A.od)("Query.limitToLast",1,1,arguments.length),new ei(this.database,xo(this._delegate,function Age(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Cge(t)}(e)))}orderByChild(e){return(0,A.od)("Query.orderByChild",1,1,arguments.length),new ei(this.database,xo(this._delegate,function Dge(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return jy("orderByChild","path",t,!1),new bge(t)}(e)))}orderByKey(){return(0,A.od)("Query.orderByKey",0,0,arguments.length),new ei(this.database,xo(this._delegate,function Rge(){return new Sge}()))}orderByPriority(){return(0,A.od)("Query.orderByPriority",0,0,arguments.length),new ei(this.database,xo(this._delegate,function Pge(){return new Nge}()))}orderByValue(){return(0,A.od)("Query.orderByValue",0,0,arguments.length),new ei(this.database,xo(this._delegate,function xge(){return new Mge}()))}startAt(e=null,n){return(0,A.od)("Query.startAt",0,2,arguments.length),new ei(this.database,xo(this._delegate,function vge(t=null,e){return By("startAt","key",e,!0),new T3(t,e)}(e,n)))}startAfter(e=null,n){return(0,A.od)("Query.startAfter",0,2,arguments.length),new ei(this.database,xo(this._delegate,function Ige(t,e){return By("startAfter","key",e,!0),new Ege(t,e)}(e,n)))}endAt(e=null,n){return(0,A.od)("Query.endAt",0,2,arguments.length),new ei(this.database,xo(this._delegate,function mge(t,e){return By("endAt","key",e,!0),new w3(t,e)}(e,n)))}endBefore(e=null,n){return(0,A.od)("Query.endBefore",0,2,arguments.length),new ei(this.database,xo(this._delegate,function yge(t,e){return By("endBefore","key",e,!0),new _ge(t,e)}(e,n)))}equalTo(e,n){return(0,A.od)("Query.equalTo",1,2,arguments.length),new ei(this.database,xo(this._delegate,function Oge(t,e){return By("equalTo","key",e,!0),new kge(t,e)}(e,n)))}toString(){return(0,A.od)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,A.od)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,A.od)("Query.isEqual",1,1,arguments.length),!(e instanceof ei))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,(0,A.oD)(e,"cancel",i.cancel,!0),i.context=r,(0,A.HN)(e,"context",i.context,!0);else if(n)if("object"==typeof n&&null!==n)i.context=n;else{if("function"!=typeof n)throw new Error((0,A.dI)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=n}return i}get ref(){return new Ps(this.database,new io(this._delegate._repo,this._delegate._path))}}class Ps extends ei{constructor(e,n){super(e,new ls(n._repo,n._path,new lC,!1)),this.database=e,this._delegate=n}getKey(){return(0,A.od)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,A.od)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Ps(this.database,Pd(this._delegate,e))}getParent(){(0,A.od)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Ps(this.database,e):null}getRoot(){return(0,A.od)("Reference.root",0,0,arguments.length),new Ps(this.database,this._delegate.root)}set(e,n){(0,A.od)("Reference.set",1,2,arguments.length),(0,A.oD)("Reference.set","onComplete",n,!0);const r=fx(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if((0,A.od)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,D3("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ro("Reference.update",this._delegate._path),(0,A.oD)("Reference.update","onComplete",n,!0);const r=pge(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){(0,A.od)("Reference.setWithPriority",2,3,arguments.length),(0,A.oD)("Reference.setWithPriority","onComplete",r,!0);const i=function fge(t,e,n){if(ro("setWithPriority",t._path),va("setWithPriority",e,t._path,!1),ix("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new A.cY;return ox(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){(0,A.od)("Reference.remove",0,1,arguments.length),(0,A.oD)("Reference.remove","onComplete",e,!0);const n=function dge(t){return ro("remove",t._path),fx(t,null)}(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){(0,A.od)("Reference.transaction",1,3,arguments.length),(0,A.oD)("Reference.transaction","transactionUpdate",e,!1),(0,A.oD)("Reference.transaction","onComplete",n,!0),function(t,e,n,r){if(void 0!==n&&"boolean"!=typeof n)throw new Error((0,A.dI)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function Jge(t,e,n){var r;if(t=(0,A.Ku)(t),ro("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=null===(r=n?.applyLocally)||void 0===r||r,s=new A.cY,a=px(t,()=>{});return function rge(t,e,n,r,i,s){Mp(t,"transaction on "+e);const o={path:e,update:n,onComplete:r,status:null,order:A4(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=ux(t,e,void 0);o.currentInputSnapshot=a;const u=o.update(a.val());if(void 0===u)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Uy("transaction failed: Data returned ",u,o.path),o.status=0;const c=DC(t.transactionQueueTree_,e),h=Rd(c)||[];let g;h.push(o),tx(c,h),"object"==typeof u&&null!==u&&(0,A.gR)(u,".priority")?(g=(0,A.yw)(u,".priority"),(0,A.vA)(Vy(g),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):g=(AC(t.serverSyncTree_,e)||dt.EMPTY_NODE).getPriority().val();const _=$y(t),v=Kn(u,g),w=JM(v,a,_);o.currentOutputSnapshotRaw=v,o.currentOutputSnapshotResolved=w,o.currentWriteId=PC(t);const b=qM(t.serverSyncTree_,e,w,o.currentWriteId,o.applyLocally);Ns(t.eventQueue_,e,b),MC(t,t.transactionQueueTree_)}}(t._repo,t._path,e,(u,c,h)=>{let g=null;u?s.reject(u):(g=new Nd(h,new io(t._repo,t._path),In),s.resolve(new Zge(c,g)))},a,i),s.promise}(this._delegate,e,{applyLocally:r}).then(s=>new sme(s.committed,new Gc(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){(0,A.od)("Reference.setPriority",1,2,arguments.length),(0,A.oD)("Reference.setPriority","onComplete",n,!0);const r=function hge(t,e){t=(0,A.Ku)(t),ro("setPriority",t._path),ix("setPriority",e,!1);const n=new A.cY;return ox(t._repo,Bn(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){(0,A.od)("Reference.push",0,2,arguments.length),(0,A.oD)("Reference.push","onComplete",n,!0);const r=function lge(t,e){t=(0,A.Ku)(t),ro("push",t._path),va("push",e,t._path,!0);const n=r3(t._repo),r=cge(n),i=Pd(t,r),s=Pd(t,r);let o;return o=null!=e?fx(s,e).then(()=>s):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),i=r.then(o=>new Ps(this.database,o));n&&i.then(()=>n(null),o=>n(o));const s=new Ps(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return ro("Reference.onDisconnect",this._delegate._path),new ime(new p3(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class qy{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:$ge,forceLongPolling:Hge}}useEmulator(e,n,r={}){!function b3(t,e,n,r={}){(t=(0,A.Ku)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&ma("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ma('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new wy(wy.OWNER);else if(r.mockUserToken){const o="string"==typeof r.mockUserToken?r.mockUserToken:(0,A.Fy)(r.mockUserToken,t.app.options.projectId);s=new wy(o)}!function Fge(t,e,n,r){t.repoInfo_=new fM(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}(i,e,n,s)}(this._delegate,e,n,r)}ref(e){if((0,A.od)("database.ref",0,1,arguments.length),e instanceof Ps){const n=m3(this._delegate,e.toString());return new Ps(this,n)}{const n=g3(this._delegate,e);return new Ps(this,n)}}refFromURL(e){(0,A.od)("database.refFromURL",1,1,arguments.length);const r=m3(this._delegate,e);return new Ps(this,r)}goOffline(){return(0,A.od)("database.goOffline",0,0,arguments.length),function Gge(t){(t=(0,A.Ku)(t))._checkNotDeleted("goOffline"),a3(t._repo)}(this._delegate)}goOnline(){return(0,A.od)("database.goOnline",0,0,arguments.length),function qge(t){(t=(0,A.Ku)(t))._checkNotDeleted("goOnline"),function nge(t){t.persistentConnection_&&t.persistentConnection_.resume(n3)}(t._repo)}(this._delegate)}}qy.ServerValue={TIMESTAMP:function Qge(){return Kge}(),increment:t=>function Yge(t){return{".sv":{increment:t}}}(t)};var ame=Object.freeze({__proto__:null,initStandalone:function ome({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){uM(n);const a=new So.h1("database-standalone"),u=new So.Kq("auth-internal",a);let c;return u.setComponent(new So.uA("auth-internal",()=>r,"PRIVATE")),i&&(c=new So.Kq("app-check-internal",a),c.setComponent(new So.uA("app-check-internal",()=>i,"PRIVATE"))),{instance:new qy(mx(t,u,c,e,o),t),namespace:s}}});const ume=qy.ServerValue;function zy(t,e,n="on",r=jw){return new nn(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),"once"===n&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),"on"===n?{unsubscribe(){null!=s&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(Ae(i=>{const{snapshot:s,prevKey:o}=i;let a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),S$())}function S3(t){return null==t}function R3(t){return"function"==typeof t.set}function N3(t,e){return R3(e)?e:t.ref(e)}function P3(t,e){if(function lme(t){return"string"==typeof t}(t))return e.stringCase();if(R3(t))return e.firebaseCase();if(function dme(t){return"function"==typeof t.exportVal}(t))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof t)}function M3(t){return(S3(t)||0===t.length)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function x3(t,e,n){return fR(...(e=M3(e)).map(i=>zy(t,i,"on",n)))}function k3(t,e){return function(r,i){return P3(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function gme(t){return function(n){return n?P3(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function O3(t,e){const n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function yme(t,e){const{payload:n,prevKey:r,key:i}=e,s=O3(t,i),o=function _me(t,e){if(S3(e))return 0;{const n=O3(t,e);return-1===n?t.length:n+1}}(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{const c={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key)).splice(o,0,e);else{if(null==r)return[e,...t];(t=t.slice()).splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){const a=t.splice(s,1)[0];return(t=t.slice()).splice(o,0,a),t}return t;default:return t}}function L3(t,e,n){return function mme(t,e,n){return zy(t,"value","once",n).pipe(On(r=>{const i=[We(r)];return e.forEach(s=>i.push(zy(t,s,"on",n))),fR(...i).pipe(Ff(yme,[]))}),yH())}(t,e=M3(e),n)}function F3(t,e){return function(){return zy(t,"value","on",e)}}!function cme(t){t.INTERNAL.registerComponent(new So.uA("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new qy(i,r)},"PUBLIC").setServiceProps({Reference:Ps,Query:ei,Database:qy,DataSnapshot:Gc,enableLogging:zge,INTERNAL:ame,ServerValue:ume}).setMultipleInstances(!0)),t.registerVersion("@firebase/database-compat","1.0.7")}(_i.A);const Ime=new ve("angularfire2.realtimeDatabaseURL"),wme=new ve("angularfire2.database.use-emulator");let _x=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,c,h,g,_,v,w,b,D){this.schedulers=a;const F=u,x=A_(n,o,r);c&&IR(x,o,h,_,v,w,g,b),this.database=Gw(`${x.name}.database.${i}`,"AngularFireDatabase",x.name,()=>{const $=o.runOutsideAngular(()=>x.database(i||void 0));return F&&$.useEmulator(...F),$},[F])}list(n,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>N3(this.database,n));let s=i;return r&&(s=r(i)),function vme(t,e){const n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:k3(r,"update"),set:k3(r,"set"),push:i=>r.push(i),remove:gme(r),snapshotChanges:i=>L3(t,i,n).pipe(lr),stateChanges:i=>x3(t,i,n).pipe(lr),auditTrail:i=>function hme(t,e,n){return function pme(t,e,n){return function fme(t,e){return zy(t,"value","on",e).pipe(Ae(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}(t,n).pipe(function phe(...t){const e=H0(t);return Oe((n,r)=>{const i=t.length,s=new Array(i);let o=t.map(()=>!1),a=!1;for(let u=0;u<i;u++)is(t[u]).subscribe(Be(r,c=>{s[u]=c,!a&&!o[u]&&(o[u]=!0,(a=o.every(Or))&&(o=null))},ii));n.subscribe(Be(r,u=>{if(a){const c=[u,...s];r.next(e?e(...c):c)}}))})}(e),Ae(([i,s])=>{const o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),function ghe(t){return Oe((e,n)=>{let r=!1,i=0;e.subscribe(Be(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),Ae(i=>i.actions))}(t,x3(t,e).pipe(Ff((i,s)=>[...i,s],[])),n)}(t,i,n).pipe(lr),valueChanges:(i,s)=>L3(t,i,n).pipe(Ae(a=>a.map(u=>s&&s.idField?{...u.payload.val(),[s.idField]:u.key}:u.payload.val())),lr)}}(s,this)}object(n){return function Eme(t,e){return{query:t,snapshotChanges:()=>F3(t,e.schedulers.outsideAngular)().pipe(lr),update:n=>t.ref.update(n),set:n=>t.ref.set(n),remove:()=>t.ref.remove(),valueChanges:()=>F3(t,e.schedulers.outsideAngular)().pipe(lr,Ae(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>N3(this.database,n)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(ce(Rf),ce(Nf,8),ce(Ime,8),ce(Ys),ce(At),ce(Hw),ce(wme,8),ce(pc,8),ce(gR,8),ce(mR,8),ce(_R,8),ce(yR,8),ce(vR,8),ce(ER,8),ce($w,8))};static \u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),Tme=(()=>{class t{constructor(){_i.A.registerVersion("angularfire",bf.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Fr({type:t});static \u0275inj=pr({providers:[_x]})}return t})();const Cme_firebase={apiKey:"AIzaSyCk2pqJq5Vm7vOhz4kH_YRIuRjkOC6K-KM",authDomain:"waldotours-42416.firebaseapp.com",databaseURL:"https://waldotours-42416-default-rtdb.europe-west1.firebasedatabase.app",projectId:"waldotours-42416",storageBucket:"waldotours-42416.appspot.com",messagingSenderId:"792793844716",appId:"1:792793844716:web:2cf7451dcf283c4a818ec9"};let Ame=(()=>{class t{constructor(n){this.db=n,this.leaderboardRef=n.list("leaderboard")}getLeaderboard(){return this.leaderboardRef.valueChanges()}addScore(n,r){this.leaderboardRef.push({name:n,score:r})}static#e=this.\u0275fac=function(r){return new(r||t)(ce(_x))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function yx(...t){const e=g_(t),n=H0(t),{args:r,keys:i}=gj(t);if(0===r.length)return en([],e);const s=new nn(function Dme(t,e,n=Or){return r=>{V3(e,()=>{const{length:i}=t,s=new Array(i);let o=i,a=i;for(let u=0;u<i;u++)V3(e,()=>{const c=en(t[u],e);let h=!1;c.subscribe(Be(r,g=>{s[u]=g,h||(h=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,e,i?o=>_j(i,o):Or));return n?s.pipe(mj(n)):s}function V3(t,e,n){t?nu(n,t,e):e()}function U3(t){return new nn(e=>{is(t()).subscribe(e)})}function Md(t,e){const n=ze(t)?t:()=>t,r=i=>i.error(n());return new nn(e?i=>e.schedule(r,0,i):r)}function vx(){return Oe((t,e)=>{let n=null;t._refCount++;const r=Be(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(n=null);const i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}class B3 extends nn{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,De(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ht;const n=this.getSubject();e.add(this.source.subscribe(Be(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ht.EMPTY)}return e}refCount(){return vx()(this)}}function Wy(t,e){return ze(e)?yi(t,e,1):yi(t,1)}function _u(t){return Oe((e,n)=>{let s,r=null,i=!1;r=e.subscribe(Be(n,void 0,void 0,o=>{s=is(t(o,_u(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function Ex(t){return t<=0?()=>bo:Oe((e,n)=>{let r=[];e.subscribe(Be(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(const i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function Ix(t){return Oe((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}const mt="primary",Ky=Symbol("RouteTitle");class Pme{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function kp(t){return new Pme(t)}function Mme(t,e,n){const r=n.path.split("/");if(r.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let s=0;s<r.length;s++){const o=r[s],a=t[s];if(":"===o[0])i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function Ea(t,e){const n=t?wx(t):void 0,r=e?wx(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!j3(t[i],e[i]))return!1;return!0}function wx(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function j3(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}return t===e}function $3(t){return t.length>0?t[t.length-1]:null}function qc(t){return function bme(t){return!!t&&(t instanceof nn||ze(t.lift)&&ze(t.subscribe))}(t)?t:i_(t)?en(Promise.resolve(t)):We(t)}const kme={exact:function q3(t,e,n){if(!kd(t.segments,e.segments)||!FC(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!t.children[r]||!q3(t.children[r],e.children[r],n))return!1;return!0},subset:z3},H3={exact:function Ome(t,e){return Ea(t,e)},subset:function Lme(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>j3(t[n],e[n]))},ignored:()=>!0};function G3(t,e,n){return kme[n.paths](t.root,e.root,n.matrixParams)&&H3[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function z3(t,e,n){return W3(t,e,e.segments,n)}function W3(t,e,n,r){if(t.segments.length>n.length){const i=t.segments.slice(0,n.length);return!(!kd(i,n)||e.hasChildren()||!FC(i,n,r))}if(t.segments.length===n.length){if(!kd(t.segments,n)||!FC(t.segments,n,r))return!1;for(const i in e.children)if(!t.children[i]||!z3(t.children[i],e.children[i],r))return!1;return!0}{const i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!(kd(t.segments,i)&&FC(t.segments,i,r)&&t.children[mt])&&W3(t.children[mt],e,s,r)}}function FC(t,e,n){return e.every((r,i)=>H3[n](t[i].parameters,r.parameters))}class xd{constructor(e=new on([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=kp(this.queryParams),this._queryParamMap}toString(){return Ume.serialize(this)}}class on{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return UC(this)}}class Qy{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=kp(this.parameters),this._parameterMap}toString(){return Y3(this)}}function kd(t,e){return t.length===e.length&&t.every((n,r)=>n.path===e[r].path)}let Op=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:()=>new VC,providedIn:"root"})}return t})();class VC{parse(e){const n=new Yme(e);return new xd(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){const n=`/${Yy(e.root,!0)}`,r=function $me(t){const e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${BC(n)}=${BC(i)}`).join("&"):`${BC(n)}=${BC(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${n}${r}${"string"==typeof e.fragment?`#${function Bme(t){return encodeURI(t)}(e.fragment)}`:""}`}}const Ume=new VC;function UC(t){return t.segments.map(e=>Y3(e)).join("/")}function Yy(t,e){if(!t.hasChildren())return UC(t);if(e){const n=t.children[mt]?Yy(t.children[mt],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==mt&&r.push(`${i}:${Yy(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function Vme(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===mt&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==mt&&(n=n.concat(e(i,r)))}),n}(t,(r,i)=>i===mt?[Yy(t.children[mt],!1)]:[`${i}:${Yy(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[mt]?`${UC(t)}/${n[0]}`:`${UC(t)}/(${n.join("//")})`}}function K3(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function BC(t){return K3(t).replace(/%3B/gi,";")}function Tx(t){return K3(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function jC(t){return decodeURIComponent(t)}function Q3(t){return jC(t.replace(/\+/g,"%20"))}function Y3(t){return`${Tx(t.path)}${function jme(t){return Object.entries(t).map(([e,n])=>`;${Tx(e)}=${Tx(n)}`).join("")}(t.parameters)}`}const Hme=/^[^\/()?;#]+/;function Cx(t){const e=t.match(Hme);return e?e[0]:""}const Gme=/^[^\/()?;=#]+/,zme=/^[^=?&#]+/,Kme=/^[^&#]+/;class Yme{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new on([],{}):new on([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[mt]=new on(e,n)),r}parseSegment(){const e=Cx(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new le(4009,!1);return this.capture(e),new Qy(jC(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const n=function qme(t){const e=t.match(Gme);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const i=Cx(this.remaining);i&&(r=i,this.capture(r))}e[jC(n)]=jC(r)}parseQueryParam(e){const n=function Wme(t){const e=t.match(zme);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const o=function Qme(t){const e=t.match(Kme);return e?e[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const i=Q3(n),s=Q3(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=Cx(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new le(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=mt);const o=this.parseChildren();n[s]=1===Object.keys(o).length?o[mt]:new on([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new le(4011,!1)}}function Z3(t){return t.segments.length>0?new on([],{[mt]:t}):t}function J3(t){const e={};for(const[r,i]of Object.entries(t.children)){const s=J3(i);if(r===mt&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}return function Zme(t){if(1===t.numberOfChildren&&t.children[mt]){const e=t.children[mt];return new on(t.segments.concat(e.segments),e.children)}return t}(new on(t.segments,e))}function Od(t){return t instanceof xd}function X3(t){let e;const i=Z3(function n(s){const o={};for(const u of s.children){const c=n(u);o[u.outlet]=c}const a=new on(s.url,o);return s===t&&(e=a),a}(t.root));return e??i}function e6(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(0===e.length)return Ax(i,i,i,n,r);const s=function Xme(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new n6(!0,0,t);let e=0,n=!1;const r=t.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([u,c])=>{a[u]="string"==typeof c?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,u)=>{0==u&&"."===a||(0==u&&""===a?n=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new n6(n,e,r)}(e);if(s.toRoot())return Ax(i,i,new on([],{}),n,r);const o=function e_e(t,e,n){if(t.isAbsolute)return new HC(e,!0,0);if(!n)return new HC(e,!1,NaN);if(null===n.parent)return new HC(n,!0,0);const r=$C(t.commands[0])?0:1;return function t_e(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new le(4005,!1);i=r.segments.length}return new HC(r,!1,i-s)}(n,n.segments.length-1+r,t.numberOfDoubleDots)}(s,i,t),a=o.processChildren?Jy(o.segmentGroup,o.index,s.commands):r6(o.segmentGroup,o.index,s.commands);return Ax(i,o.segmentGroup,a,n,r)}function $C(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Zy(t){return"object"==typeof t&&null!=t&&t.outlets}function Ax(t,e,n,r,i){let o,s={};r&&Object.entries(r).forEach(([u,c])=>{s[u]=Array.isArray(c)?c.map(h=>`${h}`):`${c}`}),o=t===e?n:t6(t,e,n);const a=Z3(J3(o));return new xd(a,s,i)}function t6(t,e,n){const r={};return Object.entries(t.children).forEach(([i,s])=>{r[i]=s===e?n:t6(s,e,n)}),new on(t.segments,r)}class n6{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&$C(r[0]))throw new le(4003,!1);const i=r.find(Zy);if(i&&i!==$3(r))throw new le(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class HC{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}}function r6(t,e,n){if(t??=new on([],{}),0===t.segments.length&&t.hasChildren())return Jy(t,e,n);const r=function r_e(t,e,n){let r=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;const o=t.segments[i],a=n[r];if(Zy(a))break;const u=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!s6(u,c,o))return s;r+=2}else{if(!s6(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const s=new on(t.segments.slice(0,r.pathIndex),{});return s.children[mt]=new on(t.segments.slice(r.pathIndex),t.children),Jy(s,0,i)}return r.match&&0===i.length?new on(t.segments,{}):r.match&&!t.hasChildren()?bx(t,e,n):r.match?Jy(t,0,i):bx(t,e,n)}function Jy(t,e,n){if(0===n.length)return new on(t.segments,{});{const r=function n_e(t){return Zy(t[0])?t[0].outlets:{[mt]:t}}(n),i={};if(Object.keys(r).some(s=>s!==mt)&&t.children[mt]&&1===t.numberOfChildren&&0===t.children[mt].segments.length){const s=Jy(t.children[mt],e,n);return new on(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=r6(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{void 0===r[s]&&(i[s]=o)}),new on(t.segments,i)}}function bx(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){const s=n[i];if(Zy(s)){const u=i_e(s.outlets);return new on(r,u)}if(0===i&&$C(n[0])){r.push(new Qy(t.segments[e].path,i6(n[0]))),i++;continue}const o=Zy(s)?s.outlets[mt]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&$C(a)?(r.push(new Qy(o,i6(a))),i+=2):(r.push(new Qy(o,{})),i++)}return new on(r,{})}function i_e(t){const e={};return Object.entries(t).forEach(([n,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(e[n]=bx(new on([],{}),0,r))}),e}function i6(t){const e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function s6(t,e,n){return t==n.path&&Ea(e,n.parameters)}const Xy="imperative";var Pt=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(Pt||{});class Ia{constructor(e,n){this.id=e,this.url=n}}class GC extends Ia{constructor(e,n,r="imperative",i=null){super(e,n),this.type=Pt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class yu extends Ia{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=Pt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var Ms=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(Ms||{}),qC=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(qC||{});class Ld extends Ia{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=Pt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Lp extends Ia{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=Pt.NavigationSkipped}}class Dx extends Ia{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=Pt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class o6 extends Ia{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Pt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class s_e extends Ia{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Pt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class o_e extends Ia{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Pt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class a_e extends Ia{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Pt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class u_e extends Ia{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Pt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class c_e{constructor(e){this.route=e,this.type=Pt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class l_e{constructor(e){this.route=e,this.type=Pt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class d_e{constructor(e){this.snapshot=e,this.type=Pt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class h_e{constructor(e){this.snapshot=e,this.type=Pt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class f_e{constructor(e){this.snapshot=e,this.type=Pt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class p_e{constructor(e){this.snapshot=e,this.type=Pt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class a6{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=Pt.Scroll}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Sx{}class zC{constructor(e,n){this.url=e,this.navigationBehaviorOptions=n}}function ko(t){return t.outlet||mt}function ev(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class E_e{get injector(){return ev(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new tv(this.rootInjector),this.attachRef=null}}let tv=(()=>{class t{constructor(n){this.rootInjector=n,this.contexts=new Map}onChildOutletCreated(n,r){const i=this.getOrCreateContext(n);i.outlet=r,this.contexts.set(n,i)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new E_e(this.rootInjector),this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static#e=this.\u0275fac=function(r){return new(r||t)(ce(ci))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class u6{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){const n=Rx(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){const n=Rx(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){const n=Nx(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Nx(e,this._root).map(n=>n.value)}}function Rx(t,e){if(t===e.value)return e;for(const n of e.children){const r=Rx(t,n);if(r)return r}return null}function Nx(t,e){if(t===e.value)return[e];for(const n of e.children){const r=Nx(t,n);if(r.length)return r.unshift(e),r}return[]}class Oo{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}}function Fp(t){const e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}class c6 extends u6{constructor(e,n){super(e),this.snapshot=n,Px(this,e)}toString(){return this.snapshot.toString()}}function l6(t){const e=function I_e(t){const s=new KC([],{},{},"",{},mt,t,null,{});return new d6("",new Oo(s,[]))}(t),n=new G([new Qy("",{})]),r=new G({}),i=new G({}),s=new G({}),o=new G(""),a=new Fd(n,r,s,o,i,mt,t,e.root);return a.snapshot=e.root,new c6(new Oo(a,[]),e)}class Fd{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(Ae(c=>c[Ky]))??We(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Ae(e=>kp(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Ae(e=>kp(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function WC(t,e,n="emptyOnly"){let r;const{routeConfig:i}=t;return r=null===e||"always"!==n&&""!==i?.path&&(e.component||e.routeConfig?.loadComponent)?{params:{...t.params},data:{...t.data},resolve:{...t.data,...t._resolvedData??{}}}:{params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.data,...i?.data,...t._resolvedData}},i&&f6(i)&&(r.resolve[Ky]=i.title),r}class KC{get title(){return this.data?.[Ky]}constructor(e,n,r,i,s,o,a,u,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=kp(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=kp(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class d6 extends u6{constructor(e,n){super(n),this.url=e,Px(this,n)}toString(){return h6(this._root)}}function Px(t,e){e.value._routerState=t,e.children.forEach(n=>Px(t,n))}function h6(t){const e=t.children.length>0?` { ${t.children.map(h6).join(", ")} } `:"";return`${t.value}${e}`}function Mx(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Ea(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),Ea(e.params,n.params)||t.paramsSubject.next(n.params),function xme(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Ea(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.urlSubject.next(n.url),Ea(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function xx(t,e){const n=Ea(t.params,e.params)&&function Fme(t,e){return kd(t,e)&&t.every((n,r)=>Ea(n.parameters,e[r].parameters))}(t.url,e.url);return n&&!(!t.parent!=!e.parent)&&(!t.parent||xx(t.parent,e.parent))}function f6(t){return"string"==typeof t.title||null===t.title}let kx=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=mt,this.activateEvents=new Yn,this.deactivateEvents=new Yn,this.attachEvents=new Yn,this.detachEvents=new Yn,this.parentContexts=he(tv),this.location=he(Eo),this.changeDetector=he(o_),this.inputBinder=he(QC,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:r,previousValue:i}=n.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new le(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new le(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new le(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new le(4013,!1);this._activatedRoute=n;const i=this.location,o=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new Ox(n,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275dir=Je({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[li]})}return t})();class Ox{__ngOutletInjector(e){return new Ox(this.route,this.childContexts,e)}constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Fd?this.route:e===tv?this.childContexts:this.parent.get(e,n)}}const QC=new ve("");let p6=(()=>{class t{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:r}=n,i=yx([r.queryParams,r.params,r.data]).pipe(On(([s,o,a],u)=>(a={...s,...o,...a},0===u?We(a):Promise.resolve(a)))).subscribe(s=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(n);const o=function Cte(t){const e=gt(t);if(!e)return null;const n=new Bm(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(r.component);if(o)for(const{templateName:a}of o.inputs)n.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,i)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})();function nv(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=e.value;const i=function T_e(t,e,n){return e.children.map(r=>{for(const i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return nv(t,r,i);return nv(t,r)})}(t,e,n);return new Oo(r,i)}{if(t.shouldAttach(e.value)){const s=t.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>nv(t,a)),o}}const r=function C_e(t){return new Fd(new G(t.url),new G(t.params),new G(t.queryParams),new G(t.fragment),new G(t.data),t.outlet,t.component,t)}(e.value),i=e.children.map(s=>nv(t,s));return new Oo(r,i)}}class Lx{constructor(e,n){this.redirectTo=e,this.navigationBehaviorOptions=n}}const g6="ngNavigationCancelingError";function YC(t,e){const{redirectTo:n,navigationBehaviorOptions:r}=Od(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=m6(!1,Ms.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function m6(t,e){const n=new Error(`NavigationCancelingError: ${t||""}`);return n[g6]=!0,n.cancellationCode=e,n}function _6(t){return!!t&&t[g6]}class D_e{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Mx(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){const i=Fp(n);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(i===s)if(i.component){const o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Fp(e);for(const o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){const o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Fp(e);for(const o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){const i=Fp(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new p_e(s.value.snapshot))}),e.children.length&&this.forwardEvent(new h_e(e.value.snapshot))}activateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(Mx(i),i===s)if(i.component){const o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){const o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Mx(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}}class y6{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class ZC{constructor(e,n){this.component=e,this.route=n}}function S_e(t,e,n){const r=t._root;return rv(r,e?e._root:null,n,[r.value])}function Vp(t,e){const n=Symbol(),r=e.get(t,n);return r===n?"function"!=typeof t||function qA(t){return null!==xu(t)}(t)?e.get(t):t:r}function rv(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=Fp(e);return t.children.forEach(o=>{(function N_e(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const u=function P_e(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!kd(t.url,e.url);case"pathParamsOrQueryParamsChange":return!kd(t.url,e.url)||!Ea(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!xx(t,e)||!Ea(t.queryParams,e.queryParams);default:return!xx(t,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new y6(r)):(s.data=o.data,s._resolvedData=o._resolvedData),rv(t,e,s.component?a?a.children:null:n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new ZC(a.outlet.component,o))}else o&&iv(e,a,i),i.canActivateChecks.push(new y6(r)),rv(t,null,s.component?a?a.children:null:n,r,i)})(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>iv(a,n.getContext(o),i)),i}function iv(t,e,n){const r=Fp(t),i=t.value;Object.entries(r).forEach(([s,o])=>{iv(o,i.component?e?e.children.getContext(s):null:e,n)}),n.canDeactivateChecks.push(new ZC(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function sv(t){return"function"==typeof t}function v6(t){return t instanceof qw||"EmptyError"===t?.name}const JC=Symbol("INITIAL_VALUE");function Up(){return On(t=>yx(t.map(e=>e.pipe(Mf(1),eT(JC)))).pipe(Ae(e=>{for(const n of e)if(!0!==n){if(n===JC)return JC;if(!1===n||V_e(n))return n}return!0}),Do(e=>e!==JC),Mf(1)))}function V_e(t){return Od(t)||t instanceof Lx}function E6(t){return function Zc(...t){return Sa(t)}(Nr(e=>{if("boolean"!=typeof e)throw YC(0,e)}),Ae(e=>!0===e))}class Fx{constructor(e){this.segmentGroup=e||null}}class XC extends Error{constructor(e){super(),this.urlTree=e}}function Bp(t){return Md(new Fx(t))}class Z_e{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return We(r);if(i.numberOfChildren>1||!i.children[mt])return Md(new le(4e3,!1));i=i.children[mt]}}applyRedirectCommands(e,n,r,i,s){if("string"!=typeof n){const a=n,{queryParams:u,fragment:c,routeConfig:h,url:g,outlet:_,params:v,data:w,title:b}=i,D=zs(s,()=>a({params:v,data:w,queryParams:u,fragment:c,routeConfig:h,url:g,outlet:_,title:b}));if(D instanceof xd)throw new XC(D);n=D}const o=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if("/"===n[0])throw new XC(o);return o}applyRedirectCreateUrlTree(e,n,r,i){const s=this.createSegmentGroup(e,n.root,r,i);return new xd(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){const r={};return Object.entries(e).forEach(([i,s])=>{if("string"==typeof s&&":"===s[0]){const a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){const s=this.createSegments(e,n.segments,r,i);let o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new on(s,o)}createSegments(e,n,r,i){return n.map(s=>":"===s.path[0]?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){const i=r[n.path.substring(1)];if(!i)throw new le(4001,!1);return i}findOrReturn(e,n){let r=0;for(const i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}}const Vx={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function J_e(t,e,n,r,i){const s=Ux(t,e,n);return s.matched?(r=function g_e(t,e){return t.providers&&!t._injector&&(t._injector=RI(t.providers,e,`Route: ${t.path}`)),t._injector??e}(e,r),function K_e(t,e,n,r){const i=e.canMatch;return i&&0!==i.length?We(i.map(o=>{const a=Vp(o,t);return qc(function F_e(t){return t&&sv(t.canMatch)}(a)?a.canMatch(e,n):zs(t,()=>a(e,n)))})).pipe(Up(),E6()):We(!0)}(r,e,n).pipe(Ae(o=>!0===o?s:{...Vx}))):We(s)}function Ux(t,e,n){if("**"===e.path)return function X_e(t){return{matched:!0,parameters:t.length>0?$3(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}(n);if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{...Vx}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const i=(e.matcher||Mme)(n,t,e);if(!i)return{...Vx};const s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function I6(t,e,n,r){return n.length>0&&function nye(t,e,n){return n.some(r=>eA(t,e,r)&&ko(r)!==mt)}(t,n,r)?{segmentGroup:new on(e,tye(r,new on(n,t.children))),slicedSegments:[]}:0===n.length&&function rye(t,e,n){return n.some(r=>eA(t,e,r))}(t,n,r)?{segmentGroup:new on(t.segments,eye(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new on(t.segments,t.children),slicedSegments:n}}function eye(t,e,n,r){const i={};for(const s of n)if(eA(t,e,s)&&!r[ko(s)]){const o=new on([],{});i[ko(s)]=o}return{...r,...i}}function tye(t,e){const n={};n[mt]=e;for(const r of t)if(""===r.path&&ko(r)!==mt){const i=new on([],{});n[ko(r)]=i}return n}function eA(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}class oye{}class cye{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Z_e(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new le(4002,`'${e.segmentGroup}'`)}recognize(){const e=I6(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Ae(({children:n,rootSnapshot:r})=>{const i=new Oo(r,n),s=new d6("",i),o=function Jme(t,e,n=null,r=null){return e6(X3(t),e,n,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){const n=new KC([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Object.freeze({}),mt,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,mt,n).pipe(Ae(r=>({children:r,rootSnapshot:n})),_u(r=>{if(r instanceof XC)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Fx?this.noMatchError(r):r}))}processSegmentGroup(e,n,r,i,s){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,n,r,s):this.processSegment(e,n,r,r.segments,i,!0,s).pipe(Ae(o=>o instanceof Oo?[o]:[]))}processChildren(e,n,r,i){const s=[];for(const o of Object.keys(r.children))"primary"===o?s.unshift(o):s.push(o);return en(s).pipe(Wy(o=>{const a=r.children[o],u=function v_e(t,e){const n=t.filter(r=>ko(r)===e);return n.push(...t.filter(r=>ko(r)!==e)),n}(n,o);return this.processSegmentGroup(e,u,a,o,i)}),Ff((o,a)=>(o.push(...a),o)),zw(null),function Sme(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Do((i,s)=>t(i,s,r)):Or,Ex(1),n?zw(e):N$(()=>new qw))}(),yi(o=>{if(null===o)return Bp(r);const a=w6(o);return function lye(t){t.sort((e,n)=>e.value.outlet===mt?-1:n.value.outlet===mt?1:e.value.outlet.localeCompare(n.value.outlet))}(a),We(a)}))}processSegment(e,n,r,i,s,o,a){return en(n).pipe(Wy(u=>this.processSegmentAgainstRoute(u._injector??e,n,u,r,i,s,o,a).pipe(_u(c=>{if(c instanceof Fx)return We(null);throw c}))),fc(u=>!!u),_u(u=>{if(v6(u))return function sye(t,e,n){return 0===e.length&&!t.children[n]}(r,i,s)?We(new oye):Bp(r);throw u}))}processSegmentAgainstRoute(e,n,r,i,s,o,a,u){return function iye(t,e,n,r){return!!(ko(t)===r||r!==mt&&eA(e,n,t))&&Ux(e,t,n).matched}(r,i,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,i,r,s,o,u):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o,u):Bp(i):Bp(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o,a){const{matched:u,parameters:c,consumedSegments:h,positionalParamSegments:g,remainingSegments:_}=Ux(n,i,s);if(!u)return Bp(n);"string"==typeof i.redirectTo&&"/"===i.redirectTo[0]&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const v=new KC(s,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,T6(i),ko(i),i.component??i._loadedComponent??null,i,C6(i)),w=WC(v,a,this.paramsInheritanceStrategy);v.params=Object.freeze(w.params),v.data=Object.freeze(w.data);const b=this.applyRedirects.applyRedirectCommands(h,i.redirectTo,g,v,e);return this.applyRedirects.lineralizeSegments(i,b).pipe(yi(D=>this.processSegment(e,r,n,D.concat(_),o,!1,a)))}matchSegmentAgainstRoute(e,n,r,i,s,o){const a=J_e(n,r,i,e);return"**"===r.path&&(n.children={}),a.pipe(On(u=>u.matched?this.getChildConfig(e=r._injector??e,r,i).pipe(On(({routes:c})=>{const h=r._loadedInjector??e,{parameters:g,consumedSegments:_,remainingSegments:v}=u,w=new KC(_,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,T6(r),ko(r),r.component??r._loadedComponent??null,r,C6(r)),b=WC(w,o,this.paramsInheritanceStrategy);w.params=Object.freeze(b.params),w.data=Object.freeze(b.data);const{segmentGroup:D,slicedSegments:F}=I6(n,_,v,c);if(0===F.length&&D.hasChildren())return this.processChildren(h,c,D,w).pipe(Ae($=>new Oo(w,$)));if(0===c.length&&0===F.length)return We(new Oo(w,[]));const x=ko(r)===s;return this.processSegment(h,c,D,F,x?mt:s,!0,w).pipe(Ae($=>new Oo(w,$ instanceof Oo?[$]:[])))})):Bp(n)))}getChildConfig(e,n,r){return n.children?We({routes:n.children,injector:e}):n.loadChildren?void 0!==n._loadedRoutes?We({routes:n._loadedRoutes,injector:n._loadedInjector}):function W_e(t,e,n,r){const i=e.canLoad;return void 0===i||0===i.length?We(!0):We(i.map(o=>{const a=Vp(o,t);return qc(function x_e(t){return t&&sv(t.canLoad)}(a)?a.canLoad(e,n):zs(t,()=>a(e,n)))})).pipe(Up(),E6())}(e,n,r).pipe(yi(i=>i?this.configLoader.loadChildren(e,n).pipe(Nr(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):function Y_e(t){return Md(m6(!1,Ms.GuardRejected))}())):We({routes:[],injector:e})}}function dye(t){const e=t.value.routeConfig;return e&&""===e.path}function w6(t){const e=[],n=new Set;for(const r of t){if(!dye(r)){e.push(r);continue}const i=e.find(s=>r.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...r.children),n.add(i)):e.push(r)}for(const r of n){const i=w6(r.children);e.push(new Oo(r.value,i))}return e.filter(r=>!n.has(r))}function T6(t){return t.data||{}}function C6(t){return t.resolve||{}}function A6(t){const e=t.children.map(n=>A6(n)).flat();return[t,...e]}function Bx(t){return On(e=>{const n=t(e);return n?en(n).pipe(Ae(()=>e)):We(e)})}let b6=(()=>{class t{buildTitle(n){let r,i=n.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===mt);return r}getResolvedTitleForRoute(n){return n.data[Ky]}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:()=>he(_ye),providedIn:"root"})}return t})(),_ye=(()=>{class t extends b6{constructor(n){super(),this.title=n}updateTitle(n){const r=this.buildTitle(n);void 0!==r&&this.title.setTitle(r)}static#e=this.\u0275fac=function(r){return new(r||t)(ce(Qre))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const jp=new ve("",{providedIn:"root",factory:()=>({})});let D6=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Wo({type:t,selectors:[["ng-component"]],standalone:!0,features:[jU],decls:1,vars:0,template:function(r,i){1&r&&Za(0,"router-outlet")},dependencies:[kx],encapsulation:2})}return t})();function jx(t){const e=t.children&&t.children.map(jx),n=e?{...t,children:e}:{...t};return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==mt&&(n.component=D6),n}const $p=new ve("");let $x=(()=>{class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=he(I2)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return We(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const r=qc(n.loadComponent()).pipe(Ae(S6),Nr(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),Ix(()=>{this.componentLoaders.delete(n)})),i=new B3(r,()=>new L).pipe(vx());return this.componentLoaders.set(n,i),i}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return We({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const s=function yye(t,e,n,r){return qc(t.loadChildren()).pipe(Ae(S6),yi(i=>i instanceof kF||Array.isArray(i)?We(i):en(e.compileModuleAsync(i))),Ae(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,!0):(s=i.create(n).injector,o=s.get($p,[],{optional:!0,self:!0}).flat()),{routes:o.map(jx),injector:s}}))}(r,this.compiler,n,this.onLoadEndListener).pipe(Ix(()=>{this.childrenLoaders.delete(r)})),o=new B3(s,()=>new L).pipe(vx());return this.childrenLoaders.set(r,o),o}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function S6(t){return function vye(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}let Hx=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:()=>he(Eye),providedIn:"root"})}return t})(),Eye=(()=>{class t{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const R6=new ve(""),N6=new ve("");function Iye(t,e,n){const r=t.get(N6),i=t.get(Cs);return t.get(At).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(c=>setTimeout(c));let s;const o=new Promise(c=>{s=c}),a=i.startViewTransition(()=>(s(),function wye(t){return new Promise(e=>{ZL({read:()=>setTimeout(e)},{injector:t})})}(t))),{onViewTransitionCreated:u}=r;return u&&zs(t,()=>u({transition:a,from:e,to:n})),o})}const P6=new ve("");let tA=(()=>{class t{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new L,this.transitionAbortSubject=new L,this.configLoader=he($x),this.environmentInjector=he(ci),this.urlSerializer=he(Op),this.rootContexts=he(tv),this.location=he(yf),this.inputBindingEnabled=null!==he(QC,{optional:!0}),this.titleStrategy=he(b6),this.options=he(jp,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=he(Hx),this.createViewTransition=he(R6,{optional:!0}),this.navigationErrorHandler=he(P6,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>We(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new l_e(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new c_e(i))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:r})}setupNavigations(n,r,i){return this.transitions=new G({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Xy,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Do(s=>0!==s.id),Ae(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),On(s=>{let o=!1,a=!1;return We(s).pipe(On(u=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Ms.SupersededByNewNavigation),bo;this.currentTransition=s,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,targetBrowserUrl:"string"==typeof u.extras.browserUrl?this.urlSerializer.parse(u.extras.browserUrl):u.extras.browserUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null};const c=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!c&&"reload"!==(u.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const g="";return this.events.next(new Lp(u.id,this.urlSerializer.serialize(u.rawUrl),g,qC.IgnoredSameUrlNavigation)),u.resolve(!1),bo}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return We(u).pipe(On(g=>{const _=this.transitions?.getValue();return this.events.next(new GC(g.id,this.urlSerializer.serialize(g.extractedUrl),g.source,g.restoredState)),_!==this.transitions?.getValue()?bo:Promise.resolve(g)}),function hye(t,e,n,r,i,s){return yi(o=>function aye(t,e,n,r,i,s,o="emptyOnly"){return new cye(t,e,n,r,i,o,s).recognize()}(t,e,n,r,o.extractedUrl,i,s).pipe(Ae(({state:a,tree:u})=>({...o,targetSnapshot:a,urlAfterRedirects:u}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),Nr(g=>{s.targetSnapshot=g.targetSnapshot,s.urlAfterRedirects=g.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:g.urlAfterRedirects};const _=new o6(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(_)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){const{id:g,extractedUrl:_,source:v,restoredState:w,extras:b}=u,D=new GC(g,this.urlSerializer.serialize(_),v,w);this.events.next(D);const F=l6(this.rootComponentType).snapshot;return this.currentTransition=s={...u,targetSnapshot:F,urlAfterRedirects:_,extras:{...b,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=_,We(s)}{const g="";return this.events.next(new Lp(u.id,this.urlSerializer.serialize(u.extractedUrl),g,qC.IgnoredByUrlHandlingStrategy)),u.resolve(!1),bo}}),Nr(u=>{const c=new s_e(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(c)}),Ae(u=>(this.currentTransition=s={...u,guards:S_e(u.targetSnapshot,u.currentSnapshot,this.rootContexts)},s)),function U_e(t,e){return yi(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?We({...n,guardsResult:!0}):function B_e(t,e,n,r){return en(t).pipe(yi(i=>function z_e(t,e,n,r,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?We(s.map(a=>{const u=ev(e)??i,c=Vp(a,u);return qc(function L_e(t){return t&&sv(t.canDeactivate)}(c)?c.canDeactivate(t,e,n,r):zs(u,()=>c(t,e,n,r))).pipe(fc())})).pipe(Up()):We(!0)}(i.component,i.route,n,e,r)),fc(i=>!0!==i,!0))}(o,r,i,t).pipe(yi(a=>a&&function M_e(t){return"boolean"==typeof t}(a)?function j_e(t,e,n,r){return en(e).pipe(Wy(i=>kR(function H_e(t,e){return null!==t&&e&&e(new d_e(t)),We(!0)}(i.route.parent,r),function $_e(t,e){return null!==t&&e&&e(new f_e(t)),We(!0)}(i.route,r),function q_e(t,e,n){const r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function R_e(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(o)).filter(o=>null!==o).map(o=>U3(()=>We(o.guards.map(u=>{const c=ev(o.node)??n,h=Vp(u,c);return qc(function O_e(t){return t&&sv(t.canActivateChild)}(h)?h.canActivateChild(r,t):zs(c,()=>h(r,t))).pipe(fc())})).pipe(Up())));return We(s).pipe(Up())}(t,i.path,n),function G_e(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return We(!0);const i=r.map(s=>U3(()=>{const o=ev(e)??n,a=Vp(s,o);return qc(function k_e(t){return t&&sv(t.canActivate)}(a)?a.canActivate(e,t):zs(o,()=>a(e,t))).pipe(fc())}));return We(i).pipe(Up())}(t,i.route,n))),fc(i=>!0!==i,!0))}(r,s,t,e):We(a)),Ae(a=>({...n,guardsResult:a})))})}(this.environmentInjector,u=>this.events.next(u)),Nr(u=>{if(s.guardsResult=u.guardsResult,u.guardsResult&&"boolean"!=typeof u.guardsResult)throw YC(0,u.guardsResult);const c=new o_e(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(c)}),Do(u=>!!u.guardsResult||(this.cancelNavigationTransition(u,"",Ms.GuardRejected),!1)),Bx(u=>{if(u.guards.canActivateChecks.length)return We(u).pipe(Nr(c=>{const h=new a_e(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(h)}),On(c=>{let h=!1;return We(c).pipe(function fye(t,e){return yi(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return We(n);const s=new Set(i.map(u=>u.route)),o=new Set;for(const u of s)if(!o.has(u))for(const c of A6(u))o.add(c);let a=0;return en(o).pipe(Wy(u=>s.has(u)?function pye(t,e,n,r){const i=t.routeConfig,s=t._resolve;return void 0!==i?.title&&!f6(i)&&(s[Ky]=i.title),function gye(t,e,n,r){const i=wx(t);if(0===i.length)return We({});const s={};return en(i).pipe(yi(o=>function mye(t,e,n,r){const i=ev(e)??r,s=Vp(t,i);return qc(s.resolve?s.resolve(e,n):zs(i,()=>s(e,n)))}(t[o],e,n,r).pipe(fc(),Nr(a=>{if(a instanceof Lx)throw YC(new VC,a);s[o]=a}))),Ex(1),function Rme(t){return Ae(()=>t)}(s),_u(o=>v6(o)?bo:Md(o)))}(s,t,e,r).pipe(Ae(o=>(t._resolvedData=o,t.data=WC(t,t.parent,n).resolve,null)))}(u,r,t,e):(u.data=WC(u,u.parent,t).resolve,We(void 0))),Nr(()=>a++),Ex(1),yi(u=>a===o.size?We(n):bo))})}(this.paramsInheritanceStrategy,this.environmentInjector),Nr({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(c,"",Ms.NoDataFromResolver)}}))}),Nr(c=>{const h=new u_e(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(h)}))}),Bx(u=>{const c=h=>{const g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe(Nr(_=>{h.component=_}),Ae(()=>{})));for(const _ of h.children)g.push(...c(_));return g};return yx(c(u.targetSnapshot.root)).pipe(zw(null),Mf(1))}),Bx(()=>this.afterPreactivation()),On(()=>{const{currentSnapshot:u,targetSnapshot:c}=s,h=this.createViewTransition?.(this.environmentInjector,u.root,c.root);return h?en(h).pipe(Ae(()=>s)):We(s)}),Ae(u=>{const c=function w_e(t,e,n){const r=nv(t,e._root,n?n._root:void 0);return new c6(r,e)}(n.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=s={...u,targetRouterState:c},this.currentNavigation.targetRouterState=c,s}),Nr(()=>{this.events.next(new Sx)}),((t,e,n,r)=>Ae(i=>(new D_e(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)))(this.rootContexts,n.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),Mf(1),Nr({next:u=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new yu(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{o=!0}}),function Nme(t){return Oe((e,n)=>{is(t).subscribe(Be(n,()=>n.complete(),ii)),!n.closed&&e.subscribe(n)})}(this.transitionAbortSubject.pipe(Nr(u=>{throw u}))),Ix(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",Ms.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),_u(u=>{if(a=!0,_6(u))this.events.next(new Ld(s.id,this.urlSerializer.serialize(s.extractedUrl),u.message,u.cancellationCode)),function A_e(t){return _6(t)&&Od(t.url)}(u)?this.events.next(new zC(u.url,u.navigationBehaviorOptions)):s.resolve(!1);else{const c=new Dx(s.id,this.urlSerializer.serialize(s.extractedUrl),u,s.targetSnapshot??void 0);try{const h=zs(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(h instanceof Lx){const{message:g,cancellationCode:_}=YC(0,h);this.events.next(new Ld(s.id,this.urlSerializer.serialize(s.extractedUrl),g,_)),this.events.next(new zC(h.redirectTo,h.navigationBehaviorOptions))}else{this.events.next(c);const g=n.errorHandler(u);s.resolve(!!g)}}catch(h){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(h)}}return bo}))}))}cancelNavigationTransition(n,r,i){const s=new Ld(n.id,this.urlSerializer.serialize(n.extractedUrl),r,i);this.events.next(s),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){const n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return n.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Tye(t){return t!==Xy}let Cye=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:()=>he(bye),providedIn:"root"})}return t})();class Aye{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}}let bye=(()=>{class t extends Aye{static#e=this.\u0275fac=(()=>{let n;return function(i){return(n||(n=jr(t)))(i||t)}})();static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),M6=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:()=>he(Dye),providedIn:"root"})}return t})(),Dye=(()=>{class t extends M6{constructor(){super(...arguments),this.location=he(yf),this.urlSerializer=he(Op),this.options=he(jp,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=he(Hx),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new xd,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=l6(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{"popstate"===r.type&&n(r.url,r.state)})}handleRouterEvent(n,r){if(n instanceof GC)this.stateMemento=this.createStateMemento();else if(n instanceof Lp)this.rawUrlTree=r.initialUrl;else if(n instanceof o6){if("eager"===this.urlUpdateStrategy&&!r.extras.skipLocationChange){const i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else n instanceof Sx?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):n instanceof Ld&&(n.code===Ms.GuardRejected||n.code===Ms.NoDataFromResolver)?this.restoreHistory(r):n instanceof Dx?this.restoreHistory(r,!0):n instanceof yu&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,r){const i=n instanceof xd?this.urlSerializer.serialize(n):n;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){const o={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(i,"",o)}else{const s={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(i,"",s)}}restoreHistory(n,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===n.finalUrl&&0===s&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static#e=this.\u0275fac=(()=>{let n;return function(i){return(n||(n=jr(t)))(i||t)}})();static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var ov=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(ov||{});function x6(t,e){t.events.pipe(Do(n=>n instanceof yu||n instanceof Ld||n instanceof Dx||n instanceof Lp),Ae(n=>n instanceof yu||n instanceof Lp?ov.COMPLETE:n instanceof Ld&&(n.code===Ms.Redirect||n.code===Ms.SupersededByNewNavigation)?ov.REDIRECTING:ov.FAILED),Do(n=>n!==ov.REDIRECTING),Mf(1)).subscribe(()=>{e()})}function Sye(t){throw t}const Rye={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Nye={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let xs=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=he(l2),this.stateManager=he(M6),this.options=he(jp,{optional:!0})||{},this.pendingTasks=he(xl),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=he(tA),this.urlSerializer=he(Op),this.location=he(yf),this.urlHandlingStrategy=he(Hx),this._events=new L,this.errorHandler=this.options.errorHandler||Sye,this.navigated=!1,this.routeReuseStrategy=he(Cye),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=he($p,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!he(QC,{optional:!0}),this.eventsSubscription=new Ht,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(r=>{try{const i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(null!==i&&null!==s)if(this.stateManager.handleRouterEvent(r,s),r instanceof Ld&&r.code!==Ms.Redirect&&r.code!==Ms.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof yu)this.navigated=!0;else if(r instanceof zC){const o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),u={browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||"eager"===this.urlUpdateStrategy||Tye(i.source),...o};this.scheduleNavigation(a,Xy,null,u,{resolve:i.resolve,reject:i.reject,promise:i.promise})}(function Mye(t){return!(t instanceof Sx||t instanceof zC)})(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Xy,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",r)},0)})}navigateToSyncWithBrowser(n,r,i){const s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){const u={...i};delete u.navigationId,delete u.\u0275routerPageId,0!==Object.keys(u).length&&(s.state=u)}const a=this.parseUrl(n);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(jx),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){const{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:u}=r,c=u?this.currentUrlTree.fragment:o;let g,h=null;switch(a){case"merge":h={...this.currentUrlTree.queryParams,...s};break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}null!==h&&(h=this.removeEmptyProps(h));try{g=X3(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||"/"!==n[0][0])&&(n=[]),g=this.currentUrlTree.root}return e6(g,n,h,c??null)}navigateByUrl(n,r={skipLocationChange:!1}){const i=Od(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Xy,null,r)}navigate(n,r={skipLocationChange:!1}){return function Pye(t){for(let e=0;e<t.length;e++)if(null==t[e])throw new le(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,r){let i;if(i=!0===r?{...Rye}:!1===r?{...Nye}:r,Od(n))return G3(this.currentUrlTree,n,i);const s=this.parseUrl(n);return G3(this.currentUrlTree,s,i)}removeEmptyProps(n){return Object.entries(n).reduce((r,[i,s])=>(null!=s&&(r[i]=s),r),{})}scheduleNavigation(n,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,u,c;o?(a=o.resolve,u=o.reject,c=o.promise):c=new Promise((g,_)=>{a=g,u=_});const h=this.pendingTasks.add();return x6(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:s,resolve:a,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(g=>Promise.reject(g))}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),nA=(()=>{class t{constructor(n,r,i,s,o,a){this.router=n,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=a,this.href=null,this.onChanges=new L,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;const u=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===u||"area"===u,this.isAnchorElement?this.subscription=n.events.subscribe(c=>{c instanceof yu&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null==n?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(this.routerLinkInput=Od(n)||Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0"))}onClick(n,r,i,s,o){const a=this.urlTree;return!!(null===a||this.isAnchorElement&&(0!==n||r||i||s||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(a,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const n=this.urlTree;this.href=null!==n&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n)):null;const r=null===this.href?null:function M1(t,e,n){return function z5(t,e){return"src"===e&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===e&&("base"===t||"link"===t)?P1:fD}(e,n)(t)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(n,r){const i=this.renderer,s=this.el.nativeElement;null!==r?i.setAttribute(s,n,r):i.removeAttribute(s,n)}get urlTree(){return null===this.routerLinkInput?null:Od(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(r){return new(r||t)(ge(xs),ge(Fd),function hm(t){return function m8(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const r=n.length;let i=0;for(;i<r;){const s=n[i];if(ll(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(s===e)return n[i+1];i+=2}}}return null}(Bt(),t)}("tabindex"),ge(Ya),ge(Is),ge(zl))};static#t=this.\u0275dir=Je({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){1&r&&yr("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&r&&ta("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",_f],skipLocationChange:[2,"skipLocationChange","skipLocationChange",_f],replaceUrl:[2,"replaceUrl","replaceUrl",_f],routerLink:"routerLink"},standalone:!0,features:[xF,li]})}return t})();class k6{}let Oye=(()=>{class t{constructor(n,r,i,s,o){this.router=n,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Do(n=>n instanceof yu),Wy(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const i=[];for(const s of r){s.providers&&!s._injector&&(s._injector=RI(s.providers,n,`Route: ${s.path}`));const o=s._injector??n,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return en(i).pipe(Pf())}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(n,r):We(null);const s=i.pipe(yi(o=>null===o?We(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??n,o.routes))));return r.loadComponent&&!r._loadedComponent?en([s,this.loader.loadComponent(r)]).pipe(Pf()):s})}static#e=this.\u0275fac=function(r){return new(r||t)(ce(xs),ce(I2),ce(ci),ce(k6),ce($x))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Gx=new ve("");let O6=(()=>{class t{constructor(n,r,i,s,o={}){this.urlSerializer=n,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof GC?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof yu?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof Lp&&n.code===qC.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof a6&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new a6(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){!function rL(){throw new Error("invalid")}()};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})();function wa(t,e){return{\u0275kind:t,\u0275providers:e}}function F6(){const t=he(or);return e=>{const n=t.get(To);if(e!==n.components[0])return;const r=t.get(xs),i=t.get(V6);1===t.get(qx)&&r.initialNavigation(),t.get(U6,null,yt.Optional)?.setUpPreloading(),t.get(Gx,null,yt.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const V6=new ve("",{factory:()=>new L}),qx=new ve("",{providedIn:"root",factory:()=>1}),U6=new ve("");function Uye(t){return wa(0,[{provide:U6,useExisting:Oye},{provide:k6,useExisting:t}])}function jye(t){return wa(9,[{provide:R6,useValue:Iye},{provide:N6,useValue:{skipNextTransition:!!t?.skipInitialTransition,...t}}])}const B6=new ve("ROUTER_FORROOT_GUARD"),$ye=[yf,{provide:Op,useClass:VC},xs,tv,{provide:Fd,useFactory:function L6(t){return t.routerState.root},deps:[xs]},$x,[]];let j6=(()=>{class t{constructor(n){}static forRoot(n,r){return{ngModule:t,providers:[$ye,[],{provide:$p,multi:!0,useValue:n},{provide:B6,useFactory:zye,deps:[[xs,new Ba,new rh]]},{provide:jp,useValue:r||{}},r?.useHash?{provide:zl,useClass:Rte}:{provide:zl,useClass:mB},{provide:Gx,useFactory:()=>{const t=he(Wne),e=he(At),n=he(jp),r=he(tA),i=he(Op);return n.scrollOffset&&t.setOffset(n.scrollOffset),new O6(i,r,t,e,n)}},r?.preloadingStrategy?Uye(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?Wye(r):[],r?.bindToComponentInputs?wa(8,[p6,{provide:QC,useExisting:p6}]).\u0275providers:[],r?.enableViewTransitions?jye().\u0275providers:[],[{provide:$6,useFactory:F6},{provide:YI,multi:!0,useExisting:$6}]]}}static forChild(n){return{ngModule:t,providers:[{provide:$p,multi:!0,useValue:n}]}}static#e=this.\u0275fac=function(r){return new(r||t)(ce(B6,8))};static#t=this.\u0275mod=Fr({type:t});static#n=this.\u0275inj=pr({})}return t})();function zye(t){return"guarded"}function Wye(t){return["disabled"===t.initialNavigation?wa(3,[{provide:XS,multi:!0,useFactory:()=>{const e=he(xs);return()=>{e.setUpLocationChangeListener()}}},{provide:qx,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?wa(2,[{provide:qx,useValue:0},{provide:XS,multi:!0,deps:[or],useFactory:e=>{const n=e.get(Dte,Promise.resolve());return()=>n.then(()=>new Promise(r=>{const i=e.get(xs),s=e.get(V6);x6(i,()=>{r(!0)}),e.get(tA).afterPreactivation=()=>(r(!0),s.closed?We(void 0):s),i.initialNavigation()}))}}]).\u0275providers:[]]}const $6=new ve("");let zx=(()=>{class t{constructor(n){this.leaderboardService=n,this.newScoreName="",this.newScoreValue=0}ngOnInit(){this.leaderboard$=this.leaderboardService.getLeaderboard()}addScore(){this.newScoreName&&this.newScoreValue&&(this.leaderboardService.addScore(this.newScoreName,this.newScoreValue),this.newScoreName="",this.newScoreValue=0)}static#e=this.\u0275fac=function(r){return new(r||t)(ge(Ame))};static#t=this.\u0275cmp=Wo({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(r,i){1&r&&Za(0,"router-outlet")},dependencies:[kx]})}return t})(),H6=(()=>{class t{constructor(n){this.afAuth=n}doFacebookLogin(){return new Promise((n,r)=>{const i=new _i.A.auth.FacebookAuthProvider;this.afAuth.signInWithPopup(i).then(s=>n(s),s=>{console.error("Facebook Login Error:",s),r(s)})})}doTwitterLogin(){return new Promise((n,r)=>{const i=new _i.A.auth.TwitterAuthProvider;this.afAuth.signInWithPopup(i).then(s=>n(s),s=>{console.error("Twitter Login Error:",s),r(s)})})}doGoogleLogin(){return new Promise((n,r)=>{const i=new _i.A.auth.GoogleAuthProvider;i.addScope("profile"),i.addScope("email"),this.afAuth.signInWithPopup(i).then(s=>n(s),s=>{console.error("Google Login Error:",s),r(s)})})}doRegister(n){return new Promise((r,i)=>{this.afAuth.createUserWithEmailAndPassword(n.email,n.password).then(s=>r(s),s=>i(s))})}doLogin(n){return new Promise((r,i)=>{this.afAuth.signInWithEmailAndPassword(n.email,n.password).then(s=>r(s),s=>i(s))})}doLogout(){var n=this;return new Promise(function(){var r=(0,ne.A)(function*(i,s){(yield n.afAuth.currentUser)?n.afAuth.signOut().then(()=>i(),o=>{console.error("Logout Error:",o),s(o)}):s("No user currently signed in")});return function(i,s){return r.apply(this,arguments)}}())}static#e=this.\u0275fac=function(r){return new(r||t)(ce(pc))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),G6=(()=>{class t{constructor(n,r,i){this.authService=n,this.router=r,this.fb=i,this.errorMessage="",this.createForm()}createForm(){this.loginForm=this.fb.group({email:["",[Aw.required,Aw.email]],password:["",Aw.required]})}tryLogin(){var n=this;return(0,ne.A)(function*(){if(n.loginForm.invalid)n.errorMessage="Please fill out the form correctly.";else try{yield n.authService.doLogin(n.loginForm.value),n.router.navigate(["/user"])}catch(r){console.error(r)}})()}tryGoogleLogin(){var n=this;return(0,ne.A)(function*(){try{yield n.authService.doGoogleLogin(),n.router.navigate(["/user"])}catch(r){console.error(r)}})()}tryFacebookLogin(){var n=this;return(0,ne.A)(function*(){try{yield n.authService.doFacebookLogin(),n.router.navigate(["/user"])}catch(r){console.error(r)}})()}tryTwitterLogin(){var n=this;return(0,ne.A)(function*(){try{yield n.authService.doTwitterLogin(),n.router.navigate(["/user"])}catch(r){console.error(r)}})()}static#e=this.\u0275fac=function(r){return new(r||t)(ge(H6),ge(xs),ge(I$))};static#t=this.\u0275cmp=Wo({type:t,selectors:[["page-login"]],decls:36,vars:2,consts:[[1,"header"],[1,"container"],[1,"row"],[1,"col-md-6","col-md-offset-3"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","email","formControlName","email",1,"form-control"],["type","password","formControlName","password",1,"form-control"],[1,"error"],["type","submit",1,"btn","btn-default"],[1,"col-md-4","col-md-offset-4"],["type","button",1,"btn","btn-primary","btn-block",3,"click"],["type","button",1,"btn","btn-danger","btn-block",3,"click"],["type","button",1,"btn","btn-info","btn-block",3,"click"],["routerLink","/register"]],template:function(r,i){1&r&&(Kt(0,"h1",0),Zn(1,"Login with Firebase or Social Providers"),Xt(),Kt(2,"div",1)(3,"div",2)(4,"div",3)(5,"form",4),yr("ngSubmit",function(){return i.tryLogin()}),Kt(6,"div",5)(7,"label"),Zn(8,"Email address"),Xt(),Za(9,"input",6),Xt(),Kt(10,"div",5)(11,"label"),Zn(12,"Password"),Xt(),Za(13,"input",7),Kt(14,"label",8),Zn(15),Xt()(),Kt(16,"button",9),Zn(17,"Login"),Xt()()()(),Kt(18,"div",2)(19,"div",10)(20,"button",11),yr("click",function(){return i.tryFacebookLogin()}),Zn(21,"Login with Facebook"),Xt()()(),Kt(22,"div",2)(23,"div",10)(24,"button",12),yr("click",function(){return i.tryGoogleLogin()}),Zn(25,"Login with Google"),Xt()()(),Kt(26,"div",2)(27,"div",10)(28,"button",13),yr("click",function(){return i.tryTwitterLogin()}),Zn(29,"Login with Twitter"),Xt()()(),Kt(30,"div",2)(31,"div",10)(32,"p"),Zn(33,"No account yet? "),Kt(34,"a",14),Zn(35,"Create a\n"),Xt()()()()()),2&r&&(gi(5),Js("formGroup",i.loginForm),gi(10),GI(i.errorMessage))},dependencies:[oR,Tf,Sw,W0,T_,Vw,nA]})}return t})(),rA=(()=>{class t{constructor(n,r){this.db=n,this.afAuth=r}getCurrentUser(){return new Promise((n,r)=>{this.afAuth.authState.subscribe(i=>{i?n(i):r("No user logged in")})})}updateCurrentUser(n){return new Promise((r,i)=>{this.afAuth.currentUser.then(o=>{o?o.updateProfile({displayName:n.name,photoURL:o.photoURL}).then(()=>{r("Profile updated")}).catch(a=>i(a)):i("No user logged in")}).catch(o=>i(o))})}static#e=this.\u0275fac=function(r){return new(r||t)(ce(I4),ce(pc))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Hp=(()=>{class t{constructor(n,r,i){this.afAuth=n,this.userService=r,this.router=i}canActivate(){return new Promise(n=>{this.afAuth.authState.subscribe(r=>{r?n(!0):(this.router.navigate(["/login"]),n(!1))},r=>{console.error("Check login error:",r),this.router.navigate(["/login"]),n(!1)})})}static#e=this.\u0275fac=function(r){return new(r||t)(ce(pc),ce(rA),ce(xs))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class q6{constructor(){this.image="",this.name="",this.provider=""}}let z6=(()=>{class t{constructor(n,r){this.userService=n,this.router=r}resolve(n){let r=new q6;return new Promise((i,s)=>{this.userService.getCurrentUser().then(o=>"password"==o.providerData[0].providerId?(r.image="https://via.placeholder.com/400x300",r.name=o.displayName,r.provider=o.providerData[0].providerId,i(r)):(r.image=o.photoURL,r.name=o.displayName,r.provider=o.providerData[0].providerId,i(r)),o=>(this.router.navigate(["/login"]),s(o)))})}static#e=this.\u0275fac=function(r){return new(r||t)(ce(rA),ce(xs))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac})}return t})();function Qye(t,e){1&t&&Za(0,"img",10),2&t&&Js("src",ff().user.image,fD)}function Yye(t,e){1&t&&Za(0,"img",11)}function Zye(t,e){if(1&t&&(Kt(0,"div",12)(1,"h4",13),Zn(2),Xt(),Kt(3,"p",14),Zn(4,"This is an example of Social Authentication using Firebase in an Angular 7 web app. "),Xt()()),2&t){const n=ff();gi(2),GI(n.user.name)}}function Jye(t,e){if(1&t){const n=MS();Kt(0,"div",12)(1,"form",15)(2,"div",16)(3,"label"),Zn(4,"Your name"),Xt(),Za(5,"input",17),Xt()(),Kt(6,"a",18),yr("click",function(){Sl(n);const i=ff();return Ch(i.save(i.profileForm.value))}),Zn(7,"Save"),Xt()()}if(2&t){const n=ff();gi(),Js("formGroup",n.profileForm)}}let Xye=(()=>{class t{constructor(n,r,i,s,o){this.userService=n,this.authService=r,this.route=i,this.location=s,this.fb=o,this.user=new q6}ngOnInit(){this.route.data.subscribe(n=>{let r=n.data;r&&(this.user=r,this.createForm(this.user.name))})}createForm(n){this.profileForm=this.fb.group({name:[n,Aw.required]})}save(n){this.userService.updateCurrentUser(n).then(r=>{console.log(r)},r=>console.log(r))}logout(){this.authService.doLogout().then(n=>{this.location.back()},n=>{console.log("Logout error",n)})}static#e=this.\u0275fac=function(r){return new(r||t)(ge(rA),ge(H6),ge(Fd),ge(yf),ge(I$))};static#t=this.\u0275cmp=Wo({type:t,selectors:[["page-user"]],decls:13,vars:4,consts:[[1,"navbar","navbar-default","navbar-static-top","navbar-inverse"],[1,"container"],[1,"navbar-text","navbar-right","navbar-link",3,"click"],[1,"header"],[1,"row"],[1,"col-md-4","col-md-offset-4"],[1,"card",2,"width","20rem"],["class","card-img-top image","alt","User image",3,"src",4,"ngIf"],["class","card-img-top image","src","https://via.placeholder.com/400x300","alt","User image",4,"ngIf"],["class","card-body",4,"ngIf"],["alt","User image",1,"card-img-top","image",3,"src"],["src","https://via.placeholder.com/400x300","alt","User image",1,"card-img-top","image"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[3,"formGroup"],[1,"form-group"],["type","text","formControlName","name","required","",1,"form-control"],[1,"btn","btn-primary",3,"click"]],template:function(r,i){1&r&&(Kt(0,"nav",0)(1,"div",1)(2,"a",2),yr("click",function(){return i.logout()}),Zn(3,"Logout"),Xt()()(),Kt(4,"h1",3),Zn(5,"Logged User Page"),Xt(),Kt(6,"div",4)(7,"div",5)(8,"div",6),zh(9,Qye,1,1,"img",7)(10,Yye,1,0,"img",8)(11,Zye,5,1,"div",9)(12,Jye,8,1,"div",9),Xt()()()),2&r&&(gi(9),Js("ngIf",i.user.image),gi(),Js("ngIf",!i.user.image),gi(),Js("ngIf","password"!=i.user.provider),gi(),Js("ngIf","password"==i.user.provider))},dependencies:[RB,oR,Tf,Sw,W0,Uw,T_,Vw],styles:[".header[_ngcontent-%COMP%]{text-align:center;font-size:30px;margin-bottom:40px}.row[_ngcontent-%COMP%]{margin-top:10px}.image[_ngcontent-%COMP%]{width:100%}"]})}return t})(),Wx=(()=>{class t{constructor(n){this.db=n}addTrophy(n){return this.db.list("trophies").push(n)}unlockTrophy(n,r){return this.db.object(`users/${n}/trophies/${r}`).set(!0)}getAllUsers(){return this.db.list("users").snapshotChanges().pipe(Ae(n=>n.map(r=>({key:r.payload.key,data:r.payload.val()}))))}generateLeaderboard(){return this.getAllUsers().pipe(Ae(n=>n.map(r=>{const i=r.data.trophies?Object.keys(r.data.trophies).length:0;return{userId:r.key,trophyCount:i}}).sort((r,i)=>i.trophyCount-r.trophyCount)))}getUserTrophies(n){return this.db.list(`users/${n}/trophies`).snapshotChanges().pipe(Ae(r=>r.map(i=>i.payload.key||"")))}getAllTrophies(){return this.db.list("trophies").snapshotChanges().pipe(Ae(n=>n.map(r=>{const i=r.payload.val();return{key:r.payload.key||"",name:i?.name||"Unknown",description:i?.description||""}})))}static#e=this.\u0275fac=function(r){return new(r||t)(ce(_x))};static#t=this.\u0275prov=Ne({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function tve(t,e){if(1&t){const n=MS();Kt(0,"li"),Zn(1),Kt(2,"button",1),yr("click",function(){const i=Sl(n).$implicit;return Ch(ff().unlockTrophy(i.key))}),Zn(3,"Unlock"),Xt()()}if(2&t){const n=e.$implicit;gi(),Xm(" ",n.key," - ")}}function nve(t,e){if(1&t&&(Kt(0,"li"),Zn(1),Xt()),2&t){const n=e.$implicit;gi(),Xm(" ",n," ")}}function ive(t,e){if(1&t&&(Kt(0,"li"),Zn(1),Xt()),2&t){const n=e.$implicit;gi(),VS(" ",n.userId,"-",n.trophyCount,": ")}}const sve=[{path:"",component:zx},{path:"login",component:G6,canActivate:[Hp]},{path:"user",component:Xye,resolve:{data:z6}},{path:"admin/trophies",component:(()=>{class t{constructor(n){this.trophyService=n,this.trophyName=""}addTrophy(){this.trophyName.trim()&&this.trophyService.addTrophy({key:"",name:this.trophyName,description:""}).then(()=>{this.trophyName=""}).catch(r=>{console.error("Error adding trophy:",r)})}static#e=this.\u0275fac=function(r){return new(r||t)(ge(Wx))};static#t=this.\u0275cmp=Wo({type:t,selectors:[["app-trophy"]],decls:4,vars:1,consts:[["placeholder","Trophy Name",3,"ngModelChange","ngModel"],[3,"click"]],template:function(r,i){1&r&&(Kt(0,"div")(1,"input",0),BS("ngModelChange",function(o){return function FU(t,e){const n=yF(t);return n&&t.set(e),n}(i.trophyName,o)||(i.trophyName=o),o}),Xt(),Kt(2,"button",1),yr("click",function(){return i.addTrophy()}),Zn(3,"Add Trophy"),Xt()()),2&r&&(gi(),US("ngModel",i.trophyName))},dependencies:[Tf,Sw,sR]})}return t})(),canActivate:[Hp]},{path:"player/trophies",component:(()=>{class t{constructor(n,r){this.trophyService=n,this.afAuth=r,this.trophies$=[],this.trophiesObtained=[]}ngOnInit(){this.initAllTrophies(),this.initUserTrophies()}initUserTrophies(){this.afAuth.authState.pipe(Nr(n=>{if(!n)throw new Error("User not logged in!")}),On(n=>this.trophyService.getUserTrophies(n.uid)),_u(n=>(console.error(n),Md(()=>new Error("Failed to fetch user trophies"))))).subscribe(n=>this.trophiesObtained=n)}initAllTrophies(){this.afAuth.authState.pipe(Nr(n=>{if(!n)throw new Error("User not logged in!")}),On(()=>this.trophyService.getAllTrophies()),_u(n=>(console.error(n),Md(()=>new Error("Failed to fetch all trophies"))))).subscribe(n=>this.trophies$=n)}unlockTrophy(n){this.afAuth.authState.pipe(Nr(r=>{if(!r)throw new Error("No user logged in!")}),On(r=>this.trophyService.unlockTrophy(r.uid,n)),_u(r=>(console.error(r),Md(()=>new Error("Failed to unlock trophy"))))).subscribe()}static#e=this.\u0275fac=function(r){return new(r||t)(ge(Wx),ge(pc))};static#t=this.\u0275cmp=Wo({type:t,selectors:[["app-user-trophies"]],decls:4,vars:2,consts:[[4,"ngFor","ngForOf"],[3,"click"]],template:function(r,i){1&r&&(Kt(0,"ul"),zh(1,tve,4,1,"li",0),Xt(),Kt(2,"ul"),zh(3,nve,2,1,"li",0),Xt()),2&r&&(gi(),Js("ngForOf",i.trophies$),gi(2),Js("ngForOf",i.trophiesObtained))},dependencies:[D0]})}return t})(),canActivate:[Hp]},{path:"leaderboard",component:(()=>{class t{constructor(n){this.trophyService=n}ngOnInit(){this.trophyService.generateLeaderboard().subscribe(n=>{this.leaderboard$=n,console.log(n)})}static#e=this.\u0275fac=function(r){return new(r||t)(ge(Wx))};static#t=this.\u0275cmp=Wo({type:t,selectors:[["app-leaderboard"]],decls:2,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(r,i){1&r&&(Kt(0,"ul"),zh(1,ive,2,2,"li",0),Xt()),2&r&&(gi(),Js("ngForOf",i.leaderboard$))},dependencies:[D0]})}return t})(),canActivate:[Hp]},{path:"**",redirectTo:""}];let ove=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Fr({type:t});static#n=this.\u0275inj=pr({imports:[j6.forRoot(sve),j6]})}return t})(),ave=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Fr({type:t,bootstrap:[zx]});static#n=this.\u0275inj=pr({providers:[Hp,rA,z6],imports:[Kre,yse,ove,Vse.initializeApp(Cme_firebase),fhe,zse,Lae,Tme,_se,xB]})}return t})();zre().bootstrapModule(ave).catch(t=>console.error(t))},345:(so,wr,ot)=>{ot.d(wr,{A:()=>fr});var S=ot(76),Fe=ot(362),Me=ot(852),X=ot(41);class Ft{constructor(at,pt){this._delegate=at,this.firebase=pt,(0,Me._addComponent)(at,new Fe.uA("app-compat",()=>this,"PUBLIC")),this.container=at.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(at){this._delegate.automaticDataCollectionEnabled=at}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(at=>{this._delegate.checkDestroyed(),at()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,Me.deleteApp)(this._delegate)))}_getService(at,pt=Me._DEFAULT_ENTRY_NAME){var tr;this._delegate.checkDestroyed();const Cr=this._delegate.container.getProvider(at);return!Cr.isInitialized()&&"EXPLICIT"===(null===(tr=Cr.getComponent())||void 0===tr?void 0:tr.instantiationMode)&&Cr.initialize(),Cr.getImmediate({identifier:pt})}_removeServiceInstance(at,pt=Me._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(at).clearInstance(pt)}_addComponent(at){(0,Me._addComponent)(this._delegate,at)}_addOrOverwriteComponent(at){(0,Me._addOrOverwriteComponent)(this._delegate,at)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Pn=new S.FA("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),de=function Vt(){const Ut=function Tr(Ut){const at={},pt={__esModule:!0,initializeApp:function an(Ye,Mn={}){const hn=Me.initializeApp(Ye,Mn);if((0,S.gR)(at,hn.name))return at[hn.name];const fe=new Ut(hn,pt);return at[hn.name]=fe,fe},app:Cr,registerVersion:Me.registerVersion,setLogLevel:Me.setLogLevel,onLog:Me.onLog,apps:null,SDK_VERSION:Me.SDK_VERSION,INTERNAL:{registerComponent:function xt(Ye){const Mn=Ye.name,hn=Mn.replace("-compat","");if(Me._registerComponent(Ye)&&"PUBLIC"===Ye.type){const fe=(fn=Cr())=>{if("function"!=typeof fn[hn])throw Pn.create("invalid-app-argument",{appName:Mn});return fn[hn]()};void 0!==Ye.serviceProps&&(0,S.zw)(fe,Ye.serviceProps),pt[hn]=fe,Ut.prototype[hn]=function(...fn){return this._getService.bind(this,Mn).apply(this,Ye.multipleInstances?fn:[])}}return"PUBLIC"===Ye.type?pt[hn]:null},removeApp:function tr(Ye){delete at[Ye]},useAsService:function ni(Ye,Mn){return"serverAuth"===Mn?null:Mn},modularAPIs:Me}};function Cr(Ye){if(!(0,S.gR)(at,Ye=Ye||Me._DEFAULT_ENTRY_NAME))throw Pn.create("no-app",{appName:Ye});return at[Ye]}return pt.default=pt,Object.defineProperty(pt,"apps",{get:function Mt(){return Object.keys(at).map(Ye=>at[Ye])}}),Cr.App=Ut,pt}(Ft);return Ut.INTERNAL=Object.assign(Object.assign({},Ut.INTERNAL),{createFirebaseNamespace:Vt,extendNamespace:function at(pt){(0,S.zw)(Ut,pt)},createSubscribe:S.tD,ErrorFactory:S.FA,deepExtend:S.zw}),Ut}(),_e=new X.Vy("@firebase/app-compat");if((0,S.Bd)()&&void 0!==window.firebase){_e.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Ut=window.firebase.SDK_VERSION;Ut&&Ut.indexOf("LITE")>=0&&_e.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const fr=de;!function Rt(Ut){(0,Me.registerVersion)("@firebase/app-compat","0.2.38",Ut)}()},852:(so,wr,ot)=>{ot.r(wr),ot.d(wr,{FirebaseError:()=>X.g,SDK_VERSION:()=>hs,_DEFAULT_ENTRY_NAME:()=>ii,_addComponent:()=>xr,_addOrOverwriteComponent:()=>Aa,_apps:()=>si,_clearComponents:()=>Ar,_components:()=>oi,_getProvider:()=>Vs,_isFirebaseApp:()=>Bs,_isFirebaseServerApp:()=>Au,_registerComponent:()=>Fs,_removeServiceInstance:()=>Us,_serverApps:()=>ds,deleteApp:()=>Fo,getApp:()=>Sa,getApps:()=>nn,initializeApp:()=>Or,initializeServerApp:()=>Zc,onLog:()=>P,registerVersion:()=>M,setLogLevel:()=>L});var S=ot(467),Fe=ot(362),Me=ot(41),X=ot(76);const Ft=(Y,j)=>j.some(ae=>Y instanceof ae);let Ve,Pn;const de=new WeakMap,_e=new WeakMap,Ue=new WeakMap,ft=new WeakMap,Rt=new WeakMap;let at={get(Y,j,ae){if(Y instanceof IDBTransaction){if("done"===j)return _e.get(Y);if("objectStoreNames"===j)return Y.objectStoreNames||Ue.get(Y);if("store"===j)return ae.objectStoreNames[1]?void 0:ae.objectStore(ae.objectStoreNames[0])}return an(Y[j])},set:(Y,j,ae)=>(Y[j]=ae,!0),has:(Y,j)=>Y instanceof IDBTransaction&&("done"===j||"store"===j)||j in Y};function Cr(Y){return"function"==typeof Y?function tr(Y){return Y!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Vt(){return Pn||(Pn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(Y)?function(...j){return Y.apply(Mt(this),j),an(de.get(this))}:function(...j){return an(Y.apply(Mt(this),j))}:function(j,...ae){const Se=Y.call(Mt(this),j,...ae);return Ue.set(Se,j.sort?j.sort():[j]),an(Se)}}(Y):(Y instanceof IDBTransaction&&function Ut(Y){if(_e.has(Y))return;const j=new Promise((ae,Se)=>{const tt=()=>{Y.removeEventListener("complete",it),Y.removeEventListener("error",_t),Y.removeEventListener("abort",_t)},it=()=>{ae(),tt()},_t=()=>{Se(Y.error||new DOMException("AbortError","AbortError")),tt()};Y.addEventListener("complete",it),Y.addEventListener("error",_t),Y.addEventListener("abort",_t)});_e.set(Y,j)}(Y),Ft(Y,function Tr(){return Ve||(Ve=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(Y,at):Y)}function an(Y){if(Y instanceof IDBRequest)return function fr(Y){const j=new Promise((ae,Se)=>{const tt=()=>{Y.removeEventListener("success",it),Y.removeEventListener("error",_t)},it=()=>{ae(an(Y.result)),tt()},_t=()=>{Se(Y.error),tt()};Y.addEventListener("success",it),Y.addEventListener("error",_t)});return j.then(ae=>{ae instanceof IDBCursor&&de.set(ae,Y)}).catch(()=>{}),Rt.set(j,Y),j}(Y);if(ft.has(Y))return ft.get(Y);const j=Cr(Y);return j!==Y&&(ft.set(Y,j),Rt.set(j,Y)),j}const Mt=Y=>Rt.get(Y),Ye=["get","getKey","getAll","getAllKeys","count"],Mn=["put","add","delete","clear"],hn=new Map;function fe(Y,j){if(!(Y instanceof IDBDatabase)||j in Y||"string"!=typeof j)return;if(hn.get(j))return hn.get(j);const ae=j.replace(/FromIndex$/,""),Se=j!==ae,tt=Mn.includes(ae);if(!(ae in(Se?IDBIndex:IDBObjectStore).prototype)||!tt&&!Ye.includes(ae))return;const it=function(){var _t=(0,S.A)(function*(Cn,...nt){const zi=this.transaction(Cn,tt?"readwrite":"readonly");let Ma=zi.store;return Se&&(Ma=Ma.index(nt.shift())),(yield Promise.all([Ma[ae](...nt),tt&&zi.done]))[0]});return function(nt){return _t.apply(this,arguments)}}();return hn.set(j,it),it}!function pt(Y){at=Y(at)}(Y=>({...Y,get:(j,ae,Se)=>fe(j,ae)||Y.get(j,ae,Se),has:(j,ae)=>!!fe(j,ae)||Y.has(j,ae)}));class fn{constructor(j){this.container=j}getPlatformInfoString(){return this.container.getProviders().map(ae=>{if(function jn(Y){const j=Y.getComponent();return"VERSION"===j?.type}(ae)){const Se=ae.getImmediate();return`${Se.library}/${Se.version}`}return null}).filter(ae=>ae).join(" ")}}const ri="@firebase/app",Os="0.10.8",zr=new Me.Vy("@firebase/app"),ii="[DEFAULT]",Yc={[ri]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai-preview":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},si=new Map,ds=new Map,oi=new Map;function xr(Y,j){try{Y.container.addComponent(j)}catch(ae){zr.debug(`Component ${j.name} failed to register with FirebaseApp ${Y.name}`,ae)}}function Aa(Y,j){Y.container.addOrOverwriteComponent(j)}function Fs(Y){const j=Y.name;if(oi.has(j))return zr.debug(`There were multiple attempts to register component ${j}.`),!1;oi.set(j,Y);for(const ae of si.values())xr(ae,Y);for(const ae of ds.values())xr(ae,Y);return!0}function Vs(Y,j){const ae=Y.container.getProvider("heartbeat").getImmediate({optional:!0});return ae&&ae.triggerHeartbeat(),Y.container.getProvider(j)}function Us(Y,j,ae=ii){Vs(Y,j).clearInstance(ae)}function Bs(Y){return void 0!==Y.options}function Au(Y){return void 0!==Y.settings}function Ar(){oi.clear()}const kr=new X.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class ba{constructor(j,ae,Se){this._isDeleted=!1,this._options=Object.assign({},j),this._config=Object.assign({},ae),this._name=ae.name,this._automaticDataCollectionEnabled=ae.automaticDataCollectionEnabled,this._container=Se,this.container.addComponent(new Fe.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(j){this.checkDestroyed(),this._automaticDataCollectionEnabled=j}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(j){this._isDeleted=j}checkDestroyed(){if(this.isDeleted)throw kr.create("app-deleted",{appName:this._name})}}class Da extends ba{constructor(j,ae,Se,tt){const it=void 0!==ae.automaticDataCollectionEnabled&&ae.automaticDataCollectionEnabled,_t={name:Se,automaticDataCollectionEnabled:it};super(void 0!==j.apiKey?j:j.options,_t,tt),this._serverConfig=Object.assign({automaticDataCollectionEnabled:it},ae),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,ae.releaseOnDeref=void 0,M(ri,Os,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(j){this.isDeleted||(this._refCount++,void 0!==j&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(j,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Fo(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw kr.create("server-app-deleted")}}const hs="10.12.5";function Or(Y,j={}){let ae=Y;"object"!=typeof j&&(j={name:j});const Se=Object.assign({name:ii,automaticDataCollectionEnabled:!1},j),tt=Se.name;if("string"!=typeof tt||!tt)throw kr.create("bad-app-name",{appName:String(tt)});if(ae||(ae=(0,X.T9)()),!ae)throw kr.create("no-options");const it=si.get(tt);if(it){if((0,X.bD)(ae,it.options)&&(0,X.bD)(Se,it.config))return it;throw kr.create("duplicate-app",{appName:tt})}const _t=new Fe.h1(tt);for(const nt of oi.values())_t.addComponent(nt);const Cn=new ba(ae,Se,_t);return si.set(tt,Cn),Cn}function Zc(Y,j){if((0,X.Bd)()&&!(0,X.p7)())throw kr.create("invalid-server-app-environment");let ae;void 0===j.automaticDataCollectionEnabled&&(j.automaticDataCollectionEnabled=!1),ae=Bs(Y)?Y.options:Y;const Se=Object.assign(Object.assign({},j),ae);if(void 0!==Se.releaseOnDeref&&delete Se.releaseOnDeref,void 0!==j.releaseOnDeref&&typeof FinalizationRegistry>"u")throw kr.create("finalization-registry-not-supported",{});const it=""+(zi=JSON.stringify(Se),[...zi].reduce((Ma,Qp)=>Math.imul(31,Ma)+Qp.charCodeAt(0)|0,0)),_t=ds.get(it);var zi;if(_t)return _t.incRefCount(j.releaseOnDeref),_t;const Cn=new Fe.h1(it);for(const zi of oi.values())Cn.addComponent(zi);const nt=new Da(ae,j,it,Cn);return ds.set(it,nt),nt}function Sa(Y=ii){const j=si.get(Y);if(!j&&Y===ii&&(0,X.T9)())return Or();if(!j)throw kr.create("no-app",{appName:Y});return j}function nn(){return Array.from(si.values())}function Fo(Y){return Ra.apply(this,arguments)}function Ra(){return(Ra=(0,S.A)(function*(Y){let j=!1;const ae=Y.name;si.has(ae)?(j=!0,si.delete(ae)):ds.has(ae)&&Y.decRefCount()<=0&&(ds.delete(ae),j=!0),j&&(yield Promise.all(Y.container.getProviders().map(Se=>Se.delete())),Y.isDeleted=!0)})).apply(this,arguments)}function M(Y,j,ae){var Se;let tt=null!==(Se=Yc[Y])&&void 0!==Se?Se:Y;ae&&(tt+=`-${ae}`);const it=tt.match(/\s|\//),_t=j.match(/\s|\//);if(it||_t){const Cn=[`Unable to register library "${tt}" with version "${j}":`];return it&&Cn.push(`library name "${tt}" contains illegal characters (whitespace or "/")`),it&&_t&&Cn.push("and"),_t&&Cn.push(`version name "${j}" contains illegal characters (whitespace or "/")`),void zr.warn(Cn.join(" "))}Fs(new Fe.uA(`${tt}-version`,()=>({library:tt,version:j}),"VERSION"))}function P(Y,j){if(null!==Y&&"function"!=typeof Y)throw kr.create("invalid-log-argument");(0,Me.Ey)(Y,j)}function L(Y){(0,Me.He)(Y)}const re="firebase-heartbeat-database",G=1,De="firebase-heartbeat-store";let Oe=null;function Be(){return Oe||(Oe=function xt(Y,j,{blocked:ae,upgrade:Se,blocking:tt,terminated:it}={}){const _t=indexedDB.open(Y,j),Cn=an(_t);return Se&&_t.addEventListener("upgradeneeded",nt=>{Se(an(_t.result),nt.oldVersion,nt.newVersion,an(_t.transaction),nt)}),ae&&_t.addEventListener("blocked",nt=>ae(nt.oldVersion,nt.newVersion,nt)),Cn.then(nt=>{it&&nt.addEventListener("close",()=>it()),tt&&nt.addEventListener("versionchange",zi=>tt(zi.oldVersion,zi.newVersion,zi))}).catch(()=>{}),Cn}(re,G,{upgrade:(Y,j)=>{if(0===j)try{Y.createObjectStore(De)}catch(ae){console.warn(ae)}}}).catch(Y=>{throw kr.create("idb-open",{originalErrorMessage:Y.message})})),Oe}function Ae(){return(Ae=(0,S.A)(function*(Y){try{const ae=(yield Be()).transaction(De),Se=yield ae.objectStore(De).get(Lr(Y));return yield ae.done,Se}catch(j){if(j instanceof X.g)zr.warn(j.message);else{const ae=kr.create("idb-get",{originalErrorMessage:j?.message});zr.warn(ae.message)}}})).apply(this,arguments)}function rr(Y,j){return ut.apply(this,arguments)}function ut(){return(ut=(0,S.A)(function*(Y,j){try{const Se=(yield Be()).transaction(De,"readwrite");yield Se.objectStore(De).put(j,Lr(Y)),yield Se.done}catch(ae){if(ae instanceof X.g)zr.warn(ae.message);else{const Se=kr.create("idb-set",{originalErrorMessage:ae?.message});zr.warn(Se.message)}}})).apply(this,arguments)}function Lr(Y){return`${Y.name}!${Y.options.appId}`}class bu{constructor(j){this.container=j,this._heartbeatsCache=null;const ae=this.container.getProvider("app").getImmediate();this._storage=new Kp(ae),this._heartbeatsCachePromise=this._storage.read().then(Se=>(this._heartbeatsCache=Se,Se))}triggerHeartbeat(){var j=this;return(0,S.A)(function*(){var ae,Se;const it=j.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),_t=Jc();if((null!=(null===(ae=j._heartbeatsCache)||void 0===ae?void 0:ae.heartbeats)||(j._heartbeatsCache=yield j._heartbeatsCachePromise,null!=(null===(Se=j._heartbeatsCache)||void 0===Se?void 0:Se.heartbeats)))&&j._heartbeatsCache.lastSentHeartbeatDate!==_t&&!j._heartbeatsCache.heartbeats.some(Cn=>Cn.date===_t))return j._heartbeatsCache.heartbeats.push({date:_t,agent:it}),j._heartbeatsCache.heartbeats=j._heartbeatsCache.heartbeats.filter(Cn=>{const nt=new Date(Cn.date).valueOf();return Date.now()-nt<=2592e6}),j._storage.overwrite(j._heartbeatsCache)})()}getHeartbeatsHeader(){var j=this;return(0,S.A)(function*(){var ae;if(null===j._heartbeatsCache&&(yield j._heartbeatsCachePromise),null==(null===(ae=j._heartbeatsCache)||void 0===ae?void 0:ae.heartbeats)||0===j._heartbeatsCache.heartbeats.length)return"";const Se=Jc(),{heartbeatsToSend:tt,unsentEntries:it}=function Na(Y,j=1024){const ae=[];let Se=Y.slice();for(const tt of Y){const it=ae.find(_t=>_t.agent===tt.agent);if(it){if(it.dates.push(tt.date),He(ae)>j){it.dates.pop();break}}else if(ae.push({agent:tt.agent,dates:[tt.date]}),He(ae)>j){ae.pop();break}Se=Se.slice(1)}return{heartbeatsToSend:ae,unsentEntries:Se}}(j._heartbeatsCache.heartbeats),_t=(0,X.Uj)(JSON.stringify({version:2,heartbeats:tt}));return j._heartbeatsCache.lastSentHeartbeatDate=Se,it.length>0?(j._heartbeatsCache.heartbeats=it,yield j._storage.overwrite(j._heartbeatsCache)):(j._heartbeatsCache.heartbeats=[],j._storage.overwrite(j._heartbeatsCache)),_t})()}}function Jc(){return(new Date).toISOString().substring(0,10)}class Kp{constructor(j){this.app=j,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,S.A)(function*(){return!!(0,X.zW)()&&(0,X.eX)().then(()=>!0).catch(()=>!1)})()}read(){var j=this;return(0,S.A)(function*(){if(yield j._canUseIndexedDBPromise){const Se=yield function ai(Y){return Ae.apply(this,arguments)}(j.app);return Se?.heartbeats?Se:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(j){var ae=this;return(0,S.A)(function*(){var Se;if(yield ae._canUseIndexedDBPromise){const it=yield ae.read();return rr(ae.app,{lastSentHeartbeatDate:null!==(Se=j.lastSentHeartbeatDate)&&void 0!==Se?Se:it.lastSentHeartbeatDate,heartbeats:j.heartbeats})}})()}add(j){var ae=this;return(0,S.A)(function*(){var Se;if(yield ae._canUseIndexedDBPromise){const it=yield ae.read();return rr(ae.app,{lastSentHeartbeatDate:null!==(Se=j.lastSentHeartbeatDate)&&void 0!==Se?Se:it.lastSentHeartbeatDate,heartbeats:[...it.heartbeats,...j.heartbeats]})}})()}}function He(Y){return(0,X.Uj)(JSON.stringify({version:2,heartbeats:Y})).length}!function Pa(Y){Fs(new Fe.uA("platform-logger",j=>new fn(j),"PRIVATE")),Fs(new Fe.uA("heartbeat",j=>new bu(j),"PRIVATE")),M(ri,Os,Y),M(ri,Os,"esm2017"),M("fire-js","")}("")},362:(so,wr,ot)=>{ot.d(wr,{Kq:()=>Ft,h1:()=>Tr,uA:()=>Me});var S=ot(467),Fe=ot(76);class Me{constructor(de,_e,Ue){this.name=de,this.instanceFactory=_e,this.type=Ue,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(de){return this.instantiationMode=de,this}setMultipleInstances(de){return this.multipleInstances=de,this}setServiceProps(de){return this.serviceProps=de,this}setInstanceCreatedCallback(de){return this.onInstanceCreated=de,this}}const X="[DEFAULT]";class Ft{constructor(de,_e){this.name=de,this.container=_e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(de){const _e=this.normalizeInstanceIdentifier(de);if(!this.instancesDeferred.has(_e)){const Ue=new Fe.cY;if(this.instancesDeferred.set(_e,Ue),this.isInitialized(_e)||this.shouldAutoInitialize())try{const ft=this.getOrInitializeService({instanceIdentifier:_e});ft&&Ue.resolve(ft)}catch{}}return this.instancesDeferred.get(_e).promise}getImmediate(de){var _e;const Ue=this.normalizeInstanceIdentifier(de?.identifier),ft=null!==(_e=de?.optional)&&void 0!==_e&&_e;if(!this.isInitialized(Ue)&&!this.shouldAutoInitialize()){if(ft)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Ue})}catch(Rt){if(ft)return null;throw Rt}}getComponent(){return this.component}setComponent(de){if(de.name!==this.name)throw Error(`Mismatching Component ${de.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=de,this.shouldAutoInitialize()){if(function Pn(Vt){return"EAGER"===Vt.instantiationMode}(de))try{this.getOrInitializeService({instanceIdentifier:X})}catch{}for(const[_e,Ue]of this.instancesDeferred.entries()){const ft=this.normalizeInstanceIdentifier(_e);try{const Rt=this.getOrInitializeService({instanceIdentifier:ft});Ue.resolve(Rt)}catch{}}}}clearInstance(de=X){this.instancesDeferred.delete(de),this.instancesOptions.delete(de),this.instances.delete(de)}delete(){var de=this;return(0,S.A)(function*(){const _e=Array.from(de.instances.values());yield Promise.all([..._e.filter(Ue=>"INTERNAL"in Ue).map(Ue=>Ue.INTERNAL.delete()),..._e.filter(Ue=>"_delete"in Ue).map(Ue=>Ue._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(de=X){return this.instances.has(de)}getOptions(de=X){return this.instancesOptions.get(de)||{}}initialize(de={}){const{options:_e={}}=de,Ue=this.normalizeInstanceIdentifier(de.instanceIdentifier);if(this.isInitialized(Ue))throw Error(`${this.name}(${Ue}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const ft=this.getOrInitializeService({instanceIdentifier:Ue,options:_e});for(const[Rt,fr]of this.instancesDeferred.entries())Ue===this.normalizeInstanceIdentifier(Rt)&&fr.resolve(ft);return ft}onInit(de,_e){var Ue;const ft=this.normalizeInstanceIdentifier(_e),Rt=null!==(Ue=this.onInitCallbacks.get(ft))&&void 0!==Ue?Ue:new Set;Rt.add(de),this.onInitCallbacks.set(ft,Rt);const fr=this.instances.get(ft);return fr&&de(fr,ft),()=>{Rt.delete(de)}}invokeOnInitCallbacks(de,_e){const Ue=this.onInitCallbacks.get(_e);if(Ue)for(const ft of Ue)try{ft(de,_e)}catch{}}getOrInitializeService({instanceIdentifier:de,options:_e={}}){let Ue=this.instances.get(de);if(!Ue&&this.component&&(Ue=this.component.instanceFactory(this.container,{instanceIdentifier:(Vt=de,Vt===X?void 0:Vt),options:_e}),this.instances.set(de,Ue),this.instancesOptions.set(de,_e),this.invokeOnInitCallbacks(Ue,de),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,de,Ue)}catch{}var Vt;return Ue||null}normalizeInstanceIdentifier(de=X){return this.component?this.component.multipleInstances?de:X:de}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Tr{constructor(de){this.name=de,this.providers=new Map}addComponent(de){const _e=this.getProvider(de.name);if(_e.isComponentSet())throw new Error(`Component ${de.name} has already been registered with ${this.name}`);_e.setComponent(de)}addOrOverwriteComponent(de){this.getProvider(de.name).isComponentSet()&&this.providers.delete(de.name),this.addComponent(de)}getProvider(de){if(this.providers.has(de))return this.providers.get(de);const _e=new Ft(de,this);return this.providers.set(de,_e),_e}getProviders(){return Array.from(this.providers.values())}}},41:(so,wr,ot)=>{ot.d(wr,{$b:()=>Fe,Ey:()=>Vt,He:()=>Tr,Vy:()=>Pn});const S=[];var Fe=function(de){return de[de.DEBUG=0]="DEBUG",de[de.VERBOSE=1]="VERBOSE",de[de.INFO=2]="INFO",de[de.WARN=3]="WARN",de[de.ERROR=4]="ERROR",de[de.SILENT=5]="SILENT",de}(Fe||{});const Me={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},X=Fe.INFO,Ft={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},Ve=(de,_e,...Ue)=>{if(_e<de.logLevel)return;const ft=(new Date).toISOString(),Rt=Ft[_e];if(!Rt)throw new Error(`Attempted to log a message with an invalid logType (value: ${_e})`);console[Rt](`[${ft}]  ${de.name}:`,...Ue)};class Pn{constructor(_e){this.name=_e,this._logLevel=X,this._logHandler=Ve,this._userLogHandler=null,S.push(this)}get logLevel(){return this._logLevel}set logLevel(_e){if(!(_e in Fe))throw new TypeError(`Invalid value "${_e}" assigned to \`logLevel\``);this._logLevel=_e}setLogLevel(_e){this._logLevel="string"==typeof _e?Me[_e]:_e}get logHandler(){return this._logHandler}set logHandler(_e){if("function"!=typeof _e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=_e}get userLogHandler(){return this._userLogHandler}set userLogHandler(_e){this._userLogHandler=_e}debug(..._e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,..._e),this._logHandler(this,Fe.DEBUG,..._e)}log(..._e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,..._e),this._logHandler(this,Fe.VERBOSE,..._e)}info(..._e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,..._e),this._logHandler(this,Fe.INFO,..._e)}warn(..._e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,..._e),this._logHandler(this,Fe.WARN,..._e)}error(..._e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,..._e),this._logHandler(this,Fe.ERROR,..._e)}}function Tr(de){S.forEach(_e=>{_e.setLogLevel(de)})}function Vt(de,_e){for(const Ue of S){let ft=null;_e&&_e.level&&(ft=Me[_e.level]),Ue.userLogHandler=null===de?null:(Rt,fr,...Ut)=>{const at=Ut.map(pt=>{if(null==pt)return null;if("string"==typeof pt)return pt;if("number"==typeof pt||"boolean"==typeof pt)return pt.toString();if(pt instanceof Error)return pt.message;try{return JSON.stringify(pt)}catch{return null}}).filter(pt=>pt).join(" ");fr>=(ft??Rt.logLevel)&&de({level:Fe[fr].toLowerCase(),message:at,args:Ut,type:Rt.name})}}}},254:(so,wr,ot)=>{ot.r(wr);var S=ot(467),Fe=ot(345),Me=ot(852),X=ot(76),Ft=ot(41),Ve=ot(635),Pn=ot(362);const Vt={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};const fr=function ft(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},Ut=function Rt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},at=new X.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),tr=new Ft.Vy("@firebase/auth");function an(p,...l){tr.logLevel<=Ft.$b.ERROR&&tr.error(`Auth (${Me.SDK_VERSION}): ${p}`,...l)}function Mt(p,...l){throw hn(p,...l)}function xt(p,...l){return hn(p,...l)}function ni(p,l,d){const m=Object.assign(Object.assign({},Ut()),{[l]:d});return new X.FA("auth","Firebase",m).create(l,{appName:p.name})}function Ye(p){return ni(p,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Mn(p,l,d){if(!(l instanceof d))throw d.name!==l.constructor.name&&Mt(p,"argument-error"),ni(p,"argument-error",`Type of ${l.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function hn(p,...l){if("string"!=typeof p){const d=l[0],m=[...l.slice(1)];return m[0]&&(m[0].appName=p.name),p._errorFactory.create(d,...m)}return at.create(p,...l)}function fe(p,l,...d){if(!p)throw hn(l,...d)}function fn(p){const l="INTERNAL ASSERTION FAILED: "+p;throw an(l),new Error(l)}function jn(p,l){p||fn(l)}function ri(){var p;return typeof self<"u"&&(null===(p=self.location)||void 0===p?void 0:p.href)||""}function Os(){return"http:"===zr()||"https:"===zr()}function zr(){var p;return typeof self<"u"&&(null===(p=self.location)||void 0===p?void 0:p.protocol)||null}class K{constructor(l,d){this.shortDelay=l,this.longDelay=d,jn(d>l,"Short delay should be less than long delay!"),this.isMobile=(0,X.jZ)()||(0,X.lV)()}get(){return function Ta(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Os()||(0,X.sr)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Z(p,l){jn(p.emulator,"Emulator should always be set here");const{url:d}=p.emulator;return l?`${d}${l.startsWith("/")?l.slice(1):l}`:d}class se{static initialize(l,d,m){this.fetchImpl=l,d&&(this.headersImpl=d),m&&(this.responseImpl=m)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void fn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void fn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void fn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const oe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Ee=new K(3e4,6e4);function ue(p,l){return p.tenantId&&!l.tenantId?Object.assign(Object.assign({},l),{tenantId:p.tenantId}):l}function Re(p,l,d,m){return Ct.apply(this,arguments)}function Ct(){return(Ct=(0,S.A)(function*(p,l,d,m,E={}){return xn(p,E,(0,S.A)(function*(){let T={},N={};m&&("GET"===l?N=m:T={body:JSON.stringify(m)});const B=(0,X.Am)(Object.assign({key:p.config.apiKey},N)).slice(1),te=yield p._getAdditionalHeaders();return te["Content-Type"]="application/json",p.languageCode&&(te["X-Firebase-Locale"]=p.languageCode),se.fetch()(Ls(p,p.config.apiHost,d,B),Object.assign({method:l,headers:te,referrerPolicy:"no-referrer"},T))}))})).apply(this,arguments)}function xn(p,l,d){return Ke.apply(this,arguments)}function Ke(){return(Ke=(0,S.A)(function*(p,l,d){p._canInitEmulator=!1;const m=Object.assign(Object.assign({},oe),l);try{const E=new $n(p),T=yield Promise.race([d(),E.promise]);E.clearNetworkTimeout();const N=yield T.json();if("needConfirmation"in N)throw Tn(p,"account-exists-with-different-credential",N);if(T.ok&&!("errorMessage"in N))return N;{const B=T.ok?N.errorMessage:N.error.message,[te,we]=B.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===te)throw Tn(p,"credential-already-in-use",N);if("EMAIL_EXISTS"===te)throw Tn(p,"email-already-in-use",N);if("USER_DISABLED"===te)throw Tn(p,"user-disabled",N);const xe=m[te]||te.toLowerCase().replace(/[_\s]+/g,"-");if(we)throw ni(p,xe,we);Mt(p,xe)}}catch(E){if(E instanceof X.g)throw E;Mt(p,"network-request-failed",{message:String(E)})}})).apply(this,arguments)}function wt(p,l,d,m){return Yt.apply(this,arguments)}function Yt(){return(Yt=(0,S.A)(function*(p,l,d,m,E={}){const T=yield Re(p,l,d,m,E);return"mfaPendingCredential"in T&&Mt(p,"multi-factor-auth-required",{_serverResponse:T}),T})).apply(this,arguments)}function Ls(p,l,d,m){const E=`${l}${d}?${m}`;return p.config.emulator?Z(p.config,E):`${p.config.apiScheme}://${E}`}function ze(p){switch(p){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class $n{constructor(l){this.auth=l,this.timer=null,this.promise=new Promise((d,m)=>{this.timer=setTimeout(()=>m(xt(this.auth,"network-request-failed")),Ee.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Tn(p,l,d){const m={appName:p.name};d.email&&(m.email=d.email),d.phoneNumber&&(m.phoneNumber=d.phoneNumber);const E=xt(p,l,m);return E.customData._tokenResponse=d,E}function nr(p){return void 0!==p&&void 0!==p.getResponse}function Ht(p){return void 0!==p&&void 0!==p.enterprise}class Ca{constructor(l){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===l.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=l.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=l.recaptchaEnforcementState}getProviderEnforcementState(l){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const d of this.recaptchaEnforcementState)if(d.provider&&d.provider===l)return ze(d.enforcementState);return null}isProviderEnabled(l){return"ENFORCE"===this.getProviderEnforcementState(l)||"AUDIT"===this.getProviderEnforcementState(l)}}function oo(){return(oo=(0,S.A)(function*(p){return(yield Re(p,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Ri(p,l){return ao.apply(this,arguments)}function ao(){return(ao=(0,S.A)(function*(p,l){return Re(p,"GET","/v2/recaptchaConfig",ue(p,l))})).apply(this,arguments)}function ii(){return(ii=(0,S.A)(function*(p,l){return Re(p,"POST","/v1/accounts:delete",l)})).apply(this,arguments)}function si(){return(si=(0,S.A)(function*(p,l){return Re(p,"POST","/v1/accounts:update",l)})).apply(this,arguments)}function ds(p,l){return oi.apply(this,arguments)}function oi(){return(oi=(0,S.A)(function*(p,l){return Re(p,"POST","/v1/accounts:lookup",l)})).apply(this,arguments)}function xr(p){if(p)try{const l=new Date(Number(p));if(!isNaN(l.getTime()))return l.toUTCString()}catch{}}function Vs(){return(Vs=(0,S.A)(function*(p,l=!1){const d=(0,X.Ku)(p),m=yield d.getIdToken(l),E=Bs(m);fe(E&&E.exp&&E.auth_time&&E.iat,d.auth,"internal-error");const T="object"==typeof E.firebase?E.firebase:void 0,N=T?.sign_in_provider;return{claims:E,token:m,authTime:xr(Us(E.auth_time)),issuedAtTime:xr(Us(E.iat)),expirationTime:xr(Us(E.exp)),signInProvider:N||null,signInSecondFactor:T?.sign_in_second_factor||null}})).apply(this,arguments)}function Us(p){return 1e3*Number(p)}function Bs(p){const[l,d,m]=p.split(".");if(void 0===l||void 0===d||void 0===m)return an("JWT malformed, contained fewer than 3 sections"),null;try{const E=(0,X.u)(d);return E?JSON.parse(E):(an("Failed to decode base64 JWT payload"),null)}catch(E){return an("Caught error parsing JWT payload as JSON",E?.toString()),null}}function Au(p){const l=Bs(p);return fe(l,"internal-error"),fe(typeof l.exp<"u","internal-error"),fe(typeof l.iat<"u","internal-error"),Number(l.exp)-Number(l.iat)}function Ar(p,l){return js.apply(this,arguments)}function js(){return(js=(0,S.A)(function*(p,l,d=!1){if(d)return l;try{return yield l}catch(m){throw m instanceof X.g&&function kr({code:p}){return"auth/user-disabled"===p||"auth/user-token-expired"===p}(m)&&p.auth.currentUser===p&&(yield p.auth.signOut()),m}})).apply(this,arguments)}class ba{constructor(l){this.user=l,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(l){var d;if(l){const m=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),m}{this.errorBackoff=3e4;const E=(null!==(d=this.user.stsTokenManager.expirationTime)&&void 0!==d?d:0)-Date.now()-3e5;return Math.max(0,E)}}schedule(l=!1){var d=this;if(!this.isRunning)return;const m=this.getInterval(l);this.timerId=setTimeout((0,S.A)(function*(){yield d.iteration()}),m)}iteration(){var l=this;return(0,S.A)(function*(){try{yield l.user.getIdToken(!0)}catch(d){return void("auth/network-request-failed"===d?.code&&l.schedule(!0))}l.schedule()})()}}class Da{constructor(l,d){this.createdAt=l,this.lastLoginAt=d,this._initializeTime()}_initializeTime(){this.lastSignInTime=xr(this.lastLoginAt),this.creationTime=xr(this.createdAt)}_copy(l){this.createdAt=l.createdAt,this.lastLoginAt=l.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function hs(p){return Or.apply(this,arguments)}function Or(){return(Or=(0,S.A)(function*(p){var l;const d=p.auth,m=yield p.getIdToken(),E=yield Ar(p,ds(d,{idToken:m}));fe(E?.users.length,d,"internal-error");const T=E.users[0];p._notifyReloadListener(T);const N=null!==(l=T.providerUserInfo)&&void 0!==l&&l.length?Fo(T.providerUserInfo):[],B=function nn(p,l){return[...p.filter(m=>!l.some(E=>E.providerId===m.providerId)),...l]}(p.providerData,N),xe=!!p.isAnonymous&&!(p.email&&T.passwordHash||B?.length),ke={uid:T.localId,displayName:T.displayName||null,photoURL:T.photoUrl||null,email:T.email||null,emailVerified:T.emailVerified||!1,phoneNumber:T.phoneNumber||null,tenantId:T.tenantId||null,providerData:B,metadata:new Da(T.createdAt,T.lastLoginAt),isAnonymous:xe};Object.assign(p,ke)})).apply(this,arguments)}function Sa(){return(Sa=(0,S.A)(function*(p){const l=(0,X.Ku)(p);yield hs(l),yield l.auth._persistUserIfCurrent(l),l.auth._notifyListenersIfCurrent(l)})).apply(this,arguments)}function Fo(p){return p.map(l=>{var{providerId:d}=l,m=(0,Ve.Tt)(l,["providerId"]);return{providerId:d,uid:m.rawId||"",displayName:m.displayName||null,email:m.email||null,phoneNumber:m.phoneNumber||null,photoURL:m.photoUrl||null}})}function M(){return(M=(0,S.A)(function*(p,l){const d=yield xn(p,{},(0,S.A)(function*(){const m=(0,X.Am)({grant_type:"refresh_token",refresh_token:l}).slice(1),{tokenApiHost:E,apiKey:T}=p.config,N=Ls(p,E,"/v1/token",`key=${T}`),B=yield p._getAdditionalHeaders();return B["Content-Type"]="application/x-www-form-urlencoded",se.fetch()(N,{method:"POST",headers:B,body:m})}));return{accessToken:d.access_token,expiresIn:d.expires_in,refreshToken:d.refresh_token}})).apply(this,arguments)}function L(){return(L=(0,S.A)(function*(p,l){return Re(p,"POST","/v2/accounts:revokeToken",ue(p,l))})).apply(this,arguments)}class re{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(l){fe(l.idToken,"internal-error"),fe(typeof l.idToken<"u","internal-error"),fe(typeof l.refreshToken<"u","internal-error");const d="expiresIn"in l&&typeof l.expiresIn<"u"?Number(l.expiresIn):Au(l.idToken);this.updateTokensAndExpiration(l.idToken,l.refreshToken,d)}updateFromIdToken(l){fe(0!==l.length,"internal-error");const d=Au(l);this.updateTokensAndExpiration(l,null,d)}getToken(l,d=!1){var m=this;return(0,S.A)(function*(){return d||!m.accessToken||m.isExpired?(fe(m.refreshToken,l,"user-token-expired"),m.refreshToken?(yield m.refresh(l,m.refreshToken),m.accessToken):null):m.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(l,d){var m=this;return(0,S.A)(function*(){const{accessToken:E,refreshToken:T,expiresIn:N}=yield function Ra(p,l){return M.apply(this,arguments)}(l,d);m.updateTokensAndExpiration(E,T,Number(N))})()}updateTokensAndExpiration(l,d,m){this.refreshToken=d||null,this.accessToken=l||null,this.expirationTime=Date.now()+1e3*m}static fromJSON(l,d){const{refreshToken:m,accessToken:E,expirationTime:T}=d,N=new re;return m&&(fe("string"==typeof m,"internal-error",{appName:l}),N.refreshToken=m),E&&(fe("string"==typeof E,"internal-error",{appName:l}),N.accessToken=E),T&&(fe("number"==typeof T,"internal-error",{appName:l}),N.expirationTime=T),N}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(l){this.accessToken=l.accessToken,this.refreshToken=l.refreshToken,this.expirationTime=l.expirationTime}_clone(){return Object.assign(new re,this.toJSON())}_performRefresh(){return fn("not implemented")}}function G(p,l){fe("string"==typeof p||typeof p>"u","internal-error",{appName:l})}class De{constructor(l){var{uid:d,auth:m,stsTokenManager:E}=l,T=(0,Ve.Tt)(l,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ba(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=d,this.auth=m,this.stsTokenManager=E,this.accessToken=E.accessToken,this.displayName=T.displayName||null,this.email=T.email||null,this.emailVerified=T.emailVerified||!1,this.phoneNumber=T.phoneNumber||null,this.photoURL=T.photoURL||null,this.isAnonymous=T.isAnonymous||!1,this.tenantId=T.tenantId||null,this.providerData=T.providerData?[...T.providerData]:[],this.metadata=new Da(T.createdAt||void 0,T.lastLoginAt||void 0)}getIdToken(l){var d=this;return(0,S.A)(function*(){const m=yield Ar(d,d.stsTokenManager.getToken(d.auth,l));return fe(m,d.auth,"internal-error"),d.accessToken!==m&&(d.accessToken=m,yield d.auth._persistUserIfCurrent(d),d.auth._notifyListenersIfCurrent(d)),m})()}getIdTokenResult(l){return function Fs(p){return Vs.apply(this,arguments)}(this,l)}reload(){return function Zc(p){return Sa.apply(this,arguments)}(this)}_assign(l){this!==l&&(fe(this.uid===l.uid,this.auth,"internal-error"),this.displayName=l.displayName,this.photoURL=l.photoURL,this.email=l.email,this.emailVerified=l.emailVerified,this.phoneNumber=l.phoneNumber,this.isAnonymous=l.isAnonymous,this.tenantId=l.tenantId,this.providerData=l.providerData.map(d=>Object.assign({},d)),this.metadata._copy(l.metadata),this.stsTokenManager._assign(l.stsTokenManager))}_clone(l){const d=new De(Object.assign(Object.assign({},this),{auth:l,stsTokenManager:this.stsTokenManager._clone()}));return d.metadata._copy(this.metadata),d}_onReload(l){fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=l,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(l){this.reloadListener?this.reloadListener(l):this.reloadUserInfo=l}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(l,d=!1){var m=this;return(0,S.A)(function*(){let E=!1;l.idToken&&l.idToken!==m.stsTokenManager.accessToken&&(m.stsTokenManager.updateFromServerResponse(l),E=!0),d&&(yield hs(m)),yield m.auth._persistUserIfCurrent(m),E&&m.auth._notifyListenersIfCurrent(m)})()}delete(){var l=this;return(0,S.A)(function*(){if((0,Me._isFirebaseServerApp)(l.auth.app))return Promise.reject(Ye(l.auth));const d=yield l.getIdToken();return yield Ar(l,function Cu(p,l){return ii.apply(this,arguments)}(l.auth,{idToken:d})),l.stsTokenManager.clearRefreshToken(),l.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(l=>Object.assign({},l)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(l,d){var m,E,T,N,B,te,we,xe;const ke=null!==(m=d.displayName)&&void 0!==m?m:void 0,bn=null!==(E=d.email)&&void 0!==E?E:void 0,Es=null!==(T=d.phoneNumber)&&void 0!==T?T:void 0,ee=null!==(N=d.photoURL)&&void 0!==N?N:void 0,lt=null!==(B=d.tenantId)&&void 0!==B?B:void 0,Sl=null!==(te=d._redirectEventId)&&void 0!==te?te:void 0,Ch=null!==(we=d.createdAt)&&void 0!==we?we:void 0,Bt=null!==(xe=d.lastLoginAt)&&void 0!==xe?xe:void 0,{uid:Ah,emailVerified:Xu,isAnonymous:Xi,providerData:Rl,stsTokenManager:bh}=d;fe(Ah&&bh,l,"internal-error");const kE=re.fromJSON(this.name,bh);fe("string"==typeof Ah,l,"internal-error"),G(ke,l.name),G(bn,l.name),fe("boolean"==typeof Xu,l,"internal-error"),fe("boolean"==typeof Xi,l,"internal-error"),G(Es,l.name),G(ee,l.name),G(lt,l.name),G(Sl,l.name),G(Ch,l.name),G(Bt,l.name);const OE=new De({uid:Ah,auth:l,email:bn,emailVerified:Xu,displayName:ke,isAnonymous:Xi,photoURL:ee,phoneNumber:Es,tenantId:lt,stsTokenManager:kE,createdAt:Ch,lastLoginAt:Bt});return Rl&&Array.isArray(Rl)&&(OE.providerData=Rl.map(tO=>Object.assign({},tO))),Sl&&(OE._redirectEventId=Sl),OE}static _fromIdTokenResponse(l,d,m=!1){return(0,S.A)(function*(){const E=new re;E.updateFromServerResponse(d);const T=new De({uid:d.localId,auth:l,stsTokenManager:E,isAnonymous:m});return yield hs(T),T})()}static _fromGetAccountInfoResponse(l,d,m){return(0,S.A)(function*(){const E=d.users[0];fe(void 0!==E.localId,"internal-error");const T=void 0!==E.providerUserInfo?Fo(E.providerUserInfo):[],N=!(E.email&&E.passwordHash||T?.length),B=new re;B.updateFromIdToken(m);const te=new De({uid:E.localId,auth:l,stsTokenManager:B,isAnonymous:N}),we={uid:E.localId,displayName:E.displayName||null,photoURL:E.photoUrl||null,email:E.email||null,emailVerified:E.emailVerified||!1,phoneNumber:E.phoneNumber||null,tenantId:E.tenantId||null,providerData:T,metadata:new Da(E.createdAt,E.lastLoginAt),isAnonymous:!(E.email&&E.passwordHash||T?.length)};return Object.assign(te,we),te})()}}const Oe=new Map;function Be(p){jn(p instanceof Function,"Expected a class definition");let l=Oe.get(p);return l?(jn(l instanceof p,"Instance stored in cache mismatched with class"),l):(l=new p,Oe.set(p,l),l)}const Ae=(()=>{class p{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,S.A)(function*(){return!0})()}_set(d,m){var E=this;return(0,S.A)(function*(){E.storage[d]=m})()}_get(d){var m=this;return(0,S.A)(function*(){const E=m.storage[d];return void 0===E?null:E})()}_remove(d){var m=this;return(0,S.A)(function*(){delete m.storage[d]})()}_addListener(d,m){}_removeListener(d,m){}}return p.type="NONE",p})();function rr(p,l,d){return`firebase:${p}:${l}:${d}`}class ut{constructor(l,d,m){this.persistence=l,this.auth=d,this.userKey=m;const{config:E,name:T}=this.auth;this.fullUserKey=rr(this.userKey,E.apiKey,T),this.fullPersistenceKey=rr("persistence",E.apiKey,T),this.boundEventHandler=d._onStorageEvent.bind(d),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(l){return this.persistence._set(this.fullUserKey,l.toJSON())}getCurrentUser(){var l=this;return(0,S.A)(function*(){const d=yield l.persistence._get(l.fullUserKey);return d?De._fromJSON(l.auth,d):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(l){var d=this;return(0,S.A)(function*(){if(d.persistence===l)return;const m=yield d.getCurrentUser();return yield d.removeCurrentUser(),d.persistence=l,m?d.setCurrentUser(m):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(l,d,m="authUser"){return(0,S.A)(function*(){if(!d.length)return new ut(Be(Ae),l,m);const E=(yield Promise.all(d.map(function(){var we=(0,S.A)(function*(xe){if(yield xe._isAvailable())return xe});return function(xe){return we.apply(this,arguments)}}()))).filter(we=>we);let T=E[0]||Be(Ae);const N=rr(m,l.config.apiKey,l.name);let B=null;for(const we of d)try{const xe=yield we._get(N);if(xe){const ke=De._fromJSON(l,xe);we!==T&&(B=ke),T=we;break}}catch{}const te=E.filter(we=>we._shouldAllowMigration);return T._shouldAllowMigration&&te.length?(T=te[0],B&&(yield T._set(N,B.toJSON())),yield Promise.all(d.map(function(){var we=(0,S.A)(function*(xe){if(xe!==T)try{yield xe._remove(N)}catch{}});return function(xe){return we.apply(this,arguments)}}())),new ut(T,l,m)):new ut(T,l,m)})()}}function Lr(p){const l=p.toLowerCase();if(l.includes("opera/")||l.includes("opr/")||l.includes("opios/"))return"Opera";if(Jc(l))return"IEMobile";if(l.includes("msie")||l.includes("trident/"))return"IE";if(l.includes("edge/"))return"Edge";if($s(l))return"Firefox";if(l.includes("silk/"))return"Silk";if(Kp(l))return"Blackberry";if(He(l))return"Webos";if(Vo(l))return"Safari";if((l.includes("chrome/")||bu(l))&&!l.includes("edge/"))return"Chrome";if(Na(l))return"Android";{const m=p.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===m?.length)return m[1]}return"Other"}function $s(p=(0,X.ZQ)()){return/firefox\//i.test(p)}function Vo(p=(0,X.ZQ)()){const l=p.toLowerCase();return l.includes("safari/")&&!l.includes("chrome/")&&!l.includes("crios/")&&!l.includes("android")}function bu(p=(0,X.ZQ)()){return/crios\//i.test(p)}function Jc(p=(0,X.ZQ)()){return/iemobile/i.test(p)}function Na(p=(0,X.ZQ)()){return/android/i.test(p)}function Kp(p=(0,X.ZQ)()){return/blackberry/i.test(p)}function He(p=(0,X.ZQ)()){return/webos/i.test(p)}function Pa(p=(0,X.ZQ)()){return/iphone|ipad|ipod/i.test(p)||/macintosh/i.test(p)&&/mobile/i.test(p)}function Se(p=(0,X.ZQ)()){return Pa(p)||Na(p)||He(p)||Kp(p)||/windows phone/i.test(p)||Jc(p)}function it(p,l=[]){let d;switch(p){case"Browser":d=Lr((0,X.ZQ)());break;case"Worker":d=`${Lr((0,X.ZQ)())}-${p}`;break;default:d=p}const m=l.length?l.join(","):"FirebaseCore-web";return`${d}/JsCore/${Me.SDK_VERSION}/${m}`}class _t{constructor(l){this.auth=l,this.queue=[]}pushCallback(l,d){const m=T=>new Promise((N,B)=>{try{N(l(T))}catch(te){B(te)}});m.onAbort=d,this.queue.push(m);const E=this.queue.length-1;return()=>{this.queue[E]=()=>Promise.resolve()}}runMiddleware(l){var d=this;return(0,S.A)(function*(){if(d.auth.currentUser===l)return;const m=[];try{for(const E of d.queue)yield E(l),E.onAbort&&m.push(E.onAbort)}catch(E){m.reverse();for(const T of m)try{T()}catch{}throw d.auth._errorFactory.create("login-blocked",{originalMessage:E?.message})}})()}}function nt(){return(nt=(0,S.A)(function*(p,l={}){return Re(p,"GET","/v2/passwordPolicy",ue(p,l))})).apply(this,arguments)}class Ma{constructor(l){var d,m,E,T;const N=l.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(d=N.minPasswordLength)&&void 0!==d?d:6,N.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=N.maxPasswordLength),void 0!==N.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=N.containsLowercaseCharacter),void 0!==N.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=N.containsUppercaseCharacter),void 0!==N.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=N.containsNumericCharacter),void 0!==N.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=N.containsNonAlphanumericCharacter),this.enforcementState=l.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(E=null===(m=l.allowedNonAlphanumericCharacters)||void 0===m?void 0:m.join(""))&&void 0!==E?E:"",this.forceUpgradeOnSignin=null!==(T=l.forceUpgradeOnSignin)&&void 0!==T&&T,this.schemaVersion=l.schemaVersion}validatePassword(l){var d,m,E,T,N,B;const te={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(l,te),this.validatePasswordCharacterOptions(l,te),te.isValid&&(te.isValid=null===(d=te.meetsMinPasswordLength)||void 0===d||d),te.isValid&&(te.isValid=null===(m=te.meetsMaxPasswordLength)||void 0===m||m),te.isValid&&(te.isValid=null===(E=te.containsLowercaseLetter)||void 0===E||E),te.isValid&&(te.isValid=null===(T=te.containsUppercaseLetter)||void 0===T||T),te.isValid&&(te.isValid=null===(N=te.containsNumericCharacter)||void 0===N||N),te.isValid&&(te.isValid=null===(B=te.containsNonAlphanumericCharacter)||void 0===B||B),te}validatePasswordLengthOptions(l,d){const m=this.customStrengthOptions.minPasswordLength,E=this.customStrengthOptions.maxPasswordLength;m&&(d.meetsMinPasswordLength=l.length>=m),E&&(d.meetsMaxPasswordLength=l.length<=E)}validatePasswordCharacterOptions(l,d){let m;this.updatePasswordCharacterOptionsStatuses(d,!1,!1,!1,!1);for(let E=0;E<l.length;E++)m=l.charAt(E),this.updatePasswordCharacterOptionsStatuses(d,m>="a"&&m<="z",m>="A"&&m<="Z",m>="0"&&m<="9",this.allowedNonAlphanumericCharacters.includes(m))}updatePasswordCharacterOptionsStatuses(l,d,m,E,T){this.customStrengthOptions.containsLowercaseLetter&&(l.containsLowercaseLetter||(l.containsLowercaseLetter=d)),this.customStrengthOptions.containsUppercaseLetter&&(l.containsUppercaseLetter||(l.containsUppercaseLetter=m)),this.customStrengthOptions.containsNumericCharacter&&(l.containsNumericCharacter||(l.containsNumericCharacter=E)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(l.containsNonAlphanumericCharacter||(l.containsNonAlphanumericCharacter=T))}}class Qp{constructor(l,d,m,E){this.app=l,this.heartbeatServiceProvider=d,this.appCheckServiceProvider=m,this.config=E,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bv(this),this.idTokenSubscription=new bv(this),this.beforeStateQueue=new _t(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=at,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=l.name,this.clientVersion=E.sdkClientVersion}_initializeWithPersistence(l,d){var m=this;return d&&(this._popupRedirectResolver=Be(d)),this._initializationPromise=this.queue((0,S.A)(function*(){var E,T;if(!m._deleted&&(m.persistenceManager=yield ut.create(m,l),!m._deleted)){if(null!==(E=m._popupRedirectResolver)&&void 0!==E&&E._shouldInitProactively)try{yield m._popupRedirectResolver._initialize(m)}catch{}yield m.initializeCurrentUser(d),m.lastNotifiedUid=(null===(T=m.currentUser)||void 0===T?void 0:T.uid)||null,!m._deleted&&(m._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var l=this;return(0,S.A)(function*(){if(l._deleted)return;const d=yield l.assertedPersistence.getCurrentUser();if(l.currentUser||d){if(l.currentUser&&d&&l.currentUser.uid===d.uid)return l._currentUser._assign(d),void(yield l.currentUser.getIdToken());yield l._updateCurrentUser(d,!0)}})()}initializeCurrentUserFromIdToken(l){var d=this;return(0,S.A)(function*(){try{const m=yield ds(d,{idToken:l}),E=yield De._fromGetAccountInfoResponse(d,m,l);yield d.directlySetCurrentUser(E)}catch(m){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",m),yield d.directlySetCurrentUser(null)}})()}initializeCurrentUser(l){var d=this;return(0,S.A)(function*(){var m;if((0,Me._isFirebaseServerApp)(d.app)){const B=d.app.settings.authIdToken;return B?new Promise(te=>{setTimeout(()=>d.initializeCurrentUserFromIdToken(B).then(te,te))}):d.directlySetCurrentUser(null)}const E=yield d.assertedPersistence.getCurrentUser();let T=E,N=!1;if(l&&d.config.authDomain){yield d.getOrInitRedirectPersistenceManager();const B=null===(m=d.redirectUser)||void 0===m?void 0:m._redirectEventId,te=T?._redirectEventId,we=yield d.tryRedirectSignIn(l);(!B||B===te)&&we?.user&&(T=we.user,N=!0)}if(!T)return d.directlySetCurrentUser(null);if(!T._redirectEventId){if(N)try{yield d.beforeStateQueue.runMiddleware(T)}catch(B){T=E,d._popupRedirectResolver._overrideRedirectResult(d,()=>Promise.reject(B))}return T?d.reloadAndSetCurrentUserOrClear(T):d.directlySetCurrentUser(null)}return fe(d._popupRedirectResolver,d,"argument-error"),yield d.getOrInitRedirectPersistenceManager(),d.redirectUser&&d.redirectUser._redirectEventId===T._redirectEventId?d.directlySetCurrentUser(T):d.reloadAndSetCurrentUserOrClear(T)})()}tryRedirectSignIn(l){var d=this;return(0,S.A)(function*(){let m=null;try{m=yield d._popupRedirectResolver._completeRedirectFn(d,l,!0)}catch{yield d._setRedirectUser(null)}return m})()}reloadAndSetCurrentUserOrClear(l){var d=this;return(0,S.A)(function*(){try{yield hs(l)}catch(m){if("auth/network-request-failed"!==m?.code)return d.directlySetCurrentUser(null)}return d.directlySetCurrentUser(l)})()}useDeviceLanguage(){this.languageCode=function wu(){if(typeof navigator>"u")return null;const p=navigator;return p.languages&&p.languages[0]||p.language||null}()}_delete(){var l=this;return(0,S.A)(function*(){l._deleted=!0})()}updateCurrentUser(l){var d=this;return(0,S.A)(function*(){if((0,Me._isFirebaseServerApp)(d.app))return Promise.reject(Ye(d));const m=l?(0,X.Ku)(l):null;return m&&fe(m.auth.config.apiKey===d.config.apiKey,d,"invalid-user-token"),d._updateCurrentUser(m&&m._clone(d))})()}_updateCurrentUser(l,d=!1){var m=this;return(0,S.A)(function*(){if(!m._deleted)return l&&fe(m.tenantId===l.tenantId,m,"tenant-id-mismatch"),d||(yield m.beforeStateQueue.runMiddleware(l)),m.queue((0,S.A)(function*(){yield m.directlySetCurrentUser(l),m.notifyAuthListeners()}))})()}signOut(){var l=this;return(0,S.A)(function*(){return(0,Me._isFirebaseServerApp)(l.app)?Promise.reject(Ye(l)):(yield l.beforeStateQueue.runMiddleware(null),(l.redirectPersistenceManager||l._popupRedirectResolver)&&(yield l._setRedirectUser(null)),l._updateCurrentUser(null,!0))})()}setPersistence(l){var d=this;return(0,Me._isFirebaseServerApp)(this.app)?Promise.reject(Ye(this)):this.queue((0,S.A)(function*(){yield d.assertedPersistence.setPersistence(Be(l))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(l){var d=this;return(0,S.A)(function*(){d._getPasswordPolicyInternal()||(yield d._updatePasswordPolicy());const m=d._getPasswordPolicyInternal();return m.schemaVersion!==d.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(d._errorFactory.create("unsupported-password-policy-schema-version",{})):m.validatePassword(l)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var l=this;return(0,S.A)(function*(){const d=yield function Cn(p){return nt.apply(this,arguments)}(l),m=new Ma(d);null===l.tenantId?l._projectPasswordPolicy=m:l._tenantPasswordPolicies[l.tenantId]=m})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(l){this._errorFactory=new X.FA("auth","Firebase",l())}onAuthStateChanged(l,d,m){return this.registerStateListener(this.authStateSubscription,l,d,m)}beforeAuthStateChanged(l,d){return this.beforeStateQueue.pushCallback(l,d)}onIdTokenChanged(l,d,m){return this.registerStateListener(this.idTokenSubscription,l,d,m)}authStateReady(){return new Promise((l,d)=>{if(this.currentUser)l();else{const m=this.onAuthStateChanged(()=>{m(),l()},d)}})}revokeAccessToken(l){var d=this;return(0,S.A)(function*(){if(d.currentUser){const m=yield d.currentUser.getIdToken(),E={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:l,idToken:m};null!=d.tenantId&&(E.tenantId=d.tenantId),yield function P(p,l){return L.apply(this,arguments)}(d,E)}})()}toJSON(){var l;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(l=this._currentUser)||void 0===l?void 0:l.toJSON()}}_setRedirectUser(l,d){var m=this;return(0,S.A)(function*(){const E=yield m.getOrInitRedirectPersistenceManager(d);return null===l?E.removeCurrentUser():E.setCurrentUser(l)})()}getOrInitRedirectPersistenceManager(l){var d=this;return(0,S.A)(function*(){if(!d.redirectPersistenceManager){const m=l&&Be(l)||d._popupRedirectResolver;fe(m,d,"argument-error"),d.redirectPersistenceManager=yield ut.create(d,[Be(m._redirectPersistence)],"redirectUser"),d.redirectUser=yield d.redirectPersistenceManager.getCurrentUser()}return d.redirectPersistenceManager})()}_redirectUserForId(l){var d=this;return(0,S.A)(function*(){var m,E;return d._isInitialized&&(yield d.queue((0,S.A)(function*(){}))),(null===(m=d._currentUser)||void 0===m?void 0:m._redirectEventId)===l?d._currentUser:(null===(E=d.redirectUser)||void 0===E?void 0:E._redirectEventId)===l?d.redirectUser:null})()}_persistUserIfCurrent(l){var d=this;return(0,S.A)(function*(){if(l===d.currentUser)return d.queue((0,S.A)(function*(){return d.directlySetCurrentUser(l)}))})()}_notifyListenersIfCurrent(l){l===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var l,d;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const m=null!==(d=null===(l=this.currentUser)||void 0===l?void 0:l.uid)&&void 0!==d?d:null;this.lastNotifiedUid!==m&&(this.lastNotifiedUid=m,this.authStateSubscription.next(this.currentUser))}registerStateListener(l,d,m,E){if(this._deleted)return()=>{};const T="function"==typeof d?d:d.next.bind(d);let N=!1;const B=this._isInitialized?Promise.resolve():this._initializationPromise;if(fe(B,this,"internal-error"),B.then(()=>{N||T(this.currentUser)}),"function"==typeof d){const te=l.addObserver(d,m,E);return()=>{N=!0,te()}}{const te=l.addObserver(d);return()=>{N=!0,te()}}}directlySetCurrentUser(l){var d=this;return(0,S.A)(function*(){d.currentUser&&d.currentUser!==l&&d._currentUser._stopProactiveRefresh(),l&&d.isProactiveRefreshEnabled&&l._startProactiveRefresh(),d.currentUser=l,l?yield d.assertedPersistence.setCurrentUser(l):yield d.assertedPersistence.removeCurrentUser()})()}queue(l){return this.operations=this.operations.then(l,l),this.operations}get assertedPersistence(){return fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(l){!l||this.frameworks.includes(l)||(this.frameworks.push(l),this.frameworks.sort(),this.clientVersion=it(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var l=this;return(0,S.A)(function*(){var d;const m={"X-Client-Version":l.clientVersion};l.app.options.appId&&(m["X-Firebase-gmpid"]=l.app.options.appId);const E=yield null===(d=l.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===d?void 0:d.getHeartbeatsHeader();E&&(m["X-Firebase-Client"]=E);const T=yield l._getAppCheckToken();return T&&(m["X-Firebase-AppCheck"]=T),m})()}_getAppCheckToken(){var l=this;return(0,S.A)(function*(){var d;const m=yield null===(d=l.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===d?void 0:d.getToken();return m?.error&&function Cr(p,...l){tr.logLevel<=Ft.$b.WARN&&tr.warn(`Auth (${Me.SDK_VERSION}): ${p}`,...l)}(`Error while retrieving App Check token: ${m.error}`),m?.token})()}}function pn(p){return(0,X.Ku)(p)}class bv{constructor(l){this.auth=l,this.observer=null,this.addObserver=(0,X.tD)(d=>this.observer=d)}get next(){return fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let xa={loadJS:()=>(0,S.A)(function*(){throw new Error("Unable to load external scripts")})(),recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Zp(p){return xa.loadJS(p)}function TA(p){return`__${p}${Math.floor(1e6*Math.random())}`}class bA{constructor(l){this.type="recaptcha-enterprise",this.auth=pn(l)}verify(l="verify",d=!1){var m=this;return(0,S.A)(function*(){function T(){return T=(0,S.A)(function*(B){if(!d){if(null==B.tenantId&&null!=B._agentRecaptchaConfig)return B._agentRecaptchaConfig.siteKey;if(null!=B.tenantId&&void 0!==B._tenantRecaptchaConfigs[B.tenantId])return B._tenantRecaptchaConfigs[B.tenantId].siteKey}return new Promise(function(){var te=(0,S.A)(function*(we,xe){Ri(B,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(ke=>{if(void 0!==ke.recaptchaKey){const bn=new Ca(ke);return null==B.tenantId?B._agentRecaptchaConfig=bn:B._tenantRecaptchaConfigs[B.tenantId]=bn,we(bn.siteKey)}xe(new Error("recaptcha Enterprise site key undefined"))}).catch(ke=>{xe(ke)})});return function(we,xe){return te.apply(this,arguments)}}())}),T.apply(this,arguments)}function N(B,te,we){const xe=window.grecaptcha;Ht(xe)?xe.enterprise.ready(()=>{xe.enterprise.execute(B,{action:l}).then(ke=>{te(ke)}).catch(()=>{te("NO_RECAPTCHA")})}):we(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((B,te)=>{(function E(B){return T.apply(this,arguments)})(m.auth).then(we=>{if(!d&&Ht(window.grecaptcha))N(we,B,te);else{if(typeof window>"u")return void te(new Error("RecaptchaVerifier is only supported in browser"));let xe=function wA(){return xa.recaptchaEnterpriseScript}();0!==xe.length&&(xe+=we),Zp(xe).then(()=>{N(we,B,te)}).catch(ke=>{te(ke)})}}).catch(we=>{te(we)})})})()}}function DA(p,l,d){return Jp.apply(this,arguments)}function Jp(){return(Jp=(0,S.A)(function*(p,l,d,m=!1){const E=new bA(p);let T;try{T=yield E.verify(d)}catch{T=yield E.verify(d,!0)}const N=Object.assign({},l);return Object.assign(N,m?{captchaResp:T}:{captchaResponse:T}),Object.assign(N,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(N,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),N})).apply(this,arguments)}function Xc(p,l,d,m){return Xp.apply(this,arguments)}function Xp(){return Xp=(0,S.A)(function*(p,l,d,m){var E;if(null!==(E=p._getRecaptchaConfig())&&void 0!==E&&E.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const T=yield DA(p,l,d,"getOobCode"===d);return m(p,T)}return m(p,l).catch(function(){var T=(0,S.A)(function*(N){if("auth/missing-recaptcha-token"===N.code){console.log(`${d} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const B=yield DA(p,l,d,"getOobCode"===d);return m(p,B)}return Promise.reject(N)});return function(N){return T.apply(this,arguments)}}())}),Xp.apply(this,arguments)}function Dv(p){const l=p.indexOf(":");return l<0?"":p.substr(0,l+1)}function Sv(p){if(!p)return null;const l=Number(p);return isNaN(l)?null:l}class ka{constructor(l,d){this.providerId=l,this.signInMethod=d}toJSON(){return fn("not implemented")}_getIdTokenResponse(l){return fn("not implemented")}_linkToIdToken(l,d){return fn("not implemented")}_getReauthenticationResolver(l){return fn("not implemented")}}function tg(p,l){return ng.apply(this,arguments)}function ng(){return(ng=(0,S.A)(function*(p,l){return Re(p,"POST","/v1/accounts:resetPassword",ue(p,l))})).apply(this,arguments)}function rg(){return(rg=(0,S.A)(function*(p,l){return Re(p,"POST","/v1/accounts:update",l)})).apply(this,arguments)}function xA(p,l){return ig.apply(this,arguments)}function ig(){return(ig=(0,S.A)(function*(p,l){return Re(p,"POST","/v1/accounts:signUp",l)})).apply(this,arguments)}function sg(){return(sg=(0,S.A)(function*(p,l){return Re(p,"POST","/v1/accounts:update",ue(p,l))})).apply(this,arguments)}function wk(p,l){return og.apply(this,arguments)}function og(){return(og=(0,S.A)(function*(p,l){return wt(p,"POST","/v1/accounts:signInWithPassword",ue(p,l))})).apply(this,arguments)}function fs(p,l){return $d.apply(this,arguments)}function $d(){return($d=(0,S.A)(function*(p,l){return Re(p,"POST","/v1/accounts:sendOobCode",ue(p,l))})).apply(this,arguments)}function Gd(){return(Gd=(0,S.A)(function*(p,l){return fs(p,l)})).apply(this,arguments)}function Nv(p,l){return qd.apply(this,arguments)}function qd(){return(qd=(0,S.A)(function*(p,l){return fs(p,l)})).apply(this,arguments)}function Pv(p,l){return ag.apply(this,arguments)}function ag(){return(ag=(0,S.A)(function*(p,l){return fs(p,l)})).apply(this,arguments)}function ug(){return(ug=(0,S.A)(function*(p,l){return fs(p,l)})).apply(this,arguments)}function Wd(){return(Wd=(0,S.A)(function*(p,l){return wt(p,"POST","/v1/accounts:signInWithEmailLink",ue(p,l))})).apply(this,arguments)}function Mv(){return(Mv=(0,S.A)(function*(p,l){return wt(p,"POST","/v1/accounts:signInWithEmailLink",ue(p,l))})).apply(this,arguments)}class Uo extends ka{constructor(l,d,m,E=null){super("password",m),this._email=l,this._password=d,this._tenantId=E}static _fromEmailAndPassword(l,d){return new Uo(l,d,"password")}static _fromEmailAndCode(l,d,m=null){return new Uo(l,d,"emailLink",m)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(l){const d="string"==typeof l?JSON.parse(l):l;if(d?.email&&d?.password){if("password"===d.signInMethod)return this._fromEmailAndPassword(d.email,d.password);if("emailLink"===d.signInMethod)return this._fromEmailAndCode(d.email,d.password,d.tenantId)}return null}_getIdTokenResponse(l){var d=this;return(0,S.A)(function*(){switch(d.signInMethod){case"password":return Xc(l,{returnSecureToken:!0,email:d._email,password:d._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",wk);case"emailLink":return function zd(p,l){return Wd.apply(this,arguments)}(l,{email:d._email,oobCode:d._password});default:Mt(l,"internal-error")}})()}_linkToIdToken(l,d){var m=this;return(0,S.A)(function*(){switch(m.signInMethod){case"password":return Xc(l,{idToken:d,returnSecureToken:!0,email:m._email,password:m._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",xA);case"emailLink":return function cg(p,l){return Mv.apply(this,arguments)}(l,{idToken:d,email:m._email,oobCode:m._password});default:Mt(l,"internal-error")}})()}_getReauthenticationResolver(l){return this._getIdTokenResponse(l)}}function uo(p,l){return lg.apply(this,arguments)}function lg(){return(lg=(0,S.A)(function*(p,l){return wt(p,"POST","/v1/accounts:signInWithIdp",ue(p,l))})).apply(this,arguments)}class co extends ka{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(l){const d=new co(l.providerId,l.signInMethod);return l.idToken||l.accessToken?(l.idToken&&(d.idToken=l.idToken),l.accessToken&&(d.accessToken=l.accessToken),l.nonce&&!l.pendingToken&&(d.nonce=l.nonce),l.pendingToken&&(d.pendingToken=l.pendingToken)):l.oauthToken&&l.oauthTokenSecret?(d.accessToken=l.oauthToken,d.secret=l.oauthTokenSecret):Mt("argument-error"),d}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(l){const d="string"==typeof l?JSON.parse(l):l,{providerId:m,signInMethod:E}=d,T=(0,Ve.Tt)(d,["providerId","signInMethod"]);if(!m||!E)return null;const N=new co(m,E);return N.idToken=T.idToken||void 0,N.accessToken=T.accessToken||void 0,N.secret=T.secret,N.nonce=T.nonce,N.pendingToken=T.pendingToken||null,N}_getIdTokenResponse(l){return uo(l,this.buildRequest())}_linkToIdToken(l,d){const m=this.buildRequest();return m.idToken=d,uo(l,m)}_getReauthenticationResolver(l){const d=this.buildRequest();return d.autoCreate=!1,uo(l,d)}buildRequest(){const l={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)l.pendingToken=this.pendingToken;else{const d={};this.idToken&&(d.id_token=this.idToken),this.accessToken&&(d.access_token=this.accessToken),this.secret&&(d.oauth_token_secret=this.secret),d.providerId=this.providerId,this.nonce&&!this.pendingToken&&(d.nonce=this.nonce),l.postBody=(0,X.Am)(d)}return l}}function Kd(){return(Kd=(0,S.A)(function*(p,l){return Re(p,"POST","/v1/accounts:sendVerificationCode",ue(p,l))})).apply(this,arguments)}function dg(){return(dg=(0,S.A)(function*(p,l){return wt(p,"POST","/v1/accounts:signInWithPhoneNumber",ue(p,l))})).apply(this,arguments)}function el(){return(el=(0,S.A)(function*(p,l){const d=yield wt(p,"POST","/v1/accounts:signInWithPhoneNumber",ue(p,l));if(d.temporaryProof)throw Tn(p,"account-exists-with-different-credential",d);return d})).apply(this,arguments)}const LA={USER_NOT_FOUND:"user-not-found"};function hg(){return(hg=(0,S.A)(function*(p,l){return wt(p,"POST","/v1/accounts:signInWithPhoneNumber",ue(p,Object.assign(Object.assign({},l),{operation:"REAUTH"})),LA)})).apply(this,arguments)}class Oa extends ka{constructor(l){super("phone","phone"),this.params=l}static _fromVerification(l,d){return new Oa({verificationId:l,verificationCode:d})}static _fromTokenResponse(l,d){return new Oa({phoneNumber:l,temporaryProof:d})}_getIdTokenResponse(l){return function OA(p,l){return dg.apply(this,arguments)}(l,this._makeVerificationRequest())}_linkToIdToken(l,d){return function Ck(p,l){return el.apply(this,arguments)}(l,Object.assign({idToken:d},this._makeVerificationRequest()))}_getReauthenticationResolver(l){return function FA(p,l){return hg.apply(this,arguments)}(l,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:l,phoneNumber:d,verificationId:m,verificationCode:E}=this.params;return l&&d?{temporaryProof:l,phoneNumber:d}:{sessionInfo:m,code:E}}toJSON(){const l={providerId:this.providerId};return this.params.phoneNumber&&(l.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(l.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(l.verificationCode=this.params.verificationCode),this.params.verificationId&&(l.verificationId=this.params.verificationId),l}static fromJSON(l){"string"==typeof l&&(l=JSON.parse(l));const{verificationId:d,verificationCode:m,phoneNumber:E,temporaryProof:T}=l;return m||d||E||T?new Oa({verificationId:d,verificationCode:m,phoneNumber:E,temporaryProof:T}):null}}class Qd{constructor(l){var d,m,E,T,N,B;const te=(0,X.I9)((0,X.hp)(l)),we=null!==(d=te.apiKey)&&void 0!==d?d:null,xe=null!==(m=te.oobCode)&&void 0!==m?m:null,ke=function fg(p){switch(p){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(E=te.mode)&&void 0!==E?E:null);fe(we&&xe&&ke,"argument-error"),this.apiKey=we,this.operation=ke,this.code=xe,this.continueUrl=null!==(T=te.continueUrl)&&void 0!==T?T:null,this.languageCode=null!==(N=te.languageCode)&&void 0!==N?N:null,this.tenantId=null!==(B=te.tenantId)&&void 0!==B?B:null}static parseLink(l){const d=function VA(p){const l=(0,X.I9)((0,X.hp)(p)).link,d=l?(0,X.I9)((0,X.hp)(l)).deep_link_id:null,m=(0,X.I9)((0,X.hp)(p)).deep_link_id;return(m?(0,X.I9)((0,X.hp)(m)).link:null)||m||d||l||p}(l);try{return new Qd(d)}catch{return null}}}let kv=(()=>{class p{constructor(){this.providerId=p.PROVIDER_ID}static credential(d,m){return Uo._fromEmailAndPassword(d,m)}static credentialWithLink(d,m){const E=Qd.parseLink(m);return fe(E,"argument-error"),Uo._fromEmailAndCode(d,E.code,E.tenantId)}}return p.PROVIDER_ID="password",p.EMAIL_PASSWORD_SIGN_IN_METHOD="password",p.EMAIL_LINK_SIGN_IN_METHOD="emailLink",p})();class Hs{constructor(l){this.providerId=l,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(l){this.defaultLanguageCode=l}setCustomParameters(l){return this.customParameters=l,this}getCustomParameters(){return this.customParameters}}class Du extends Hs{constructor(){super(...arguments),this.scopes=[]}addScope(l){return this.scopes.includes(l)||this.scopes.push(l),this}getScopes(){return[...this.scopes]}}class tl extends Du{static credentialFromJSON(l){const d="string"==typeof l?JSON.parse(l):l;return fe("providerId"in d&&"signInMethod"in d,"argument-error"),co._fromParams(d)}credential(l){return this._credential(Object.assign(Object.assign({},l),{nonce:l.rawNonce}))}_credential(l){return fe(l.idToken||l.accessToken,"argument-error"),co._fromParams(Object.assign(Object.assign({},l),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(l){return tl.oauthCredentialFromTaggedObject(l)}static credentialFromError(l){return tl.oauthCredentialFromTaggedObject(l.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:l}){if(!l)return null;const{oauthIdToken:d,oauthAccessToken:m,oauthTokenSecret:E,pendingToken:T,nonce:N,providerId:B}=l;if(!m&&!E&&!d&&!T||!B)return null;try{return new tl(B)._credential({idToken:d,accessToken:m,nonce:N,pendingToken:T})}catch{return null}}}let Ov=(()=>{class p extends Du{constructor(){super("facebook.com")}static credential(d){return co._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.FACEBOOK_SIGN_IN_METHOD,accessToken:d})}static credentialFromResult(d){return p.credentialFromTaggedObject(d)}static credentialFromError(d){return p.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d||!("oauthAccessToken"in d)||!d.oauthAccessToken)return null;try{return p.credential(d.oauthAccessToken)}catch{return null}}}return p.FACEBOOK_SIGN_IN_METHOD="facebook.com",p.PROVIDER_ID="facebook.com",p})(),UA=(()=>{class p extends Du{constructor(){super("google.com"),this.addScope("profile")}static credential(d,m){return co._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.GOOGLE_SIGN_IN_METHOD,idToken:d,accessToken:m})}static credentialFromResult(d){return p.credentialFromTaggedObject(d)}static credentialFromError(d){return p.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{oauthIdToken:m,oauthAccessToken:E}=d;if(!m&&!E)return null;try{return p.credential(m,E)}catch{return null}}}return p.GOOGLE_SIGN_IN_METHOD="google.com",p.PROVIDER_ID="google.com",p})(),Lv=(()=>{class p extends Du{constructor(){super("github.com")}static credential(d){return co._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.GITHUB_SIGN_IN_METHOD,accessToken:d})}static credentialFromResult(d){return p.credentialFromTaggedObject(d)}static credentialFromError(d){return p.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d||!("oauthAccessToken"in d)||!d.oauthAccessToken)return null;try{return p.credential(d.oauthAccessToken)}catch{return null}}}return p.GITHUB_SIGN_IN_METHOD="github.com",p.PROVIDER_ID="github.com",p})();class Su extends ka{constructor(l,d){super(l,l),this.pendingToken=d}_getIdTokenResponse(l){return uo(l,this.buildRequest())}_linkToIdToken(l,d){const m=this.buildRequest();return m.idToken=d,uo(l,m)}_getReauthenticationResolver(l){const d=this.buildRequest();return d.autoCreate=!1,uo(l,d)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(l){const d="string"==typeof l?JSON.parse(l):l,{providerId:m,signInMethod:E,pendingToken:T}=d;return m&&E&&T&&m===E?new Su(m,T):null}static _create(l,d){return new Su(l,d)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Yd extends Hs{constructor(l){fe(l.startsWith("saml."),"argument-error"),super(l)}static credentialFromResult(l){return Yd.samlCredentialFromTaggedObject(l)}static credentialFromError(l){return Yd.samlCredentialFromTaggedObject(l.customData||{})}static credentialFromJSON(l){const d=Su.fromJSON(l);return fe(d,"argument-error"),d}static samlCredentialFromTaggedObject({_tokenResponse:l}){if(!l)return null;const{pendingToken:d,providerId:m}=l;if(!d||!m)return null;try{return Su._create(m,d)}catch{return null}}}let Fv=(()=>{class p extends Du{constructor(){super("twitter.com")}static credential(d,m){return co._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.TWITTER_SIGN_IN_METHOD,oauthToken:d,oauthTokenSecret:m})}static credentialFromResult(d){return p.credentialFromTaggedObject(d)}static credentialFromError(d){return p.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{oauthAccessToken:m,oauthTokenSecret:E}=d;if(!m||!E)return null;try{return p.credential(m,E)}catch{return null}}}return p.TWITTER_SIGN_IN_METHOD="twitter.com",p.PROVIDER_ID="twitter.com",p})();function Bo(p,l){return Vv.apply(this,arguments)}function Vv(){return(Vv=(0,S.A)(function*(p,l){return wt(p,"POST","/v1/accounts:signUp",ue(p,l))})).apply(this,arguments)}class ps{constructor(l){this.user=l.user,this.providerId=l.providerId,this._tokenResponse=l._tokenResponse,this.operationType=l.operationType}static _fromIdTokenResponse(l,d,m,E=!1){return(0,S.A)(function*(){const T=yield De._fromIdTokenResponse(l,m,E),N=pg(m);return new ps({user:T,providerId:N,_tokenResponse:m,operationType:d})})()}static _forOperation(l,d,m){return(0,S.A)(function*(){yield l._updateTokensIfNecessary(m,!0);const E=pg(m);return new ps({user:l,providerId:E,_tokenResponse:m,operationType:d})})()}}function pg(p){return p.providerId?p.providerId:"phoneNumber"in p?"phone":null}function mg(){return(mg=(0,S.A)(function*(p){var l;if((0,Me._isFirebaseServerApp)(p.app))return Promise.reject(Ye(p));const d=pn(p);if(yield d._initializationPromise,null!==(l=d.currentUser)&&void 0!==l&&l.isAnonymous)return new ps({user:d.currentUser,providerId:null,operationType:"signIn"});const m=yield Bo(d,{returnSecureToken:!0}),E=yield ps._fromIdTokenResponse(d,"signIn",m,!0);return yield d._updateCurrentUser(E.user),E})).apply(this,arguments)}class Zd extends X.g{constructor(l,d,m,E){var T;super(d.code,d.message),this.operationType=m,this.user=E,Object.setPrototypeOf(this,Zd.prototype),this.customData={appName:l.name,tenantId:null!==(T=l.tenantId)&&void 0!==T?T:void 0,_serverResponse:d.customData._serverResponse,operationType:m}}static _fromErrorAndOperation(l,d,m,E){return new Zd(l,d,m,E)}}function Uv(p,l,d,m){return("reauthenticate"===l?d._getReauthenticationResolver(p):d._getIdTokenResponse(p)).catch(T=>{throw"auth/multi-factor-auth-required"===T.code?Zd._fromErrorAndOperation(p,T,l,m):T})}function _g(p){return new Set(p.map(({providerId:l})=>l).filter(l=>!!l))}function Bv(){return Bv=(0,S.A)(function*(p,l){const d=(0,X.Ku)(p);yield yg(!0,d,l);const{providerUserInfo:m}=yield function Yc(p,l){return si.apply(this,arguments)}(d.auth,{idToken:yield d.getIdToken(),deleteProvider:[l]}),E=_g(m||[]);return d.providerData=d.providerData.filter(T=>E.has(T.providerId)),E.has("phone")||(d.phoneNumber=null),yield d.auth._persistUserIfCurrent(d),d}),Bv.apply(this,arguments)}function jv(p,l){return $v.apply(this,arguments)}function $v(){return($v=(0,S.A)(function*(p,l,d=!1){const m=yield Ar(p,l._linkToIdToken(p.auth,yield p.getIdToken()),d);return ps._forOperation(p,"link",m)})).apply(this,arguments)}function yg(p,l,d){return Hv.apply(this,arguments)}function Hv(){return(Hv=(0,S.A)(function*(p,l,d){yield hs(l);const E=!1===p?"provider-already-linked":"no-such-provider";fe(_g(l.providerData).has(d)===p,l.auth,E)})).apply(this,arguments)}function jA(p,l){return Gv.apply(this,arguments)}function Gv(){return(Gv=(0,S.A)(function*(p,l,d=!1){const{auth:m}=p;if((0,Me._isFirebaseServerApp)(m.app))return Promise.reject(Ye(m));const E="reauthenticate";try{const T=yield Ar(p,Uv(m,E,l,p),d);fe(T.idToken,m,"internal-error");const N=Bs(T.idToken);fe(N,m,"internal-error");const{sub:B}=N;return fe(p.uid===B,m,"user-mismatch"),ps._forOperation(p,E,T)}catch(T){throw"auth/user-not-found"===T?.code&&Mt(m,"user-mismatch"),T}})).apply(this,arguments)}function vg(p,l){return le.apply(this,arguments)}function le(){return(le=(0,S.A)(function*(p,l,d=!1){if((0,Me._isFirebaseServerApp)(p.app))return Promise.reject(Ye(p));const m="signIn",E=yield Uv(p,m,l),T=yield ps._fromIdTokenResponse(p,m,E);return d||(yield p._updateCurrentUser(T.user)),T})).apply(this,arguments)}function lo(p,l){return Ru.apply(this,arguments)}function Ru(){return(Ru=(0,S.A)(function*(p,l){return vg(pn(p),l)})).apply(this,arguments)}function Eg(p,l){return qv.apply(this,arguments)}function qv(){return(qv=(0,S.A)(function*(p,l){const d=(0,X.Ku)(p);return yield yg(!1,d,l.providerId),jv(d,l)})).apply(this,arguments)}function $A(p,l){return Jd.apply(this,arguments)}function Jd(){return(Jd=(0,S.A)(function*(p,l){return jA((0,X.Ku)(p),l)})).apply(this,arguments)}function jo(){return(jo=(0,S.A)(function*(p,l){return wt(p,"POST","/v1/accounts:signInWithCustomToken",ue(p,l))})).apply(this,arguments)}function $o(){return $o=(0,S.A)(function*(p,l){if((0,Me._isFirebaseServerApp)(p.app))return Promise.reject(Ye(p));const d=pn(p),m=yield function ho(p,l){return jo.apply(this,arguments)}(d,{token:l,returnSecureToken:!0}),E=yield ps._fromIdTokenResponse(d,"signIn",m);return yield d._updateCurrentUser(E.user),E}),$o.apply(this,arguments)}class Pu{constructor(l,d){this.factorId=l,this.uid=d.mfaEnrollmentId,this.enrollmentTime=new Date(d.enrolledAt).toUTCString(),this.displayName=d.displayName}static _fromServerResponse(l,d){return"phoneInfo"in d?nl._fromServerResponse(l,d):"totpInfo"in d?Ho._fromServerResponse(l,d):Mt(l,"internal-error")}}class nl extends Pu{constructor(l){super("phone",l),this.phoneNumber=l.phoneInfo}static _fromServerResponse(l,d){return new nl(d)}}class Ho extends Pu{constructor(l){super("totp",l)}static _fromServerResponse(l,d){return new Ho(d)}}function Ig(p,l,d){var m;fe((null===(m=d.url)||void 0===m?void 0:m.length)>0,p,"invalid-continue-uri"),fe(typeof d.dynamicLinkDomain>"u"||d.dynamicLinkDomain.length>0,p,"invalid-dynamic-link-domain"),l.continueUrl=d.url,l.dynamicLinkDomain=d.dynamicLinkDomain,l.canHandleCodeInApp=d.handleCodeInApp,d.iOS&&(fe(d.iOS.bundleId.length>0,p,"missing-ios-bundle-id"),l.iOSBundleId=d.iOS.bundleId),d.android&&(fe(d.android.packageName.length>0,p,"missing-android-pkg-name"),l.androidInstallApp=d.android.installApp,l.androidMinimumVersionCode=d.android.minimumVersion,l.androidPackageName=d.android.packageName)}function Zt(p){return zv.apply(this,arguments)}function zv(){return(zv=(0,S.A)(function*(p){const l=pn(p);l._getPasswordPolicyInternal()&&(yield l._updatePasswordPolicy())})).apply(this,arguments)}function Ot(){return(Ot=(0,S.A)(function*(p,l,d){const m=pn(p),E={requestType:"PASSWORD_RESET",email:l,clientType:"CLIENT_TYPE_WEB"};d&&Ig(m,E,d),yield Xc(m,E,"getOobCode",Nv)})).apply(this,arguments)}function Hn(){return Hn=(0,S.A)(function*(p,l,d){yield tg((0,X.Ku)(p),{oobCode:l,newPassword:d}).catch(function(){var m=(0,S.A)(function*(E){throw"auth/password-does-not-meet-requirements"===E.code&&Zt(p),E});return function(E){return m.apply(this,arguments)}}())}),Hn.apply(this,arguments)}function Wv(){return Wv=(0,S.A)(function*(p,l){yield function Ik(p,l){return sg.apply(this,arguments)}((0,X.Ku)(p),{oobCode:l})}),Wv.apply(this,arguments)}function Kv(p,l){return zt.apply(this,arguments)}function zt(){return(zt=(0,S.A)(function*(p,l){const d=(0,X.Ku)(p),m=yield tg(d,{oobCode:l}),E=m.requestType;switch(fe(E,d,"internal-error"),E){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":fe(m.newEmail,d,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":fe(m.mfaInfo,d,"internal-error");default:fe(m.email,d,"internal-error")}let T=null;return m.mfaInfo&&(T=Pu._fromServerResponse(pn(d),m.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===m.requestType?m.newEmail:m.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===m.requestType?m.email:m.newEmail)||null,multiFactorInfo:T},operation:E}})).apply(this,arguments)}function Mu(){return(Mu=(0,S.A)(function*(p,l){const{data:d}=yield Kv((0,X.Ku)(p),l);return d.email})).apply(this,arguments)}function Qv(){return(Qv=(0,S.A)(function*(p,l,d){if((0,Me._isFirebaseServerApp)(p.app))return Promise.reject(Ye(p));const m=pn(p),N=yield Xc(m,{returnSecureToken:!0,email:l,password:d,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Bo).catch(te=>{throw"auth/password-does-not-meet-requirements"===te.code&&Zt(p),te}),B=yield ps._fromIdTokenResponse(m,"signIn",N);return yield m._updateCurrentUser(B.user),B})).apply(this,arguments)}function Gs(){return(Gs=(0,S.A)(function*(p,l,d){const m=pn(p),E={requestType:"EMAIL_SIGNIN",email:l,clientType:"CLIENT_TYPE_WEB"};(function T(N,B){fe(B.handleCodeInApp,m,"argument-error"),B&&Ig(m,N,B)})(E,d),yield Xc(m,E,"getOobCode",Pv)})).apply(this,arguments)}function Yv(){return(Yv=(0,S.A)(function*(p,l,d){if((0,Me._isFirebaseServerApp)(p.app))return Promise.reject(Ye(p));const m=(0,X.Ku)(p),E=kv.credentialWithLink(l,d||ri());return fe(E._tenantId===(m.tenantId||null),m,"tenant-id-mismatch"),lo(m,E)})).apply(this,arguments)}function Tg(){return(Tg=(0,S.A)(function*(p,l){return Re(p,"POST","/v1/accounts:createAuthUri",ue(p,l))})).apply(this,arguments)}function Cg(){return Cg=(0,S.A)(function*(p,l){const m={identifier:l,continueUri:Os()?ri():"http://localhost"},{signinMethods:E}=yield function Mk(p,l){return Tg.apply(this,arguments)}((0,X.Ku)(p),m);return E||[]}),Cg.apply(this,arguments)}function Wr(){return Wr=(0,S.A)(function*(p,l){const d=(0,X.Ku)(p),E={requestType:"VERIFY_EMAIL",idToken:yield p.getIdToken()};l&&Ig(d.auth,E,l);const{email:T}=yield function Hd(p,l){return Gd.apply(this,arguments)}(d.auth,E);T!==p.email&&(yield p.reload())}),Wr.apply(this,arguments)}function Zv(){return Zv=(0,S.A)(function*(p,l,d){const m=(0,X.Ku)(p),T={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield p.getIdToken(),newEmail:l};d&&Ig(m.auth,T,d);const{email:N}=yield function kA(p,l){return ug.apply(this,arguments)}(m.auth,T);N!==p.email&&(yield p.reload())}),Zv.apply(this,arguments)}function Jv(){return(Jv=(0,S.A)(function*(p,l){return Re(p,"POST","/v1/accounts:update",l)})).apply(this,arguments)}function Xv(){return Xv=(0,S.A)(function*(p,{displayName:l,photoURL:d}){if(void 0===l&&void 0===d)return;const m=(0,X.Ku)(p),T={idToken:yield m.getIdToken(),displayName:l,photoUrl:d,returnSecureToken:!0},N=yield Ar(m,function Ok(p,l){return Jv.apply(this,arguments)}(m.auth,T));m.displayName=N.displayName||null,m.photoURL=N.photoUrl||null;const B=m.providerData.find(({providerId:te})=>"password"===te);B&&(B.displayName=m.displayName,B.photoURL=m.photoURL),yield m._updateTokensIfNecessary(N)}),Xv.apply(this,arguments)}function pr(p,l,d){return xu.apply(this,arguments)}function xu(){return xu=(0,S.A)(function*(p,l,d){const{auth:m}=p,T={idToken:yield p.getIdToken(),returnSecureToken:!0};l&&(T.email=l),d&&(T.password=d);const N=yield Ar(p,function MA(p,l){return rg.apply(this,arguments)}(m,T));yield p._updateTokensIfNecessary(N,!0)}),xu.apply(this,arguments)}class La{constructor(l,d,m={}){this.isNewUser=l,this.providerId=d,this.profile=m}}class eE extends La{constructor(l,d,m,E){super(l,d,m),this.username=E}}class Xd extends La{constructor(l,d){super(l,"facebook.com",d)}}class eh extends eE{constructor(l,d){super(l,"github.com",d,"string"==typeof d?.login?d?.login:null)}}class Ag extends La{constructor(l,d){super(l,"google.com",d)}}class tE extends eE{constructor(l,d,m){super(l,"twitter.com",d,m)}}function zA(p){const{user:l,_tokenResponse:d}=p;return l.isAnonymous&&!d?{providerId:null,isNewUser:!1,profile:null}:function qA(p){var l,d;if(!p)return null;const{providerId:m}=p,E=p.rawUserInfo?JSON.parse(p.rawUserInfo):{},T=p.isNewUser||"identitytoolkit#SignupNewUserResponse"===p.kind;if(!m&&p?.idToken){const N=null===(d=null===(l=Bs(p.idToken))||void 0===l?void 0:l.firebase)||void 0===d?void 0:d.sign_in_provider;if(N)return new La(T,"anonymous"!==N&&"custom"!==N?N:null)}if(!m)return null;switch(m){case"facebook.com":return new Xd(T,E);case"github.com":return new eh(T,E);case"google.com":return new Ag(T,E);case"twitter.com":return new tE(T,E,p.screenName||null);case"custom":case"anonymous":return new La(T,null);default:return new La(T,m,E)}}(d)}class fo{constructor(l,d,m){this.type=l,this.credential=d,this.user=m}static _fromIdtoken(l,d){return new fo("enroll",l,d)}static _fromMfaPendingCredential(l){return new fo("signin",l)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(l){var d,m;if(l?.multiFactorSession){if(null!==(d=l.multiFactorSession)&&void 0!==d&&d.pendingCredential)return fo._fromMfaPendingCredential(l.multiFactorSession.pendingCredential);if(null!==(m=l.multiFactorSession)&&void 0!==m&&m.idToken)return fo._fromIdtoken(l.multiFactorSession.idToken)}return null}}class rl{constructor(l,d,m){this.session=l,this.hints=d,this.signInResolver=m}static _fromError(l,d){const m=pn(l),E=d.customData._serverResponse,T=(E.mfaInfo||[]).map(B=>Pu._fromServerResponse(m,B));fe(E.mfaPendingCredential,m,"internal-error");const N=fo._fromMfaPendingCredential(E.mfaPendingCredential);return new rl(N,T,function(){var B=(0,S.A)(function*(te){const we=yield te._process(m,N);delete E.mfaInfo,delete E.mfaPendingCredential;const xe=Object.assign(Object.assign({},E),{idToken:we.idToken,refreshToken:we.refreshToken});switch(d.operationType){case"signIn":const ke=yield ps._fromIdTokenResponse(m,d.operationType,xe);return yield m._updateCurrentUser(ke.user),ke;case"reauthenticate":return fe(d.user,m,"internal-error"),ps._forOperation(d.user,d.operationType,xe);default:Mt(m,"internal-error")}});return function(te){return B.apply(this,arguments)}}())}resolveSignIn(l){var d=this;return(0,S.A)(function*(){return d.signInResolver(l)})()}}class aE{constructor(l){this.user=l,this.enrolledFactors=[],l._onReload(d=>{d.mfaInfo&&(this.enrolledFactors=d.mfaInfo.map(m=>Pu._fromServerResponse(l.auth,m)))})}static _fromUser(l){return new aE(l)}getSession(){var l=this;return(0,S.A)(function*(){return fo._fromIdtoken(yield l.user.getIdToken(),l.user)})()}enroll(l,d){var m=this;return(0,S.A)(function*(){const E=l,T=yield m.getSession(),N=yield Ar(m.user,E._process(m.user.auth,T,d));return yield m.user._updateTokensIfNecessary(N),m.user.reload()})()}unenroll(l){var d=this;return(0,S.A)(function*(){const m="string"==typeof l?l:l.uid,E=yield d.user.getIdToken();try{const T=yield Ar(d.user,function Lt(p,l){return Re(p,"POST","/v2/accounts/mfaEnrollment:withdraw",ue(p,l))}(d.user.auth,{idToken:E,mfaEnrollmentId:m}));d.enrolledFactors=d.enrolledFactors.filter(({uid:N})=>N!==m),yield d.user._updateTokensIfNecessary(T),yield d.user.reload()}catch(T){throw T}})()}}const Dg=new WeakMap,Sg="__sak";class uE{constructor(l,d){this.storageRetriever=l,this.type=d}_isAvailable(){try{return this.storage?(this.storage.setItem(Sg,"1"),this.storage.removeItem(Sg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(l,d){return this.storage.setItem(l,JSON.stringify(d)),Promise.resolve()}_get(l){const d=this.storage.getItem(l);return Promise.resolve(d?JSON.parse(d):null)}_remove(l){return this.storage.removeItem(l),Promise.resolve()}get storage(){return this.storageRetriever()}}const br=(()=>{class p extends uE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(d,m)=>this.onStorageEvent(d,m),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Rg(){const p=(0,X.ZQ)();return Vo(p)||Pa(p)}()&&function tt(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Se(),this._shouldAllowMigration=!0}forAllChangedKeys(d){for(const m of Object.keys(this.listeners)){const E=this.storage.getItem(m),T=this.localCache[m];E!==T&&d(m,T,E)}}onStorageEvent(d,m=!1){if(!d.key)return void this.forAllChangedKeys((B,te,we)=>{this.notifyListeners(B,we)});const E=d.key;if(m?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const B=this.storage.getItem(E);if(d.newValue!==B)null!==d.newValue?this.storage.setItem(E,d.newValue):this.storage.removeItem(E);else if(this.localCache[E]===d.newValue&&!m)return}const T=()=>{const B=this.storage.getItem(E);!m&&this.localCache[E]===B||this.notifyListeners(E,B)},N=this.storage.getItem(E);!function ae(){return(0,X.lT)()&&10===document.documentMode}()||N===d.newValue||d.newValue===d.oldValue?T():setTimeout(T,10)}notifyListeners(d,m){this.localCache[d]=m;const E=this.listeners[d];if(E)for(const T of Array.from(E))T(m&&JSON.parse(m))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((d,m,E)=>{this.onStorageEvent(new StorageEvent("storage",{key:d,oldValue:m,newValue:E}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(d,m){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[d]||(this.listeners[d]=new Set,this.localCache[d]=this.storage.getItem(d)),this.listeners[d].add(m)}_removeListener(d,m){this.listeners[d]&&(this.listeners[d].delete(m),0===this.listeners[d].size&&delete this.listeners[d]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(d,m){var E=()=>super._set,T=this;return(0,S.A)(function*(){yield E().call(T,d,m),T.localCache[d]=JSON.stringify(m)})()}_get(d){var m=()=>super._get,E=this;return(0,S.A)(function*(){const T=yield m().call(E,d);return E.localCache[d]=JSON.stringify(T),T})()}_remove(d){var m=()=>super._remove,E=this;return(0,S.A)(function*(){yield m().call(E,d),delete E.localCache[d]})()}}return p.type="LOCAL",p})(),Va=(()=>{class p extends uE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(d,m){}_removeListener(d,m){}}return p.type="SESSION",p})();let sl=(()=>{class p{constructor(d){this.eventTarget=d,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(d){const m=this.receivers.find(T=>T.isListeningto(d));if(m)return m;const E=new p(d);return this.receivers.push(E),E}isListeningto(d){return this.eventTarget===d}handleEvent(d){var m=this;return(0,S.A)(function*(){const E=d,{eventId:T,eventType:N,data:B}=E.data,te=m.handlersMap[N];if(!te?.size)return;E.ports[0].postMessage({status:"ack",eventId:T,eventType:N});const we=Array.from(te).map(function(){var ke=(0,S.A)(function*(bn){return bn(E.origin,B)});return function(bn){return ke.apply(this,arguments)}}()),xe=yield function Vk(p){return Promise.all(p.map(function(){var l=(0,S.A)(function*(d){try{return{fulfilled:!0,value:yield d}}catch(m){return{fulfilled:!1,reason:m}}});return function(d){return l.apply(this,arguments)}}()))}(we);E.ports[0].postMessage({status:"done",eventId:T,eventType:N,response:xe})})()}_subscribe(d,m){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[d]||(this.handlersMap[d]=new Set),this.handlersMap[d].add(m)}_unsubscribe(d,m){this.handlersMap[d]&&m&&this.handlersMap[d].delete(m),(!m||0===this.handlersMap[d].size)&&delete this.handlersMap[d],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return p.receivers=[],p})();function Ua(p="",l=10){let d="";for(let m=0;m<l;m++)d+=Math.floor(10*Math.random());return p+d}class nh{constructor(l){this.target=l,this.handlers=new Set}removeMessageHandler(l){l.messageChannel&&(l.messageChannel.port1.removeEventListener("message",l.onMessage),l.messageChannel.port1.close()),this.handlers.delete(l)}_send(l,d,m=50){var E=this;return(0,S.A)(function*(){const T=typeof MessageChannel<"u"?new MessageChannel:null;if(!T)throw new Error("connection_unavailable");let N,B;return new Promise((te,we)=>{const xe=Ua("",20);T.port1.start();const ke=setTimeout(()=>{we(new Error("unsupported_event"))},m);B={messageChannel:T,onMessage(bn){const Es=bn;if(Es.data.eventId===xe)switch(Es.data.status){case"ack":clearTimeout(ke),N=setTimeout(()=>{we(new Error("timeout"))},3e3);break;case"done":clearTimeout(N),te(Es.data.response);break;default:clearTimeout(ke),clearTimeout(N),we(new Error("invalid_response"))}}},E.handlers.add(B),T.port1.addEventListener("message",B.onMessage),E.target.postMessage({eventType:l,eventId:xe,data:d},[T.port2])}).finally(()=>{B&&E.removeMessageHandler(B)})})()}}function Qn(){return window}function Pg(){return typeof Qn().WorkerGlobalScope<"u"&&"function"==typeof Qn().importScripts}function Go(){return(Go=(0,S.A)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const lE="firebaseLocalStorageDb",ol="firebaseLocalStorage",he="fbase_key";class zo{constructor(l){this.request=l}toPromise(){return new Promise((l,d)=>{this.request.addEventListener("success",()=>{l(this.request.result)}),this.request.addEventListener("error",()=>{d(this.request.error)})})}}function ku(p,l){return p.transaction([ol],l?"readwrite":"readonly").objectStore(ol)}function Mg(){const p=indexedDB.open(lE,1);return new Promise((l,d)=>{p.addEventListener("error",()=>{d(p.error)}),p.addEventListener("upgradeneeded",()=>{const m=p.result;try{m.createObjectStore(ol,{keyPath:he})}catch(E){d(E)}}),p.addEventListener("success",(0,S.A)(function*(){const m=p.result;m.objectStoreNames.contains(ol)?l(m):(m.close(),yield function al(){const p=indexedDB.deleteDatabase(lE);return new zo(p).toPromise()}(),l(yield Mg()))}))})}function dE(p,l,d){return xg.apply(this,arguments)}function xg(){return(xg=(0,S.A)(function*(p,l,d){const m=ku(p,!0).put({[he]:l,value:d});return new zo(m).toPromise()})).apply(this,arguments)}function Ba(){return(Ba=(0,S.A)(function*(p,l){const d=ku(p,!1).get(l),m=yield new zo(d).toPromise();return void 0===m?null:m.value})).apply(this,arguments)}function hE(p,l){const d=ku(p,!0).delete(l);return new zo(d).toPromise()}const Lu=(()=>{class p{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var d=this;return(0,S.A)(function*(){return d.db||(d.db=yield Mg()),d.db})()}_withRetries(d){var m=this;return(0,S.A)(function*(){let E=0;for(;;)try{const T=yield m._openDb();return yield d(T)}catch(T){if(E++>3)throw T;m.db&&(m.db.close(),m.db=void 0)}})()}initializeServiceWorkerMessaging(){var d=this;return(0,S.A)(function*(){return Pg()?d.initializeReceiver():d.initializeSender()})()}initializeReceiver(){var d=this;return(0,S.A)(function*(){d.receiver=sl._getInstance(function qo(){return Pg()?self:null}()),d.receiver._subscribe("keyChanged",function(){var m=(0,S.A)(function*(E,T){return{keyProcessed:(yield d._poll()).includes(T.key)}});return function(E,T){return m.apply(this,arguments)}}()),d.receiver._subscribe("ping",function(){var m=(0,S.A)(function*(E,T){return["keyChanged"]});return function(E,T){return m.apply(this,arguments)}}())})()}initializeSender(){var d=this;return(0,S.A)(function*(){var m,E;if(d.activeServiceWorker=yield function cE(){return Go.apply(this,arguments)}(),!d.activeServiceWorker)return;d.sender=new nh(d.activeServiceWorker);const T=yield d.sender._send("ping",{},800);T&&null!==(m=T[0])&&void 0!==m&&m.fulfilled&&null!==(E=T[0])&&void 0!==E&&E.value.includes("keyChanged")&&(d.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(d){var m=this;return(0,S.A)(function*(){if(m.sender&&m.activeServiceWorker&&function XA(){var p;return(null===(p=navigator?.serviceWorker)||void 0===p?void 0:p.controller)||null}()===m.activeServiceWorker)try{yield m.sender._send("keyChanged",{key:d},m.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,S.A)(function*(){try{if(!indexedDB)return!1;const d=yield Mg();return yield dE(d,Sg,"1"),yield hE(d,Sg),!0}catch{}return!1})()}_withPendingWrite(d){var m=this;return(0,S.A)(function*(){m.pendingWrites++;try{yield d()}finally{m.pendingWrites--}})()}_set(d,m){var E=this;return(0,S.A)(function*(){return E._withPendingWrite((0,S.A)(function*(){return yield E._withRetries(T=>dE(T,d,m)),E.localCache[d]=m,E.notifyServiceWorker(d)}))})()}_get(d){var m=this;return(0,S.A)(function*(){const E=yield m._withRetries(T=>function eb(p,l){return Ba.apply(this,arguments)}(T,d));return m.localCache[d]=E,E})()}_remove(d){var m=this;return(0,S.A)(function*(){return m._withPendingWrite((0,S.A)(function*(){return yield m._withRetries(E=>hE(E,d)),delete m.localCache[d],m.notifyServiceWorker(d)}))})()}_poll(){var d=this;return(0,S.A)(function*(){const m=yield d._withRetries(N=>{const B=ku(N,!1).getAll();return new zo(B).toPromise()});if(!m)return[];if(0!==d.pendingWrites)return[];const E=[],T=new Set;if(0!==m.length)for(const{fbase_key:N,value:B}of m)T.add(N),JSON.stringify(d.localCache[N])!==JSON.stringify(B)&&(d.notifyListeners(N,B),E.push(N));for(const N of Object.keys(d.localCache))d.localCache[N]&&!T.has(N)&&(d.notifyListeners(N,null),E.push(N));return E})()}notifyListeners(d,m){this.localCache[d]=m;const E=this.listeners[d];if(E)for(const T of Array.from(E))T(m)}startPolling(){var d=this;this.stopPolling(),this.pollTimer=setInterval((0,S.A)(function*(){return d._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(d,m){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[d]||(this.listeners[d]=new Set,this._get(d)),this.listeners[d].add(m)}_removeListener(d,m){this.listeners[d]&&(this.listeners[d].delete(m),0===this.listeners[d].size&&delete this.listeners[d]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return p.type="LOCAL",p})(),Vu=1e12;class Uk{constructor(l){this.auth=l,this.counter=Vu,this._widgets=new Map}render(l,d){const m=this.counter;return this._widgets.set(m,new pE(l,this.auth.name,d||{})),this.counter++,m}reset(l){var d;const m=l||Vu;null===(d=this._widgets.get(m))||void 0===d||d.delete(),this._widgets.delete(m)}getResponse(l){var d;return(null===(d=this._widgets.get(l||Vu))||void 0===d?void 0:d.getResponse())||""}execute(l){var d=this;return(0,S.A)(function*(){var m;return null===(m=d._widgets.get(l||Vu))||void 0===m||m.execute(),""})()}}class pE{constructor(l,d,m){this.params=m,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const E="string"==typeof l?document.getElementById(l):l;fe(E,"argument-error",{appName:d}),this.container=E,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Bk(p){const l=[],d="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let m=0;m<p;m++)l.push(d.charAt(Math.floor(62*Math.random())));return l.join("")}(50);const{callback:l,"expired-callback":d}=this.params;if(l)try{l(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,d)try{d()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Kr=TA("rcb"),kg=new K(3e4,6e4);class Uu{constructor(){var l;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(l=Qn().grecaptcha)||void 0===l||!l.render)}load(l,d=""){return fe(function jk(p){return p.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(p)}(d),l,"argument-error"),this.shouldResolveImmediately(d)&&nr(Qn().grecaptcha)?Promise.resolve(Qn().grecaptcha):new Promise((m,E)=>{const T=Qn().setTimeout(()=>{E(xt(l,"network-request-failed"))},kg.get());Qn()[Kr]=()=>{Qn().clearTimeout(T),delete Qn()[Kr];const B=Qn().grecaptcha;if(!B||!nr(B))return void E(xt(l,"internal-error"));const te=B.render;B.render=(we,xe)=>{const ke=te(we,xe);return this.counter++,ke},this.hostLanguage=d,m(B)},Zp(`${function IA(){return xa.recaptchaV2Script}()}?${(0,X.Am)({onload:Kr,render:"explicit",hl:d})}`).catch(()=>{clearTimeout(T),E(xt(l,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(l){var d;return!(null===(d=Qn().grecaptcha)||void 0===d||!d.render)&&(l===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class gE{load(l){return(0,S.A)(function*(){return new Uk(l)})()}clearedOneInstance(){}}const gs="recaptcha",Nt={theme:"light",type:"image"};class ms{constructor(l,d,m=Object.assign({},Nt)){this.parameters=m,this.type=gs,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=pn(l),this.isInvisible="invisible"===this.parameters.size,fe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const E="string"==typeof d?document.getElementById(d):d;fe(E,this.auth,"argument-error"),this.container=E,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new gE:new Uu,this.validateStartingState()}verify(){var l=this;return(0,S.A)(function*(){l.assertNotDestroyed();const d=yield l.render(),m=l.getAssertedRecaptcha();return m.getResponse(d)||new Promise(T=>{const N=B=>{B&&(l.tokenChangeListeners.delete(N),T(B))};l.tokenChangeListeners.add(N),l.isInvisible&&m.execute(d)})})()}render(){try{this.assertNotDestroyed()}catch(l){return Promise.reject(l)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(l=>{throw this.renderPromise=null,l})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(l=>{this.container.removeChild(l)})}validateStartingState(){fe(!this.parameters.sitekey,this.auth,"argument-error"),fe(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),fe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(l){return d=>{if(this.tokenChangeListeners.forEach(m=>m(d)),"function"==typeof l)l(d);else if("string"==typeof l){const m=Qn()[l];"function"==typeof m&&m(d)}}}assertNotDestroyed(){fe(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var l=this;return(0,S.A)(function*(){if(yield l.init(),!l.widgetId){let d=l.container;if(!l.isInvisible){const m=document.createElement("div");d.appendChild(m),d=m}l.widgetId=l.getAssertedRecaptcha().render(d,l.parameters)}return l.widgetId})()}init(){var l=this;return(0,S.A)(function*(){fe(Os()&&!Pg(),l.auth,"internal-error"),yield function mE(){let p=null;return new Promise(l=>{"complete"!==document.readyState?(p=()=>l(),window.addEventListener("load",p)):l()}).catch(l=>{throw p&&window.removeEventListener("load",p),l})}(),l.recaptcha=yield l._recaptchaLoader.load(l.auth,l.auth.languageCode||void 0);const d=yield function Tu(p){return oo.apply(this,arguments)}(l.auth);fe(d,l.auth,"internal-error"),l.parameters.sitekey=d})()}getAssertedRecaptcha(){return fe(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class ul{constructor(l,d){this.verificationId=l,this.onConfirmation=d}confirm(l){const d=Oa._fromVerification(this.verificationId,l);return this.onConfirmation(d)}}function Bu(){return(Bu=(0,S.A)(function*(p,l,d){if((0,Me._isFirebaseServerApp)(p.app))return Promise.reject(Ye(p));const m=pn(p),E=yield ll(m,l,(0,X.Ku)(d));return new ul(E,T=>lo(m,T))})).apply(this,arguments)}function qs(){return(qs=(0,S.A)(function*(p,l,d){const m=(0,X.Ku)(p);yield yg(!1,m,"phone");const E=yield ll(m.auth,l,(0,X.Ku)(d));return new ul(E,T=>Eg(m,T))})).apply(this,arguments)}function cl(){return(cl=(0,S.A)(function*(p,l,d){const m=(0,X.Ku)(p);if((0,Me._isFirebaseServerApp)(m.auth.app))return Promise.reject(Ye(m.auth));const E=yield ll(m.auth,l,(0,X.Ku)(d));return new ul(E,T=>$A(m,T))})).apply(this,arguments)}function ll(p,l,d){return ah.apply(this,arguments)}function ah(){return ah=(0,S.A)(function*(p,l,d){var m;const E=yield d.verify();try{let T;if(fe("string"==typeof E,p,"argument-error"),fe(d.type===gs,p,"argument-error"),T="string"==typeof l?{phoneNumber:l}:l,"session"in T){const N=T.session;if("phoneNumber"in T)return fe("enroll"===N.type,p,"internal-error"),(yield function po(p,l){return Re(p,"POST","/v2/accounts/mfaEnrollment:start",ue(p,l))}(p,{idToken:N.credential,phoneEnrollmentInfo:{phoneNumber:T.phoneNumber,recaptchaToken:E}})).phoneSessionInfo.sessionInfo;{fe("signin"===N.type,p,"internal-error");const B=(null===(m=T.multiFactorHint)||void 0===m?void 0:m.uid)||T.multiFactorUid;return fe(B,p,"missing-multi-factor-info"),(yield function ui(p,l){return Re(p,"POST","/v2/accounts/mfaSignIn:start",ue(p,l))}(p,{mfaPendingCredential:N.credential,mfaEnrollmentId:B,phoneSignInInfo:{recaptchaToken:E}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:N}=yield function xv(p,l){return Kd.apply(this,arguments)}(p,{phoneNumber:T.phoneNumber,recaptchaToken:E});return N}}finally{d._reset()}}),ah.apply(this,arguments)}function uh(){return(uh=(0,S.A)(function*(p,l){const d=(0,X.Ku)(p);if((0,Me._isFirebaseServerApp)(d.auth.app))return Promise.reject(Ye(d.auth));yield jv(d,l)})).apply(this,arguments)}let ju=(()=>{class p{constructor(d){this.providerId=p.PROVIDER_ID,this.auth=pn(d)}verifyPhoneNumber(d,m){return ll(this.auth,d,(0,X.Ku)(m))}static credential(d,m){return Oa._fromVerification(d,m)}static credentialFromResult(d){return p.credentialFromTaggedObject(d)}static credentialFromError(d){return p.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{phoneNumber:m,temporaryProof:E}=d;return m&&E?Oa._fromTokenResponse(m,E):null}}return p.PROVIDER_ID="phone",p.PHONE_SIGN_IN_METHOD="phone",p})();function ja(p,l){return l?Be(l):(fe(p._popupRedirectResolver,p,"argument-error"),p._popupRedirectResolver)}class hl extends ka{constructor(l){super("custom","custom"),this.params=l}_getIdTokenResponse(l){return uo(l,this._buildIdpRequest())}_linkToIdToken(l,d){return uo(l,this._buildIdpRequest(d))}_getReauthenticationResolver(l){return uo(l,this._buildIdpRequest())}_buildIdpRequest(l){const d={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return l&&(d.idToken=l),d}}function rb(p){return vg(p.auth,new hl(p),p.bypassAuthState)}function ib(p){const{auth:l,user:d}=p;return fe(d,l,"internal-error"),jA(d,new hl(p),p.bypassAuthState)}function ys(p){return Og.apply(this,arguments)}function Og(){return(Og=(0,S.A)(function*(p){const{auth:l,user:d}=p;return fe(d,l,"internal-error"),jv(d,new hl(p),p.bypassAuthState)})).apply(this,arguments)}class Lg{constructor(l,d,m,E,T=!1){this.auth=l,this.resolver=m,this.user=E,this.bypassAuthState=T,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(d)?d:[d]}execute(){var l=this;return new Promise(function(){var d=(0,S.A)(function*(m,E){l.pendingPromise={resolve:m,reject:E};try{l.eventManager=yield l.resolver._initialize(l.auth),yield l.onExecution(),l.eventManager.registerConsumer(l)}catch(T){l.reject(T)}});return function(m,E){return d.apply(this,arguments)}}())}onAuthEvent(l){var d=this;return(0,S.A)(function*(){const{urlResponse:m,sessionId:E,postBody:T,tenantId:N,error:B,type:te}=l;if(B)return void d.reject(B);const we={auth:d.auth,requestUri:m,sessionId:E,tenantId:N||void 0,postBody:T||void 0,user:d.user,bypassAuthState:d.bypassAuthState};try{d.resolve(yield d.getIdpTask(te)(we))}catch(xe){d.reject(xe)}})()}onError(l){this.reject(l)}getIdpTask(l){switch(l){case"signInViaPopup":case"signInViaRedirect":return rb;case"linkViaPopup":case"linkViaRedirect":return ys;case"reauthViaPopup":case"reauthViaRedirect":return ib;default:Mt(this.auth,"internal-error")}}resolve(l){jn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(l),this.unregisterAndCleanUp()}reject(l){jn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(l),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const sb=new K(2e3,1e4);function Fg(){return(Fg=(0,S.A)(function*(p,l,d){if((0,Me._isFirebaseServerApp)(p.app))return Promise.reject(xt(p,"operation-not-supported-in-this-environment"));const m=pn(p);Mn(p,l,Hs);const E=ja(m,d);return new Ug(m,"signInViaPopup",l,E).executeNotNull()})).apply(this,arguments)}function ch(){return(ch=(0,S.A)(function*(p,l,d){const m=(0,X.Ku)(p);if((0,Me._isFirebaseServerApp)(m.auth.app))return Promise.reject(xt(m.auth,"operation-not-supported-in-this-environment"));Mn(m.auth,l,Hs);const E=ja(m.auth,d);return new Ug(m.auth,"reauthViaPopup",l,E,m).executeNotNull()})).apply(this,arguments)}function Vg(){return(Vg=(0,S.A)(function*(p,l,d){const m=(0,X.Ku)(p);Mn(m.auth,l,Hs);const E=ja(m.auth,d);return new Ug(m.auth,"linkViaPopup",l,E,m).executeNotNull()})).apply(this,arguments)}let Ug=(()=>{class p extends Lg{constructor(d,m,E,T,N){super(d,m,T,N),this.provider=E,this.authWindow=null,this.pollId=null,p.currentPopupAction&&p.currentPopupAction.cancel(),p.currentPopupAction=this}executeNotNull(){var d=this;return(0,S.A)(function*(){const m=yield d.execute();return fe(m,d.auth,"internal-error"),m})()}onExecution(){var d=this;return(0,S.A)(function*(){jn(1===d.filter.length,"Popup operations only handle one event");const m=Ua();d.authWindow=yield d.resolver._openPopup(d.auth,d.provider,d.filter[0],m),d.authWindow.associatedEvent=m,d.resolver._originValidation(d.auth).catch(E=>{d.reject(E)}),d.resolver._isIframeWebStorageSupported(d.auth,E=>{E||d.reject(xt(d.auth,"web-storage-unsupported"))}),d.pollUserCancellation()})()}get eventId(){var d;return(null===(d=this.authWindow)||void 0===d?void 0:d.associatedEvent)||null}cancel(){this.reject(xt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,p.currentPopupAction=null}pollUserCancellation(){const d=()=>{var m,E;this.pollId=null!==(E=null===(m=this.authWindow)||void 0===m?void 0:m.window)&&void 0!==E&&E.closed?window.setTimeout(()=>{this.pollId=null,this.reject(xt(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(d,sb.get())};d()}}return p.currentPopupAction=null,p})();const Wo="pendingRedirect",fl=new Map;class cb extends Lg{constructor(l,d,m=!1){super(l,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],d,void 0,m),this.eventId=null}execute(){var l=()=>super.execute,d=this;return(0,S.A)(function*(){let m=fl.get(d.auth._key());if(!m){try{const T=(yield function Fr(p,l){return lh.apply(this,arguments)}(d.resolver,d.auth))?yield l().call(d):null;m=()=>Promise.resolve(T)}catch(E){m=()=>Promise.reject(E)}fl.set(d.auth._key(),m)}return d.bypassAuthState||fl.set(d.auth._key(),()=>Promise.resolve(null)),m()})()}onAuthEvent(l){var d=()=>super.onAuthEvent,m=this;return(0,S.A)(function*(){if("signInViaRedirect"===l.type)return d().call(m,l);if("unknown"!==l.type){if(l.eventId){const E=yield m.auth._redirectUserForId(l.eventId);if(E)return m.user=E,d().call(m,l);m.resolve(null)}}else m.resolve(null)})()}onExecution(){return(0,S.A)(function*(){})()}cleanUp(){}}function lh(){return(lh=(0,S.A)(function*(p,l){const d=go(l),m=gr(p);if(!(yield m._isAvailable()))return!1;const E="true"===(yield m._get(d));return yield m._remove(d),E})).apply(this,arguments)}function Je(p,l){return Vr.apply(this,arguments)}function Vr(){return(Vr=(0,S.A)(function*(p,l){return gr(p)._set(go(l),"true")})).apply(this,arguments)}function Gn(p,l){fl.set(p._key(),l)}function gr(p){return Be(p._redirectPersistence)}function go(p){return rr(Wo,p.config.apiKey,p.name)}function Ur(p,l,d){return function _E(p,l,d){return dh.apply(this,arguments)}(p,l,d)}function dh(){return(dh=(0,S.A)(function*(p,l,d){if((0,Me._isFirebaseServerApp)(p.app))return Promise.reject(Ye(p));const m=pn(p);Mn(p,l,Hs),yield m._initializationPromise;const E=ja(m,d);return yield Je(E,m),E._openRedirect(m,l,"signInViaRedirect")})).apply(this,arguments)}function hh(p,l,d){return function lb(p,l,d){return Bg.apply(this,arguments)}(p,l,d)}function Bg(){return(Bg=(0,S.A)(function*(p,l,d){const m=(0,X.Ku)(p);if(Mn(m.auth,l,Hs),(0,Me._isFirebaseServerApp)(m.auth.app))return Promise.reject(Ye(m.auth));yield m.auth._initializationPromise;const E=ja(m.auth,d);yield Je(E,m.auth);const T=yield vE(m);return E._openRedirect(m.auth,l,"reauthViaRedirect",T)})).apply(this,arguments)}function fh(p,l,d){return function db(p,l,d){return pl.apply(this,arguments)}(p,l,d)}function pl(){return(pl=(0,S.A)(function*(p,l,d){const m=(0,X.Ku)(p);Mn(m.auth,l,Hs),yield m.auth._initializationPromise;const E=ja(m.auth,d);yield yg(!1,m,l.providerId),yield Je(E,m.auth);const T=yield vE(m);return E._openRedirect(m.auth,l,"linkViaRedirect",T)})).apply(this,arguments)}function $u(){return($u=(0,S.A)(function*(p,l){return yield pn(p)._initializationPromise,jg(p,l,!1)})).apply(this,arguments)}function jg(p,l){return gl.apply(this,arguments)}function gl(){return(gl=(0,S.A)(function*(p,l,d=!1){if((0,Me._isFirebaseServerApp)(p.app))return Promise.reject(Ye(p));const m=pn(p),E=ja(m,l),N=yield new cb(m,E,d).execute();return N&&!d&&(delete N.user._redirectEventId,yield m._persistUserIfCurrent(N.user),yield m._setRedirectUser(null,l)),N})).apply(this,arguments)}function vE(p){return ml.apply(this,arguments)}function ml(){return(ml=(0,S.A)(function*(p){const l=Ua(`${p.uid}:::`);return p._redirectEventId=l,yield p.auth._setRedirectUser(p),yield p.auth._persistUserIfCurrent(p),l})).apply(this,arguments)}class $g{constructor(l){this.auth=l,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(l){this.consumers.add(l),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,l)&&(this.sendToConsumer(this.queuedRedirectEvent,l),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(l){this.consumers.delete(l)}onEvent(l){if(this.hasEventBeenHandled(l))return!1;let d=!1;return this.consumers.forEach(m=>{this.isEventForConsumer(l,m)&&(d=!0,this.sendToConsumer(l,m),this.saveEventToCache(l))}),this.hasHandledPotentialRedirect||!function Hg(p){switch(p.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return IE(p);default:return!1}}(l)||(this.hasHandledPotentialRedirect=!0,d||(this.queuedRedirectEvent=l,d=!0)),d}sendToConsumer(l,d){var m;if(l.error&&!IE(l)){const E=(null===(m=l.error.code)||void 0===m?void 0:m.split("auth/")[1])||"internal-error";d.onError(xt(this.auth,E))}else d.onAuthEvent(l)}isEventForConsumer(l,d){const m=null===d.eventId||!!l.eventId&&l.eventId===d.eventId;return d.filter.includes(l.type)&&m}hasEventBeenHandled(l){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ko(l))}saveEventToCache(l){this.cachedEventUids.add(Ko(l)),this.lastProcessedEventTime=Date.now()}}function Ko(p){return[p.type,p.eventId,p.sessionId,p.tenantId].filter(l=>l).join("-")}function IE({type:p,error:l}){return"unknown"===p&&"auth/no-auth-event"===l?.code}function _l(p){return Gg.apply(this,arguments)}function Gg(){return(Gg=(0,S.A)(function*(p,l={}){return Re(p,"GET","/v1/projects",l)})).apply(this,arguments)}const qg=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ph=/^https?/;function Qo(){return(Qo=(0,S.A)(function*(p){if(p.config.emulator)return;const{authorizedDomains:l}=yield _l(p);for(const d of l)try{if(zg(d))return}catch{}Mt(p,"unauthorized-domain")})).apply(this,arguments)}function zg(p){const l=ri(),{protocol:d,hostname:m}=new URL(l);if(p.startsWith("chrome-extension://")){const N=new URL(p);return""===N.hostname&&""===m?"chrome-extension:"===d&&p.replace("chrome-extension://","")===l.replace("chrome-extension://",""):"chrome-extension:"===d&&N.hostname===m}if(!ph.test(d))return!1;if(qg.test(p))return m===p;const E=p.replace(/\./g,"\\.");return new RegExp("^(.+\\."+E+"|"+E+")$","i").test(m)}const hb=new K(3e4,6e4);function wE(){const p=Qn().___jsl;if(p?.H)for(const l of Object.keys(p.H))if(p.H[l].r=p.H[l].r||[],p.H[l].L=p.H[l].L||[],p.H[l].r=[...p.H[l].L],p.CP)for(let d=0;d<p.CP.length;d++)p.CP[d]=null}let mo=null;const pb=new K(5e3,15e3),gb="__/auth/iframe",Wg="emulator/auth/iframe",zs={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CE=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gh(p){const l=p.config;fe(l.authDomain,p,"auth-domain-config-required");const d=l.emulator?Z(l,Wg):`https://${p.config.authDomain}/${gb}`,m={apiKey:l.apiKey,appName:p.name,v:Me.SDK_VERSION},E=CE.get(p.config.apiHost);E&&(m.eid=E);const T=p._getFrameworks();return T.length&&(m.fw=T.join(",")),`${d}?${(0,X.Am)(m).slice(1)}`}function Kg(){return Kg=(0,S.A)(function*(p){const l=yield function fb(p){return mo=mo||function TE(p){return new Promise((l,d)=>{var m,E,T;function N(){wE(),gapi.load("gapi.iframes",{callback:()=>{l(gapi.iframes.getContext())},ontimeout:()=>{wE(),d(xt(p,"network-request-failed"))},timeout:hb.get()})}if(null!==(E=null===(m=Qn().gapi)||void 0===m?void 0:m.iframes)&&void 0!==E&&E.Iframe)l(gapi.iframes.getContext());else{if(null===(T=Qn().gapi)||void 0===T||!T.load){const B=TA("iframefcb");return Qn()[B]=()=>{gapi.load?N():d(xt(p,"network-request-failed"))},Zp(`${function vk(){return xa.gapiScript}()}?onload=${B}`).catch(te=>d(te))}N()}}).catch(l=>{throw mo=null,l})}(p),mo}(p),d=Qn().gapi;return fe(d,p,"internal-error"),l.open({where:document.body,url:gh(p),messageHandlersFilter:d.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zs,dontclear:!0},m=>new Promise(function(){var E=(0,S.A)(function*(T,N){yield m.restyle({setHideOnLeave:!1});const B=xt(p,"network-request-failed"),te=Qn().setTimeout(()=>{N(B)},pb.get());function we(){Qn().clearTimeout(te),T(m)}m.ping(we).then(we,()=>{N(B)})});return function(T,N){return E.apply(this,arguments)}}()))}),Kg.apply(this,arguments)}const mb={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class bE{constructor(l){this.window=l,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const Eb="__/auth/handler",Ib="emulator/auth/handler",wb=encodeURIComponent("fac");function vl(p,l,d,m,E,T){return Gu.apply(this,arguments)}function Gu(){return(Gu=(0,S.A)(function*(p,l,d,m,E,T){fe(p.config.authDomain,p,"auth-domain-config-required"),fe(p.config.apiKey,p,"invalid-api-key");const N={apiKey:p.config.apiKey,appName:p.name,authType:d,redirectUrl:m,v:Me.SDK_VERSION,eventId:E};if(l instanceof Hs){l.setDefaultLanguage(p.languageCode),N.providerId=l.providerId||"",(0,X.Im)(l.getCustomParameters())||(N.customParameters=JSON.stringify(l.getCustomParameters()));for(const[xe,ke]of Object.entries(T||{}))N[xe]=ke}if(l instanceof Du){const xe=l.getScopes().filter(ke=>""!==ke);xe.length>0&&(N.scopes=xe.join(","))}p.tenantId&&(N.tid=p.tenantId);const B=N;for(const xe of Object.keys(B))void 0===B[xe]&&delete B[xe];const te=yield p._getAppCheckToken(),we=te?`#${wb}=${encodeURIComponent(te)}`:"";return`${function gn({config:p}){return p.emulator?Z(p,Ib):`https://${p.authDomain}/${Eb}`}(p)}?${(0,X.Am)(B).slice(1)}${we}`})).apply(this,arguments)}const ye="webStorageSupport",qn=class qe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Va,this._completeRedirectFn=jg,this._overrideRedirectResult=Gn}_openPopup(l,d,m,E){var T=this;return(0,S.A)(function*(){var N;jn(null===(N=T.eventManagers[l._key()])||void 0===N?void 0:N.manager,"_initialize() not called before _openPopup()");const B=yield vl(l,d,m,ri(),E);return function yb(p,l,d,m=500,E=600){const T=Math.max((window.screen.availHeight-E)/2,0).toString(),N=Math.max((window.screen.availWidth-m)/2,0).toString();let B="";const te=Object.assign(Object.assign({},mb),{width:m.toString(),height:E.toString(),top:T,left:N}),we=(0,X.ZQ)().toLowerCase();d&&(B=bu(we)?"_blank":d),$s(we)&&(l=l||"http://localhost",te.scrollbars="yes");const xe=Object.entries(te).reduce((bn,[Es,ee])=>`${bn}${Es}=${ee},`,"");if(function j(p=(0,X.ZQ)()){var l;return Pa(p)&&!(null===(l=window.navigator)||void 0===l||!l.standalone)}(we)&&"_self"!==B)return function vb(p,l){const d=document.createElement("a");d.href=p,d.target=l;const m=document.createEvent("MouseEvent");m.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),d.dispatchEvent(m)}(l||"",B),new bE(null);const ke=window.open(l||"",B,xe);fe(ke,p,"popup-blocked");try{ke.focus()}catch{}return new bE(ke)}(l,B,Ua())})()}_openRedirect(l,d,m,E){var T=this;return(0,S.A)(function*(){return yield T._originValidation(l),function JA(p){Qn().location.href=p}(yield vl(l,d,m,ri(),E)),new Promise(()=>{})})()}_initialize(l){const d=l._key();if(this.eventManagers[d]){const{manager:E,promise:T}=this.eventManagers[d];return E?Promise.resolve(E):(jn(T,"If manager is not set, promise should be"),T)}const m=this.initAndGetManager(l);return this.eventManagers[d]={promise:m},m.catch(()=>{delete this.eventManagers[d]}),m}initAndGetManager(l){var d=this;return(0,S.A)(function*(){const m=yield function Hu(p){return Kg.apply(this,arguments)}(l),E=new $g(l);return m.register("authEvent",T=>(fe(T?.authEvent,l,"invalid-auth-event"),{status:E.onEvent(T.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),d.eventManagers[l._key()]={manager:E},d.iframes[l._key()]=m,E})()}_isIframeWebStorageSupported(l,d){this.iframes[l._key()].send(ye,{type:ye},E=>{var T;const N=null===(T=E?.[0])||void 0===T?void 0:T[ye];void 0!==N&&d(!!N),Mt(l,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(l){const d=l._key();return this.originValidationPromises[d]||(this.originValidationPromises[d]=function ci(p){return Qo.apply(this,arguments)}(l)),this.originValidationPromises[d]}get _shouldInitProactively(){return Se()||Vo()||Pa()}};class Wi{constructor(l){this.factorId=l}_process(l,d,m){switch(d.type){case"enroll":return this._finalizeEnroll(l,d.credential,m);case"signin":return this._finalizeSignIn(l,d.credential);default:return fn("unexpected MultiFactorSessionType")}}}class sr extends Wi{constructor(l){super("phone"),this.credential=l}static _fromCredential(l){return new sr(l)}_finalizeEnroll(l,d,m){return function il(p,l){return Re(p,"POST","/v2/accounts/mfaEnrollment:finalize",ue(p,l))}(l,{idToken:d,displayName:m,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(l,d){return function Fu(p,l){return Re(p,"POST","/v2/accounts/mfaSignIn:finalize",ue(p,l))}(l,{mfaPendingCredential:d,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Qr=(()=>{class p{constructor(){}static assertion(d){return sr._fromCredential(d)}}return p.FACTOR_ID="phone",p})();var Xe="@firebase/auth";class DE{constructor(l){this.auth=l,this.internalListeners=new Map}getUid(){var l;return this.assertAuthConfigured(),(null===(l=this.auth.currentUser)||void 0===l?void 0:l.uid)||null}getToken(l){var d=this;return(0,S.A)(function*(){return d.assertAuthConfigured(),yield d.auth._initializationPromise,d.auth.currentUser?{accessToken:yield d.auth.currentUser.getIdToken(l)}:null})()}addAuthTokenListener(l){if(this.assertAuthConfigured(),this.internalListeners.has(l))return;const d=this.auth.onIdTokenChanged(m=>{l(m?.stsTokenManager.accessToken||null)});this.internalListeners.set(l,d),this.updateProactiveRefresh()}removeAuthTokenListener(l){this.assertAuthConfigured();const d=this.internalListeners.get(l);d&&(this.internalListeners.delete(l),d(),this.updateProactiveRefresh())}assertAuthConfigured(){fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Ks(){return window}(0,X.XA)("authIdTokenMaxAge"),function Yp(p){xa=p}({loadJS:p=>new Promise((l,d)=>{const m=document.createElement("script");m.setAttribute("src",p),m.onload=l,m.onerror=E=>{const T=xt("internal-error");T.customData=E,d(T)},m.type="text/javascript",m.charset="UTF-8",function Yo(){var p,l;return null!==(l=null===(p=document.getElementsByTagName("head"))||void 0===p?void 0:p[0])&&void 0!==l?l:document}().appendChild(m)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),function mn(p){(0,Me._registerComponent)(new Pn.uA("auth",(l,{options:d})=>{const m=l.getProvider("app").getImmediate(),E=l.getProvider("heartbeat"),T=l.getProvider("app-check-internal"),{apiKey:N,authDomain:B}=m.options;fe(N&&!N.includes(":"),"invalid-api-key",{appName:m.name});const te={apiKey:N,authDomain:B,clientPlatform:p,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:it(p)},we=new Qp(m,E,T,te);return function RA(p,l){const d=l?.persistence||[],m=(Array.isArray(d)?d:[d]).map(Be);l?.errorMap&&p._updateErrorMap(l.errorMap),p._initializeWithPersistence(m,l?.popupRedirectResolver)}(we,d),we},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((l,d,m)=>{l.getProvider("auth-internal").initialize()})),(0,Me._registerComponent)(new Pn.uA("auth-internal",l=>{const d=pn(l.getProvider("auth").getImmediate());return new DE(d)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,Me.registerVersion)(Xe,"1.7.6",function zu(p){switch(p){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(p)),(0,Me.registerVersion)(Xe,"1.7.6","esm2017")}("Browser");function Il(){return Il=(0,S.A)(function*(p,l,d){var m;const{BuildInfo:E}=Ks();jn(l.sessionId,"AuthEvent did not contain a session ID");const T=yield function mr(p){return _r.apply(this,arguments)}(l.sessionId),N={};return Pa()?N.ibi=E.packageName:Na()?N.apn=E.packageName:Mt(p,"operation-not-supported-in-this-environment"),E.displayName&&(N.appDisplayName=E.displayName),N.sessionId=T,vl(p,d,l.type,void 0,null!==(m=l.eventId)&&void 0!==m?m:void 0,N)}),Il.apply(this,arguments)}function Qi(){return(Qi=(0,S.A)(function*(p){const{BuildInfo:l}=Ks(),d={};Pa()?d.iosBundleId=l.packageName:Na()?d.androidPackageName=l.packageName:Mt(p,"operation-not-supported-in-this-environment"),yield _l(p,d)})).apply(this,arguments)}function An(){return(An=(0,S.A)(function*(p,l,d){const{cordova:m}=Ks();let E=()=>{};try{yield new Promise((T,N)=>{let B=null;function te(){var ke;T();const bn=null===(ke=m.plugins.browsertab)||void 0===ke?void 0:ke.close;"function"==typeof bn&&bn(),"function"==typeof d?.close&&d.close()}function we(){B||(B=window.setTimeout(()=>{N(xt(p,"redirect-cancelled-by-user"))},2e3))}function xe(){"visible"===document?.visibilityState&&we()}l.addPassiveListener(te),document.addEventListener("resume",we,!1),Na()&&document.addEventListener("visibilitychange",xe,!1),E=()=>{l.removePassiveListener(te),document.removeEventListener("resume",we,!1),document.removeEventListener("visibilitychange",xe,!1),B&&window.clearTimeout(B)}})}finally{E()}})).apply(this,arguments)}function _r(){return(_r=(0,S.A)(function*(p){const l=function Qg(p){if(jn(/[0-9a-zA-Z]+/.test(p),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(p);const l=new ArrayBuffer(p.length),d=new Uint8Array(l);for(let m=0;m<p.length;m++)d[m]=p.charCodeAt(m);return d}(p),d=yield crypto.subtle.digest("SHA-256",l);return Array.from(new Uint8Array(d)).map(E=>E.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class yh extends $g{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(l=>{this.resolveInitialized=l})}addPassiveListener(l){this.passiveListeners.add(l)}removePassiveListener(l){this.passiveListeners.delete(l)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(l){return this.resolveInitialized(),this.passiveListeners.forEach(d=>d(l)),super.onEvent(l)}initialized(){var l=this;return(0,S.A)(function*(){yield l.initPromise})()}}function SE(p){return Yg.apply(this,arguments)}function Yg(){return(Yg=(0,S.A)(function*(p){const l=yield Jg()._get(Cl(p));return l&&(yield Jg()._remove(Cl(p))),l})).apply(this,arguments)}function RE(){const p=[];for(let d=0;d<20;d++){const m=Math.floor(62*Math.random());p.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(m))}return p.join("")}function Jg(){return Be(br)}function Cl(p){return rr("authEvent",p.config.apiKey,p.name)}function Xg(p){if(!p?.includes("?"))return{};const[l,...d]=p.split("?");return(0,X.I9)(d.join("?"))}const zk=class qk{constructor(){this._redirectPersistence=Va,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=jg,this._overrideRedirectResult=Gn}_initialize(l){var d=this;return(0,S.A)(function*(){const m=l._key();let E=d.eventManagers.get(m);return E||(E=new yh(l),d.eventManagers.set(m,E),d.attachCallbackListeners(l,E)),E})()}_openPopup(l){Mt(l,"operation-not-supported-in-this-environment")}_openRedirect(l,d,m,E){var T=this;return(0,S.A)(function*(){!function _h(p){var l,d,m,E,T,N,B,te,we,xe;const ke=Ks();fe("function"==typeof(null===(l=ke?.universalLinks)||void 0===l?void 0:l.subscribe),p,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),fe(typeof(null===(d=ke?.BuildInfo)||void 0===d?void 0:d.packageName)<"u",p,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),fe("function"==typeof(null===(T=null===(E=null===(m=ke?.cordova)||void 0===m?void 0:m.plugins)||void 0===E?void 0:E.browsertab)||void 0===T?void 0:T.openUrl),p,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),fe("function"==typeof(null===(te=null===(B=null===(N=ke?.cordova)||void 0===N?void 0:N.plugins)||void 0===B?void 0:B.browsertab)||void 0===te?void 0:te.isAvailable),p,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),fe("function"==typeof(null===(xe=null===(we=ke?.cordova)||void 0===we?void 0:we.InAppBrowser)||void 0===xe?void 0:xe.open),p,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(l);const N=yield T._initialize(l);yield N.initialized(),N.resetRedirect(),function gt(){fl.clear()}(),yield T._originValidation(l);const B=function vs(p,l,d=null){return{type:l,eventId:d,urlResponse:null,sessionId:RE(),postBody:null,tenantId:p.tenantId,error:xt(p,"no-auth-event")}}(l,m,E);yield function Tl(p,l){return Jg()._set(Cl(p),l)}(l,B);const te=yield function je(p,l,d){return Il.apply(this,arguments)}(l,B,d),we=yield function mh(p){const{cordova:l}=Ks();return new Promise(d=>{l.plugins.browsertab.isAvailable(m=>{let E=null;m?l.plugins.browsertab.openUrl(p):E=l.InAppBrowser.open(p,function Y(p=(0,X.ZQ)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(p)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(p)}()?"_blank":"_system","location=yes"),d(E)})})}(te);return function Qu(p,l,d){return An.apply(this,arguments)}(l,N,we)})()}_isIframeWebStorageSupported(l,d){throw new Error("Method not implemented.")}_originValidation(l){const d=l._key();return this.originValidationPromises[d]||(this.originValidationPromises[d]=function wl(p){return Qi.apply(this,arguments)}(l)),this.originValidationPromises[d]}attachCallbackListeners(l,d){const{universalLinks:m,handleOpenURL:E,BuildInfo:T}=Ks(),N=setTimeout((0,S.A)(function*(){yield SE(l),d.onEvent(Cb())}),500),B=function(){var xe=(0,S.A)(function*(ke){clearTimeout(N);const bn=yield SE(l);let Es=null;bn&&ke?.url&&(Es=function Zg(p,l){var d,m;const E=function Hk(p){const l=Xg(p),d=l.link?decodeURIComponent(l.link):void 0,m=Xg(d).link,E=l.deep_link_id?decodeURIComponent(l.deep_link_id):void 0;return Xg(E).link||E||m||d||p}(l);if(E.includes("/__/auth/callback")){const T=Xg(E),N=T.firebaseError?function $k(p){try{return JSON.parse(p)}catch{return null}}(decodeURIComponent(T.firebaseError)):null,B=null===(m=null===(d=N?.code)||void 0===d?void 0:d.split("auth/"))||void 0===m?void 0:m[1],te=B?xt(B):null;return te?{type:p.type,eventId:p.eventId,tenantId:p.tenantId,error:te,urlResponse:null,sessionId:null,postBody:null}:{type:p.type,eventId:p.eventId,tenantId:p.tenantId,sessionId:p.sessionId,urlResponse:E,postBody:null}}return null}(bn,ke.url)),d.onEvent(Es||Cb())});return function(bn){return xe.apply(this,arguments)}}();typeof m<"u"&&"function"==typeof m.subscribe&&m.subscribe(null,B);const te=E,we=`${T.packageName.toLowerCase()}://`;Ks().handleOpenURL=function(){var xe=(0,S.A)(function*(ke){if(ke.toLowerCase().startsWith(we)&&B({url:ke}),"function"==typeof te)try{te(ke)}catch(bn){console.error(bn)}});return function(ke){return xe.apply(this,arguments)}}()}};function Cb(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:xt("no-auth-event")}}function vh(){var p;return(null===(p=self?.location)||void 0===p?void 0:p.protocol)||null}function em(p=(0,X.ZQ)()){return!("file:"!==vh()&&"ionic:"!==vh()&&"capacitor:"!==vh()||!p.toLowerCase().match(/iphone|ipad|ipod|android/))}function PE(){try{const p=self.localStorage,l=Ua();if(p)return p.setItem(l,"1"),p.removeItem(l),!function eO(p=(0,X.ZQ)()){return function Jk(){return(0,X.lT)()&&11===document?.documentMode}()||function Xk(p=(0,X.ZQ)()){return/Edge\/\d+/.test(p)}(p)}()||(0,X.zW)()}catch{return Eh()&&(0,X.zW)()}return!1}function Eh(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function li(){return(function NE(){return"http:"===vh()||"https:"===vh()}()||(0,X.sr)()||em())&&!function Zk(){return(0,X.lV)()||(0,X.Ll)()}()&&PE()&&!Eh()}function tm(){return em()&&typeof document<"u"}function nm(){return(nm=(0,S.A)(function*(){return!!tm()&&new Promise(p=>{const l=setTimeout(()=>{p(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(l),p(!0)})})})).apply(this,arguments)}const di={LOCAL:"local",NONE:"none",SESSION:"session"},Al=fe,Ih="persistence";function Yi(p){return wh.apply(this,arguments)}function wh(){return(wh=(0,S.A)(function*(p){yield p._initializationPromise;const l=bt(),d=rr(Ih,p.config.apiKey,p.name);l&&l.setItem(d,p._getPersistence())})).apply(this,arguments)}function bt(){var p;try{return(null===(p=function ME(){return typeof window<"u"?window:null}())||void 0===p?void 0:p.sessionStorage)||null}catch{return null}}const rm=fe;class Zi{constructor(){this.browserResolver=Be(qn),this.cordovaResolver=Be(zk),this.underlyingResolver=null,this._redirectPersistence=Va,this._completeRedirectFn=jg,this._overrideRedirectResult=Gn}_initialize(l){var d=this;return(0,S.A)(function*(){return yield d.selectUnderlyingResolver(),d.assertedUnderlyingResolver._initialize(l)})()}_openPopup(l,d,m,E){var T=this;return(0,S.A)(function*(){return yield T.selectUnderlyingResolver(),T.assertedUnderlyingResolver._openPopup(l,d,m,E)})()}_openRedirect(l,d,m,E){var T=this;return(0,S.A)(function*(){return yield T.selectUnderlyingResolver(),T.assertedUnderlyingResolver._openRedirect(l,d,m,E)})()}_isIframeWebStorageSupported(l,d){this.assertedUnderlyingResolver._isIframeWebStorageSupported(l,d)}_originValidation(l){return this.assertedUnderlyingResolver._originValidation(l)}get _shouldInitProactively(){return tm()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return rm(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var l=this;return(0,S.A)(function*(){if(l.underlyingResolver)return;const d=yield function Ab(){return nm.apply(this,arguments)}();l.underlyingResolver=d?l.cordovaResolver:l.browserResolver})()}}function Br(p){return p.unwrap()}function bl(p){return hi(p)}function hi(p){const{_tokenResponse:l}=p instanceof X.g?p.customData:p;if(!l)return null;if(!(p instanceof X.g)&&"temporaryProof"in l&&"phoneNumber"in l)return ju.credentialFromResult(p);const d=l.providerId;if(!d||d===Vt.PASSWORD)return null;let m;switch(d){case Vt.GOOGLE:m=UA;break;case Vt.FACEBOOK:m=Ov;break;case Vt.GITHUB:m=Lv;break;case Vt.TWITTER:m=Fv;break;default:const{oauthIdToken:E,oauthAccessToken:T,oauthTokenSecret:N,pendingToken:B,nonce:te}=l;return T||N||E||B?B?d.startsWith("saml.")?Su._create(d,B):co._fromParams({providerId:d,signInMethod:d,pendingToken:B,idToken:E,accessToken:T}):new tl(d).credential({idToken:E,accessToken:T,rawNonce:te}):null}return p instanceof X.g?m.credentialFromError(p):m.credentialFromResult(p)}function fi(p,l){return l.catch(d=>{throw d instanceof X.g&&function Ga(p,l){var d;const m=null===(d=l.customData)||void 0===d?void 0:d._tokenResponse;if("auth/multi-factor-auth-required"===l?.code)l.resolver=new Ji(p,function oE(p,l){var d;const m=(0,X.Ku)(p),E=l;return fe(l.customData.operationType,m,"argument-error"),fe(null===(d=E.customData._serverResponse)||void 0===d?void 0:d.mfaPendingCredential,m,"argument-error"),rl._fromError(m,E)}(p,l));else if(m){const E=hi(l),T=l;E&&(T.credential=E,T.tenantId=m.tenantId||void 0,T.email=m.email||void 0,T.phoneNumber=m.phoneNumber||void 0)}}(p,d),d}).then(d=>{const E=d.user;return{operationType:d.operationType,credential:bl(d),additionalUserInfo:zA(d),user:Qs.getOrCreate(E)}})}function Dl(p,l){return im.apply(this,arguments)}function im(){return(im=(0,S.A)(function*(p,l){const d=yield l;return{verificationId:d.verificationId,confirm:m=>fi(p,d.confirm(m))}})).apply(this,arguments)}class Ji{constructor(l,d){this.resolver=d,this.auth=function Db(p){return p.wrapped()}(l)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(l){return fi(Br(this.auth),this.resolver.resolveSignIn(l))}}class Qs{constructor(l){this._delegate=l,this.multiFactor=function QA(p){const l=(0,X.Ku)(p);return Dg.has(l)||Dg.set(l,aE._fromUser(l)),Dg.get(l)}(l)}static getOrCreate(l){return Qs.USER_MAP.has(l)||Qs.USER_MAP.set(l,new Qs(l)),Qs.USER_MAP.get(l)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(l){return this._delegate.getIdTokenResult(l)}getIdToken(l){return this._delegate.getIdToken(l)}linkAndRetrieveDataWithCredential(l){return this.linkWithCredential(l)}linkWithCredential(l){var d=this;return(0,S.A)(function*(){return fi(d.auth,Eg(d._delegate,l))})()}linkWithPhoneNumber(l,d){var m=this;return(0,S.A)(function*(){return Dl(m.auth,function _s(p,l,d){return qs.apply(this,arguments)}(m._delegate,l,d))})()}linkWithPopup(l){var d=this;return(0,S.A)(function*(){return fi(d.auth,function ub(p,l,d){return Vg.apply(this,arguments)}(d._delegate,l,Zi))})()}linkWithRedirect(l){var d=this;return(0,S.A)(function*(){return yield Yi(pn(d.auth)),fh(d._delegate,l,Zi)})()}reauthenticateAndRetrieveDataWithCredential(l){return this.reauthenticateWithCredential(l)}reauthenticateWithCredential(l){var d=this;return(0,S.A)(function*(){return fi(d.auth,$A(d._delegate,l))})()}reauthenticateWithPhoneNumber(l,d){return Dl(this.auth,function nb(p,l,d){return cl.apply(this,arguments)}(this._delegate,l,d))}reauthenticateWithPopup(l){return fi(this.auth,function ab(p,l,d){return ch.apply(this,arguments)}(this._delegate,l,Zi))}reauthenticateWithRedirect(l){var d=this;return(0,S.A)(function*(){return yield Yi(pn(d.auth)),hh(d._delegate,l,Zi)})()}sendEmailVerification(l){return function kk(p,l){return Wr.apply(this,arguments)}(this._delegate,l)}unlink(l){var d=this;return(0,S.A)(function*(){return yield function Dk(p,l){return Bv.apply(this,arguments)}(d._delegate,l),d})()}updateEmail(l){return function Ne(p,l){const d=(0,X.Ku)(p);return(0,Me._isFirebaseServerApp)(d.auth.app)?Promise.reject(Ye(d.auth)):pr(d,l,null)}(this._delegate,l)}updatePassword(l){return function Fk(p,l){return pr((0,X.Ku)(p),null,l)}(this._delegate,l)}updatePhoneNumber(l){return function dl(p,l){return uh.apply(this,arguments)}(this._delegate,l)}updateProfile(l){return function Lk(p,l){return Xv.apply(this,arguments)}(this._delegate,l)}verifyBeforeUpdateEmail(l,d){return function Qe(p,l,d){return Zv.apply(this,arguments)}(this._delegate,l,d)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Qs.USER_MAP=new WeakMap;const Yu=fe;let sm=(()=>{class p{constructor(d,m){if(this.app=d,m.isInitialized())return this._delegate=m.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:E}=d.options;Yu(E,"invalid-api-key",{appName:d.name}),Yu(E,"invalid-api-key",{appName:d.name});const T=typeof window<"u"?Zi:void 0;this._delegate=m.initialize({options:{persistence:om(E,d.name),popupRedirectResolver:T}}),this._delegate._updateErrorMap(fr),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Qs.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(d){this._delegate.languageCode=d}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(d){this._delegate.tenantId=d}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(d,m){!function NA(p,l,d){const m=pn(p);fe(m._canInitEmulator,m,"emulator-config-failed"),fe(/^https?:\/\//.test(l),m,"invalid-emulator-scheme");const E=!!d?.disableWarnings,T=Dv(l),{host:N,port:B}=function PA(p){const l=Dv(p),d=/(\/\/)?([^?#/]+)/.exec(p.substr(l.length));if(!d)return{host:"",port:null};const m=d[2].split("@").pop()||"",E=/^(\[[^\]]+\])(:|$)/.exec(m);if(E){const T=E[1];return{host:T,port:Sv(m.substr(T.length+1))}}{const[T,N]=m.split(":");return{host:T,port:Sv(N)}}}(l);m.config.emulator={url:`${T}//${N}${null===B?"":`:${B}`}/`},m.settings.appVerificationDisabledForTesting=!0,m.emulatorConfig=Object.freeze({host:N,port:B,protocol:T.replace(":",""),options:Object.freeze({disableWarnings:E})}),E||function Rv(){function p(){const l=document.createElement("p"),d=l.style;l.innerText="Running in emulator mode. Do not use with production credentials.",d.position="fixed",d.width="100%",d.backgroundColor="#ffffff",d.border=".1em solid #000000",d.color="#b50000",d.bottom="0px",d.left="0px",d.margin="0px",d.zIndex="10000",d.textAlign="center",l.classList.add("firebase-emulator-warning"),document.body.appendChild(l)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",p):p())}()}(this._delegate,d,m)}applyActionCode(d){return function wg(p,l){return Wv.apply(this,arguments)}(this._delegate,d)}checkActionCode(d){return Kv(this._delegate,d)}confirmPasswordReset(d,m){return function HA(p,l,d){return Hn.apply(this,arguments)}(this._delegate,d,m)}createUserWithEmailAndPassword(d,m){var E=this;return(0,S.A)(function*(){return fi(E._delegate,function Ni(p,l,d){return Qv.apply(this,arguments)}(E._delegate,d,m))})()}fetchProvidersForEmail(d){return this.fetchSignInMethodsForEmail(d)}fetchSignInMethodsForEmail(d){return function xk(p,l){return Cg.apply(this,arguments)}(this._delegate,d)}isSignInWithEmailLink(d){return function Nk(p,l){const d=Qd.parseLink(l);return"EMAIL_SIGNIN"===d?.operation}(0,d)}getRedirectResult(){var d=this;return(0,S.A)(function*(){Yu(li(),d._delegate,"operation-not-supported-in-this-environment");const m=yield function yE(p,l){return $u.apply(this,arguments)}(d._delegate,Zi);return m?fi(d._delegate,Promise.resolve(m)):{credential:null,user:null}})()}addFrameworkForLogging(d){!function Wk(p,l){pn(p)._logFramework(l)}(this._delegate,d)}onAuthStateChanged(d,m,E){const{next:T,error:N,complete:B}=Zu(d,m,E);return this._delegate.onAuthStateChanged(T,N,B)}onIdTokenChanged(d,m,E){const{next:T,error:N,complete:B}=Zu(d,m,E);return this._delegate.onIdTokenChanged(T,N,B)}sendSignInLinkToEmail(d,m){return function Rk(p,l,d){return Gs.apply(this,arguments)}(this._delegate,d,m)}sendPasswordResetEmail(d,m){return function Sk(p,l,d){return Ot.apply(this,arguments)}(this._delegate,d,m||void 0)}setPersistence(d){var m=this;return(0,S.A)(function*(){let E;switch(function bb(p,l){Al(Object.values(di).includes(l),p,"invalid-persistence-type"),(0,X.lV)()?Al(l!==di.SESSION,p,"unsupported-persistence-type"):(0,X.Ll)()?Al(l===di.NONE,p,"unsupported-persistence-type"):Eh()?Al(l===di.NONE||l===di.LOCAL&&(0,X.zW)(),p,"unsupported-persistence-type"):Al(l===di.NONE||PE(),p,"unsupported-persistence-type")}(m._delegate,d),d){case di.SESSION:E=Va;break;case di.LOCAL:E=(yield Be(Lu)._isAvailable())?Lu:br;break;case di.NONE:E=Ae;break;default:return Mt("argument-error",{appName:m._delegate.name})}return m._delegate.setPersistence(E)})()}signInAndRetrieveDataWithCredential(d){return this.signInWithCredential(d)}signInAnonymously(){return fi(this._delegate,function gg(p){return mg.apply(this,arguments)}(this._delegate))}signInWithCredential(d){return fi(this._delegate,lo(this._delegate,d))}signInWithCustomToken(d){return fi(this._delegate,function Nu(p,l){return $o.apply(this,arguments)}(this._delegate,d))}signInWithEmailAndPassword(d,m){return fi(this._delegate,function GA(p,l,d){return(0,Me._isFirebaseServerApp)(p.app)?Promise.reject(Ye(p)):lo((0,X.Ku)(p),kv.credential(l,d)).catch(function(){var m=(0,S.A)(function*(E){throw"auth/password-does-not-meet-requirements"===E.code&&Zt(p),E});return function(E){return m.apply(this,arguments)}}())}(this._delegate,d,m))}signInWithEmailLink(d,m){return fi(this._delegate,function Pk(p,l,d){return Yv.apply(this,arguments)}(this._delegate,d,m))}signInWithPhoneNumber(d,m){return Dl(this._delegate,function oh(p,l,d){return Bu.apply(this,arguments)}(this._delegate,d,m))}signInWithPopup(d){var m=this;return(0,S.A)(function*(){return Yu(li(),m._delegate,"operation-not-supported-in-this-environment"),fi(m._delegate,function ob(p,l,d){return Fg.apply(this,arguments)}(m._delegate,d,Zi))})()}signInWithRedirect(d){var m=this;return(0,S.A)(function*(){return Yu(li(),m._delegate,"operation-not-supported-in-this-environment"),yield Yi(m._delegate),Ur(m._delegate,d,Zi)})()}updateCurrentUser(d){return this._delegate.updateCurrentUser(d)}verifyPasswordResetCode(d){return function Ze(p,l){return Mu.apply(this,arguments)}(this._delegate,d)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return p.Persistence=di,p})();function Zu(p,l,d){let m=p;"function"!=typeof p&&({next:m,error:l,complete:d}=p);const E=m;return{next:N=>E(N&&Qs.getOrCreate(N)),error:l,complete:d}}function om(p,l){const d=function xE(p,l){const d=bt();if(!d)return[];const m=rr(Ih,p,l);switch(d.getItem(m)){case di.NONE:return[Ae];case di.LOCAL:return[Lu,Va];case di.SESSION:return[Va];default:return[]}}(p,l);if(typeof self<"u"&&!d.includes(Lu)&&d.push(Lu),typeof window<"u")for(const m of[br,Va])d.includes(m)||d.push(m);return d.includes(Ae)||d.push(Ae),d}class Ju{constructor(){this.providerId="phone",this._delegate=new ju(Br(Fe.A.auth()))}static credential(l,d){return ju.credential(l,d)}verifyPhoneNumber(l,d){return this._delegate.verifyPhoneNumber(l,d)}unwrap(){return this._delegate}}Ju.PHONE_SIGN_IN_METHOD=ju.PHONE_SIGN_IN_METHOD,Ju.PROVIDER_ID=ju.PROVIDER_ID;const Th=fe;class am{constructor(l,d,m=Fe.A.app()){var E;Th(null===(E=m.options)||void 0===E?void 0:E.apiKey,"invalid-api-key",{appName:m.name}),this._delegate=new ms(m.auth(),l,d),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function et(p){p.INTERNAL.registerComponent(new Pn.uA("auth-compat",l=>{const d=l.getProvider("app-compat").getImmediate(),m=l.getProvider("auth");return new sm(d,m)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:kv,FacebookAuthProvider:Ov,GithubAuthProvider:Lv,GoogleAuthProvider:UA,OAuthProvider:tl,SAMLAuthProvider:Yd,PhoneAuthProvider:Ju,PhoneMultiFactorGenerator:Qr,RecaptchaVerifier:am,TwitterAuthProvider:Fv,Auth:sm,AuthCredential:ka,Error:X.g}).setInstantiationMode("LAZY").setMultipleInstances(!1)),p.registerVersion("@firebase/auth-compat","0.5.11")}(Fe.A)},467:(so,wr,ot)=>{function S(Me,X,Ft,Ve,Pn,Tr,Vt){try{var de=Me[Tr](Vt),_e=de.value}catch(Ue){return void Ft(Ue)}de.done?X(_e):Promise.resolve(_e).then(Ve,Pn)}function Fe(Me){return function(){var X=this,Ft=arguments;return new Promise(function(Ve,Pn){var Tr=Me.apply(X,Ft);function Vt(_e){S(Tr,Ve,Pn,Vt,de,"next",_e)}function de(_e){S(Tr,Ve,Pn,Vt,de,"throw",_e)}Vt(void 0)})}}ot.d(wr,{A:()=>Fe})},635:(so,wr,ot)=>{function X(K,Z){var se={};for(var oe in K)Object.prototype.hasOwnProperty.call(K,oe)&&Z.indexOf(oe)<0&&(se[oe]=K[oe]);if(null!=K&&"function"==typeof Object.getOwnPropertySymbols){var Ee=0;for(oe=Object.getOwnPropertySymbols(K);Ee<oe.length;Ee++)Z.indexOf(oe[Ee])<0&&Object.prototype.propertyIsEnumerable.call(K,oe[Ee])&&(se[oe[Ee]]=K[oe[Ee]])}return se}function Ue(K,Z,se,oe){return new(se||(se=Promise))(function(ue,Re){function Ct(wt){try{Ke(oe.next(wt))}catch(Yt){Re(Yt)}}function xn(wt){try{Ke(oe.throw(wt))}catch(Yt){Re(Yt)}}function Ke(wt){wt.done?ue(wt.value):function Ee(ue){return ue instanceof se?ue:new se(function(Re){Re(ue)})}(wt.value).then(Ct,xn)}Ke((oe=oe.apply(K,Z||[])).next())})}function an(K){return this instanceof an?(this.v=K,this):new an(K)}function Mt(K,Z,se){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ee,oe=se.apply(K,Z||[]),ue=[];return Ee={},Ct("next"),Ct("throw"),Ct("return",function Re(ze){return function($n){return Promise.resolve($n).then(ze,Yt)}}),Ee[Symbol.asyncIterator]=function(){return this},Ee;function Ct(ze,$n){oe[ze]&&(Ee[ze]=function(Tn){return new Promise(function(nr,Ht){ue.push([ze,Tn,nr,Ht])>1||xn(ze,Tn)})},$n&&(Ee[ze]=$n(Ee[ze])))}function xn(ze,$n){try{!function Ke(ze){ze.value instanceof an?Promise.resolve(ze.value.v).then(wt,Yt):Ls(ue[0][2],ze)}(oe[ze]($n))}catch(Tn){Ls(ue[0][3],Tn)}}function wt(ze){xn("next",ze)}function Yt(ze){xn("throw",ze)}function Ls(ze,$n){ze($n),ue.shift(),ue.length&&xn(ue[0][0],ue[0][1])}}function ni(K){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var se,Z=K[Symbol.asyncIterator];return Z?Z.call(K):(K=function Ut(K){var Z="function"==typeof Symbol&&Symbol.iterator,se=Z&&K[Z],oe=0;if(se)return se.call(K);if(K&&"number"==typeof K.length)return{next:function(){return K&&oe>=K.length&&(K=void 0),{value:K&&K[oe++],done:!K}}};throw new TypeError(Z?"Object is not iterable.":"Symbol.iterator is not defined.")}(K),se={},oe("next"),oe("throw"),oe("return"),se[Symbol.asyncIterator]=function(){return this},se);function oe(ue){se[ue]=K[ue]&&function(Re){return new Promise(function(Ct,xn){!function Ee(ue,Re,Ct,xn){Promise.resolve(xn).then(function(Ke){ue({value:Ke,done:Ct})},Re)}(Ct,xn,(Re=K[ue](Re)).done,Re.value)})}}}ot.d(wr,{AQ:()=>Mt,N3:()=>an,Tt:()=>X,sH:()=>Ue,xN:()=>ni}),"function"==typeof SuppressedError&&SuppressedError}},so=>{so(so.s=470)}]);